    

Ff

 

Be
Asa Hs =

LSEVIER

Energy 213 (2020) 118784

Contents lists available at ScienceDirect

te

 

Energy

journal homepage: www.elsevier.com/locate/energy See

 

Use of new variables based on air temperature for forecasting

 

day-ahead spot electricity prices using deep neural networks: A new _ ‘ease

approach

Tomasz Jasinski

Faculty of Management and Production Engineering, Lodz University of Technology, Piotrkowska 266, 90924, Lodz, Poland

ARTICLE INFO

Article history:

Received 4 April 2020

Received in revised form

30 August 2020

Accepted 2 September 2020
Available online 10 September 2020

JEL classification:
Q41
Q47
C45
C53

ABSTRACT

The paper presents a way of creating three new, innovative variables based on air temperature to be used
in forecasts of electricity demand and prices. The forecasting methods developed so far, especially in the
area of energy prices, either did not use temperature data or were based on data that had not undergone
pre-processing, which made it difficult for the model to use their potential. Newly developed variables
have a linear relationship with the demand for electricity. This paper describes in detail the procedure for
determining the parameters of new variables using the electricity market in Poland (a country in Central
Europe) as a case study. The proposed approach allows both to avoid data clustering into different
seasons and to precisely determine the temperatures at which the nature of the dependence with the
demand for electricity changes. The validity of the proposed new variables in prognostic models has been
confirmed by their use in deep neural networks. The proposed approach allows reducing the sMAPE by
up to 15.3%. The designed new explanatory variables can be used not only in models based on artificial

intelligence tools, but also in other forecasting methods that allow the use of exogenous inputs.

Keywords:

Electricity price

Forecasting

Artificial neural network

Air temperature-based variable

1. Introduction

Electricity is essential for the functioning of modern societies,
especially in high-growth countries, where wholesale electricity
markets, unlike retail markets, are considered to be competitive.
This means that, taking into account their specificities, it is possible
and indeed reasonable to adopt forecasting systems used in other
exchange markets.

Tools from the AI area, including ANN, are almost universally
used in the electricity market. Operators use such tools as well. The
New York Independent System Operator uses ANN in LFM, because
of their ability to forecast hourly loads for the day-ahead market,
and a combination of ANN and regression type forecast models to
generate hourly load forecasts for the current and following six
days [1]. PJM Interconnection [2] uses combinations of different
models for forecasting purposes, including ANN based on historical
load, temperature and temperature forecasts, and networks using
THI — in summer — and wind chill — in winter — instead of

E-mail addresses: tomasz.jasinski@p.lodz.pl, tomasz.jasinski@p.lodz.pl.

https://doi.org/10.1016/j.energy.2020.118784
0360-5442/© 2020 Elsevier Ltd. All rights reserved.

© 2020 Elsevier Ltd. All rights reserved.

temperature [3].

An aim of this study is to design and verify the validity of
new, innovative independent variables based on air tempera-
ture for forecasting electricity prices using ANN. A research gap
has been identified in this area. As shown in the literature re-
view in Section 2, commonly used forecasting models largely do
not use temperature data to model electricity prices, even
though temperature is one of the main determinants of demand
in this market [4]. In order to address this knowledge gap, it is
necessary to carry out in-depth research on the relation between
air temperature and electricity demand, and develop new variables
that can be used in forecasting models.

The contribution of this study revolves around temperature-
based variables, which enable the analysis of data without
dividing it into summer, winter (see Ref. [5|) and transition pe-
riods (this approach currently dominates the literature — see
Ref. [6,7]. This is made possible by introducing a unidirectional
relation between new variables and electricity demand. The
above enables the creation of models covering the entire period
in question, thus reducing the workload and time needed to
build forecasting models both in the area of electricity prices
T. Jasinski

Acronyms

Adam
Al

AIS
ANFIS
ANN
AR
ARIMA
ARMA
ARMAX
BED
BPNN
CLSSVM
CNN
DAPF
DCT

DE

DL

DM
DMin
DNN
DR
DWT
EGARCH

adaptive moment estimation

artificial intelligence

artificial immune system

adaptive neuro-fuzzy inference system
artificial neural network
autoregressive

AR integrated moving average

AR moving average

ARMA with exogenous input

bivariate empirical mode decomposition denoising

back propagation neural network
chaotic LSSVM

combinatorial neural network
day-ahead price forecast
discrete cosine transform
differential evolution

deep learning
Diebold-Mariano

data mining

deep neural network

dynamic regression

discrete wavelet transform
evaluating exponential GARCH

EGARCH-M EGARCH-in-mean

ELM
EMA
EMD
ENN
EPNN
EPSO
ES
EWT
FA
FEEMD
FNN
FNP
FWPT
GA
GARCH

GBT
GM
GRU
HEA
HMM
HPA
HW

ICEEMDAN improved complete ensemble empirical mode

extreme learning machine
exponential moving average
empirical mode decomposition
Elman neural network

enhanced probability neural network
evolutionary PSO

evolution strategy

empirical wavelet transform

firefly algorithm

fast ensemble empirical mode decomposition
fuzzy neural networks

functional nonparametric

flexible wavelet packet transform
genetic algorithm

generalised autoregressive conditional
heteroscedasticity

gradient boosting trees

grey model

gated recurrent unit

hybrid evolutionary-adaptive

hidden Markov model

hybrid PSO-ANFIS

Holt-Winters

decomposition with adaptive noise

IMWM
KELM
KRR
K-SVR
LFM
LMP
LR
LSSVM
LSTM
MAPE
MCP
MI
MLP
MOGWO
MS

Energy 213 (2020) 118784

Institute of Meteorology and Water Management
kernel extreme learning machine
kernel ridge regression

SVR with clustering

load forecasting model

locational marginal price

linear regression

least squares SVM

long short-term memory

mean absolute percentage error
market clearing price

mutual information

multilayer perceptron
multi-objective grey wolf optimiser
Markov regime switching

MS-GARCH Markov-switching GARCH

NLSSVM
NW-KDE
PCA
PCPF
PLSSVM
PPE

PPS

PR

PSO

PV
qGAM
qGLM
QM

QR
RBFNN
RVM
ReLU
RNN
RTM

SA
SARIMA
SFPL
SHQ
SMA
SMAPE
SOM
SSA
SVM
SVR

THI
TVR
VMD
WNN

nonlinear LSSVM

Nadaraya-Watson Kernel density estimator
principal component analysis

panel cointegration and particle filter
LSSVM optimised by PSO

Polish Power Exchange

Polish Power System

polynomial regression

particle swarm optimisation
photovoltaic

quantile generalised additive model
quantile generalised linear model
quantile mixture

quantile regression

radial basis function neural network
relevance vector machine

rectifier linear unit

recurrent neural network

real-time market

seasonal adjustment

seasonal ARIMA

semi-functional partial linear
simple hierarchical qualitative approach
simple moving average

symmetric MAPE

self-organising map neural network
singular spectrum analysis

support vector machines

support vector regression
temperature-humidity index
time-varying parameter regression
variational mode decomposition
wavelet neural network

 

and demand for electricity. The currently dominant approach
(division into three types of periods), although correct, carries the
risk of incorrect forecasts in the event of unusual weather situa-
tions, e.g. relatively low temperatures in summer (requiring energy
consumption for heating purposes). Doubts are also raised by the
way in which the calendar year was divided into the periods
mentioned above. It should be noted that depending on the pre-
vailing temperatures, it would be reasonable to adapt it to the
analysed area. The a priori selection of split points carries the risk of
suboptimum. The new approach presented in this paper reduces

this risk and enables the determination of all relationship param-
eters in an algorithmic manner. In comparison to other approaches,
i.e. [8], it allows to model precisely (using additional segments)
transitions in moments when dependencies between temperature
and demand change.

2. Electricity price forecasting models

Independent variables are the basic element of a properly
functioning forecasting system. Electricity prices depend on many
T. Jasinski

factors. First of all, they are a derivative of demand. This, in turn, is
usually dependent on: weather conditions, economic factors,
population habits, network conditions, seasonal impacts [9]. In-
dependent variables should be optimally selected for the modelled
dependent variable. In the case of the electricity market, the fore-
cast horizon is important. Day-ahead models require different
input variables than models with a long forecast horizon.

Depending on the forecast horizon, models are referred to as: (i)
short-term — hour-ahead forecasts [10], day-ahead hourly forecasts
[11], from a few minutes up to a few days or a week forecasts [12],
from one to 12 weeks ahead, daily forecasts [13], (ii) mid-term —
from one month to six months forecasts [14], from a few days to a
few months ahead forecasts [12], between 24 and 168 h ahead
forecasts [15], and (iii) long-term — from a few months up to a few
years ahead forecasts [12], at least one year ahead forecasts [16], up
to 20 years ahead forecasts [17]. As this division is not the
consensus in the literature, specific (numerical) horizon forecasts
will be indicated in this article.

Table 1 contains a list of independent variables used in the
literature to model electricity prices. The literature review takes
into account both the most recent publications, as well as and
selected literature from previous years for a comprehensive over-
view of the present state of knowledge. The basic input variable is
undoubtedly that of lagged electricity price. This is largely due to
the dominance of autoregressive models. Electricity demand is the
next most popular variable. Two approaches prevail here: the use of
actual lagged data, the use of demand forecasts. In the latter case
consideration should be given to the possibility of replacing them
in a model that predicts electricity prices by demand determinants.
In other words, instead of building a cascade model or using
external demand/grid load forecasts (see Ref. [18]), a comprehen-
sive model can be developed (Fig. 1).

3. Air temperature as an independent variable

The existence of a dependency between weather conditions and
electricity demand is obvious and has been the subject of numerous
studies [19—22]. The impact of atmospheric factors on the price of
electricity is a different matter. Apart from the important issues of
market regulation and conditions of high market competitiveness,
it should be assumed that price depends on both demand and
supply, which are affected by weather conditions. For example, an
increase in insolation (positively correlated with temperature
changes in summer [23]) results in an increase in electricity de-
mand (air-conditioning systems), but at the same time also in an
increase in electricity production by PV cells. It is, thus, not only the
demand but also the supply of electricity that increases. Therefore,
changes in price will depend on the relation between both sides of
the market. The relation between temperature (weather factor
most correlated with demand [22]) and electricity price, due to its
complex nature, is not linear. This was confirmed by research
conducted by the author on the wholesale market in regard to the
PPE for hourly data (Fig. 2). Panapakidis and Dagoumas [24] came to
the same conclusion by studying the above-mentioned dependence
on the Italian market. Elamin and Fukushige [25] obtained similar
results using data from the Tokyo Electric Power Company.

Patterns of electricity demand are different at weekdays and at
weekends. This has been repeatedly indicated in the literature on
the subject (inter alia in Ref. [79] — a clear decline in demand on
Sunday in India and [80] — lower demand throughout the whole
weekend in French). For this reason, only data for the weekdays
were analysed in this paper.

The dependence of electricity supply and demand on tempera-
ture should be further analysed separately. Fig. 3 shows the elec-
tricity demand in Poland as a function of the temperature for the

Energy 213 (2020) 118784

weekday at 11:00. There is a clear increase in demand at low
temperatures and a slight increase at high temperatures. This is a
typical correlation also observed in other countries [19,20,22]. Its
detailed course depends on many factors, and especially on the
time for which the analysis is carried out. Other determinants
include meteorological parameters (e.g. air humidity), type of
buildings and economic factors [81]. The preferred temperature
depends not only on objective factors, but also on subjective ones
[82,83]. Moreover, different geographical areas may have different
expectations for optimal weather conditions. Studies carried out in
Poland [84] have shown that the indoor temperature above which
discomfort is felt is 24.7 °C or 25.7 °C (the second value was more
frequent). It can be expected that in the case of a higher indoor
temperature, users will be more likely to reduce it and thus in-
crease electricity demand from air-conditioning systems. As the
test group was small (ten people) the values obtained should be
treated as approximate only.

Gianniou et al. [85], based on data from smart meters from more
than 14,000 households in Denmark, determined the desired in-
door temperature for property users. According to research, the
temperature was about 19 °C. Therefore, a lower temperature
should result in the switching on of heating systems and, conse-
quently, an increase in electricity demand.

The described dependencies between temperature and elec-
tricity demand can be approximated by three linear functions. The
first modelled the dependency for temperatures below the lower
comfort point, the second for temperatures between the lower and
upper comfort point and the third for higher temperatures (see
Ref. [20]). As empirical studies indicate that electricity demand as a
function of temperature for its values between the extremes of the
comfort zone is relatively constant, it has been approximated by
means of a fixed function at a later stage of the study. For tem-
peratures below and above the upper comfort point, the linear
regression functions were determined.

The analysis of data obtained by the author of this study from
the PPS and the IMWM shows that for the Polish average, the two
outdoor temperatures determining the comfort zone for people
within buildings are located in the area of values noticeably lower
than the internal temperatures expected by respondents. It should
be assumed that one of the main reasons for this is the fact that
additional heat is generated by electrical equipment in buildings
and living organisms residing there (mainly humans), thus
increasing internal temperature in relation to the conditions pre-
vailing outside. The analyses deliberately omitted the influence of
other weather factors due to their much smaller correlation with
electricity demand [22] (see also [4]).

The nature of the dependency between temperature and energy
demand changes with time. This is confirmed by diagrams drawn in
Ref. [86] and cannot be fully explained solely by changes in outdoor
temperature. Different expectations of electricity consumers as to
the amount of electricity consumption depending on the hour of
the day force the construction of 24 forecasting models.

4. Methodology

The new approach to model the dependency between air tem-
perature and electricity demand requires three key steps: the
detection and removal of outliers, development of new
temperature-based variables, smoothing of a new variable at the
point of changing the nature of the relationship between the
temperature and electricity consumption. Due to the complexity of
the approach, this section uses figures based on empirical data used
in section 6.
T. Jasinski
Table 1
Independent variables of electricity price forecasting models.

Independent variable (lagged or forecast data)

System data
Electricity price and its statistical or technical analysis

Demand/load level

Energy 213 (2020) 118784

Description

Autoregression models without exogenous input

[26]-ARIMA, ARIMA-EGARCH, ARIMA-EGARCH-M, hourly price forecast

[11]-ARIMA, FNP models, SFPL models, DAPF

[27]-hybrid method combined with DWT, ARIMA and Least Squares SVM, PLSSVM, DAPF
[28]-EMD-SA-ARIMA, half-hourly price forecast

[29]-ARMA, one-week-ahead forecast (168 h)

| 10]-ARMA-GARCH models, predicted hour-ahead price

[30]-SARIMA-GARCH, 3 and 1-factor GIGARCH, horizon prediction: 1, 10, 20, 30 days
[31]-MS-GARCH, DAPF, 5 days ahead, 10 days ahead prices

[32]-hybrid method combined with DWT, CLSSVM, EGARCH, DAPF

[33]-Vector ARMA, forecasting horizons from 1 up to 15 days

[34]-Curvelet denoising based algorithm (using ARMA), DAPF

[35]-BED, DAPF

Other models

[6]-hybrid ANFIS, ARMAX and GARCH, DAPF

[14]-SVM, hybrid SVM and ARMAX, hourly MCP for an entire month forecast, six months ahead
[36]-AR models, DAPF

[7]-combination of models: ARMAX, LR, TVR, MS, DAPF

[37]-ARMAX-GARCH, hourly prices forecast, horizon 24 h and 168 h

[38]-WNN and DMin, price spike, 30 min interval data

[39]-stochastic time change

[40]-Wavelet-ARIMA, FNN, MLP, DAPF

[41]-combining DWT, ARMA and KELM, DAPF

[42]-RNN, hourly price forecast, DAPF

[43]-CNN, DAPF

[44]-MLP, horizon forecast: 7, 14, 21, 28, 91 days

[24,45—47]-MLP, DAPF

[48]-MLP with DCT, DAPF

[49]-GM, daily and hourly electricity price forecast

[50]-LSSVM with DWT, DAPF

[51]-combination of FWPT, ARIMA and NLSSVM, hourly price forecast

[52]-SOM-SVM-PSO, DAPF

[53]-combination of the cuckoo search algorithm, SVM and SSA, half-hourly price forecast
[54]-two-stage model based on RVM, hour day-ahead LMP forecast

[55]-QR, day-ahead forecast (30-min periods)

[56]-DR, Periodic DR, MLP, HW, DAPF

[57]-K-SVR, real-time forecast (hourly data)

[58]-PCPF, DAPF

[15]-HEA methodology — combination of MI, DWT, EPSO, ANFIS, horizon 24 h and 168 h
[59]-hybrid model based on EMD-KRR-SVR, half-hourly horizon forecast

[60]-HPA, next-week prices forecast

[61]-4-step approach based on ARIMA, RBFNN, SVR, ENN and ELM, DAPF

[62]-probabilistic price forecasting model based on NW-KDE, day-ahead hourly price forecast
[63]-MLP, hybrid model based on MLP and cost-production optimisation model, DAPF and 1-week-ahead
price forecast

[64]-hybrid system based on ICEEMDAN, VMD, MOGWO and ENN, 30 and 90 min ahead forecast
[65]-hybrid model based on FEEMD, VMD and BPNN optimised by FA, forecast of one, two, four and six-step
ahead price

[66]-ANN, hourly DAPF

[67]-ANNs combine with SQG or AIS, DAPF

[68]-qGAM, QM, qGLM, t-quantiles of DAPF

[69]-QR, GBT — hourly and daily average price forecast

[4]-higher order (weak) HMM, daily electricity spot prices forecasts

[70]-DE algorithm to optimise LSTM, 1-h-ahead and 24-h-ahead forecasts

[71]-hybrid model based on EWT, SVR and bi-directional LSTM, forecast of one-step ahead price
[18]-DNN, DNN-LSTM, GRU-DNN, spot price forecast

[72]-hybrid DNN model (EPNet) based on CNN and LSTM, forecast of next hour electricity price
| 73]-two-stage model based on PR, SVR, ANN and DNN, RTM price forecast

[74]-Bayesian DNN, DAPF

[75]-hybrid model using a three-stage algorithm (DWT, Kalman forecasting model, MLP and ANFIS), next
24 h price profile forecast

[24,45—47]-MLP, DAPF

[63]-MLP, hybrid model based on MLP and cost-production optimisation model, DAPF and 1-week-ahead
price forecast

[38]-WNN and DMin, price spike, 30 min interval data

[76]-EPNN, DAPF

[18]-DNN, DNN-LSTM, GRU-DNN, spot prices forecast

[75]-hybrid model using a three-stage algorithm (DWT, Kalman forecasting model, MLP and ANFIS), next
24 h price profile forecast

[51]-combination of FWPT, ARIMA and NLSSVM, hourly price forecast

[54]-two-stage model based on RVM, hour DAPF (LMP)

[40]-Wavelet-ARIMA, FNN, MLP, DAPF

[13]-ARIMA with PCA and ANN, price 12-steps-ahead forecast (12 weeks)
T. Jasinski

Table 1 (continued )

Independent variable (lagged or forecast data)

Transfer flow

Reserve margin and indicators based on it

Fuel prices

Carbon emission price
Wind and/or solar generation

Hydro and thermal generation and energy in reservoirs
(stored and inflow)

Temporal data

Time/day of the week/week/month of electricity use (and its
derivatives)

Indicator of holidays and weekends

Weather factors
Mean/observed/predicted temperature

Irradiation

Humidity and dew point

Wind speed

Economic factors

Market concentration index (HHI)

4.1. Detection and removal of outliers

Energy 213 (2020) 118784

Description

[55]-QR, DAPF (30-min periods)

[36]-AR models, DAPF

[56]-DR, Periodic DR, MLP, HW, DAPF

[6]-hybrid ANFIS, ARMAX and GARCH, DAPF

[7]-combination of models: ARMAX, LR, TVR, MS, DAPF
[37]-ARMAX-GARCH, hourly price forecast, horizon 24 h and 168 h
[77]-SVR, DAPF

[57]-K-SVR, real-time forecast (hourly data)

[78]-Multiple SVM, hourly price forecast for an entire month, six months ahead
[58]-PCPF, DAPF

[68]-qGAM, QM, qGLM, t-quantiles of DAPF

[69]-QR, GBT — hourly and daily average price forecast
[62]-probabilistic price forecasting model based on NW-KDE, DAPF
[67]-ANNs combine with SQG or AIS, DAPF

[74]-Bayesian DNN, DAPF

[76]-EPNN, DAPF

[67]-ANNs combine with SQG or AIS, DAPF

|77]-SVR, yearly average price forecast

[38]-WNN and DMin, price spike, 30 min interval data

[55]-QR, DAPF (30-min periods)

[36]-AR models, DAPF

[7]-combination of models: ARMAX, LR, TVR, MS, DAPF

|77]-SVR, yearly average price forecast

[55]-QR, DAPF (30 min periods)

[78]-Multiple SVM, hourly price forecast for an entire month, six months ahead
[54]-two-stage model based on RVM, hour DAPF (LMP)

[24,47 ]-MLP, DAPF

|7]combination of models: ARMAX, LR, TVR, MS, DAPF

[55]-QR, DAPF (30-min periods)

[56]-DR, Periodic DR, MLP, HW, DAPF

[57]-K-SVR, real-time forecast (hourly data)

[24,47 ]-MLP, DAPF

[63]-MLP, hybrid model based on MLP and cost-production optimisation model, DAPF and 1-week-ahead
price forecast

[69]-QR, GBT — hourly and daily average price forecast

[67]-ANNs combine with SQG or AIS, DAPF

[62]-probabilistic price forecasting model based on NW-KDE, DAPF
| 73]-two-stage model based on PR, SVR, ANN and DNN, RTM price forecast
[74]-Bayesian DNN, DAPF

[13]-ARIMA with PCA and ANN, price 12-steps-ahead forecast
[69]-QR, GBT — hourly and daily average price forecast
[62]-probabilistic price forecasting model based on NW-KDE, DAPF

[77]-SVR, DAPF

[56]-DR, Periodic DR, MLP, HW, DAPF

[66]-ANN, hourly DAPF

[24,46,47]-MLP, DAPF

[69]-QR, GBT — hourly and daily average price forecast
[37]-ARMAX-GARCH, hourly price forecast, horizon 24 h and 168 h
[62]-probabilistic price forecasting model based on NW-KDE, DAPF
[54]-two-stage model based on RVM, DAPF (LMP)

[74]-Bayesian DNN, DAPF

[24]-MLP, DAPF

[63]-MLP, hybrid model based on MLP and cost-production optimisation model, DAPF and 1-week-ahead
price forecast

[39]-stochastic time change

[57]-K-SVR, real-time forecast (hourly data)

[54]-two-stage model based on RVM, DAPF (LMP)

[76]-EPNN, DAPF

[75]-hybrid model using a three-stage algorithm (DWT, Kalman forecasting model, MLP and ANFIS), next
24 h price profile forecast

[62]-probabilistic price forecasting model based on NW-KDE, DAPF

[57]-K-SVR, real-time forecast (hourly data)

[62]-probabilistic price forecasting model based on NW-KDE, DAPF

|77]-SVR, yearly average price forecast

clearly visible in Fig. 3. The quartile test by Barnett and Eisen [87]
was used for this purpose. Fig. 4 shows the dependency between

In order to determine with precision the range of neutral out- external temperature and electricity demand upon removing
door temperature for each hour of the day in weekdays, it was atypical observations.
necessary to remove the outliers from observation data. These are
T. Jasinski

Mainly system
and/or
meteorological
data

 
     
 
 
 
    
     

Demand
forecasts

 
 

Mainly system
and/or
meteorological
data

Electricity
prices
forecasts

a) The cascade model diagram

  
   
   
 

  

System and
meteorological
data based
variables

Electricity
prices
forecasts

 

b) The proposed comprehensive forecasting model

Fig. 1. Diagrams of models forecasting electricity prices.

900,00
800,00
700,00

600,00

LN/MWh)

2 500,00

Ice

‘5 400,00 2 =

300,00 so —_* + +4 =

Electricity pr

200,00

 

100,00

0,00
-20 -10 0 10 20 30

Temperature (°C)

Fig. 2. Diagram of electricity prices as a function of air temperature for 11:00 (station
no. 160).

30000
28000

26000

M
No
&
So
So
oO

22000

20000

 

*= 18000

16000

Electricity demand (

14000 : Hy ge
12000
10000

-20 -10 0 10 20 30
Temperature (°C)

Fig. 3. Diagram of electricity demand as a function of air temperature for 11:00 (sta-
tion no. 160).

4.2. Construction of a new temperature based variable

As was noted earlier, the outside temperature in the “middle”
range is associated with a relatively constant demand _ for

Energy 213 (2020) 118784

30000
28000

26000

No
&
So
o
o

 

16000

Electricity demand (MW)
N

14000
12000

10000
-20 -10 0 10 20 30

Temperature (°C)

Fig. 4. Example of temperature and electricity demand dependency for 11:00 after
removing outliers (station no. 160).

electricity; this dependence has been reduced to a constant func-
tion with a value equal to the arithmetic average of data considered
typical. For data corresponding to temperatures below the
described range, a clear linear relation is visible. This function has
been determined by the least squares method. The slope of the
function is negative. An analogous procedure has been applied for
data corresponding to temperatures above the comfort zone. The
resulting approximation can be expressed using the formula:

apt + br, t<Tq
1
d(t)=4 ———) ot, Ta <t<Tou (1)
tcl,tcu
ayt + by, t>Tcy

where: t — outdoor temperature, Tc, Tcy — initial estimations of the
lower and upper-temperature boundary for the comfort zone
respectively, ntcitcu — number of elements in data set for temper-
atures between [Tc,,Tcy]. Slope ay is negative and ay positive.

The resulting three lines do not intersect exactly at the Tq, and
Tcy points. Therefore, it was necessary to determine the two points
of intersection by comparing in pairs the first and last two com-
ponents of Eq. (1). These points are designated as T; and Ty. Eq. (1)
has now taken the form of:

ayt + by, t<T,
1
=< —— < f<
d(t) Tatu Sot, Ty <t<Tu (2)
ayt + by, t>Ty

where: T,, Ty — the final lower and upper-temperature boundary
for the comfort zone respectively.

In Fig. 4, the newly created approximation for data from 11:00 is
marked with a black broken line.

As the aim of this operation is to obtain the input variable of a
predictive model operating on the basis of ANN, it is necessary to
create a formula which: indicates the temperature range for
which there are clear demand correlations, has a unidirectional
(preferably linear) relation between the quantity representing
temperature and demand, has a relation the slope of which is
the same for both low and high temperatures.

The first postulate can easily be fulfilled by assigning a zero
value to all data corresponding to temperatures in the [T,,Ty] range.
The second postulate can be achieved by replacing the value of
T. Jasinski

slope ay by its module (i.e. changing the value from negative to
positive) and by replacing the temperature (t) with the difference
between T, and ¢, as well as between t and Ty as proposed by the
author in Eq. (3).

Jap|(T, —¢t), t<T,
y(t)=4 0, Tp <t<Ty (3)
ay((—Ty), ¢>Tu

In order to meet the final postulate it is necessary to unify the
slope in the new formula for t < Ty and t > Ty. For this purpose, Eq.
(3) has been modified to:

lay |(T, — ¢), t<T,

y(t) = 0, Tp <t<Ty (4)

a
jay] (t—Ty), t>Ty
|ay|

Replacing the model input variable in the form of temperature
(t) with a new variable can be defined as:

(Ty ~~ t), o< Ty

v(t) = 0, Tp <t<Ty (5)
*U (t— Ty), t>Ty
|ay|

Eq. (4) takes the form of:

y(v) = |az|v (6)

Fig. 5 shows the dependency between electricity demand and
the new variable v. Its linear character is visible. The slope of the
line according to Eq. (6) is |ay].

The described procedure can be used if the sample size for each
of the three temperature ranges is high enough. Due to Poland’s
location in a temperate climate zone, outdoor temperatures above
the upper comfort threshold occur only occasionally in the night
hours. Thus, the directly proportional dependency between tem-
peratures above the comfort threshold and electricity demand as
shown in Eqs. (1)—(5), practically does not occur. Even if the tem-
perature threshold was exceeded in individual observations, the
amount of data does not allow for a reliable determination of linear

30000
28000

26000

Ww
NR
B
So
So
So

nN
No
So
So
So

20000 are

 

icity demand (MW)

= 18000 fv"

16000

Electr

14000
12000
10000

0 5 10 15 20 25 30 35
v (°C)

Fig. 5. Example of dependency between electricity demand and variable v (11:00).

Energy 213 (2020) 118784

regression coefficients. For this reason, it has been assumed that Eq.
(5) should be used only in those cases where a minimum of 50
occurrences of upper-temperature values have been recorded in a
given hour. Otherwise, individual occurrences are included in the
comfort range and a simplified version of Eq. (6) is used in the form
of:

wey= {yO ESE 7)

4.3. Smoothing of a new variable by a single line segment

Consideration should be given to the validity of modelling
electricity demand not by means of two half-lines and one line
segment, but by more line segments in order to obtain smoother
transitions between temperatures inside and outside the comfort
zone. The study proposes to add a line segment connecting that
defined by a constant function equal to 0 (representing the comfort
zone) with a half-line defined by a linear function for t < T, (rep-
resenting temperatures below the comfort zone). This function will
model the dependence of electricity demand on temperature for t
in the range (T,—e1,T,+e2) — Fig. 6. Eq. (4) takes the form of:

 

lap|(T, — e, —C) + jag|(ey + €2), t<TL-e
dy
| tt, +e — 0), Tp —e, <t<TL +e
yay I
0, TL t+e2 <t<Ty
la,| <2 (t —Ty), t>Ty
|ay,|
(8)
where:
t
ay (Ty — ey) + by — D
ae — _ Necl,teu (9)

€, + €2

for te[Tcr,Tcu].
Modified Eq. (5) is expressed by the formula:

22000

21000

NO
Oo
oS
°o
oO

ao°"S

7 (Te+e3,d(Tite2)) (To atu)

      

* (Tiss, d(Tize0)):
19000 ° «. ne

18000

Electricity demand (MW)

17000

16000
10 12 14 16 18 20 22 24

Temperature (°C)

Fig. 6. Example of smoothing with an additional line segment.
T. Jasinski

Jae

 

 

(Tr -e1 — 0) +15 (1 +e), t<TLp-e
lel (Ts ey) — 8), Tp —e, <t<Tli +e2
ve(t) = 4 [aL
. TL + €2 < C < Ty
t—T t>T
a] a ( U)s > lu
(10)
Eq. (6) remains unchanged and Eq. (7) has the form of:
Te 04 Se +e), t<TLp-e
L
ve(t) = S(T tea ~ 8) Trp —e1 <t<Ty +¢2
L
0, C = Tp + ED
(11)

4.4. Smoothing the new variable with n line segments

This approximation may not be sufficient for modelling the
actual situation in case of a rapid increase in electricity demand as a
function of temperature drop. Consideration should then be given
to using more line segments to approximate the actual course of
the curve. In general, it may be assumed that their number is n (this
should be determined experimentally), and the markings are as in
Fig. 7 (example for n = 4). Temperature T, should be assumed to be
known. Temperatures marked as T; for i = O ... n—1 should be
indicated either arbitrarily or according to the chosen algorithm. In
this paper, T; has been determined in such a way that the lengths of
the resulting n line segments (marked as c, where c > O) are equal.

The slopes a; are defined proportionally as:

ay
n+1

 

aj = 1, i=1...n (12)

The lengths of line segments (c) can be determined using Eq.
(13):

 

c= (ait + b, _—

Be) [sin arctan |a;|) (13)

Ntcl wtcu

20600 . . :
20400 *

20200

    
   

Nr
“(r acre) Ts, aT)

49600 - <a % . . - (To; d(T) - (Tu, d(Tu

19800 .

Electricity demand (MW)

10 12 14 16 18 20 22 24
Temperature (°C)

Fig. 7. Example of smoothing with four line segments.

Energy 213 (2020) 118784

Temperatures T; fori=0O..
using Eq. (14):

. n—1 can be determined iteratively

Vie(on—1)li =Ti41 + Cos (arctan |aj,1|)c (14)

Eqs. (4), (5) and (7) take the form of (15), (16) and (17)
respectively:

Nn
Jay|(Tn—t) +9 (Te-1 -Te) lard: t<Tn
k=1
a i—1
aul ge Tha 0+ SMa Thao T<t Ta d=.
k=1
y(O)=
alert T, <t<T,
|ay al (To )s 1<t<Tpo
0, To9<t<Ty
a
aul ete) t>Ty
(15)
Nn
(Th 1—_ Tx) |ax |
Ty —t)+  , t<T
( n ) > lay | n
i— 1
—T,)
lail cy t) + (Th 1 k (Tr_1 = Tr) fax] , T;<t<Tj_1,i=2...n
© lai a al
Un C =
lal ep —t) Ty <t<T,
lao” me
0, To <t<Ty
a
ia (t— Tu), t>Ty
(16)
Nn
(Th 1—_ Ty) |ax |
Ty —t)+ a, t<T
( n ) > lay | nN
lail cy - + ( (Th4 —Tx) |ax| .
t)+ , 1<t<Tj_1,1=2...n
Un (t) = iay|¢ Ot al jay | i i-1
a
_ Ty <t<To
0, t>To
(17)

Line segments marked in Fig. 7 are not visually equal in length,
which is caused by the different scale of the horizontal and vertical
axes. Empirical studies, however, have shown that such a
smoothing method in a number of analysed cases translates into an
improvement in the results achieved by ANN. When using other
forecasting methods or the occurrence of different values of elec-
tricity demand, it is necessary to consider the application of
different variants of T; temperatures selection and length of scaled
line segments c; for i = 0 ... n—1. In particular, different lengths of
line segments c; scaled according to slope a; can be introduced. It
can be assumed that the length of line segment c; will be defined as
follows:
T. Jasinski

Gj =Cai/a, (18)

Then, equality (Eq. (19)) is true:

n n
; aj ;
5 c sin(arctana;) = 5 c— w sin(arctana;) (19)
‘ . al
i=1 i=1
where:

w — correction coefficient for different lengths of c; line
segments.
By transforming Eq. (19) the obtained formula is:

_3 y-j_1 Sin(arctana;)

w-a—ei- errr 20
‘Sf, sin(arctana;)a; (20)
Modified Eq. (14) now takes the form of:
Vieon—1)li =Ti41 + Cos (arctan |aj.1|)cjw (21)

The obtained division into temperature ranges is shown in Fig. 8.
Other scaling coefficients can be implemented in the same way.
Eqs. (15)—(17) do not change.

4.5. Construction of other independent variables

The supply side of the electricity market has been linked with
wind speed due to the noticeable contribution of this energy source
in total electricity generation in Poland.

Based on hourly data on wind speed, a new variable was
determined in the form of a weighted average according to Eq. (22):

ws(m) = > /gc.ws,(m) / > scp (22)

kes kes

where:

S — a set of weather stations, gc, — power of wind turbines in
voivodship where weather station number k is located, ws;,(m) —
wind speed recorded at moment m by weather station number k.

Wind energy depends on its speed to the third power. For wind
speeds below the cut-on point (the study assumes 4 m/s) there is
no electricity generation in turbines. Above this value there is
approximately an exponential increase in energy generation until
the wind reaches the rated speed of the turbine (assumed to be
15 m/s). From that point onwards, generation remains relatively
constant. When the wind speed exceeds the safety cut-off, the

20600

20400 *

  
      

nN
oO
Nh
°
oO

8

(Ta; d(Ta))\

  

Electricity demand (MW)

20000 | ‘ (Ts, d{Ts)) . : :
19800 r . $ 7 (Ta, d(T2)) . * (Ts, d(T)
19600 ee (To, d(To)) (Tu, d(Tu))
19400 vs .
10 12 14 16 18 20 22 24

Temperature (°C)

Fig. 8. Example of smoothing with four line segments (version with scaling factor w).

Energy 213 (2020) 118784

turbine is stopped (generation drops to zero). This study assumes a
cut-off point at 25 m/s (see Refs. [88]). This forecasting model uses a
new variable defined by Eq. (23):

0, ws(m) <4
3
ScKWws)(™) , 4<ws(m)<15
wse(m) = kes dkesSCk (23)
15°, 15 < ws(m) <25
0, ws(m) > 25

This approach allows to easily create a variable that is auxiliary
in the proposed model. It would be reasonable to consider other —
more complicated — methods of estimating the size of the gener-
ation. An example can be the study [89], in which PCA was used to
forecast wind speed in a given area based on delayed data. As the
authors conclude, the selected prediction horizon should depend
on the current state of wind speed. In Ref. [90] the model based on
ARIMA was proposed. It turned out to be accurate for predictions
for time lags below 2 h. With a longer horizon, the authors suggest
using alternative approaches. They also note that using ANN, in this
case, requires large data sets for training. In Ref. [91] it was pointed
out that especially in the case of large wind speed fluctuations
using the Langevin model instead of ANN should be considered. A
highly optimised wind speed forecasting system, taking into ac-
count the location of specific wind turbines, could translate into
further improvement of the model’s precision.

In Poland, the contribution of PV cells is electricity generation
negligible. For this reason, the model has not introduced a variable
related to the influence of atmospheric conditions on the genera-
tion capacity of PV cells.

4.6. Assessment methods for forecast accuracy

The process of building a comprehensive forecasting model
based on ANN requires numerous simulations and the selection of
those networks with the highest accuracy. For this purpose, SMAPE
metric [92,93] was used. An analogous approach in the assessment
of electricity price forecasts was applied by Lago et al. [18]. In
addition, they used the DM test to demonstrate the statistical sig-
nificance of the difference between models. In the present study,
this method has been used to verify whether the forecasts obtained
using new variables are significantly better than the forecasts using
air temperature values. The DM statistic [94] was defined according
to the following formula:

DM = a (29)

\ (10 + 2>.ha'y1) /N

where h is taken as the value N!/? [95,96] rounded up to a whole
number.
The one-sided DM test was defined as in Ref. [18].

 

5. Data

The hourly data set covered the period from January 1, 2009 to
May 31, 2017. Archival electricity prices and trading volume were
obtained from the PPE resources. Data on past demand for elec-
tricity were obtained from the PPS. Archival weather information
was downloaded from the IMWM server. Fig. 9 shows a map
pointing at the location of meteorological stations (their number
and city name).
T. Jasinski

    
  
 
    
  

120 (LEBA) aeED
105 (KOSZALIN) 115 (USTKA) gis (ELBLAG-MILEJEWO)
e e
235 (CHOJNICE) 280 (MIKOLAJKI) 195 (SUWAEKI)
200 (SwINOUISCIE) | Sos (SzczECIN) @ e

   
   
     
 
 

e
250 (TORUN) 270 (MLAWA) , 295 (BIALYSTOK)

e
330 (POZNAN)

300 (GORZOW WIELKOPOLSKI

    
 
  
 

P 399 (TERESPOL)
400 (ZIELONA GORA)

385 (SIEDLCE)
e e

° 465 (LODZ) 375 (WARSAW) $ 497 (WEODAWA)
435 (KALISZ) e
: 488 (KOZIENICE) e
a0) Cee @ 424 (WROCLAW) 495 (LUBLIN-RADAWIEC)
© 530 (OPOLE)
510 (SNIEZKA) ° 570 (KIELCE-SUKOW)

e
520 (KLODZKO) @ 580 (RZESZOW-JASIONKA)
566 (CRACOW-BALICE)
600 (BIELSKO-BIALA)
690 (LESKO)
650 (KASPROWY WIERCH) 625 (ZAKOPANE)

e
560 (KATOWICE)
e

Fig. 9. Map of meteorological stations used in the research.

Data of the power generated by onshore wind turbine in-
stallations (WT) and PV cells by voivodship were obtained from the
Energy Regulatory Office (as of March 31, 2018) and are presented
in Fig. 10.

Appendix A contains data used in training and testing ANN for
11:00 a.m. simulations. Based on them, it is possible to perform the
experiment again and verify the research and results described in
this paper.

6. Numerical results

In the first stage of this study, a new temperature variable was
determined using the method described in section 4. The calcula-
tions were carried out separately for each hour of the day. It was
assumed that the population’s expectations regarding temperature
might depend on the time (e.g. at night the desired temperature
should be lower than during the day, when activity is increased).
Simulations aimed to determine the optimal parameters of new
input variables based on air temperature were carried out sepa-
rately for data from each of the 37 weather stations. On this basis,
linear regression coefficients (ay, br, ay, by) were determined in
accordance with the procedure described earlier, and then the
values of new variable v(t) were calculated. The Pearson correlation

      
 
 

WT 692.334
PV 2.437 WT 354.265
WT 1489.620 PV 8.888
PV 3.997 WT 197.760
PV 7.162

    
  
 

WT 386.025
PV 1.879

WT 192.000 WT 698.990
PV 6.789

 

PV 3.429

   
  

   

     
 

WT 138.900
WT 176.360
PV 30.936
PV 5.715 (WT 22.064
sengende WT 33.325 yr
WT 138.150 py 8.985.
PV 0.938
wr 6 co1 4 WT 152.956
PV 4.419

   

PV 9.287

Fig. 10. Power (GW) of on-shore wind turbines and PV cells.

Energy 213 (2020) 118784

coefficient (r) was used to estimate its (linear) relations with
electricity demand. Experimentally, the Tc, and Tcy values were
selected, as well as the weather stations for which r reached the
highest values. The temperature ranges from 11 °C to 20.5 °C and
from 19 °C to 26 °C for the lower and upper boundary for the
comfort zone respectively with a step of 0.1 °C were assessed (a
minimum of 2 °C difference between the comfort zone limits was
assumed). The calculations were carried out according to the al-
gorithm presented in Fig. 11.

Table 2 shows the optimal parameters of the new temperature
variable determined for each hour of the day. Since the temperature
readings came from many weather stations, they cannot be directly
compared with one another. Attention should be paid to coefficient
r, which is noticeably lower for data between 01:00 and 05:00.
During these hours there is the smallest linear relation between the

START

Ty =11
Ty = 19

Thestci =11
Thestcu = 19
Vest 0

 

YES CALCULATIONS OF:
Ti(Tpestcu), Tu(Thestcu)

Ti(Tpestct)
Tu(Testcu)

Tpestcu

 

     
   
     
  

Vhest
Shest

STOP

CALCULATIONS OF:
ays Diss ays, bus, Ntcl,teu,s
Ths Tus, v(t), rs
where:
s=1...n
n - the number of weather stations

 

Thestci = Ta

Thestcu = Tcu

Vhest =r
Sbest =

 

Fig. 11. Flow chart of the algorithm for determining optimal values of parameters of
the new temperature variable.

10
T. Jasinski

Table 2
Optimal values of parameters required to determine a new variable.
hour ay by ay by
01:00 —128.55 16536.87 —* —*
02:00 —129.59 15930.03 —4 _*
03:00 —124.53 15618.21 —* —*
04:00 —132.03 15616.36 —* —*
05:00 —150.32 15813.23 —* —*
06:00 —162.00 16168.15 —* —*
07:00 —166.54 18418.04 —* —*
08:00 —159.04 20476.38 —4 _*
09:00 —152.83 21562.74 42.03 18177.76
10:00 —151.59 22052.53 62.25 18248.32
11:00 —154.53 22125.41 107.92 17124.37
12:00 —152.33 22389.08 126.58 16837.74
13:00 —152.26 22447.55 128.58 16796.22
14:00 —162.12 22581.72 41.47 19152.45
15:00 —159.27 22218.61 56.64 18433.95
16:00 —150.52 22094.14 82.73 17531.22
17:00 —197.38 22528.82 86.57 16986.99
18:00 —245.48 22868.07 70.20 17203.12
19:00 —242.59 23165.39 85.69 16523.21
20:00 —201.58 22826.24 52.91 17559.34
21:00 —158.32 22305.09 104.37 16560.44
22:00 —112.51 20872.31 —* —*
23:00 —111.85 19280.59 —* —*
24:00 —109.47 17872.60 —4 _*

Energy 213 (2020) 118784

Tz (°C) Ty (°C) 1/Mecitcu Zt station number r

12.2 — 14968.57 400 0.6271
12.0 —" 14369.31 400 0.6468
12.4 — 16056.55 400 0.6641
12.4 — 13981.27 400 0.6706
12.7 — 13899.78 400 0.7070
14.3 — 13857.13 495 0.7562
15.7 — 15796.36 495 0.7666
17.0 —" 17766.97 160 0.7756
16.8 19.3 18988.69 160 0.7994
17.0 19.7 19473.29 160 0.8037
16.0 23.4 19645.67 160 0.7991
15.8 24.9 19983.89 160 0.7800
15.4 25.7 20102.81 160 0.7643
15.7 21.4 20040.11 160 0.7813
15.8 22.5 19707.88 160 0.7825
18.4 21.7 19325.57 375 0.7611
17.4 24.3 19093.80 488 0.7908
16.6 22.8 18804.89 570 0.8494
18.9 24.1 18587.14 560 0.8612
20.2 22.6 18754.87 385 0.8315
19.5 25.4 19210.89 488 0.8004
14.6 — 19225.30 495 0.7811
11.8 — 17958.11 495 0.7743
11.9 —" 16565.64 495 0.7938

* Number of observations for temperatures above the upper comfort threshold was less than 50 (using Eq. (7)).

new variable and electricity demand. This can be partly explained
by the fact that most people are sleeping at this time and their
expectations as to internal temperature (realized typically by pre-
set automatic controls) are lowered in relation to the activity time.

For the new variable, the method of smoothing transition be-
tween temperatures that are too low and the comfort zone was
used according to Eqs. (10) and (11). It was assumed that e; and e2
belong to the range (0 °C, 6 °C]. The search for their optimal values
was Carried out with a step of 0.1 °C. Then, Pearson correlation
coefficients (Table 3) were determined for the newly obtained

Table 3
Optimal values for new variables.

variable.

The third variable based on temperature was determined ac-
cording to Eqs. (16) and (17). The transition between the comfort
zone and lower temperatures was modelled using four additional
line segments (n = 4). Temperature T4, was determined using
simulation, and optimal values were sought with a step of 0.1 °C in
the range [T ,—3°C,T,°C] with a limit of T9<Ty—2°C. Appropriate
values from Table 2 were used as Ty. The obtained results are
presented in Table 3.

In the case of single segment smoothing, coefficient r was better

hour smoothed with one line segment smoothed with four line segments
€1 (°C) €2 (°C) ae r Ta (°C) T3 (°C) T2 (°C) T, (°C) To (°C) r

01:00 0.9 1.3 —52.59 0.6273 11.4 11.6 12.0 12.5 13.5 0.6264
02:00 1.2 1.0 —~70.69 0.6468 11.4 11.6 11.9 12.3 13.1 0.6466
03:00 0.9 0.8 —65.93 0.6643 11.7 11.9 12.2 12.6 13.4 0.6640
04:00 0.5 0.1 —110.02 0.6706 12.3° 12.3° 12.4° 12.4° 12.5 0.6708
05:00 0.1 1.4 —10.02 0.7070 12.6° 12.6° 12.7 12.8 12.9 0.7070
06:00 0.1 2.4 —6.48 0.7562 14.2” 14.2” 14.2” 14.3 14.4 0.7562
07:00 0.2 1.5 —~19.59 0.7666 15.6” 15.6” 15.7 15.8 16.0 0.7666
08:00 0.3 1.6 25.11 0.7756 16.9° 16.9° 17.0 17.1 17.3 0.7755
09:00 0.1 0.1 —76.41 0.7994 16.7” 16.7” 16.8 16.9 17.1 0.7991
10:00 0.3 1.0 —34,98 0.8037 16.9° 16.9° 17.0 17.1 17.2 0.8032
11:00 0.7 2.4 —34.89 0.7992 14.6 15.1 15.7 16.6 18.4 0.7992
12:00 0.2 3.2 8.96 0.7800 15.7” 15.7” 15.8 15.8 15.9 0.7800
13:00 0.1 4.5 —3.31 0.7643 15.3° 15.3° 15.4° 15.4° 15.6 0.7642
14:00 1.3 0.2 —140.51 0.7813 15.6° 15.6° 15.7” 15.7” 15.8 0.7813
15:00 0.2 5.9 —5.22 0.7825 15.7> 15.7> 15.7> 15.8 15.9 0.7824
16:00 0.1 3.2 —4.56 0.7611 18.3° 18.3° 18.4° 18.4° 18.5 0.7611
17:00 0.9 0.2 —161.50 0.7908 16.9 17.1 17.3 17.6 18.2 0.7908
18:00 0.8 4.7 —35.71 0.8495 15.3 15.7 16.2 17.0 18.6 0.8495
19:00 0.5 2.8 —36.76 0.8613 18.2 18.4 18.7 19.1 20.0 0.8611
20:00 0.4 2.3 29.86 0.8316 19.5 19.7 20.0 20.4 21.3 0.8315
21:00 0.1 0.1 79.16 0.8004 19.3 19.4 19.5 19.6 19.9 0.8001
22:00 1.2 0.6 ~75.01 0.7812 14.1 14.3 14.5 14.8 15.5 0.7811
23:00 0.4 0.7 —40.67 0.7744 11.3 11.5 11.7 12.0 12.7 0.7747
24:00 0.1 0.1 —54.73 0.7938 11.8° 11.8° 11.9 12.0 12.2 0.7933

* Bold font indicates higher values and italics lower than the corresponding coefficients in Table 2.

> Determined temperatures differed in the second decimal place.
T. Jasinski

for 8 h (cases) than in the version without smoothing. For the
remaining hours, the r values were the same (rounded to four
decimal places). For the variable smoothed with four segments,
only in the case of 4 h were the values of r higher than their
equivalents for the variable without smoothing, while in two cases
they were also higher than the r values for the variable smoothed
with a single segment. It should be noted that the described dif-
ferences are not large, which only confirms the fact that the de-
pendency between temperature and electricity demand below the
defined lower thresholds of comfort zones has changed rapidly.

A surprisingly high value of ay was observed for 21:00. This fact
may be due to the relatively small number of occurrences of such
high temperatures at that time (although it exceeded the accepted
limit of 50 observations). Consideration should be given either to a
slight increase in the limit or to an arbitrary assumption of no
modelling by a separate half-line for temperatures above Ty. In
order to maintain the objectivity of research and minimise bias on
the results obtained in this paper, no such correction was made.

6.1. Construction of a forecast model using ANN

Due to the need to use different independent variables for each
hour, it was necessary to develop 24 different forecasting models.
Each of them used a different ANN. The number of neurons in the
input layer was adjusted to the number of independent variables,
and amounted to 19 (18 for hour 24:00 — see subsection 6.1.2). DNN
had four learning layers, including three hidden layers of 70, 50 and
30 neurons respectively, and a single output built of one cell. ReLU
was used as an activation function. The network was learned using
the MAPE loss function, Adam algorithm with learning rate equal to
0.002 and learning rate decay equal to O (except for the single oc-
currences). Each batch consisted of 8 samples and the number of
epochs was up to 550.

The data is divided into three separate sets: training — used for
ANN learning, validation — used to determine when the training
process ended and testing — necessary to check the quality of the
model’s performance. The test set containing data from the time
interval between June 1, 2015 and May 31, 2017 gave reliable results
as to the model’s ability for out-of-sample forecasts.

6.1.1. Preparation of input data
Three versions of the new temperature variable were used
interchangeably to forecast the demand side of the electricity

 

Energy 213 (2020) 118784

market in 24 different ANN models (one for each hour of the day):
basic (no smoothing), smoothed in one line segment, and four line

19 cells 7Ocells 50cells 30cells 1 cell

NEW
VARIABLE

a

d-2
d-3
d-4

d-5

cS. CG D

d-1,h-1

So

d-1,h+1

Ss

OO OOOO0 OOO
OO OOOOO O
OO OOOO

:

Q
aS

2
a

Qn Q2 2 2

~~
a.
=

vo
wse

dn

dwn

ee0e0e6

dyn
5 a4
SMA’,

OOOO OOOO OOO OOOO O OOO
@o@ee0e0080

4 d-1
EMA‘,

OOOO OOOO ©

Fig. 12. Scheme of the best ANN.

Table 4
List of all independent variables.
Symbol Description
pt* electricity price k days earlier (weekdays only, same hour), k = {1, ...,5}
po hao} electricity price 1 h earlier on the previous day
po-bhel electricity price 1 h later on the previous day (variable not available for 24:00)
pt >h-l electricity price 1 h earlier, one week back
pth electricity price 1 h later, one week back
dtk electricity demand k days earlier (weekdays only, the same time), k = {2, ...,5} (for k = 1 the value of electricity demand is not available at the
time of forecast)
vol transaction volume k days earlier (weekdays only, the same time), k = {1, ...,5}
tv v(t) v v,(t) v vp(t) air temperature (t) or one of the three new weather variables
t*-> vv *-5(t) v vt-9(t) v va air temperature or one of the three new weather variables, one week back (the same hour)
d-5(¢)
wse variable based on wind energy
dn number of day from the first day of the analysis
dwn weekend day number (1—Monday ...
5—Friday)
dyn number of the day of the year
SMA? ot 5-element SMA of variable p*~! (weekdays only)
EMA‘, 4-element EMA of variable p*—! (weekdays only)

p-

12
T. Jasinski

Table 5

sMAPE.
hour sMAPE for variables in form*

t v(t) v(t) v,(¢)

01:00 11.08 8.69 7.50 7.94
02:00 10.28 8.07 8.67 8.69
03:00 9.84 9.22 9.70 8.67
04:00 10.09 8.70 7.84 9.66
05:00 8.77 8.75 7.47 7.77
06:00 9.31 7.86 7.62 6.76
07:00 8.08 7.78 6.69 6.81
08:00 10.58 8.73 8.73 9.17
09:00 13.03 11.05 10.34 8.77
10:00 12.36 12.58 13.05 11.13
11:00 13.02 11.71 10.80 10.32
12:00 14.76 13.37 13.74 13.70
13:00 16.48 13.67 13.07 13.13
14:00 14.52 13.73? 12.77” 13.32?
15:00 14.54 13.77” 11.32 11.22
16:00 11.95 10.81 11.50 11.11
17:00 12.33 12.38 11.25 10.72
18:00 11.67 11.42 11.09 11.33
19:00 11.41 10.31 10.76 10.27
20:00 10.34 10.73 10.13 10.54
21:00 10.32 9.76 8.81 9.02°
22:00 9.09 7.72 7.47 6.74
23:00 6.84 5.22 5.57 4.66
24:00 8.14° 7.29° 7.01° 6.88°

* Bold font indicates the lowest error values for a given hour.

> Due to the observed exploding gradient problem, the learning rate was reduced
to 0.0015 and the learning rate decay was increased to 0.00001.

© Due to the observed vanishing gradient problem, the learning rate was
increased to 0.0025.

segments.

The supply of electricity generated by wind power plants was
estimated using Eqs. (22) and (23). Three regions were distin-
guished for the highest power generation — Fig. 10 (West Pomer-
anian — 1489.620 GW, Greater Poland — 698.990 GW and
Pomeranian — 692.334 GW). For each of these voivodships, one
weather station was selected to set S: nos 105, 330 and 120 (Fig. 9).

Due to the cyclical nature of the electricity market, the following
variables were used: dwn — number of the day of the week dyn —
number of the day of the year. Their purpose is to facilitate the
modelling of annual and weekly cycles respectively. Due to the use
of separate models for each hour of the day, it is not necessary to
take into account daily cycles.

Energy 213 (2020) 118784

Due to changes in the electricity market over time (associated,
for example, with the increasing participation of renewable energy
sources in total electricity generation), the model has been
enriched with the variable dn, indicating the number of the day
from the first day of the analysis. Historical market situations are
represented by delayed: prices (p), transaction volumes (vol) and
electricity demand (d). A list of all used independent variables is
presented in Table 4.

6.1.2. Selection of independent variables and training ANN

A highly optimised set of ANN input variables and network
parameters were selected experimentally (Fig. 12).

For 24:00, the variable p*~!"*! was not introduced into the ANN
because it was in fact the forecast electricity price at 01:00. (i.e. data
not available at the time of prediction).

In the next stage of the study, the originally used new variable
v(t) was replaced by t, v,(t) and v,(t). Forecasts obtained as a result
of the described procedure (separately for each hour of the day)
served as a comparative model determining the influence of new
temperature variables on the quality of ANN performance. The re-
sults are presented in Table 5.

For each hour of the day, the DM statistic was calculated. The
obtained results are presented in Fig. 13.

7. Discussion

The conducted research has shown that the new variables
directly translate into improved accuracy of electricity price fore-
casts. For all hours, the lowest sMAPE value was reached by ANN
using one of the new variables. Differences in the precision of
forecasts obtained by models using new variables are relatively
small and it can be assumed that they are largely due to the random
selection of initial weights in neurons. At 20:00, the difference
between the error meter values for models based on both new
variables and air temperature is very small. This may suggest that
for this hour the temperature-related variables did not play a sig-
nificant role.

Three models forecasting electricity price at 14:00 using the
new variables encountered the exploding gradient problem. This
also affected one ANN (using the variable v(t)) modelling prices at
15:00. The problem was partially solved by a reduction of the
learning rate combined with an increase of the learning rate decay
value. Further modification of ANN including changes in its struc-
ture, should be considered. In the study, the modifications

DM statistic

-8
-10
-12

-14

 

 

 

 

 

—@—ANN (V) —t#=ANN (Ve) —®=ANN (Vn)

—

2 3 4 5 6 7 8 9 10 11 #12 #13 «14 «15 16 17 18 #19 20 21 22 23 24
Hour of the day

Fig. 13. DM results. Values below the lower dashed line represent cases where, with a 95% confidence level.

13
T. Jasinski

described above were not introduced due to the need to maintain
objectivity and to use the same networks for all compared sets of
input variables.

8. Conclusions

In this paper, the validity of using the proposed new input
variables has been evaluated through energy price forecasting
models, although it should be emphasised that these variables
should be used primarily in electricity demand forecasts.

ANNs model non-linear relations between independent and
dependent variables. Studies have shown that simplifying the de-
pendency between variables by bringing it closer to a linear rela-
tion even in non-linear models may translate into a significant
improvement in the quality of forecasts. The proposed procedure
allows both to avoid data clustering into different seasons and to
precisely determine the temperatures at which the nature of the
dependence with the demand for electricity changes. Compared to
the model based on air temperature, the sMAPE reduction was
achieved on average from 9.7% (without smoothing in the transi-
tion area) to 15.3% (for the smoothed in four-line segments model).
The methodology presented in this paper allows for the creation of
variables with any number of segments in the transition area,
which makes it possible to adapt new variables to the specificity of
other electricity markets. It should be expected that the proposed
variables will be useful for other forecasting models using exoge-
nous inputs.

Improvement of precision in determining the parameters of
new variables on the basis of temperature can be expected by
iterative determination of temperatures Ty and Tc,, as well as Ty
and Tcy. It is appropriate to extend the tests to other DNN archi-
tectures (in particular LSTM) and to use AI methods (GA or ES) to
optimise the ANN in the future.

Credit author statement
Tomasz Jasinski: Conceptualization, Methodology, Software,

Formal Analysis, Investigation, Data curation, Writing- Original
Draft Preparation, Visualization.

Declaration of competing interest
The authors declare that they have no known competing

financial interests or personal relationships that could have
appeared to influence the work reported in this paper.

Acknowledgements
The author thanks the three anonymous reviewers whose
comments and suggestions were very helpful in improving the

quality of this paper. The author also thanks the editors for their
constructive suggestions.

Appendix A. Supplementary data

Supplementary data to this article can be found online at
https: //doi.org/10.1016/j.energy.2020.118784.

Role of the funding source

The Lodz University of Technology financed the proofreading of
the article by a native English speaker with expertise in the field.

14

Energy 213 (2020) 118784

References

[1] NYISO. Energy market operations. Manual 11. Day-ahead scheduling manual.
Rensselaer: NYISO; 2017.

PJM. Who we are. 2018. http://www.pjm.com. [Accessed 16 July 2018].
Anastasio E, SODRSFT-PJM. Load forecasting overview. 2018. https://www.
pjm.com/-/media/committees-groups/task-forces/sodrstf/20180309/
20180309-item-04-load-forecasting.ashx. [Accessed 10 August 2018].

Xiong H, Mamon R. A higher-order Markov chain-modulated model for
electricity spot-price dynamics. Appl Energy 2019;233—234:495—515. https://
doi.org/10.1016/j.apenergy.2018.09.039.

Staffell I, Pfenninger S. The increasing impact of weather on electricity supply
and demand. Energy 2018;145:65—78. https://doi.org/10.1016/
j.energy.2017.12.051.

Zhang J-L, Zhang Y-J, Li D-Z, Tan Z-F, Ji J-F. Forecasting day-ahead electricity
prices using a new integrated model. Int J Electr Power Energy Syst 2019;105:
541-8. https://doi.org/10.1016/j.ijepes.2018.08.025.

Bordignon S, Bunn DW, Lisi F, Nan F. Combining day-ahead forecasts for
British electricity prices. Energy Econ 2013;35:88—103. https://doi.org/
10.1016/j.eneco.2011.12.001.

Moral-Carcedo J, Pérez-Garcia J. Time of day effects of temperature and
daylight on short term electricity load. Energy 2019;174:169—83. https://
doi.org/10.1016/j.energy.2019.02.158.

Bunnoon P, Chalermyanont K, Limsakul C. Wavelet and neural network
approach to demand forecasting based on whole and electric sub-control
center area. Int J Soft Comput AndEngineering 2012;1:81—6.

Liu H, Shi J. Applying ARMA—GARCH approaches to forecasting short-term
electricity prices. Energy Econ 2013;37:152—66. https://doi.org/10.1016/
j-eneco.2013.02.006.

Vilar JM, Cao R, Aneiros G. Forecasting next-day electricity demand and price
using nonparametric functional methods. Int J Electr Power Energy Syst
2012;39:48—55. https://doi.org/10.1016/j.ijepes.2012.01.004.

Beigaite R, Krilavicius T, Man KL. Electricity price forecasting for nord pool
data. In: 2018 int. Conf. Platf. Technol. Serv. IEEE; 2018. p. 1—6. https://doi.org/
10.1109/PlatCon.2018.8472762.

Reston Filho JC, Affonso M, de C, de Oliveir RCL. Short-term energy price
prediction multi-step-ahead in the Brazilian market using data mining. In:
Karahoca A, editor. Adv. Data min. Knowl. Discov. Appl. InTech; 2012.
p. 219—34. https://doi.org/10.5772/48472.

Yan X, Chowdhury NA. Mid-term electricity market clearing price forecasting
utilizing hybrid support vector machine and auto-regressive moving average
with external input. Int J Electr Power Energy Syst 2014;63:64—70. https://
doi.org/10.1016/j.ijepes.2014.05.037.

Osorio GJ, Matias JCO, Catalao JPS. Electricity prices forecasting by a hybrid
evolutionary-adaptive methodology. Energy Convers Manag 2014;80:
363-73. https://doi.org/10.1016/j.enconman.2014.01.063.

de Marcos RA, Reneses J, Bello A. Long-term Spanish electricity market price
forecasting with cointegration and VEC models. In: 2016 int. Conf. Probabi-
listic methods appl. To power syst. IEEE; 2016. p. 1—7. https://doi.org/
10.1109/PMAPS.2016.7764158.

Badran SM, Abouelatta OB. Forecasting electrical load using ANN combined
with multiple regression method. Res Bull Jordan ACM 2011;2:152—8.

Lago J, De Ridder F, De Schutter B. Forecasting spot electricity prices: deep
learning approaches and empirical comparison of traditional algorithms. Appl
Energy 2018;221:386—405. https://doi.org/10.1016/j.apenergy.2018.02.069.
Hernandez L, Baladr6n C, Aguiar JM, Calavia L, Carro B, Sanchez-Esguevillas A,
et al. A study of the relationship between weather variables and electric po-
wer demand inside a smart grid/smart world framework. Sensors 2012;12:
11571-—91. https://doi.org/10.3390/s120911571.

Yi-Ling H, Hai-Zhen M, Guang-Tao D, Jun S. Influences of urban temperature
on the electricity consumption of Shanghai. Adv Clim Change Res 2014;5:
74—80. https://doi.org/10.3724/SP.J.1248.2014.074.

Jose D, Mathew M, Krishnan A. Weather dependency of electricity demand: a
case study in warm humid tropical climate. In: 2016 3rd int. Conf. Electr.
Energy syst. JEEE; 2016. p. 102-5. https://doi.org/10.1109/
ICEES.2016.7510624.

Chapagain K, Kittipiyakul S. Performance analysis of short-term electricity
demand with atmospheric variables. Energies 2018;11:818. https://doi.org/
10.3390/en11040818.

Rodriguez F, Fleetwood A, Galarza A, Fontan L. Predicting solar energy gen-
eration through artificial neural networks using weather forecasts for
microgrid control. Renew Energy 2018;126:855—64. https://doi.org/10.1016/
j.renene.2018.03.070.

Panapakidis IP, Dagoumas AS. Day-ahead electricity price forecasting via the
application of artificial neural network based models. Appl Energy 2016;172:
132—51. https://doi.org/10.1016/j.apenergy.2016.03.089.

Elamin N, Fukushige M. Modeling and forecasting hourly electricity demand
by SARIMAX with interactions. Energy 2018;165:257—68. https://doi.org/
10.1016/j.energy.2018.09.157.

Bowden N, Payne JE. Short term forecasting of electricity prices for MISO
hubs: evidence from ARIMA-EGARCH models. Energy Econ 2008;30:3186—97.
https://doi.org/10.1016/j.eneco.2008.06.003.

Zhang J, Tan Z, Yang S. Day-ahead electricity price forecasting by a new hybrid
method. Comput Ind Eng 2012;63:695—701.  https://doi.org/10.1016/

[2]
[3]

[4]

[5

—

[6]

[7]

[8]

[9

—

[10]

[11]

[12]

[13]

[14]

[15]

[16]

[17]

[18]

[19]

[20]

[21]

[22]

[23]

[24]

[25]

[26]

[27]
T. Jasinski

[28]

[29]

[30]

[31]

[32]

[33]

[34]

[35]

[36]

[37]

[38]

[39]

[40]

[41]

[42]

[43]

[44]

[45]

[46]

[47]

[48]

[49]

[50]

[51]

[52]

[53]

[54]

j.cie.2012.03.016.

Dong Y, Wang J, Jiang H, Wu J. Short-term electricity price forecast based on
the improved hybrid model. Energy Convers Manag 2011;52:2987—95.
https://doi.org/10.1016/j.enconman.2011.04.020.

Crespo Cuaresma J, Hlouskova J, Kossmeier S, Obersteiner M. Forecasting
electricity spot-prices using linear univariate time-series models. Appl Energy
2004;77:87—106. https://doi.org/10.1016/S0306-2619(03)00096-5.

Diongue AK, Guégan D, Vignal B. Forecasting electricity spot market prices
with a k-factor GIGARCH process. Appl Energy 2009;86:505—10. https://
doi.org/10.1016/j.apenergy.2008.07.005.

Cifter A. Forecasting electricity price volatility with the Markov-switching
GARCH model: evidence from the Nordic electric power market. Elec Power
Syst Res 2013;102:61—7. https://doi.org/10.1016/j.epsr.2013.04.007.

Zhang J, Tan Z. Day-ahead electricity price forecasting using WT, CLSSVM and
EGARCH model. Int J Electr Power Energy Syst 2013;45:362—8. https://
doi.org/10.1016/j.ijepes.2012.09.007.

Garcia-Martos C, Rodriguez J, Sanchez MJ. Modelling and forecasting fossil
fuels, CO2 and electricity prices and their volatilities. Appl Energy 2013;101:
363-75. https://doi.org/10.1016/j.apenergy.2012.03.046.

He K, Xu Y, Zou Y, Tang L. Electricity price forecasts using a Curvelet denoising
based approach. Phys A Stat Mech Its Appl 2015;425:1—9. https://doi.org/
10.1016/j.physa.2015.01.012.

He K, Yu L, Tang L. Electricity price forecasting with a BED (Bivariate EMD
Denoising) methodology. Energy 2015;91:601—9. https://doi.org/10.1016/
j.energy.2015.08.021.

Karakatsani NV, Bunn DW. Forecasting electricity prices: the impact of fun-
damentals and time-varying coefficients. Int J Forecast 2008;24:764—85.
https://doi.org/10.1016/j.ijforecast.2008.09.008.

Hickey E, Loomis DG, Mohammadi H. Forecasting hourly electricity prices
using ARMAX—GARCH models: an application to MISO hubs. Energy Econ
2012;34:307—15. https://doi.org/10.1016/j.eneco.2011.11.011.

Lu X, Dong ZY, Li X. Electricity market price spike forecast with data mining
techniques. Elec Power Syst Res 2005;73:19—29. https://doi.org/10.1016/
j-epsr.2004.06.002.

Borovkova S, Schmeck MD. Electricity price modeling with stochastic time
change. Energy Econ 2017;63:51—65. https://doi.org/10.1016/
j-eneco.2017.01.002.

Amjady N, Keynia F. Day-ahead price forecasting of electricity markets by a
new feature selection algorithm and cascaded neural network technique.
Energy Convers Manag 2009;50:2976—82. https://doi.org/10.1016/
j.enconman.2009.07.016.

Yang Z, Ce L, Lian L. Electricity price forecasting by a hybrid model, combining
wavelet transform, ARMA and kernel-based extreme learning machine
methods. Appl Energy 2017;190:291—305. https://doi.org/10.1016/
j.apenergy.2016.12.130.

Crisostomi E, Gallicchio C, Micheli A, Raugi M, Tucci M. Prediction of the
Italian electricity price for smart grid applications. Neurocomputing
2015;170:286—95. https://doi.org/10.1016/j.neucom.2015.02.089.

Abedinia O, Amjady N, Shafie-khah M, Catalao JPS. Electricity price forecast
using Combinatorial Neural Network trained by a new stochastic search
method. Energy Convers Manag 2015;105:642—54. https://doi.org/10.1016/
j.enconman.2015.08.025.

Pao H-T. Forecasting electricity market pricing using artificial neural net-
works. Energy Convers Manag 2007;48:907—12. https://doi.org/10.1016/
j.enconman.2006.08.016.

Yamashita D, Isa AM, Yokoyama R, Niimura T. Forecasting of electricity price
and demand using autoregressive neural networks. IFAC Proc 2008;41:
14934—8. https://doi.org/10.3182/20080706-5-KR-1001.02527.

Singhal D, Swarup KS. Electricity price forecasting using artificial neural
networks. Int J Electr Power Energy Syst 2011;33:550—5. https://doi.org/
10.1016/j.ijepes.2010.12.009.

Keles D, Scelle J, Paraschiv F, Fichtner W. Extended forecast methods for day-
ahead electricity spot prices applying artificial neural networks. Appl Energy
2016;162:218—30. https://doi.org/10.1016/j.apenergy.2015.09.087.
Anbazhagan S, Kumarappan N. Day-ahead deregulated electricity market
price forecasting using neural network input featured by DCT. Energy Convers
Manag 2014;78:711—9. https://doi.org/10.1016/j.enconman.2013.11.031.

Lei M, Feng Z. A proposed grey model for short-term electricity price fore-
casting in competitive power markets. Int J Electr Power Energy Syst 2012;43:
531-8. https://doi.org/10.1016/j.ijepes.2012.06.001.

Shayeghi H, Ghasemi A. Day-ahead electricity prices forecasting by a modified
CGSA technique and hybrid WT in LSSVM based scheme. Energy Convers
Manag 2013;74:482—91. https://doi.org/10.1016/j.enconman.2013.07.013.
Ghasemi A, Shayeghi H, Moradzadeh M, Nooshyar M. A novel hybrid algo-
rithm for electricity price and load forecasting in smart grids with demand-
side management. Appl Energy 2016;177:40—59. https://doi.org/10.1016/
j.apenergy.2016.05.083.

Niu D, Liu D, Wu DD. A soft computing system for day-ahead electricity price
forecasting. Appl Soft Comput 2010;10:868—75. https://doi.org/10.1016/
j.asoc.2009.10.004.

Zhang X, Wang J, Gao Y. A hybrid short-term electricity price forecasting
framework: cuckoo search-based feature selection with singular spectrum
analysis and SVM. Energy Econ 2019;81:899—913. https://doi.org/10.1016/
j-eneco.2019.05.026.

Agrawal RK, Muchahary F, Tripathi MM. Ensemble of relevance vector

15

[55]

[56]

[57]

[58]

[59]

[60]

[61]

[62]

[63]

[64]

[65]

[66]

[67]

[68]

[69]

[70]

[71]

[72]

[73]

[74]

[75]

[76]

[77]

[78]

[79]

[80]

Energy 213 (2020) 118784

machines and boosted trees for electricity price forecasting. Appl Energy
2019;250:540—8. https://doi.org/10.1016/j.apenergy.2019.05.062.

Hagfors LI, Bunn D, Kristoffersen E, Staver TT, Westgaard S. Modeling the UK
electricity price distributions using quantile regression. Energy 2016;102:
231—43. https://doi.org/10.1016/j.energy.2016.02.025.

Cruz A, Munoz A, Zamora JL, Espinola R. The effect of wind generation and
weekday on Spanish electricity spot price forecasting. Elec Power Syst Res
2011;81. https://doi.org/10.1016/j.epsr.2011.06.002. 1924—35.,

Feijoo F, Silva W, Das TK. A computationally efficient electricity price fore-
casting model for real time energy markets. Energy Convers Manag 2016;113:
27-35. https://doi.org/10.1016/j.enconman.2016.01.043.

Li XR, Yu CW, Ren SY, Chiu CH, Meng K. Day-ahead electricity price forecasting
based on panel cointegration and particle filter. Elec Power Syst Res 2013;95:
66—76. https://doi.org/10.1016/j.epsr.2012.07.021.

Qiu X, Suganthan PN, Amaratunga GAJ. Short-term electricity price forecasting
with empirical mode decomposition based ensemble kernel machines. Pro-
cedia Comput Sci 2017;108:1308—17. https://doi.org/10.1016/
j._procs.2017.05.055.

Pousinho HMI, Mendes VMF, Catalao JPS. Short-term electricity prices fore-
casting in a competitive market by a hybrid PSO—ANFIS approach. Int J Electr
Power Energy Syst 2012;39:29—35. https://doi.org/10.1016/
j.ijepes.2012.01.001.

Wang F, Li K, Zhou L, Ren H, Contreras J, Shafie-khah M, et al. Daily pattern
prediction based classification modeling approach for day-ahead electricity
price forecasting. Int J Electr Power Energy Syst 2019;105:529—40. https://
doi.org/10.1016/j.ijepes.2018.08.039.

Monteiro C, Ramirez-Rosado JJ, Fernandez-Jimenez LA, Ribeiro M. New
probabilistic price forecasting models: application to the Iberian electricity
market. Int J Electr Power Energy Syst 2018;103:483—96. https://doi.org/
10.1016/j.ijepes.2018.06.005.

de Marcos RA, Bello A, Reneses J. Electricity price forecasting in the short term
hybridising fundamental and econometric modelling. Elec Power Syst Res
2019;167:240—51. https://doi.org/10.1016/j.epsr.2018.10.034.

Yang W, Wang J, Niu T, Du P. A hybrid forecasting system based on a dual
decomposition strategy and multi-objective optimization for electricity price
forecasting. Appl Energy 2019;235:1205—25. https://doi.org/10.1016/
j.apenergy.2018.11.034.

Wang D, Luo H, Grunder O, Lin Y, Guo H. Multi-step ahead electricity price
forecasting using a hybrid model based on two-layer decomposition tech-
nique and BP neural network optimized by firefly algorithm. Appl Energy
2017;190:390—407. https://doi.org/10.1016/j.apenergy.2016.12.134.

Gareta R, Romeo LM, Gil A. Forecasting of electricity prices with neural net-
works. Energy Convers Manag 2006;47:1770—8. https://doi.org/10.1016/
j.enconman.2005.10.010.

Fidalgo JN, Da Rocha EFNR. Improving electricity price forecasting trough data
segmentation based on artificial immune systems. In: 2018 15th int. conf. eur.
energy mark. IEEE; 2018. p. 1—5. https://doi.org/10.1109/EEM.2018.8469954.
Gaillard P, Goude Y, Nedellec R. Additive models and robust aggregation for
GEFCom2014 probabilistic electric load and electricity price forecasting. Int J
Forecast 2016;32:1038—50. https://doi.org/10.1016/j.ijforecast.2015.12.001.
Andrade J, Filipe J, Reis M, Bessa R. Probabilistic price forecasting for day-
ahead and intraday markets: beyond the statistical model. Sustainability
2017;9:1990. https://doi.org/10.3390/su9111990.

Peng L, Liu S, Liu R, Wang L. Effective long short-term memory with differ-
ential evolution algorithm for electricity price prediction. Energy 2018;162:
1301-14. https://doi.org/10.1016/j.energy.2018.05.052.

Cheng H, Ding X, Zhou W, Ding R. A hybrid electricity price forecasting model
with Bayesian optimization for German energy exchange. Int J Electr Power
Energy Syst 2019;110:653—66. https://doi.org/10.1016/j.ijepes.2019.03.056.
Kuo P-H, Huang C-J. An electricity price forecasting model by hybrid struc-
tured deep neural networks. Sustainability 2018;10:1280. https://doi.org/
10.3390/su10041280.

Luo S, Weng Y. A two-stage supervised learning approach for electricity price
forecasting by leveraging different data sources. Appl Energy 2019;242:
1497—512. https://doi.org/10.1016/j.apenergy.2019.03.129.

Brusaferri A, Matteucci M, Portolani P, Vitali A. Bayesian deep learning based
method for probabilistic forecast of day-ahead electricity prices. Appl Energy
2019;250:1158—75. https://doi.org/10.1016/j.apenergy.2019.05.068.

Nazar MS, Fard AE, Heidari A, Shafie-khah M, Catalao JPS. Hybrid model using
three-stage algorithm for simultaneous load and price forecasting. Elec Power
Syst Res 2018;165:214—28. https://doi.org/10.1016/j.epsr.2018.09.004.

Lin W-M, Gow H-J, Tsai M-T. Electricity price forecasting using enhanced
probability neural network. Energy Convers Manag 2010;51:2707—14.
https://doi.org/10.1016/j.enconman.2010.06.006.

Gao C, Bompard E, Napoli R, Cheng H. Price forecast in the competitive
electricity market by support vector machine. Phys A Stat Mech Its Appl
2007;382:98—113. https://doi.org/10.1016/j.physa.2007.03.050.

Yan X, Chowdhury NA. Mid-term electricity market clearing price forecasting:
a multiple SVM approach. Int J Electr Power Energy Syst 2014;58:206—14.
https://doi.org/10.1016/j.ijepes.2014.01.023.

Gaur K, Kumar H, Agarwal RPK, Baba KVS, Soonee SK. Analysing the electricity
demand pattern. In: 2016 natl. Power syst. Conf. IEEE; 2016. p. 1—6. https://
doi.org/10.1109/NPSC.2016.7858969.

Cornillon P-A, Hengartner N, Lefieux V, Matzner-Lgber E. Fully nonparametric
short term forecasting electricity consumption. In: Antoniadis A, Poggi J-M,
T. Jasinski

[81]

[82]

[83]

[84]

[85]

[86]

[87]

Brossat X, editors. Model. Stoch. Learn. Forecast. High Dimens.; 2015.
p. 79—93. https://doi.org/10.1007/978-3-319-18732-7_5.

Zhang Z, Zhang Y, Jin L. Thermal comfort in interior and semi-open spaces of
rural folk houses in hot-humid areas. Build Environ 2018;128:336—47.
https://doi.org/10.1016/j.buildenv.2017.10.028.

Luo M, Wang Z, Brager G, Cao B, Zhu Y. Indoor climate experience, migration,
and thermal comfort expectation in buildings. Build Environ 2018;141:
262-72. https://doi.org/10.1016/j.buildenv.2018.05.047.

Galassi V, Madlener R. Shall I open the window? Policy implications of
thermal-comfort adjustment practices in residential buildings. Energy Pol
2018;119:518—27. https://doi.org/10.1016/j.enpol.2018.03.015,

Szczurek A, Maciejewska M, Uchronski M. Determination of thermal prefer-
ences based on event analysis. Energy Build 2018;166:210—9. https://doi.org/
10.1016/j.enbuild.2018.02.014.

Gianniou P, Reinhart C, Hsu D, Heller A, Rode C. Estimation of temperature
setpoints and heat transfer coefficients among residential buildings in
Denmark based on smart meter data. Build Environ 2018;139:125—33.
https://doi.org/10.1016/j.buildenv.2018.05.016.

Gobakis K, Kolokotsa D. Coupling building energy simulation software with
microclimatic simulation for the evaluation of the impact of urban outdoor
conditions on the energy consumption and indoor environmental quality.
Energy Build 2017;157:101—15. https://doi.org/10.1016/
j.enbuild.2017.02.020.

Barnett A, Eisen E. A quartile test for differences in distribution. J Am Stat
Assoc 1982;77:47—51. https://doi.org/10.2307/2287768.

16

[88]

[89]

[90]

[91]

[92]
[93]
[94]

[95]

[96]

Energy 213 (2020) 118784

Barbosa de Alencar D, de Mattos Affonso C, Limao de Oliveira R, Moya
Rodriguez J, Leite J, Reston Filho J. Different models for forecasting wind po-
wer generation: case study. Energies 2017;10:1976. https://doi.org/10.3390/
en10121976.

Lopes VV, Scholz T, Raischel F, Lind PG. Principal wind turbines for a condi-
tional portfolio approach to wind farms. J Phys Conf Ser 2014;524:012183.
https://doi.org/10.1088/1742-6596/524/1/012183.

Sim S-K, Maass P, Lind P. Wind speed modeling by nested ARIMA processes.
Energies 2018;12:69. https://doi.org/10.3390/en12010069.

Lind P, Vera-Tudela L, Wachter M, Kiihn M, Peinke J. Normal behaviour
models for wind turbine vibrations: comparison of neural networks and a
stochastic approach. Energies 2017;10:1944. https://doi.org/10.3390/
en10121944.

Armstrong JS. Long-range forecasting: from crystal ball to computer. second
ed. New York: John Wiley & Sons; 1985.

Makridakis S. Accuracy measures: theoretical and practical concerns. Int J
Forecast 1993;9:527—9. https://doi.org/10.1016/0169-2070(93)90079-3.
Diebold FX, Mariano RS. Comparing predictive accuracy. J Bus Econ Stat
1995;13:253—63. https://doi.org/10.1080/07350015.1995.10524599.

Kiefer NM, Vogelsang TJ. A new asymptotic theory for heteroskedasticity-
autocorrelation robust tests. Econom Theor 2005;21. https://doi.org/
10.1017/S0266466605050565.

Coroneo L, Iacone F. Comparing predictive accuracy in small samples using
fixed-smoothing asymptotics. J Appl Econ 2020;35(4):391—409. https://
doi.org/10.1002/jae.2756.
