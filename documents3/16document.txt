Np} | Digital Medicine

REVIEW ARTICLE OPEN

www.nature.com/npjdigitalmed

Photoplethysmography based atrial fibrillation detection: a

review

Tania Pereira(@'*, Nate Tran', Kais Gadhoumi', Michele M. Pelter', Duc H. Do’, Randall J. Lee*, Rene Colorado’, Karl Meisel* and

Xiao Hu@'°”

Atrial fibrillation (AF) is a cardiac rhythm disorder associated with increased morbidity and mortality. It is the leading risk factor for
cardioembolic stroke and its early detection is crucial in both primary and secondary stroke prevention. Continuous monitoring of
cardiac rhythm is today possible thanks to consumer-grade wearable devices, enabling transformative diagnostic and patient
management tools. Such monitoring is possible using low-cost easy-to-implement optical sensors that today equip the majority of
wearables. These sensors record blood volume variations—a technology known as photoplethysmography (PPG)—from which the
heart rate and other physiological parameters can be extracted to inform about user activity, fitness, sleep, and health. Recently,
new wearable devices were introduced as being capable of AF detection, evidenced by large prospective trials in some cases. Such
devices would allow for early screening of AF and initiation of therapy to prevent stroke. This review is a summary of a body of work
on AF detection using PPG. A thorough account of the signal processing, machine learning, and deep learning approaches used in
these studies is presented, followed by a discussion of their limitations and challenges towards clinical applications.

npj Digital Medicine (2020)3:3 ; https://doi.org/10.1038/s41746-019-0207-9

INTRODUCTION

Atrial fibrillation (AF) is an abnormal cardiac rhythm characterized
by a disorganized atrial activity. AF is recognized in the
electrocardiogram (ECG) as an irregularly irregular rhythm lasting
more than 30s, with no discernible P-waves preceding the QRS
complex.’ AF prevalence is age, gender, and race dependent.’ It is
particularly high in the elderly population, reaching 10-17% in
subjects 80 years and older.° In addition, AF is more prevalent in
males and in the white population.® AF is associated with
significant morbidity and mortality. One in five strokes is
associated with AF and one-third of cardiac arrhythmias
hospitalizations are due to AF-related complications. AF has been
associated with a twofold increase in the risk of death.*
Additionally, the aging population in the US and worldwide is
leading to a markedly increasing AF prevalence®”.

The high prevalence of asymptomatic AF has significant clinical
implications on the diagnosis and management of AF.° Inter-
mittent ECG evaluation during clinical visits has a low likelihood of
detecting paroxysmal AF. Continuous monitoring would increase
the chances of AF detection, thereby allowing appropriate primary
and secondary stroke prevention strategies to reduce the high
morbidity and mortality of stroke.

For patients with acute ischemic stroke or transient ischemic
attack, approximately 10% will have new AF detected during their
hospital admission.’ ? Continuous ECG monitoring for 30 days is
recommended in case of an embolic stroke of undetermined
cause (cryptogenic).? Novel non-intrusive approaches for cardiac
rhythm monitoring can potentially enable early and accurate
detection of asymptomatic paroxysmal AF and create a shift in AF
management.'”'' Especially for asymptomatic AF cases, new tools

that allow the AF detection will help make the appropriate clinical
decisions.'°

Photoplethysmography (PPG) has emerged as a low-cost and
non-intrusive modality for continuous monitoring of heart rate. A
variety of wearable devices offer PPG-based monitoring, including
smartphones and smartwatches. A photoplethysmogram is a
pulse pressure signal resulting from the propagation of blood
pressure pulses along arterial blood vessels. Measured on the
periphery, it carries rich information about the cardiac activity,
cardiovascular condition, the interaction between parasympa-
thetic and sympathetic nervous systems, and hemoglobin level. '7
Many physiological parameters can be derived from PPG,
including oxygen saturation, heart rate, blood pressure, and
cardiac output.'* These capacities of PPG open the door to
develop new ambulatory diagnosis tools enabling early screening
of heart conditions, including arrhythmia. '*

This review provides an account of the approaches used in PPG-
based AF detection. A brief overview of the technology behind
PPG is first presented, followed by a summary of methods and
algorithms developed for PPG-based AF detection. Recognizing
the importance of using PPG to detect AF at scale, the motivation
of this review is to guide the future development of algorithms
towards clinical-grade applications.

PHOTOPLETHYSMOGRAPHY

PPG signal

PPG waveform is generated during a cardiac cycle and typically
measured at a peripheral site. Therefore, it is essentially a pulse
pressure waveform that originates from the heart contraction and
propagates through the vascular tree. As blood flow is controlled

 

‘Department of Physiological Nursing, University of California, San Francisco, CA, USA. *David Geffen School of Medicine, University of California, Los Angeles, CA, USA.
Cardiovascular Research Institute, Department of Medicine, Institute for Regeneration Medicine, University of California, San Francisco, CA, USA. “Department of Neurology,
School of Medicine, University of California, San Francisco, CA, USA. °Department of Neurosurgery, School of Medicine, University of California, Los Angeles, CA, USA.
°Department of Neurological Surgery, University of California, San Francisco, CA, USA. ‘Institute of Computational Health Sciences, University of California, San Francisco, CA, USA.

*email: taniapereiral0@gmail.com

Scripps Research Translational Institute

np} nature partner

journals
np}

T. Pereira et al.

 

PPG signal

Normal Sinus Rhythm

PPG Measurement

i) |
Mi

|
\

%SpO2 PRbpm

 

 

Fig. 1

by neural, cardiac, and respiratory interactions, various physiolo-
gical parameters could theoretically be extracted from analyzing a
PPG signal.'° For this reason, the PPG signal has rich information
about physiological conditions.'*

PPG waveforms have typical morphological components
corresponding to landmark events in the cardiac cycle. During
the contraction of the left ventricle, blood is ejected out of the
heart and propagates along the arterial tree, this corresponds to
the initial positive slope of a PPG pulse. The systolic peak marks
the maximum of the waveform. A decrease in amplitude following
the systolic peak is marked by a local minimum, or the dicrotic
notch, which corresponds to the closing of aortic valves
separating the systolic and diastolic phases. In some cases, a
third peak following the dicrotic notch can be identified. It
corresponds to a reflected component of the forward wave from
various reflection sites including vessel bifurcations.'°

Clinical parameters

One primary clinical application of PPG is arterial blood oxygen
saturation (SpO2) estimation through pulse oximetry.'’ SpO2 is
defined as the percentage of oxygen saturation in the arterial
blood, which can be measured by the ratio of oxygenated
hemoglobin concentration to the total hemoglobin concentration,
with a normal range between 97% and 98%.'® Recently, new
applications of PPG have emerged for the continuous estimation
of valuable cardiovascular parameters in ambulatory settings.
Heart rate, blood pressure, and respiratory rate could be closely
monitored for fitness or health assessment.’ Advanced diagnostic
applications of PPG were also envisaged. Cardiac function, arterial
stiffness, autonomic nervous system (ANS) responses, and apnea
are among conditions that could potentially be detected or
evaluated using PPG.

Changes in blood volume are synchronous with the heart beats,
such synchrony is manifested by the concordance of inter-beat
intervals (RR intervals) measured in PPG and time-synchronized
ECG.”° Heart rate variability (HRV) is an indirect measurement of
ANS, and it has also been considered as a surrogate parameter of
the interaction between the brain and cardiovascular system.”'
HRV metrics can be derived from analyzing RR intervals in time
and/or frequency domain as well as using nonlinear dynamic
analysis approaches.~* Respiratory rate is one of the fundamental
vital signs and can be determined from the time-frequency
representation of a PPG signal.”°

Some hemodynamic parameters such as augmentation index
(Alx) and pulse wave velocity (PWV) are important biomarkers of
arterial stiffness, which is a direct cause of hypertension and a
major risk factor for cardiovascular events such as myocardial

npj Digital Medicine (2020) 3

| ‘i

|
| ul

I

Glut
lk \ |
NTN

"| ni

"|
| |!

| |
| | hf
i t r
\j| | IN
| NVA Hy “ I" l

| } |

HLH \

mm |
A I I

iy)

i LK
Mi Whi NI |
| |

|
NI

| | " i

 
 

Noise Artifact

PPG signal acquired using a wearable device and typical waveforms representing NSR, AF, and noise artifact.

infarction and stroke. Both Alx and PWV could be derived from
PPG,**?° Subendocardial Viability Ratio (SEVR %) and Ejection
Time Index (ETI) are two hemodynamic parameters used in the
evaluation of cardiac workload that can be estimated with PPG
analysis.2° Additionally, some studies claim that arterial blood
pressure could be estimated using advanced analysis of PPG.'”

Modes of PPG measurement

A PPG signal has two main components: a quasi-static direct
current (DC) component, which represents light reflected/trans-
mitted from static arterial blood, venous blood, skin and tissues;
and pulsatile alternate current (AC) component which arises from
modulation in light absorption due to changes in arterial blood
volume. PPG measurement can be carried out using two modes:
transmission and reflectance. In transmission mode, the light
transmitted through the medium is detected by a photodetector
(PD), which is positioned in the opposite site of the light source.
The sensor must be located on the body at a site where
transmitted light can be detected. The measurement site is limited
to the extremities of the body, such as the fingertip or earlobe.
The greatest disadvantage of the transmission mode is the
location of the device that can interfere with daily routine
movements.”° In reflectance mode, the PD detects light that is
back scattered or reflected from tissues, bone, and/or blood
vessels, which means the light source and PD are positioned on
the same side. Unlike the transmission mode, the measurement
sites are not restricted to any particular location, which facilitates a
user-friendly monitoring approach. The wrist, forearm, ankle, and
forehead are common measurement sites.7”

Since the basic form of PPG technology requires only a few
optoelectronic components (a light source and a PD: to measure
the variations on the light reflected/transmitted by the tissues), it
can be easily and inexpensively incorporated in various digital
devices such as watches, smartphones, or wearables.*® The
ubiquitous availability of PPG in a wide range of wearable digital
devices has motivated the search for new applications and the
development of novel biomedical solutions.

PPG-BASED AF DETECTION

In a PPG signal, AF is manifested as varying pulse-to pulse intervals
and pulse morphologies. On the other hand, a normal sinus
rhythm (NSR) is recognizable through regularly spaced PPG pulses
with similar morphologies between consecutive pulses. Recogniz-
ing an arrhythmia in a PPG signal can sometimes be challenging in
the presence of artifacts. Common sources of artifacts are motion
and poor sensor contacts. Artifacts can be misinterpreted as

Scripps Research Translational Institute
 

Smart Watch
PPG Measurement
Device
PPG Representations z
P
es Time(sec)
PPG Length
Traditional Statistics
NSR .
\/
Classification
approach
PPG feature
Number of patients
Hundreds

Le

Smart Phone

    

   
 

Increase the amount OPS

Hundreds

T. Pereira et al.

np)

 

Fingertip Ear Clip

 

%SpO2 PRbpm

I) oy

 

——_

Time series Image representation

 

Amplitude (A.U.)

Time(sec)

[10 sec: 10 min]

 

Machine Learning

Deep Learning

‘ey fea
Ke x

 

Thousands

——_

Fig.2 Overview of the main features extracted from PPG signals used in the studies reviewed (see Tables 1-3). SoO2 oxygen saturation,

PRbpm pulse rate (beats per minute).

physiological abnormalities. Motion artifacts can be identified
using accelerometry data. Most modern wearable devices include
accelerometry sensors that measure acceleration forces along
different spatial directions. It is a common practice to discard PPG
contaminated with an artifact. Figure 1 depicts samples of PPG
with NSR, AF, and artifact.

ECG remains the gold standard for the electrophysiological
definition and recognition of arrhythmias,’ including AF diag-
nosis.*” In a recent study, new deep learning approaches achieved
cardiologist-level AF detection of 12 types of arrhythmia (F1 score =
0.84 vs F1 score = 0.78) when 91,232 single-lead ECGs from 53,549
patients were analyzed.°° Compared to ECG, PPG-based AF
detection is more challenging but also rewarding in situations
where longer monitoring time and lower cost beyond what ECG
offers is needed, e.g., screening AF at scale.

Recent advances in sensor technologies and wearable devices
have increased the role that a PPG-based solution could play in
the assessment of health status. Electronics capable of recording
PPG signals with relatively high signal-to-noise ratio (SNR) may
warrant reliable PPG monitoring and screening of arrhythmia.''*'

In a typical AF detection algorithm, features (temporal, spectral,
or morphological) are extracted from the acquired PPG signal and
analyzed by the detection algorithm to inform if an AF rhythm is
detected. In some approaches, image representation of the
temporal waveform has been considered. The derived image
would then be analyzed using conventional image processing or
artificial intelligence-based methods (Fig. 2).°*** Traditionally,
prominent features were derived from the tachogram (RR
intervals) since it is a reliable measure of heart beats.*° Realizing
that PPG waveforms may carry physiological information beyond
heart rate, new features beyond RR intervals were derived.*° The
use of PPG time series and their images representation (e.g. raw

Scripps Research Translational Institute

plot of the signal, fast Fourier transform spectrum, or wavelet
spectrogram—represented in the Fig. 2 in PPG representation
part) were used with promising results in the detection of
physiological events,***”** Images for PPG representation in Fig. 2
is a general depiction of the format types of information used by
the different algorithms.

In the following sections, we review studies of PPG-based AF
detection. A body of white papers and peer-reviewed works
indexed by PubMed, Scopus, IEEE Xplore, and Web of Science up
to June 2019 was selected based on the following search
expression: (PPG “OR” Photoplethysmography) “AND” (atrial
fibrillation “OR” AF “OR” AFib) “AND” (detection “OR” recognition).
Each study is reviewed with respect to the size, the number of
patients, and recording settings of data analyzed, the PPG device
and site of recording, the AF detection algorithm, and_ its
performance. Figure 2 summarizes the main features examined
in these studies, described with more details in Tables 1-3.

Performance metrics

AF detection algorithms can be evaluated using several perfor-
mance metrics. It is common for many studies to report sensitivity,
specificity, and accuracy. Sensitivity is defined as the probability to
detect true AF events, while the specificity measures the
proportion of actual Non-AF instances correctly identified as such.
Accuracy is a balanced metric of sensitivity and specificity. The
accuracy of an AF detection algorithm is its ability to differentiate
between AF and Non-AF cases.’ Generally, accuracy is the most
common reported metric, along with the area under the curve
(AUC) of the receiver operating characteristic (ROC). A ROC for
differentiating AF vs Non-AF is generated by plotting sensitivity vs
(1-specificity) at different classification thresholds. AUC is a

npj Digital Medicine (2020) 3
T. Pereira et al.

 

Np)

6060 = ds
‘606'0 = uas

DOU 3Eq JO}
saiunjeay Jo sanjea

‘7660 =22V_  ploysasyy paauaq

S6°0 = DNV
‘8L6°0 =22V
9/6°0 = ds
‘EEL0 = UBS
‘0960 = 22V
DAd ‘0860 = dS
‘L99°0 = uas
‘GS6°0 = 22V
Vd “SE6'0 = dS
‘0Z6°0 = uas

‘LS6°0 = 29 dV

0S6'0 = ds
‘0S6'0 = uas
‘LE6°0 = DNV

€0'0 66:0 = dS
‘TO'0 ¥ Z6'0 = UaS

66°0 = DNV
‘y6'0 = ds
‘'J6°0 = uas
‘660 =22V
6£S6'0 = ds
‘9LZ6'0 = Uuas
‘Sv96'0 = 22V
UO!}DoI}ep

SWYIAUI JOJ
SNSd1 DDUCULOJdd

Japow d1}sIHoO}
you dNse|9

DOU 3$9q JO}
sainjyeaj Jo sanjen

pjoysasy} paauaq

DOU 3$9q JO}
sainjyeaj Jo sanjen

pjoysasy} paauaq

japPOW AOWeW

3}eS-| | Japso-}Sul4

Japow d1}sIHoO}
JON Ise]

DOU 3Eq JO}
saiunjeay Jo sanjea

pjoysasy} paauaq

ABojopou ew

jo abesane ‘uolelAap
puepuejs ‘uo! euen

JO JUSIDYJaOD “saunjeay
SOWaS SOW!) YY

(sounjeay AdojuUa
ajdwes ay} Jo xew

9y} pue ull ‘UOI}eIADpP
PJePU\s DU} JO UOISIDA
sNngol ‘UO!}JeIAapP
puepueys ‘Adol}uUa
ajduwes) saunjeay saiias
sould YY + NND 24}
WOJJ paulejqo sainjea;
—WJOJsUueI} JaJBAeM
Jo uonejUasaidal
jeuydeds SHew! Odd

Jo|d auedulog ‘AdojjUy

uouueys ‘GSSWY
sainjeaj sauas saw YY

jojd aiedulog au}
WOd pe}de11X9 XapuU!

cQS/LGS pue CSSINY
sainjeay Savas SPW YY

sainjeay Savas SPW YY

uolelAap puepuejys
sNngol ‘UO!}JeIAapP
piepueys “(7UuqdWwes
pue ,uqdwes) Z

pue ‘| = W suolsuauwip
Bulppequia au}

yum Adosjua ajdwes
Sainjyeaj SOAS SOW YY

Adojjua uouURYSs pue
SUOIDUNJ 9DUdIBYOD
BulAsen Sully

sainjeay Salas SOW YY

ejep indu|

juaiedu|

juaiedu|

juaiedu|

yUuIOdyDayD
juaijedjno
pue -u|

JUaWaINseaw
snonuljuo>
—}ua1}ed1nO

juaiedu|

juaiedu|

SUOI}PUOD
uollsinboy

JOSUAS Odd
aqojied ajbuis

puequis bunswes
BDIABP UWOM-}SI\\

auoydyews
Jo elawued OAPI)

auoydyews

Jo elawued OAPI)
ajNpo-= Huvoywuopy
uohoy

pue olpie> sdijiud
—JOSUAS J|QeleoM-}SLI\\

puequis bunswes
BDIABP UWOM-}SI\\

auoydyews
Jo elawued OAPI)

BQIIAIVP JUDWOINSPO|/

UILU G°g 0} S*E

s}UaWUbaS
Ddd yiybue7

LL +89

‘LL¥SV
‘LL V9
‘TL FBE

99

ulug £+S/ 8+08

O'VL +7S9

uole;ndod
jo aby

dV Yum
LZ ‘spafqns Ayyeoy

EL ‘AV YUM EE

‘spafqns Ayyeey pr

(YYW) SWUYAUI 19410

UUM €S ‘JW UUM Sp

Ad YUM SL DWd
YIM SL IV YM g6

AV
-UON OF AV YUM OV

YSN LL Jeuny
jeuze | ‘AV YUM v

d1yeWIO}dWAS

-UOU LE JV YUM GL
(aseqejeq

eI AU

HIG-LIW + YSN HI
-LIW + 4V HIG-LIW)
saseqeyep dIqQNd

+ UOISIBAOIPIeD
Jaye pue sould 77

soinjyeo} Joseyeq

sjuaijed

pe(Z LOZ)

pe sal ZZ “Je ye AosuOD ‘|

<(ZL0Z) ‘1238
86  Jewuny!yseys

<6(QLOZ) ‘Ie 38

LZL snueWpPwW ‘d

z6(QL0Z) ‘Je 32
08 Ul9}S4J “f

o¢(9L0Z)
QL ‘je J@ lWOUOg

7<(9L0Z)
ov ‘Je Je HewWaN

(EL0Z)

vl ‘Je 8 997

[‘JO4] (4eaA)

jo JaquuinN Jouiny

 

‘sayneoidde sishjeue jedijsizeys Hulsn uolnda}eap 4y paeseq-AydesbowsAyjajdojoud uo saipnis “| ayqey

Scripps Research Translational Institute

npj Digital Medicine (2020) 3
Np}

T. Pereira et al.

 

0860 = ds
‘y86'0 = uas
‘186'0 = 29V
€166'°0 = ds

‘GV86'0 = UaS

vlZ6°0 =ds
‘G9Z6'0 = Uas
‘19960 = 22V

9LL6°0 = 297

€£6°0 = DNV
“UIWW-0 |

‘TL6'°0 = DNV “Ulw-Z
‘6v6'0 = DNV ‘ulw-|

U0!}39}98p
SWYIAUI JOJ
SNSd1 DDUCULOJdd

sJeAJa}U! YY JO JaquuNU |e}0} ay} Aq SLU OZ JO OP JO GE Papasdxa Jey} YY ASAISSaDINS Jo saduaJayIp Jo a6e}UaDIad O/NNG/OPNNG/SENNG ‘Uo!De4]UOD jelye SiNyeWwaid
Dd ‘SUO!DeIJUOD Je|NIJUSA aINJeWald D/A ‘AWDYyIDeds ds ‘AWAIWSUAS UAS ‘ADeINDIe Dy ‘BAIND 9} JaPUN eae DNV ‘selwY We JejNIIUAA AJ ‘selUUy Ye JAYIO YY ‘WY SNuUIs [eWIOU YSN ‘JeAJOWU! Y OF Y YY

DOU 3Eq JO}
saiunjeay Jo sanjea

pjoysasy} paauaq

japPOW AOWeW

Spjoysaiy}
:UO!Da}ap

dV ‘spjoysesyy
:UO!Da}ap
JUSWAAOW/ASION

SOUIUICW JOPDDA
yioddns :uo1D9}ap
AV ‘Spjoysesy}
:U01}Da}98p
JUSWSAOW/SSION

sisAjeue
uoissaibad 319s1607

ABojopou ew

Ado.\uUa
ajdwes Jo JUaIDYJa0d
pue ‘AdoJjua ajdwes

‘OZNNG ‘OvNNG ‘asswy

pezijeuou ‘GSSWY
‘AdoijUua UOUUeUS

sainjeay Savas SPW YY

sainjeay Savas SPW YY

(ays) AdowjuyZ UOUUeUS
pue QSSWY -YUO!>e}0p
4v ‘e6ueypd sisoyny
pue ‘sabueypd oes
juiod BHulusn} ‘sabueyd
adoys jeubis :uo0lDa}ap
JUSLUSAOW/ASION

(Adojjua ajdwes

pue Adosjua UuouUeYs
‘GSSWY) seunjeay satas
SAU!) YY :UO!D9a}ap

dV ‘uole;npowsp
xajdwo> Aduanbauy
ajqelweA :uolDa}ap
JUSWIAOW/SSION

oles JuIod

BHuluin} pue ‘AdoJjua
uouUeUS :spoy}eW
jediyAjeue JedUl|UON “4H
pue 47] JO oles dy} pue
(4H) e6ues ADuanbay
-ybiy ay ul Jamod ‘(47)
abues Aduanbaj-mo]
sulewuop Aduanbeal4
‘dSSWu pue ‘uoHelAsp
puepueys ‘Ueda
SUIEWOP SU] “soinjeay
SOW9S SOW! YY

GENNG :3e8q-0}

-Jeaq Ul DDUDIALJIP By

ejep indu|

JUaWaINsSesw
snonuljuo>
—}ua1}ed1nO

juaiedu|

yUuIOdyDayD
—}ua1}ed1nO

yUuIOdyDayD
—}ua1}ed1nO

juaiedu|

SUOI}PUOD
uollsinboy

olpse> sdijiud
DIIAVP UJOM-}SL\A

“P¥1 YUOPS|Nd
BIIABP UWOM-}SUM

auoydyews
Jo elawued OAPI)

auoydyews
Jo elawued OAPI)

JOWUOW apispag

BQIIAIVP JUDWOINSPO|/

SOCL
YY SAIINDasUOD
0c

UIW OL
‘Ul Z ‘UIW I

s}UaWUbaS
Ddd yiybue7

€lL+Z9
‘LOL +69
€8F8 ZL
‘LOLFGL9

JV-UOU 61 AV 8

dV YUM PL YSN SL

spelqns yyeoy

L | UOISIBAOIPIeD
Jaye pue soud

JV YUM sjuaned gg

pjo sueak Gp

UeY} JaP|O

4AV-UON
OLS ‘AV YUM OSL

SVL +99
‘STLFESPL

uole;ndod

jo aby sainjyeaj jasejeq

sjuaijed
ayONIS 999

sjuaijed
jo saquinn

,(8L0Z)
Je Ja aaUOW

LC 2P ‘WH
6y(8 LOZ)
6Z ‘Je Je nuadiwey

<o(8L0Z)
66 ‘|e 339 buoyD

p9(8L02)
00Z ‘Je Ja AeYseg

ay(ZL0Z)
‘ye yo Huey

[‘JO4] (4eaA)
Jouiny

panuluo> | aqeL

 

npj Digital Medicine (2020) 3

Scripps Research Translational Institute
T. Pereira et al.

Np)

 

UO!}De4]UOD jee ainyeWaid
yd ‘suolDe1UO0D JejNIWYWUAaA auNyewWad D/¢g ‘AyoyIDads ds ‘AYANISUaS Us ‘ADeINDIe DIV ‘AAIND ayy JapUN eale DY ‘sel Ye Je]NIWIUAA V/A ‘sey Aye JaYO YYYp ‘WYIAUW snuIs JeUOU YS ‘JeAJAIU! Y 02 Y YY

 

8760 = dS ‘7960 =

UBS ‘0S6'0 = 22V *(WASYSN)
SA 4V °Z88'0 =dS ‘1860

= uas '666'0 = 2°V “WA

SA JV “vZ6'0 = dS ‘266°0 =
UaS ‘L860 = 22V ‘USN SA AV

AV JO UO!DVJep Pe2]J9d

892'0 = dS ‘8SZ°0 = uas
‘Yu “€96'0 = dS

‘ySZ'0 = uas

‘dV “8760 = OS

‘EZL'0 = URS “YSN

S8€6'0 = 2°V

L560 = 9°
‘TV6'0 = URS
‘LZ6°0 = DNV

uolpDaj}ap sSWYy us
JO} SYNSAaI BDURWOLad

‘(xapul Ajund jesjdeds pue
‘snipes jesydeds jeuolipedy
‘AdoijuUa jes}Deds ‘Adol}Ud

uonenwad ‘aduUaJAaJJIP
aseyd ay} Jo adojs ay} jo
adUeLeA ‘XapU! UOHezZIUeHIO
aAndepe :sainjyeay
WOJOACM-Odd ‘GSSWd
“WWNWIXeUW “WUNLUUIUILU
‘ajenbiajul ‘uelpaw
‘uolelAap puepuejs ‘uedW

$9aJ} UOISIDEG isaunjeay sauas sawn YY

sJaMOd jesads

9Say} JO sjuaizonb pue
Aduanbay ybiy ‘ADuanba.y
Mo] ‘ADuanba. Moy} AWaA
‘sjuawbas asjnd aalyndasuod
JO UOI}e]a1109-SSOID

‘UIPIM WIOJaAem ‘jybIeay
We ‘WYUBiay as yead ‘awi}
JsaID ‘GVW pue gs ‘UeIlpaw
‘URDU :SaIN}esJ WIOJIACM
-Ddd ‘Adojjua UOUUeUS
‘GSSWY PeZi|ewsou -qSsWY
(GVW) UolelAsp aynjosge
ueawW ay} pue UOl}elAap
puepuejs ‘uelpaw ‘Ueda
Soinjeaj SOAS SOW YY

SaUIyeW
Jopeaa Yoddns

sainjeay

WJOJOACM-Hdqd ‘Siskjeue
Ayejnbaw pue Ayyiqeuen
‘sisAjeue jesjdads :saunjeaj

JayIsse]> NNX = vZ-Saunyeaj salias sawn YY

YY jo abues

ajiuenbiajul pue
‘uelpauu ‘WuNuWIUIWU ‘ued
saunjyeaj Saas SOW!) YY

auIy Dew
Jopeaa Yoddns

oles JUIOd

Bulusny ‘Adosjua UOUUeUS
‘AdoJ}Ua 9]eDS-1jNW

‘(4H/41) 4H Pue 47 Ul Jamod
Jo ones (4H) Aouanbay
ybiy (47) Aoduanbai Mo}
‘abues ADuanbadj-mo] Ayan
ul Jamod ‘QSsWyY ‘UOHelAap
puepuejs ‘uelpaw ‘Ueda
‘saunjyeay Saas SOW} YY

SaUIyeW
Jopeaa Yoddns

ABojopouyew eyep indu|

juarjedu|

juarjedu|

juarjedu|

juarjedu|

juarjedu|

SUOI}IPUOD
uolusinboy

BDIABP UJOM-}SUM SOL

auoyudyews
JO esOLUeD ODP!) S0Z

puegisuM py esnedwy UIW Z

adIAap paseq
“ISM Ddd SOL

JOWUOW apispag UIW Z

sjuow bas

Odd

ad1Aap JUaWAaINseal| y}6ue7

eL+ZS

SL¥99 ‘6

+ 9L'L1 FOV

uole;ndod
jo aby

(WA) set Aye
JejNIWIUSA YSN AV Ll

SSION JO ZL ‘YSN
JO V67 ‘AV YUM OZ 9CE

YSN LE ‘YYV
6 ‘AV YM OF OZ

0c

sjualjed
2401S BO

sjualjed

soinyeo} Joseyeq jfO JOQUINN

o9(6 L072)
‘|e Jo

JeI/P4 “S

¢¢(Z LOZ)
‘|e Jo

4PEYIS “L

gc(Z LOZ)
ye ja
OULIOD ‘A

7<(9L0Z)
|e a
Aewa)] ‘W

o<(9L0Z)
‘ye Ja UeUS

[‘JO4] (4eaA)
Jouiny

 

‘sayrdeoidde Jw Huisn uoldejap 4y paseq AydesbouwsKyjajdoyoud uo saipnis

“C 81qeL

Scripps Research Translational Institute

npj Digital Medicine (2020) 3
Np}
7

966'0 = INV
‘GLZ6'0 = 22V °866°0
= DNV ‘85260 = 29

G60 = 2°V
‘oL=ds ‘26°0 =4d DNV

‘L600 = DNV

676'0 = DNV

 

T. Pereira et al.

866'0 = dS ‘6660 = UasS
‘6660 = DNV

s96'0 = ds

‘9/6'0 = URS :4V “886'0
= ds ‘7ZZ'0 = uas
‘UY “786'0 = AS ‘L660
= UaS ‘YSN “L =dS
‘0Z6'0 = UaS :aSION
"L960 = 29¥ |]242A0
9/9':0 =ds ‘2290

= uas ‘7Z'0 = DNV

:L 18S 1S9l “7060

= ds ‘0860 = uas
‘L6°0 = DNV [1 39S SAL

£966'0 = DNV
‘6186°0 = 2°V

uoIpPa}ap SWIYAUI JO}
S]JNSaJ FDURULOJJad

yJOmjau jeinau
JUAINDDY *yJOMaU
jeunaU |eEUOIIN|OAUOD
|EUOISUBWIG-|

Huluses Jajsued}
YUM (NNYG) 4OMION
jeundan JUauNdayY
JPEUO!IIoIIPIg

JONSY CL

440MJaU
jeinau JUuauNdaL
-|PUO!INJOAUOD

S4DO|q BSUBP XIS YUM
sINJIVUYIIC NND

sake]

-8 JO yIOMJaU JeINAaN
(NNYD) [ePOW
puUqAH JUsINDDY
-UOIN|OAUOD

*U0!}99198P AV NND
suoHedyissey> Ayjeno

ABojopoure;

juaiedu;  uawbas Odd

js9} - paseq
-o6eul

Ddd ‘bururey
—peseq
-a9bewl 594

yulodyDay>
—jua1}ed1nO

JUDWsINSeowW
Snonul}UOd

—juaneding = juaewbeas Odd

jUaWaINseaw
snonuljuod daayjse
‘HSN JUSHedINO

+ uareduy juaewbas Odd

quaneding = juawbes Odd

yulodyDay>
juaied3jno :Z

Jas ‘jsd] JUaIZeEduUy|
iL Jas ysay

soiNnjeo} Solos
sow) YY

yuawbas Odd

SUOI}IPUOD

uolusinboy ejep indu|

diviabuy Odd

puequis Hunswes
BIIABP UOM-}SUM

puequis Hunswes
BIIABP UOM-}SUM

SdIAap Jaye} sSaUIY
3dAj0}01d UWIOM-}SUM\

QUOYUCWeWS

yojem ajddy
BdIABP UOM-}SUM

ad!Aep Jeab Hunswes

QIIAIP JUDWODINSPO|]

‘saydeoidde qq Buisn uoindajep 4y paseq AydesbowsAyjajdojoud uo saipnis

SOE

sjuow bas

Odd
yybue]

.

9AIND jjeDa1-UOISIDaId 94} JopUuNn eole Jdanv ‘uol}De1]UOD jeuyze ainjyewuasd

8L+E9

pjo sieak
68-81

sa] “sueaA
SCF Ly -ulesL

pjo sieak
G8-LE

CTL +V89
:dnosb \sa}

LOL + 1°99
tL Jas Ysa]
CL +p ules

uole;ndod
jo aby

dyV ES pue AV PP -HSEL

YSN 02

/AV OL :3S8L “YSN CE/AV

6| suoiepiyen + ules]

YSN Vv AV

YUM 7 “SAL “YSN

EL AV YUM 67 -UlesL
(Jaseyep

ylewysuag a}ey
Moyesdsay Odd JAWEL
-943| + sudeyunjoa
Ayyeey wo jasejep
JeEWO/ + aseqejep

add [eID |II-DIWIW)
soseqeyep dIQNd :ulesL

4y¥ OU 9178
‘SW YUM Lye culedL

soinjyeo} Joseyeq

26 74891
‘OS8C -uledL

LL asay
Ty SUleAL

ELOL -3S9L
“EZEE UleAL

LLOL ‘2
Jas \sa]

"LG tL Jas say
‘OS 26 :uledL

6L

sjuaijed
Jo JaqUINN

Dd ‘SUODeI}UOD JeEjNIWWUaA aINJeWad D/A ‘AyDYIDads ds ‘AWAIYISUAS UasS ‘ADeINDIe DV ‘BAND ay} JaPUN eae DNV ‘SelwY Ye Je]NIUIUAA VJ ‘SelWUUy AYU JaUIO YY ‘WYIAUA SNUIS JELUIOU YSN ‘JEAJAIU! Y OF Y YY

o¢(6L0Z)

‘je Jo UOMY °S

-<(8L0Z) ‘12 38
JRLWUNYIYSeYS °S

|e(61L0Z)

‘Je 12 UISIOA "W

je(BL0Z) ‘12 32
YAAO!|IOD *|

- (8102)
‘Je 18 YOd ‘W

z/(8L0Z)
‘Je JO UOSIL

¢(8 LOZ) UPYS
pue WWiwelly

[Jou] (4eaA)
Joyuiny

“€ 91qel

 

npj Digital Medicine (2020) 3

Scripps Research Translational Institute
T. Pereira et al.

 

measure of how well AF cases ranked higher than Non-AF cases.
Since AF has a low prevalence it is generally required that PPG-
based AF detectors show high precision (positive predictive value).
Rather than reporting the AUC, the area under the precision-recall
curve (AUPRC) is an alternative metric suitable for highly
imbalanced data (ie. low prevalence).*° In general, any reported
performance metric should take into account the low prevalence
of AF and be evaluated on an independent test dataset.

AF detection studies

Studies were split into three groups based on the approaches
undertaken to build an AF detector: traditional statistical analysis,
machine learning (ML), and deep learning (DL) methods. In
traditional statistical analysis, statistical metrics are derived from
PPG signals, and classification thresholds were estimated to
distinguish between AF and Non-AF segments. ML techniques call
for the extraction of pre-selected features, a process that can be
quite manual, labor-intensive, and can usually benefit from
incorporating complex physiological knowledge. An ML classifier
is then built upon extracted features from training data samples.
DL approaches require less manual feature engineering than
conventional ML since DL incorporates automatic features
representation process of input data. Recently, there was a
significant focus on DL methods driven notably by technological
advancement in computational power and the acclaimed success
in computer vision applications.*'*7

Statistical analysis approaches

Statistical models for AF detection are built using the thresholds
for a set of features extracted from the RR-interval time series of
well-annotated and publicly available ECG databases, such as MIT-
BIH atrial fibrillation, MIT-BIH normal sinus rhythm, or MIT-BIH
arrhythmia database.***° Specifically, features were first extracted
from the RR-interval time series of pre-annotated ECG waveforms.
The histograms of each feature were analyzed respectively with or
without the presence of AF and other cardiac rhythms in order to
define the threshold that best separates the rhythm classes. These
thresholds were then applied to the same RR time series-based
features extracted from PPG signals.*°*” Other arrhythmias (ie.,
premature ventricular contractions, and premature atrial contrac-
tion) could also be detected similarly in a sequence of binary
classifications.*°

Other statistical approaches can also be applied to classify
between AF and Non-AF such as logistic regression.*® Logistic
regression models use the logistic function, instead of a straight
line or a hyperplane, to fit output the probability between 0 and 1
(corresponding to Non-AF and AF). Markov model is another
Statistical tool that could be used for AF detection. RR-interval time
series features are used in this model to define the distributions
that best fit the data, and the probability for various rhythms can
be drawn from these distributions,““*?°° Elastic net is a
regularization method for regression and classification models.
Elastic net performs both variable selection and regularization in
order to enhance the prediction accuracy and interpretability of
the logistic regression model. Regularization approaches were
successfully applied to improve the performance of AF
detection.?'”

Table 1 summarizes a selection of PPG-based AF detection
studies which used statistical models. Different study aspects are
shown to depict the patient population and datasets used, the
features and methods, the context (inpatient vs outpatient), and
the performance results.

Machine learning approaches. ML has been used for AF detection
with interesting results. ML techniques require extensive domain
expertise to design features suitable for a comprehensive
representation of PPG waveforms and the detection of class-

npj Digital Medicine (2020) 3

differentiating patterns. Features commonly extracted from PPG
time series are morphological descriptors, time domain statistics,
frequency domain statistics, nonlinear measures, wavelet based
measures, and cross-correlation measures.°> °°

There were generally three main ML approaches used in the
reviewed studies: k-nearest neighbors (KNN), support vector
machine (SVM), and decision trees (DT). KNN classification is a
relatively simple clustering technique where a sample is classified
by a plurality vote of its neighbors and assigned to the class based
on the most common class among its k closest neighbors.°'

SVM finds a hyperplane that separates two classes with a high
margin that maximizes the distances between nearest data points
from each class. SVMs prove to be successful in nonlinear
classification problems by mapping non-separable features into
a higher dimensional space, a procedure known as the kernel trick
which uses kernel functions such as Radial Basis Function (RBF) or
polynomial.°*

In DT approaches, the training set is continuously split
according to a chosen feature. A feature tree can be explained
by two entities, namely decision nodes and leaves. The leaves are
the decisions or final outcomes. And the decision nodes are where
the data is split.°? The objective is to find in each decision node of
the tree, the best attribute allowing to diminish as much as
possible the overlapping of classes. The classification starts from
the root, and it evaluates the relative attribute and it takes the
branch corresponding to the outcome. This process is repeated
until a leaf is encountered and a sample is assigned the class
labeling the leaf.

Some studies used a combination of threshold-based and ML
approaches. For example, the thresholds of some features were
first used to exclude poor pulses, then an ML model was built for
the detection of AF in the clean pulses.°*® Table 2 is a
chronological summary of the selected ML studies and the
reported performance results. All the studies reported in the Table
2 were based in short length of PPG segment, with maxima of
2 min.

Deep learning approaches. DL has recently emerged as a
powerful method for the detection of abnormalities in physiolo-
gical signals, encouraging applications of arrhythmia detection
from ECG and PPG, including AF detection. Unlike ML, deep
learning models automatically learn feature representations,
sparing the tedious task of feature crafting. DL uses a neural
network, a set of interconnected layers of computational nodes.
The most common DL approaches used for AF detection are
based on Convolutional Neural Networks (CNN). CNN was applied
in automatic feature extraction and in classification problems.
Some studies used CNNs only for automatic feature extraction.”!
In one study, an aggregated model of two serially connected
CNNs was proposed, where the former detects clean segments
from which the latter identifies instances of AF.°' Some DL models
were trained with hybrid input data (i.e., time series and images) in
order to capture a wide range of features spanning more than one
domain.

Training a DL model from scratch requires a large amount of
labeled training data and generally poses a major constraint in
biomedical applications due to the limited amount of labeled
data. A possible solution to overcome this limitation is transfer
learning where the task is to fine-tune a sophisticated pre-trained
DL.°° The required number of layers and the complexity of fine-
tuning depend on specific applications.®” In ref. ** a pre-trained
ECG-based CNN model was used to detect AF from PPG segments
by fine-tuning the network using a small set of labeled PPG
segments.

Table 3 is a chronological summary of the selected DL studies
and the reported performance results. Notably, all studies were
based on relatively short segments (less than 10 min), mainly due
to the low yield of AF events in PPG data. Table 3 is a

Scripps Research Translational Institute
chronological summary of the selected DL studies and the
reported performance results. Notably, all studies were based on
relatively short segments (<10 min), mainly due to the low yield of
AF events in PPG data. Many of recent studies were developed
and tested using ambulatory data (outpatients). Such data setting
is the closest to real conditions where developed solutions would
be applied.°® Training and testing algorithms on real-world data is
crucial to assess their true performance and evaluate their
readiness for commercial use. For this reason, most of the studies
in Table 3 are based on outpatient data.

Recently, large-scale AF screening studies have been performed
by the leading tech companies, in order to test the performance of
the most recent PPG-based smart devices.

In Huawei Heart study a continuous PPG was monitored in a
cohort of 187,912 patients using a smart-device in ambulatory
conditions. Participants were monitoring for at least 14 days with a
wristband or wristwatch and a 60-s PPG signal was continuously
measured at every 10min.°? Only individuals identified with
“suspected AF” were assessed by using ECG. Results showed
87.0% of cases were AF with positive predictive value (PPV) of
91.6%.°? The algorithm for AF detection was not described;
however, morphology and frequency analysis of the pulse
waveform was used to identify the AF events according to a
previous publication.”°

Apple Heart Study enrolled 419,093 participants in a prospec-
tive study.’' PPG was monitored by Apple Watch, a subsequent
ambulatory ECG patch was used for cases initially identified as AF
using a proprietary PPG-based algorithm. Therefore, this study was
not included in this review.

Both studies claim they demonstrate the ability of a smart
devices to screen AF events. Due to the study design of both
studies, they cannot assess the sensitivity of PPG-based AF
detection, since only participants identified with AF events
(irregular pulse notification) received an ECG monitoring system.

MAIN CURRENT CHALLENGES

While the performance results summarized in Tables 1-3 suggest
that PPG can be an alternative to ECG for AF detection, it remains
that in real-world applications, PPG-based AF detection could be
limited by a number of factors.

Other cardiac arrhythmias

The presence of different cardiac rhythms within a recording
poses a challenge for AF detection. For some of the works
reviewed, control data only contain NSR.“°*”’”* Statistical methods
for AF detection are usually limited to distinguishing between AF
and NSR since other arrhythmias will likely present a distribution
with mixed characteristics from both distributions of AF and NSR
cases. ML and DL methods are generally more robust than
statistical methods in distinguishing AF from a variety of rhythms.
With DL expected to be on the rise for the next years, AF detection
can benefit from new and more reliable DL algorithms. Such
advancement will likely require very large training datasets of
comprehensive cardiac rhythmic morphologies. New algorithms
are expected to be better in discriminating AF and AF-mimic
rhythms leading to high and perhaps clinical-grade performance
levels.°° New algorithms are also expected to demonstrate
robustness to noise, inter- and intra-subject variabilities, and to
other variables currently posing issues to existing methods.

Corrupted signals

A significant limitation with PPG signals is motion artifacts.
Artifacts in PPG signals can generate fluctuations and distortions
that complicate the detection of cardiac components. Sources of
motion artifact usually include movement of the PPG sensors
either on the skin or loose contact with the skin, and deformation

Scripps Research Translational Institute

T. Pereira et al.

 

of the illuminated tissue volume by dynamic variations in sensor
contact-pressure. Specifically, for AF detection, these problems
present a major challenge. PPG signals with AF and motion
artifacts can both have similar characteristics of irregular pulse-to-
pulse intervals. This situation can lead sinus rhythm signals
corrupted by motion artifacts to be incorrectly detected as AF and
vice versa.°°’”* The most common approach to deal with this issue
is to simply discard the corrupted segments and use only the
clean parts of PPG signals.*7°°°%°°°*’* Some of the works
followed a two-step approach: first, to identify motion artifacts
by using accelerometer data, or by performing PPG signal quality
assessment; and second, to perform AF detections with only good
quality signals.°'’”° This often implies loss, and in some cases, a
huge part of the signals acquired. One study shows that almost
40% of collected PPG signals were reported unreliable.°° To
overcome this limitation, one can improve the wearables in order
to be more robust in detecting motion artifacts and to develop
powerful methods to recover poor signals. Recent progress in
flexible and stretchable sensors could help to enhance the SNR.
Novel flexible sensors for transmission and reflection-mode pulse
oximetry show a higher SNR due to a reduction in ambient
noise.”°

Algorithms such as the independent component analysis
(ICA),’” Kalman filtering, wavelet denoising,”® and empirical mode
decomposition’”®° were proposed for removing artifacts in PPG
signal; however, these techniques were mainly proposed for
scenarios with weak noise.

Ideally, AF detection models can continuously and accurately
detect AF episodes in PPG collected in an ambulatory setting,
without discarding PPG segments and being robustness to motion
artifacts.®' Other DL techniques can be interesting options to solve
artifact issues. For example, Generative Adversarial Networks
(GAN) is a technique that combines two different neural networks
together into a single pipeline—generative and discriminative
neural networks. GANs have been used to recover information
from images®? and biomedical signals,®? and can be an interesting
option to recover the PPG signal.

Data annotation

The methods used for AF classification presented in Tables 1-3 are
based on supervised methods where data were labeled, using a
ground truth (often based on simultaneously recorded ECG).
Manual annotation is usually very time consuming, expensive, and
laborious. Other annotation methods, such as the use of other
devices to identify ground truth, are usually not reliable since the
patient needs to use more devices, in a continuous and
synchronized way and there are no “perfect” devices with perfect
sensitivity and specificity in detecting AF. Active learning is a
Strategy that aims to ease the data labeling process by
automatically deciding which instances should be labeled. Instead
of annotating an entire dataset, active learning minimizes manual
labeling effort, creating annotated datasets in an efficient way,°*?

Another disadvantage of the manual annotation is inherent
inter-rater variability reflected in inter-rater disagreements coeffi-
cients (such as Kappa scores). Ideally, heuristic rules defining the
annotation process are precise enough to warrant an ideal inter-
rater agreement. However, in AF detection as in most physiolo-
gical patterns, data complexity and pattern variability among and
within patients render high inter-rater agreement difficult to
reach. Such disagreement leads to a labeling noise that translates
into a bias that the AF detection algorithm needs to deal with.
Mislabeled training samples can potentially affect the perfor-
mance of supervised classifiers.°° Generally, relatively small
proportions of noisy labels are tolerated in large training datasets
but high proportions of noisy labels can severely degrade the
performance of a classifier.°”°° At the data level, mislabeling can
be mitigated using voting from multiple annotators. At the

npj Digital Medicine (2020) 3
Np)

T. Pereira et al.

 

10

algorithm level, some DL models were shown to be resistant to
relatively small levels of label noise.®”

Other challenges

DL algorithms have started to be applied in PPG-based AF
detection and in general, showed superior performance. However,
the computational resources required for low-latency real-time
inference can be a huge engineering challenge to actually deploy
the DL algorithm on wearable devices. Wearables have limited
energy and constrains for battery size and heat dissipation. Due to
these limitations, some of PPG devices were combined with
computation-intensive applications on smartphones.®”

In addition, the interpretability of black-box DL algorithms can
be a challenge for doctors to perform diagnosis based on results
from those algorithms. Many machine learning algorithms used in
the clinical field are essentially black boxes, which make
predictions without giving any clinical explanation. The clinical
community points out that the accuracy achieved by the ML
algorithm is not enough for accepting ML-enabled technology.”°
Explainable ML algorithms are emerging with interpretable
models, which can give information about which aspect of input
data contributes more to the final prediction. The most recent
approaches for AF detection showed that the model seems to
focus on systolic and diastolic peaks and slopes.®'

A general limitation in the medical field and also in the studies
of AF detection is the fact that models take into consideration a
small group of patients from one medical center. The models
should be developed using data from multiple medical centers in
order to ensure that all the population heterogeneities were
represented in the sample used for the study.

CONCLUSIONS

A review of statistical and machine learning approaches applied to
AF detection using PPG is presented. Although PPG has proven to
be a good alternative to ECG for ambulatory real-time and
continuous detection of AF, there are challenges remaining to be
solved that are currently limiting the expansion of PPG-based AF
detection beyond consumer wearables and its application in other
clinical applications. Recent advances in computational power and
the advent of powerful deep earning algorithms capable of
solving complex pattern recognition problems have led to new AF
detection methods proving a significant improvement in accuracy,
robustness, and reliability compared to earlier approaches.
Whether deep learning will ultimately lead to clinical-grade
performance levels of PPG-based AF detection remains a question.
Wearable devices powered by sophisticated algorithms offering
precise and continuous AF detection will provide an excellent
opportunity to screen AF at scale as demonstrated in the recent
Apple and Huawei studies.

Received: 26 July 2019; Accepted: 22 November 2019;
Published online: 10 January 2020

REFERENCES

1. Kirchhof, P. et al. 2016 ESC guidelines for the management of atrial fibrillation
developed in collaboration with EACTS. Eur. Heart J. 37, 2893-2962 (2016).

2. Lane, D. A. & Lip, G. Y. H. Stroke prevention in atrial fibrillation: can we do better?.
Nat. Rev. Cardiol. 13, 511-512 (2016).

3. Zoni-Berisso, M., Lercari, F., Carazza, T. & Domenicucci, S. Epidemiology of atrial
fbrillation: European perspective. Clin. Epidemiol. 6, 213-220 (2014).

4. Hollis, |. B., Reed, B. N., Rodgers, J. E., Cook, A. M. & Danelich, |. M. Clinical update
on the management of atrial fibrillation. Pharmacother. J. Hum. Pharmacol. Drug
Ther. 33, 422-446 (2013).

5. Singh, D. et al. Worldwide epidemiology of atrial fibrillation. Circulation 129,
837-847 (2013).

npj Digital Medicine (2020) 3

10.

11

12.

13.

14.

15.

16.

17.

18.

19.

20.

21.

22.

23.

24.

25.

26.

27.

28.

29.

30.

31.

32.

33.

34.

. Rho, R. W. & Page, R. L. Asymptomatic atrial fibrillation. Prog. Cardiovasc. Dis. 48,

79-87 (2005).

. Hart, R. G. et al. Independent predictors of stroke in patients with atrial fibrillation:

The Stroke Risk in Atrial Fibrillation Working Group. Neurology 69, 546-554
(2007). https://doi.org/10.1212/01.wnl.0000267275.68538.8d.

. Flint, A. C., Banki, N. M., Ren, X., Rao, V. A. & Go, A. S. Detection of paroxysmal atrial

fibrillation by 30-day event monitoring in cryptogenic ischemic stroke. Stroke 43,
2788-2790 (2012).

. Kernan, W.N. et al. Guidelines for the prevention of stroke in patients with stroke

and transient ischemic attack. Stroke 45, 2160-2236 (2014).
Boriani, G. & Padeletti, L. Management of atrial fibrillation in bradyarrhythmias.
Nat. Rev. Cardiol. 12, 337-349 (2015).

. Trayanova, N. From genetics to smart watches: developments in precision car-

diology. Nat. Rev. Cardiol. 16, 72-73 (2019).

Kavsaojlu, A. R., Polat, K. & Hariharan, M. Non-invasive prediction of hemoglobin
level using machine learning techniques with the PPG signal’s characteristics
features. Appl. Soft Comput. J. 37, 983-991 (2015).

Pereira, T. et al. Pulse pressure waveform estimation using distension profiling
with contactless optical probe. Med. Eng. Phys. 36, 1515-1520 (2014).
Gadhoumi, K., Keenan, K., Colorado, R., Meisel, K. & Hu, X. A Statistical Comparative
Study of Photoplethysmographic Signals in Wrist-Worn and Fingertip Pulse-
Oximetry Devices. Comput. Cardiol Computing in Cardiology Conference (CinC). pp.
1-4 (Maastricht, Netherlands, 2018). https://doi.org/10.22489/CinC.2018.316.
Njoum, H. & Kyriacou, P. A. Investigation of finger reflectance photo-
plethysmography in volunteers undergoing a local sympathetic stimulation. J.
Phys. Conf. Ser. 450, 012012 (2013).

Nara, S., Kaur, M. & Lal Verma, K. Novel notch detection algorithm for detection of
Dicrotic notch in PPG signals. Int. J. Comput. App!l. 86, 36-39 (2014).

Elgendi, M. et al. The use of photoplethysmography for assessing hypertension.
npj Digit. Med. 2, 60 (2019). https://doi.org/10.1038/s41746-019-0136-7.

Nitzan, M., Romem, A. & Koppel, R. Pulse oximetry: fundamentals and technology
update. Med. Dev. Evid. Res. 7, 231-239 (2014).

Moraes, J. L. et al. Advances in photopletysmography signal analysis for biome-
dical applications. Sensors (Switzerland) 18, 1-26 (2018).

Bilgaiyan, A., Sugawara, R., Elsamnah, F., Shim, C., Affig, M. & Hattori, R. Optimizing
performance of reflectance-based organic photoplethysmogram (PPG) sensor.
Proc. SPIE 10738, Organic and Hybrid Sensors and Bioelectronics Xl. 1073808, 7
(2018). https://doi.org/10.1117/12.2321060.

Ernst, G. Heart-rate variability—more than heart beats? Front. Public Heal. 5, 240
(2017). https://doi.org/10.3389/fpubh.201 7.00240.

Pereira, T., Almeida, P. R. Cunha, J. P. S. & Aguiar, A. Heart rate variability metrics
for fine-grained stress level assessment. Comput. Methods Programs Biomed. 148,
71-80 (2017).

Pirhonen, M., Peltokangas, M. & Vehkaoja, A. Acquiring respiration rate from
photoplethysmographic signal by recursive Bayesian tracking of intrinsic modes
in time-frequency spectra. Sensors 18, 1693 (2018).

Pereira, T., Correia, C. & Cardoso, J. Novel methods for pulse wave velocity
measurement. J. Med. Biol. Eng. 35, 555-565 (2015).

Pereira, T. et al. Characterization of optical system for hemodynamic multi-
parameter assessment. Cardiovasc. Eng. Technol. 4, 87-97 (2013).

Tamura, T., Maeda, Y., Sekine, M. & Yoshida, M. Wearable photoplethysmographic
sensors—past and present. Electronics 3, 282-302 (2014).

Ghamari, M. A review on wearable photoplethysmography sensors and their
potential future applications in health care. Int. J. Biosens. Bioelectron. 4, 195-202
(2018).

Allen, J. Photoplethysmography and its application in clinical physiological
measurement. Physiol. Meas. 28, R1-R39 (2007).

Slocum, J., Sahakian, A. & Swiryn, S. Diagnosis of atrial fibrillation from surface
electrocardiograms based on computer-detected atrial activity. J. Electrocardiol.
25, 1-8 (1992).

Hannun, A. Y. et al. Cardiologist-level arrhythmia detection and classification in
ambulatory electrocardiograms using a deep neural network. Nat. Med. 25, 65-69
(2019). https://doi.org/10.1038/s41591-018-0268-3.

Chon, K. H. & Mcmanus, D. D. Detection of atrial fibrillation using a smartwatch.
Nat. Rev. Cardiol. 15, 657-658 (2018).

Shashikumar, S. P., Shah, A. J., Clifford, G. D. & Nemati, S. Detection of paroxysmal
atrial fibrillation using attention-based bidirectional recurrent neural networks. In
KDD ‘18 Proc. of the 24th ACM SIGKDD International Conference on Knowledge
Discovery & Data Mining. pp. 715-723, Preprint at http://arXiv.org/1805.09133 [q-
bio.NC] (London, UK, 2018).

Liang, Y., Chen, Z., Ward, R. & Elgendi, M. Photoplethysmography and deep
learning: enhancing hypertension risk stratification. Biosensors 8, 1-13 (2018).
Cicone, A. & Wu, H. T. How nonlinear-type time-frequency analysis can help in
sensing instantaneous heart rate and instantaneous respiratory rate from pho-
toplethysmography in a reliable way. Front. Physiol. 8, 1-17 (2017).

Scripps Research Translational Institute
35.

36.

37.

38.

39.

40.

41.

42.

43.

AA,

45.

46.

47.

48.

49.

50.

51.

52.

53.

54.

55.

56.

57.

58.

59.

Christov, |. et al. Ranking of the most reliable beat morphology and heart rate
variability features for the detection of atrial fibrillation in short single-lead ECG.
Physiol. Meas. 39, 094005 (2018).

Chong, J. W., Esa, N., McManus, D. D. & Chon, K. H. Arrhythmia discrimination
using a smart phone. /EEE J. Biomed. Heal. Inform. 19, 815-824 (2015).

Reiss, A., Schmidt, P., Indlekofer, |. & Van Laerhoven, K. PPG-based heart rate
estimation with time-frequency spectra. In UbiComp ‘18 Proc. of the 2018 ACM
International Joint Conference and 2018 International Symposium on Pervasive and
UbiquitousComputing and Wearable Computers. pp. 1283-1292 (Singapore, Sin-
gapore, 2018).

Remya, R., Selvakumar, J. & Anburajan, M. Evaluation of hypotension using
wavelet and time frequency analysis of photoplethysmography (PPG) signal. Int.
J. Comput. Sci. Inform. Security (CIC 2016 Special Issue) 14, 57-61 (2016).
Baratloo, A., Hosseini, M., Negida, A. & Ashal, G. El Part 1: Simple definition and
calculation of accuracy, sensitivity and specificity. Emergency 3, 48-49 (2015).
Saito, T. & Rehmsmeier, M. The precision-recall plot is more informative than the
ROC plot when evaluating binary classifiers on imbalanced datasets. PLoS ONE
10, e0118432 (2015). https://doi.org/10.1371/journal.pone.0118432.

Szegedy, C., Vanhoucke, V., Shlens, J. & Wojna, Z. Rethinking the inception
architecture for computer vision. In 2016 IEEE Conference on Computer Vision and
Pattern Recognition (CVPR), pp. 2818-2826, https://doi.org/10.1109/
CVPR.2016.308, Preprint at http://arXiv.org/1512.00567v3 (Las Vegas, NV, 2016).
He, K., Zhang, X., Ren, S. & Sun, J. Deep residual learning for image recognition.
In 2016 IEEE Conference on Computer Vision and Pattern Recognition (CVPR).
pp. 770-778 https://doi.org/10.1109/CVPR.2016.90, Preprint at http://arXiv.org/
1512.03385v1 (Las Vegas, NV, 2016).

Goldberger AL, S. H. et al. PhysioBank, PhysioToolkit, and PhysioNet components
of a new research resource for complex physiologic signals. Circulation 101,
e215-e220 (2000).

Moody G. & Mark, R. A new method for detecting atrial fibrillation using R-R
intervals. Comput. Cardiol. 10, 227-230 (1983).

Moody, G. B. & Mark, R. G. The impact of the MIT-BIH arrhythmia database. /EEE
Eng. Med. Biol. Mag. 20, 45-50 (2001).

Lee, J., Reyes, B. A., McManus, D. D., Mathias, O. & Chon, K. H. Atrial fibrillation
detection using an iPhone 4S. /EEE Trans. Biomed. Eng. 60, 203-206 (2013).
McManus, D. D. et al. A novel application for the detection of an irregular pulse
using an iPhone 4S in patients with atrial fibrillation. Hear. Rhythm 10, 315-319
(2013).

Tang, S. C. et al. Identification of atrial fibrillation by quantitative analyses of
fingertip photoplethysmogram. Sci. Rep. 7, 1-7 (2017).

Tarniceriu, A. et al. The accuracy of atrial fibrillation detection from wrist pho-
toplethysmography. a study on post-operative patients. Proc. Annu. Int. Conf. IEEE
Eng. Med. Biol. Soc. EMBS 2018, 1-4 (2018).

Bonomi, A. et al. Atrial fibrillation detection using photo-plethysmography and
acceleration data at the wrist. Comput. Cardiol. Conference (CinC), 277-280
(Vancouver, BC, 2016).

Shashikumar, S. P., Shah, A. J., Li, Q., Clifford, G. D. & Nemati, S. A deep learning
approach to monitoring and detecting atrial fibrillation using wearable tech-
nology, In 20177 IEEE EMBS Int. Conf. Biomed. Heal. Informatics, BHI 2017,
pp. 141-144, https://doi.org/10.1109/BHI.2017.7897225, (Orlando, FL, 2017).
Nemati, S. et al. Monitoring and detecting atrial fibrillation using wearable
technology. In 2016 38th Annual International Conference of the IEEE Engineering
in Medicine and Biology Society (EMBC), pp. 3394-3397, https://doi.org/10.1109/
EMBC.2016.7591456, (Orlando, FL, 2016).

Pereira, T., Paiva, J. S., Correia, C. & Cardoso, J. An automatic method for arterial
pulse waveform recognition using KNN and SVM classifiers. Med. Biol. Eng.
Comput. 54, 1049-1059 (2016).

Paiva, J. S., Cardoso, J. & Pereira, T. Supervised learning methods for pathological
arterial pulse wave differentiation: a SVM and neural networks approach. /nt. J.
Med. Inform. 109, 30-38 (2018).

Pereira, T. et al. A supervised approach to robust photoplethysmography quality
assessment. In /EEE J. Biomed. Health Inform. 1-9 (2019). https://doi.org/10.1109/
JBHI.2019.2909065.

Shan, S. M. et al. Reliable PPG-based algorithm in atrial fibrillation detection. In
Proc. In 2016 IEEE Biomedical Circuits and Systems Conference, (BioCAS), 340-343,
https://doi.org/10.1109/BioCAS.2016.7833801, (Shanghai, 2016).

Lemay, M. et al. Wrist: located optical device for atrial fibrillation screening: a
clinical study on twenty patients. Comput. Cardiol. 43, 3-6 (2016).

Corino, V. D. A. et al. Detection of atrial fibrillation episodes using a wristband
device. Physiol. Meas. 38, 787-799 (2017).

Schack, T., Harb, Y. S., Muma, M. & Zoubir, A. M. Computationally efficient algo-
rithm for photoplethysmography-based atrial fibrillation detection using smart-
phones. In 2077 38th Annual International Conference of the IEEE Engineering in
Medicine and Biology Society (EMBC), pp. 104-108, https://doi.org/10.1109/
EMBC.2017.8036773, (Seogwipo, 2017).

Scripps Research Translational Institute

T. Pereira et al.

Np}

 

60.

61.

62.

63.

64.

65.

66.

67.

68.

69.

70.

71.

72.

73.

74.

75.

76.

77.

78.

79.

80.

81.

82.

83.

84.

Fallet, S. et al. Can one detect atrial fibrillation using a wrist-type photo-
plethysmographic device? Med. Biol. Eng. Comput. 57, 477 (2019). https://doi.org/
10.1007/s11517-018-1886-0.

Md lsa, N. E., Amir, A., Ilyas, M. Z. & Razalli, M. S. The performance analysis of K-
nearest neighbors (K-NN) algorithm for motor imagery classification based on
EEG signal. The International Conference on Emerging Electronic Solutions for
lol. MATEC Web Conf. Vol. 140, 01024 (Batu Feringghi, Malaysia, 2017).

Nalepa, J. & Kawulok, M. Selecting training sets for support vector machines: a
review. Artif. Intell. Rev. 52, 857-900 (2019). https://doi.org/10.1007/s10462-017-
9611-1.

Yan-yan, S. O. N. G. & Ying, L. U. Decision tree methods: applications for classi-
fication and prediction. Shanghai Arch. Psychiatry 27, 130-135 (2015).

Bashar, S. K. et al. Developing a novel noise artifact detection algorithm for
smartphone PPG signals: preliminary results. In 2078 IEEE EMBS International
Conference on Biomedical & Health Informatics (BHI) pp. 79-82, https://doi.org/
10.1109/BHI.2018.8333374, (2018).

Chong, J. W. et al. Motion and noise artifact-resilient atrial fibrillation detection
using a smartphone. In /EEE J. Emerg. Sel. Top. Circuits Syst. 8, pp. 2156-3357,
https://doi.org/10.1109/JETCAS.2018.2818185, (2018).

Xiao, R. et al. Monitoring significant ST changes through deep learning. J. Elec-
trocardiol. 51, S78-S82 (2018).

Tajbakhsh, N. et al. Convolutional neural networks for medical image analysis: full
training or fine tuning? /EEE Trans. Med. Imaging 35, 1299-1312 (2016).

Trull, T. J. & Ebner-Priemer, U. Ambulatory assessment. Annu Rev. Clin. Psychol. 9,
151-176 (2013).

Guo, Y. et al. Mobile health technology for atrial fibrillation screening using
photoplethysmography-based smart devices: The HUAWEI Heart study, J. Am.
Coll. Cardiol. 74, 2365-2375 (2019).

Fan, Y. Y. et al. Diagnostic performance of a smart device with photo-
plethysmography technology for atrial fibrillation detection: Pilot study (Pre-
mAFA II registry) JMIR Mhealth Uhealth. J. Med. Internet Res. 7, e11437 (2019).
https://doi.org/10.2196/1 1437.

Turakhia, M. P. et al. Rationale and design of a large-scale, app-based study to
identify cardiac arrhythmias using a smartwatch: The Apple Heart Study. Am.
Heart J. 207, 66-75 (2019).

Tison, G. H. et al. Passive detection of atrial fibrillation using a commercially
available smartwatch. JAMA Cardiol. 3, 409-416 (2018). https://doi.org/10.1001/
jamacardio.2018.0136.

Poh, M. Z. et al. Diagnostic assessment of a deep learning system for detecting
atrial fibrillation in pulse waveforms. Heart 104, 1921-1928 (2018).

de Morree, H. M. et al. Comparison between electrocardiogram- and
photoplethysmogram-derived features for atrial fibrillation detection in free-
living conditions. Physiol. Meas. 39, 084001 (2018).

Aliamiri, A. & Shen, Y. Deep learning based atrial fibrillation detection using
wearable photoplethysmography sensor. In 2078 IEEE EMBS Int. Conf. Biomed.
Heal. Inform., BHI, pp. 442-445, https://doi.org/10.1109/BHI.2018.8333463, (Las
Vegas, NV, 2018).

Lochner, C. M. et al. A flexible organic reflectance oximeter array. Proc. Natl Acad.
Sci. USA 115, E11015-E11024 (2018).

Kim, B. S. & Yoo, S. K. Motion artifact reduction in photoplethysmography using
independent component analysis. /EEE Trans. Biomed. Eng. 53, 566-568 (2006).

Raghuram, M. et al. Dual-tree complex wavelet transform for motion artifact
reduction of PPG signals. In 2072 IEEE International Symposium on Medical Mea-
surements and Applications Proc., pp. 1-4, https://doi.org/10.1109/MeMeA.2012.
6226643, (Budapest, 2012).

Sadrawi, M. et al. Ensemble empirical mode decomposition applied for PPG
motion artifact. In IECBES 2016—I/EEE-EMBS Conf. Biomed. Eng. Sci (IECBES). pp.
266-269, https://doi.org/10.1109/IECBES.2016.7843455, (Kuala Lumpur, 2016).

Li, S., Liu, L., Wu, J., Tang, B. & Li, D. Comparison and noise suppression of the
transmitted and reflected photoplethysmography signals. Biomed. Res. Int. 2018,
4523593 (2018).

Voisin, M. et al. Ambulatory atrial fibrillation monitoring using wearable pho-
toplethysmography with deep learning. In KDD ‘19 Proceedings of the 25th ACM
SIGKDD International Conference on Knowledge Discovery & Data Mining.
pp. 1909-1916, Preprint at http://arXiv.org/1811.07774 (Anchorage, AK, USA,
2019).

Tripathi, S., San, U. C. Zachary, D., Lipton, C. & Nguyen, T. Q. Correction by
projection: denoising images with generative adversarial networks. Preprint at
http://arXiv.org/1803.04477v1 (2018).

Gandhi, S., Oates, T., Mohsenin, T. & Hairston, D. In Phung, D. & Tseng, V. S. (eds)
Advances in Knowledge Discovery and Data Mining Vol. 0939, 285-296 (Springer
International Publishing, 2018).

Bressan, R. S., Camargo, G., Bugatti, P. H. & Saito, P. T. M. Exploring active learning
based on representativeness and uncertainty for biomedical data classification.
IEEE J. Biomed. Health Inform. XX, 1-7 (2018).

npj Digital Medicine (2020) 3

11
Np)

T. Pereira et al.

 

12

85.

86.

87.

88.

89.

90.

91.

92.

93.

94.

95.

96.

97.

Yang, L., Zhang, Y., Chen, J., Zhang, S. & Chen, D. Z. Suggestive annotation: a deep
active learning framework for biomedical image segmentation. Lecture Notes on
Computer Science (including Subseries Lecture Notes on Artificial Intelligence, Lecture
Notes on Bioinformatics) 10435 (no. 1), 399-407 (MICCAI, 2017).

Goldgof, D. B. et al. Active cleaning of label noise. Pattern Recognit. 51, 463-480
(2015).

Rolnick, D., Veit, A., Belongie, S. & Shavit, N. Deep learning is robust to massive
label noise. Preprint at http://arXiv.org/1705.10694 [cs.LG] (2017).

Hendrycks, D., Mazeika, M., Wilson, D. & Gimpel, K. Using trusted data to train
deep networks on labels corrupted by severe noise. In NIPS'18 Proceedings of the
32nd International Conference on Neural Information Processing Systems. pp.
10477-10486, Preprint at http://arXiv.org/1802.05300v4, no. Nips (Montréal,
Canada, 2018).

Xu, M., Qian, F. & Pushp, S. Enabling cooperative inference of deep learning on
wearables and smartphones. Preprint at http://arXiv.org/1712.03073, 1-21 (2017).
The Lancet Respiratory Medicine. Opening the black box of machine learning
Lancet Respir. Med. 6, P801 (2018).

Lee, J., Nam, Y., McManus, D. D. & Chon, K. H. Time-varying coherence function for
atrial fibrillation detection. IEEE Trans. Biomed. Eng. 60, 2783-2793 (2013).
Eckstein, J. et al. Smart detection of atrial fibrillation. Europace. 19, 753-757
(2016).

McManus, D. D. et al. PULSE-SMART: Pulse-Based Arrhythmia Discrimination
Using a Novel Smartphone Application. Journal of Cardiovascular Electro-
physiology. 27, 51-57 (2016).

Conroy, T., Guzman J. H., Hall, B., Tsouri, G. & Couderc, J. P. Detection of atrial
fibrillation using an earlobe photoplethysmographic sensor. Physiol. Meas. 38,
1906-1918 (2017).

Schack, T., Harb, Y. S., Muma, M. & Zoubir, A. M. Computationally Efficient
Algorithm for Photoplethysmography-Based Atrial Fibrillation Detection Using
Smartphones. In 38th Annual International Conference of the IEEE Engineering in
Medicine and Biology Society. 104-108 (2017).

Gotlibovych, |. et al. End-to-end deep learning from raw sensor data: Atrial
fibrillation detection using wearables. Preprint at https://arxiv.org/abs/
1807.10707 (2018).

Kwon, S. et al. Deep Learning Approaches to Detect Atrial Fibrillation Using
Photoplethysmographic Signals: Algorithms Development Study. JM/R mHealth
and uHealth. 7, €12770 (2019).

ACKNOWLEDGEMENTS
This work is partially funded by NIH award RO1NHLBI128679.

npj Digital Medicine (2020) 3

AUTHOR CONTRIBUTIONS

T.P. designed the manuscript, collected the studies. and wrote the first draft. N.T., K.G.
and X.H. contributed to the structure of the manuscript, the discussion of the studies,
and thoroughly revised the paper. M.M.P., D.H.D., R.J.L., R.C. and K.M. contributed with
clinical insights. All authors reviewed the manuscript.

COMPETING INTERESTS

The authors declare the following competing interests: RJ.L.: non-financial
competing interest as an equity holder in Life Signal, Inc. and SentreHEART/Atricure,
Inc. and co-founder of Indevor Corp. K.M.: non-financial competing interest as local
investigator for Medtronic funded STROKE-AF study. X.H.: non-financial competing
interest as a co-founder of Indevor Corp. Other authors declare no competing
interests.

ADDITIONAL INFORMATION

Correspondence and requests for materials should be addressed to T.P.

Reprints and permission information is available at http://www.nature.com/
reprints

Publisher’s note Springer Nature remains neutral with regard to jurisdictional claims
in published maps and institutional affiliations.

Open Access This article is licensed under a Creative Commons

ri Attribution 4.0 International License, which permits use, sharing,
adaptation, distribution and reproduction in any medium or format, as long as you give
appropriate credit to the original author(s) and the source, provide a link to the Creative
Commons license, and indicate if changes were made. The images or other third party
material in this article are included in the article’s Creative Commons license, unless
indicated otherwise in a credit line to the material. If material is not included in the
article’s Creative Commons license and your intended use is not permitted by statutory
regulation or exceeds the permitted use, you will need to obtain permission directly
from the copyright holder. To view a copy of this license, visit http://creativecommons.
org/licenses/by/4.0/.

© The Author(s) 2020

Scripps Research Translational Institute
