Measurement Science and Technology

PAPER * OPEN ACCESS
Aerodynamic probe calibration using Gaussian process regression

To cite this article: Florian M Heckmeier and Christian Breitsamter 2020 Meas. Sci. Technol. 31 125301

View the article online for updates and enhancements.

This content was downloaded from IP address 79.13.42.43 on 22/11/2020 at 22:51
OPEN ACCESS
IOP Publishing

Meas. Sci. Technol. 31 (2020) 125301 (16pp)

Measurement Science and Technology

https://doi.org/10.1088/1361-6501/aba37d

Aerodynamic probe calibration using
Gaussian process regression

Florian M Heckmeier® and Christian Breitsamter

Chair of Aerodynamics and Fluid Mechanics, Department of Mechanical Engineering, Technical

University of Munich, 85748 Garching bei Miinchen, Germany

E-mail: florian.heckmeier @ aer.mw.tum.de
Received 14 April 2020, revised 25 June 2020

Accepted for publication 7 July 2020
Published 30 September 2020

Abstract

®

CrossMark

During the calibration of an aerodynamic probe, the correlation between the present
representative flow quantities of the fluid and the measurand is determined. Thus, a large
number, sometimes several thousands, of different calibration points are set and measured,
making this a very time-consuming process. The differences in the calibration data of similar
constructed probes are very small. With the help of statistical methods, more precisely Gaussian
process regressions, this similarity is exploited in order to use existing calibration data of
different probes reducing the calibration time with sufficient reconstruction accuracy. Data from
single-wire hot-wire probes and from five-hole probes are tested and show a very high
reconstruction accuracy compared to the full calibration data set. The number of calibration
points in the five-hole probe case is reduced by at least one order of magnitude with comparable

reconstruction accuracy.

Keywords: aerodynamic intrusive measurement, probe calibration, gaussian process regression,
machine learning, multi-hole pressure probe, constant temperature anemometry (CTA)

(Some figures may appear in colour only in the online journal)

1. Introduction

Experimentally obtained data of flow phenomena are still of
great interest for academic and industrial research, despite
the ongoing development and optimization of CFD (com-
putational fluid dynamics) simulations. Furthermore, experi-
mental results often serve as data basis for the validation of
CFD solvers. The most commonly used intrusive measure-
ment methods are hot-wire probes and multi-hole pressure
probes. Even though hot-wire constant temperature anemo-
metry (CTA) is known for its high temporal resolution, hot-
wire probes are characterized by very low mechanical robust-
ness when used in harsh environments. In contrast, multi-hole

Original Content from this work may be used under the
7 terms of the Creative Commons Attribution 4.0 licence. Any

further distribution of this work must maintain attribution to the author(s) and
the title of the work, journal citation and DOI.

1361-6501/20/125301+16$33.00

1

pressure probes are inexpensive to manufacture and easy to
operate. However, attention should be paid to the fact that
meaningful and accurate measurement results can only be
obtained if the probe has been calibrated under representative
conditions before use. During the calibration, different com-
binations of flow parameters (inflow velocity and flow angles)
are set in a calibration free-jet wind tunnel [1, 2]. The corres-
ponding measurement data are recorded with the aerodynamic
measurement probe. Depending on the probe and the expec-
ted reconstruction accuracy, this calibration process some-
times comprises several hundreds or thousands of calibration
points [3]. Thus, the calibration is a very time-consuming step.
Hot-wire probes for example require a recalibration before
each measurement campaign or after damage to the wire and
rewelding.

When analyzing the calibration data, it is noteworthy that
the (multivariate) functions are often very alike in shape. Since
aerodynamic probe calibrations can be described as regression
problems, besides a standard polynomial regression approach,
Bayesian statistics methods can be used. Gelman et al describe

© 2020 The Author(s). Published by lOP Publishing Ltd Printed in the UK
Meas. Sci. Technol. 31 (2020) 125301

the basics of Bayesian statistics [4]. Furthermore, Rasmussen
applies Gaussian processes GP to machine learning problems,
both for regression and classification problems [5]. In various
research fields in the literature, Gaussian processes have been
applied: in geostatistics, Gaussian process regression 1s better
known as kriging [6]. During the application of Gs, the place-
ment of test point locations is crucial. Krause et al describe
an optimization routine for the placement of the locations in
Gaussian process problems [7]. Furthermore, in engineering
applications, Gaussian process regression has been used for
the wind energy turbine power curve model prediction [8].
Its application on the calibration of spectroscopic sensors has
also been shown [9]. In aerodynamic metrology, Garcia-Ruiz
et al show the application of Gaussian processes for the hot-
wire temperature compensation [10]. Moreover, Agrawal et al
introduce a non-linear regression approach to minimize recal-
ibration for non-thermal drifts [11].

Since aerodynamic probe calibrations a) require a regres-
sion within all measured data points, and b) show similarity
among themselves, the idea of applying Bayesian statistics,
viz. Gaussian process regression, on aerodynamic probe cal-
ibration arises. Hence, governing hypotheses can be identified
and are investigated within this paper:

Hypothesis 1 The knowledge of former calibration data
of various different shaped probes can be transferred to
future probe calibrations incorporating the similarity among
themselves.

Hypothesis 2 Bayesian statistics and machine learning
algorithms, more precisely Gaussian process regression, are
applicable on aerodynamic probe calibration data.

Hypothesis 3 The number of calibration points needed can
be significantly reduced while still showing acceptable recon-
struction accuracy, and thus, leading to a reduction of time
consumption.

Especially under the assumption that the first two hypo-
theses hold, a confirmation of the third hypothesis could result
in a significant time saving in set-up costs of a measurement
campaign with aerodynamic probes.

In this paper, the usage of Gaussian process regression for
the reduction of calibration points is described. Hence, the
theoretical background of Gaussian processes is outlined first
in section 2. Moreover, the calibration process for hot-wire
anemometry and multi-hole pressure probes is described in
section 3. In the last part of the paper (see section 4), invest-
igations on the applicability of the Gaussian process regres-
sion on real calibration data is demonstrated. The procedure is
introduced with a generic example. Furthermore, apart from
single-wire hot-wire data, the focus lies on the application of
Gaussian process regression on the calibration of multi-hole
pressure probes. Thereby, several GPs have to be considered
simultaneously side by side.

2. Gaussian process regression

In this section, the theoretical background to Gaussian pro-
cess regression is explained. In section 2.1, the principles of
Bayesian statistics are outlined. The theory of the Gaussian

F M Heckmeier and C Breitsamter

process regression is introduced in section 2.2. The upcoming
sections are based on the more detailed discussion given by
Rasmussen and Williams by addressing Gaussian processes in
machine learning applications [5, 12]. Furthermore, general
information on pattern recognition and machine learning is
given by Bishop [13].

2.1. Theoretical background to Bayesian statistics

Engineering problems are often characterized by the lack
of available information. This is where probability models
provide a remedy when it comes to dealing with the chal-
lenge of missing information. In Bayesian statistics, the model
based on existing data can successively be improved with
new information by inference. The question on how probab-
ilities change due to new information are thus brought into
a mathematical framework by using the Bayesian theorem.
The more general question on what can be inferred on the
population based on samples is hereby answered. Hence, the
Bayesian formalism introduces various probabilities, which
are described in the following: A prior probability P(7) has to
be specified, expressing the belief about the hypothesis before
incorporating observations. The likelihood probability P(E|H)
is the probability of the observations given the hypothesis. The
marginal likelihood or evidence P(E) is the normalizing con-
stant. The posterior combines the likelihood and the prior and
takes all information that is known into account. The posterior
P(H\E), the probability of the hypothesis given the evidence,
can be calculated by Bayes’ rule:

teri likelihood x prior (1)
osterior = ———_____—_
P marginal likelihood

P(E|H) x P(H)

PCIE) = Fo

(2)

2.2. Gaussian processes

In the context of Bayesian statistics, multiple machine learning
algorithms have been developed, one of which is the Gaus-
sian process regression. As noted in the Bayesian statistics
introducing comments, new information can be used to infer
a new posterior Gaussian process model, which incorporates
the observations by updating the initial/prior Gaussian pro-
cess. In contrast to basic fitting methods, the expected order
of the approximation does not need to be specified beforehand
for the Gaussian process regression.

A Gaussian process describes a distribution over functions
and is fully characterized by the mean function m(x) and the
covariance function k(x,x’) of a real process f(x).

m(x) =E[f(x)] (3)
Meas. Sci. Technol. 31 (2020) 125301

For noise-free observations, the Gaussian process can be writ-
ten as:

f(x) ~ GP(m,k) (5)
A distinct finite number 7 of locations is considered further
and the mean u and the covariance » can be expressed as:

LU; = m(x;), i=1,...,n (6)

diy = k(xi,x)), Lj= l,...,n (7)
The joint distribution of m known training case function values,
f, and a set of n« function values corresponding to the test set

inputs, f,., gives:
f » »
w N [ , ff f,* (8)
f.. LU, dof Dox
Here, for example Yr, = U(X, X..) represents the n x n* mat-
rix of the covariances evaluated at all n training points X and
n« test points X~*.
The predictive joint posterior distribution can be used to
sample function values f, of test inputs X« by evaluating the
mean and covariance matrix:

(f,|X,,X,f) ~ NH. t Ee Dp (fn), Den — Da tDpy Er.)
(9)
The covariance of a Gaussian process random variable can
be described by the kernel or covariance function and relates
one observation to another. For a valid kernel function, the ker-
nel matrix +; = k(X, X) has to be positive definite. This implies
a symmetric covariance matrix. The prediction of the Gaussian
process strongly depends on the choice of the covariance func-
tion. Instead of fixing it to a specific shape, usually a para-
metric family of functions is selected and its parameters are
optimized by inferring with the training data. In the following,
two different families are introduced. Afterwards, it is shown
briefly how the hyperparameters can be optimized.

2.2.1. Kernel function families. One of the most basic kernel
function families is the squared exponential kernel, or Gaus-
sian kernel (see figure | (top)):

el ||2
k(x,x’) = OF exp (-= * ®)

10
5a? (10)

Here, of denotes the signal standard deviation or the maximum
allowable covariance between two different observations. Fur-
ther, a; is the characteristic length scale which defines the
range of influence of two different observations. Another ker-
nel function, which is commonly applied, is the Matérn 3/2
covariance function (see figure | (bottom)). This kernel func-
tion is also used for the GP of the CTA and the multi-hole
pressure probe data in section 4.2 and 4.3, respectively:

__y/
k(x,x’) = a7 (1 + V/3r) exp (—v3r) , with r= Ix=x'l

O]

(11)

F M Heckmeier and C Breitsamter

Figure 2 shows a representation of the kernel matrix for
both the Gaussian and the Matérn 3/2 kernels with randomly
chosen hyperparameters of = 1.0 and o;=1.0. Comparing
both kernel functions, it can be seen that the squared expo-
nential kernel shape has a broader peak in comparison to the
Matérn kernel, but contrary flattens out earlier with increasing
distance ||x — x’||>.

The set of hyperparameters is often pooled in the vector 0.
For the previously defined kernel functions, @ is defined as:

=(0,) (5)

ee) Of

Depending on the mean and kernel function chosen in the prior
step, different free parameters have to be set. The stated equa-
tions hold true for noise-free data. In real-world problems,
observations are subject to noise. This can be expressed in
additional terms in the GP formulation. The measured value
y with noise is defined as: y = f(x) + €. Here, the noise ¢ is
Gaussian distributed with a noise variance o7. Furthermore,

the covariance also changes to Ly = Xi¢-+ o7I, where du is the
covariance matrix for noise-free observations.

(12)

2.2.2. Training of hyperparameters. The evaluation of the
marginal likelihood function p(y|X, 0) is the basis for the train-
ing of the hyperparameter vector 0. This can be done by max-
imizing the log likelihood function with efficient gradient-
based algorithms, e.g. conjugate gradient solvers [14]. The log
likelihood function £ for multivariate Gaussian distributions is
given by:

nN

ler, 1
L=logp(y|X,0) =—=y"d, 'y— 3 logl*s1— 5

5 log 27.

(13)
It has to be noted that log p(y|X,@) is a non-convex function.
Hence, it could have multiple maxima. Numerous methods in
the literature cover the determination and optimization of this
problems by inverting J, efficiently while reducing computa-
tional costs of the O(n?) computation.

Furthermore, regarding non-linear optimization, the gradi-
ent of the log likelihood function is needed as well. This is
done by seeking the partial derivatives of the marginal likeli-
hood w.r.t. the hyperparameters 6; (here, Tr is the trace of the
matrix):

_,O% 1 Od,
—f£=--=Tr (s =) + 5Y ay >) ly.

14
» 06; a0; U4)

2.2.3. Sparse GP for large data sets. __In the case of a high
number of input/training data sets, GP models experience a
high computational effort due to matrix inversions 1n the infer-
ence step. Considering n training points x, an exact inference
via the Gaussian likelihood method is of O(n*) for the stand-
ard n X n matrix inversion. In order to reduce the computa-
tional load, there are different methods to approximate the cov-
ariance matrix. Instead of using the full covariance matrix »,
Meas. Sci. Technol. 31 (2020) 125301

Matérn 3

y Gi eden AN .

t

 

F M Heckmeier and C Breitsamter

Figure 1. Squared exponential kernel (top) and Matérn kernel (bottom) for various hyperparameters oy and 07.

Squared Exponential Kernel

-5 1
0.8
0.6 i
0.4
0.2

5

-5 0 5
xX

5
0.8
Uo
0.4 x
0.2
o
5 0 5

Matérn 3/2 Kernel

—_

x

Figure 2. Squared exponential kernel matrix (left) and Matérn 3/2 kernel matrix (right) for hyperparameters of = 1.0 and a; = 1.0.

an approximate matrix » is used for the inference. Quinonero-
Candela and Rasmussen give an overview of different meth-
ods [15]. Generally, the approximation methods work with a
set of m inducing points u with a reduced computational load
of O(mn’). In the GPML Matlab toolbox the Fully Independ-
ent Training Conditional (FITC) approximation is applied,
which is briefly explained in the following. The approximated
covariance matrix 5As Ca) begxpressed as [15-17]: (15)

with

Ow = dun + a. I,

O= 7 OF) Du,
(16)

with g,,, being the noise variance from the inducing points. The
diagonal matrix diag(A) comprises the diagonal elements of
A. Besides the known n X n covariance matrix J, the formula
also uses the n x m covariance matrix between the test points

and the inducing points ©, and the m x m covariance matrix
between the inducing points Yiy,.

3. Calibration of aerodynamic probes

The application of aerodynamic probes in experiments in
unknown flow conditions requires a calibration of the probe in
a known free-jet calibration wind tunnel in advance. Within the
context of the aerodynamic/spatial calibration of a probe, the
correlation between the mean free-jet flow conditions and the
measured quantity Xmeqas,c at the probe is determined. The index
c denotes values in the calibration step, whereas the index T
will be used for values in the reconstruction of test points.
Xmeas can, for example, be the voltage measured by a hot-wire
probe or the pressure recorded by a multi-hole pressure probe
at the location of its pressure transducer. During the calibra-
tion, different combinations of the free-jet velocity U..,- and
Meas. Sci. Technol. 31 (2020) 125301

the flow angles a, and {, are set in the free-jet calibration
wind tunnel, see figure 3. In order to determine the actual flow
conditions at the probe tip in an experiment, the measurand
Xmeas,r Must be post-processed with the stored calibration data.
In the literature, there are several methods how the calibration
data can be used to reconstruct the flow field properties. The
most commonly used one is an interpolation approach, which
is applied to calculate the flow data at the probe tip based on
the acquired measurements. In the following sections, the cal-
ibration and reconstruction methods for both measurements
techniques, hot-wire anemometry in section 3.1 and multi-hole
pressure probes in section 3.2, are briefly introduced.

3.1. Hot-wire probes

The calibration of a CTA hot-wire probe determines a rela-
tionship between the CTA output and the flow velocity U..
It is performed by exposing the probe to a known flow and
recording the voltages E. A curve fit through the acquired
points (E,U,.) is used when converting data sets from
voltages to velocities, see figure 4. CTA bases on the cool-
ing effect of the flow on the wire (convective heat transfer).
The current/voltage that has to be provided by the anemo-
meter to the wire to keep the wire at a constant temperature
is measured. The wire is one arm of a Wheatstone bridge and
has to be balanced before being calibrated. Hence, the bridge
voltage F is a direct measure for the flow velocity U,,.. Fur-
thermore, it is important to monitor the air temperature during
the probe calibration. If it varies from calibration to measure-
ment, it is necessary to correct the CTA data for temperature
variations, see [18—20]. The gold-plated tungsten wire with a
length of approximately 1.25 mm and a diameter of 5 um is
welded between two prongs. The sensor temperature coeffi-
cient is 0.003 6 1 K~! and an overheat ratio of a = 1.8 is applied
within all calibrations. For X-wire or triple-wire probes, a dir-
ectional calibration has to be performed. For reasons of brev-
ity, this paper does not deal with the directional calibrations
for hot-wire probes in detail. Henceforth, solely single-wire
probes are considered. More details on multi-wire probes can
be found in the literature [21]. For single-wire probes, the cal-
ibrated data points, shown in figure 4, can be approximated
with either a polynomial or a power-law curve fitting:

U=ajta,:-E+@-E’+a,-E+a,-E (17)

E? =A+B-U" (18)
Here, Opo1y = [ao,41,a2,43,a4] are calibration coefficients for
the polynomial fit, whereas A and B and n represent the cal-
ibration constants for the power law fit 0,0, = [A,B,n]. The
exponent n usually lies in the region of n = (0.4, 0.55) and is
adapted to the calibration data set.

3.2. Multi-hole pressure probes

The working principle of pressure probes relies on the stagna-
tion of the flow around the probe. At the stagnation point, the

F M Heckmeier and C Breitsamter

total pressure p; is equal to the sum of the static pressure p, and
the dynamic pressure g. Multi-hole probes measure the total
pressure of the flow at various locations at the probe tip. By
measuring all pressures and setting them into relation, the flow
properties at the probe tip can be concluded. For a five-hole
probe, the pressures p; — ps are recorded and post-processed.
Both, pitch a and yaw {, angles (see figure 5) can be resolved.
To gather the calibration data set, different angle combinations
and free-stream velocities are set in the free-jet wind tunnel.
Figure 6 shows an exemplary calibration grid for a multi-hole
pressure probe. For each calibration velocity, several hundreds
or sometimes more than a thousand angle combinations are
calibrated. The maximal calibration angle of a five-hole probe,
and hence its reconstruction range, 1s near + 60.

Non-dimensional calibration coefficients can be calculated
with the acquired pressures, which form the basis for the inter-
polation. The interpolation routines can be divided into global
or local interpolations, depending on whether all calibration
points or only points in the surroundings with similar calib-
ration coefficients should be used. In the local interpolation
method, the calibration data is divided into a low- and a high-
angle regime, see [22]. The pressure port with the highest
measured pressure determines the set of calibration coeffi-
cients used for reconstruction. In the event that multiple pres-
sure ports see similar pressures within a given range, overlap
segments are defined where the coefficients are calculated for
each dominant pressure port. For the low-angle regime, where
the central port p; measures the highest pressure, the coeffi-
cients are defined as follows:

ba = 5 (P3 — P2) (19)
bg = 4(pa—Ps) (20)
Ar = 5(p1 —Pr) (21)
As = 5(P1— Ps) (22)
with = =p, — @tPstpates (23)

q denotes the pseudo dynamic pressure, which is used to
non-dimensionalize the coefficients. In the high-angle regime,
where one of the circumferential ports p; records the highest
pressure, the coefficients read:

be = 5(Pi—P1) (24)
by = 5(p* —P-) (25)
A= (Pi - Pr) (26)
As = 5 (Pi — Ps) (27)
Meas. Sci. Technol. 31 (2020) 125301

STEP 1: CALIBRATION STEP

Uo = known

—_—_—

Qe, Bc = known

oN

———___

Xmeas,c —_— $$ — —————————
O

F M Heckmeier and C Breitsamter

CT Calibration — Data

  

 

 

STEP 2: RECONSTRUCTION STEP

Uot =?
ar, Br =?

OO

Xmeas,T

Reconstruction

a Uso recon
™. recon)

Brecon

Figure 3. Calibration and reconstruction of aerodynamic probe data.

 

x HW
Ath order polynomial}
— Power law
0 5 10 15 20 25 30 39 AQ) A5 50
Uso [m/s|

Figure 4. Example of a single-wire calibration.

+ —
7 +
q=pi- 5

 

with (28)
Hereby, pt and p~ denote the pressures at the circumferential
pressure ports in clockwise and counter-clockwise direction.

During the reconstruction, the test point pressure data vec-
tor p; is recorded. The subscript T indicates the values at the
test point. The non-dimensional coefficients bar, bg,r or be,r,
by,r for low and high angle regimes are calculated as defined
above. In the following step the quantities A,7, As and a7,
Br or O67, br are determined by the interpolation algorithm
as functions of f(ba,7,b,,r) or f(bo,r,b¢,r). Furthermore, the
Mach number M and the deduced velocity magnitude U are
calculated as a function of p; and p,. The velocity components
can be expressed by using the flow angles a and £.

4. Exploitation of gaussian process regression for
the calibration of aerodynamic probes

In this section, the findings from section 2 on the fundament-
als of Gaussian process regression are applied to calibration

data of aerodynamic probes. Using an introducing example in
the following section 4.1, the procedure of the Gaussian pro-
cess regression for the reduction in the number of the calib-
ration points will be demonstrated, see figure 7. Thereby, the
application of the GPML Matlab-toolbox implementation by
Rasmussen and Nickisch [23] and the choice of the parameters
will be discussed. In section 4.2, single-wire CTA calibra-
tion data are examined and the applicability of Gaussian pro-
cess regression to real aerodynamic probe data is shown. As a
final demonstration of the approximation technique for aero-
dynamic probe data, the more complex calibration of a five-
hole pressure probe is explained (see section 4.3).

4.1. An introducing example

In this introducing example, the Gaussian process regression
procedure from the flow chart in figure 7 1s explained step by
step using generically generated data. After starting the GPML
Matlab toolbox, the available calibration data are read in first.
Meas. Sci. Technol. 31 (2020) 125301

 

Figure 5. Interchangeable coordinate system: a-(@ and 6-¢.

 

T T
*, a*
"se, ey
- ®, *, * *
‘2, *
‘*, a*
* *
'* a*
%. *
~ . 3
ae athe an!
gga oe
tc tha x Fa a 5 oat Sone Ne
Po ee a |
ies rg a
0) i ( | )}
| sesseennsessnnneeessssnnsess ( © eeeeessees |
seu eee es
att WAS Af 24 fs
es ll bas
ee ot =e
pis ae negstgt
ban’ ann ee
r a* *
a* r %e
r 2,
« 2
* 2
a= - « m e, * 4
«* . %.
* 'e
1 1

 

oO

Figure 6. Exemplary calibration grid for a multi-hole pressure
probe.

Here, the ten different input data sets are displayed in fig-
ure 8 (left). Since the number of input data points is small, the
normal GP approach is applied. A squared exponential ker-
nel function and the Gaussian likelihood formulation is chosen
for inference. The prior GP(0,k) is now initialized with the
initial hyperparameters in table 1, and thereafter, a posterior
GP is trained with the input data (see figure 8 (right)). In the
optimization step, the hyperparameter vector @ is optimized by
maximizing the log marginal likelihood as described in sec-
tion 2.2. The optimized values in table | show that the initially

F M Heckmeier and C Breitsamter

Table 1. Prior and optimized hyperparameters for the squared
exponential kernel function in the example test case.

Initial hyperparameter Optimized hyperparameter

hyp hyPopt
O] 0.1 2.27
of 0.1 1.61
on 0.1 2.2-10~7

chosen values vary widely from the optimized hyperparamet-
ers. The location of the first supporting point, viz. the loca-
tion of the first point to be calibrated in the new probe cal-
ibration, is determined. This can be done manually or e.g. by
choosing the location of the highest predictive output variance,
which is available as an output vector of the gp-routine. At this
point, newly calibrated points of the probe under investigation
are added to the GP regression approach. This is done in a
while loop: as long as the termination condition is not ful-
filled, an updated conditional GP is formed with the available
supporting points from the new calibration and new locations
for further supporting points are determined. If the termina-
tion condition is reached, a final GP is formed with all newly
calibrated supporting points. The results of the last step serves
as a new calibration curve for the probe and can be used for
post-processing or visualization. In figure 9, the gp-routine
outputs of the first three iterations and the final iteration are
visualized. Besides the mean and the standard deviation of the
updated GPs, the test curve, which represents the probe calib-
ration curve to be approximated, and the supporting points are
shown.

Already after two iterations, the output of the GP is close
to the function to be approximated y,,.,,. After five iterations,
the termination condition selected here is reached and the final
GP is calculated. The GP-output matches almost exactly the
test CUIVE Vresz.

4.2. Single-wire CTA-probes

In this test case, real aerodynamic probe calibration data of
single-wire CTA probes are used. The input data set com-
prises 13 different single-wire calibrations. Each of the cal-
ibrations was conducted separately and is independent of each
other. The bridge balancing and setup of the CTA was done in
advance and the gain and offset voltages were set, respectively.
Furthermore, some calibrations were digitized with an AD-
converter analog input voltage range up to 5 V and some with
up to 10 V. Furthermore, the maximum calibrated air speed
differs between the input data sets. Maximum velocities range
from 10 ms~! up to 120 ms~!. Concluding, the input data
sets are independent of each other and very heterogeneous.
In the following first part of the hot-wire investigations,
the regular GP regression methodology, as explained in the
introducing example shown in figure 7, is applied on the hot-
wire data. After first tests, the Matérn 3/2 kernel is chosen for
the covariance and the following initial hyperparameters are
chosen (see table 2). For the sake of consistency and clarity,
Meas. Sci. Technol. 31 (2020) 125301 F M Heckmeier and C Breitsamter

Start GP Regression Toolbox
Read existing
calibration data sets

Large data set?
Initialization of hyperparameters Initialization of hyperparameters
hyp for sparse GP hyp for normal GP

      
   

      

Posterior GP
|---| = gpl.--);

Optimization of
hyperparameters
hyPopt = minimize(...);

Determination of first
supporting point location

Read test calibration data
at supporting point location(s)

       
     
 

  

‘Termination
condition reached?

Updated GP with Final GP with
supporting point(s) supporting point(s)
|---|] = gpl.--); |---| = gpl..-);

Determination of additional
supporting point location
Stop GP Regression Toolbox

Figure 7 Flow chart of the Gaussian process regression applied on aerodynamic probe calibration data.

    
   

Post-processing and visualization

 

 

3

:

| ee

2 1 0 12

Figure 8. Input data sets for the introducing example (left) and the initial GP (right).
Meas. Sci. Technol. 31 (2020) 125301 F M Heckmeier and C Breitsamter

 

 

  

 

Iteration #1 Iteration #2 9 Iteration #3
2 | =
> I [ wa
0; ae
-2 0 2
LX L x
9 Iteration #5

 

 

 

 

 

 

 

100  ~—«150
DG GG

Figure 10. Input data sets for the hot-wire data (left) and the initial GP (right).

Iteration #1 Iteration #2 Iteration #3

 

 

 

2 _© Supporting point(s)
| i I a

Pi LS: ee ae

() 10 20 30 40 50 60 70 80

x

Figure 11. Output of the updated GPs with supporting points in comparison to the test function yyes; for the first three and the final iteration
for the hot-wire data.
Meas. Sci. Technol. 31 (2020) 125301

max. standard deviation

F M Heckmeier and C Breitsamter

 

Iteration #

Figure 12. Maximum standard deviation of the GP after each iteration for the determination of new supporting points.

 
   
 

+ HW |

> 4 |
Led ape HAMM kN deemed edhe femoel nest nest ourboyrcteneclomclunabonsboned an 4th order polynomial”
et , —Power law |
9 ) vt -.-GP | |
0 10 20 30 AQ 50 60 70
Ux |m/s|

Figure 13. Hot-wire calibration data fitted with a 4th order polynomial and a power law fitting and described by the final GP.

Table 2. Prior and optimized hyperparameters for the Matérn 3/2
kernel function in the hot wire test case.

Initial hyperparameter Optimized hyperparameter

hyp hyPopt
Co] 1000 112.96
of 10 8.19
on 1.0 1077 1.51077

the velocity and voltage data are denoted as x and y, respect-
ively. In figure 10 (left) all calibration data that are used for
the determination of the initial GP (see figure 10 (right)) are
shown. Figure 11 shows the updating process of the GP regres-
sion routine for various iterations. After eight iterations, the
termination condition is reached. Figure 12 displays the max-
imum standard deviation of the updated GP after each itera-
tion. It is used to determine the location of the next supporting
point. The relative improvement between the successive steps
is decreasing and after the 8th iteration the standard deviation
lies below the margin for the termination condition.

In figure 13, the hot-wire test calibration that is to be
approximated by the Gaussian process regression is shown.
Here, results of both fitting methods, which are described in
section 3.1, are displayed alongside the mean of the final
updated GP. The free parameters are chosen as Opo1y =
[1.787 1, 0.2629, —8.1602- 1077, 1.2661 -10~*, —7.1646-
10~"] for the polynomial fitting. With a gradient descent

optimization approach, the power law coefficients were set
to Onow = (2.0969, 3.7724, 0.549 1].

In the second part of the hot-wire investigations, the
influence of the initial determination of the hyperparamet-
ers on the outcome of the Gaussian process regression 1s
studied. This is done in a sampling routine, similar to a
Monte-Carlo-method (MCM) simulation. It is determined how
many supporting points are needed to reach the determination
criterion. Thereby, the three hyperparameters 0), of and o,
are sampled out of three normal distributions \V,,(1000, 300),
N,(10,5) and N,,,(0.01,0.000 1), respectively. Nucu = 10*
multivariate samples are drawn and tested. The determina-
tion criterion of each of the Nycy GPs is set to a threshold
RMS-difference value of €,:; = 0.05 between the updated GP-
output and the test hot-wire calibration. Figure 14 shows the
resulting number of supporting points needed to reach €y:n5
for each MCM-sample, as well as the initial and the updated
hyperparameters.

The initialized hyperparameters show the expected
Gaussian shape, and hence, the assumed number of MCM-
samples Nycu = 10* is appropriate, which is a prerequisite
before discussing the output data. In the column for the optim-
ized hyperparameters after the GPML optimization routine, it
can be seen that the distributions are not fully Gaussian any-
more. The noise hyperparameter 7, is negligible now, whereas
o; 1s distributed around a mean of a; = 110 and of around a
mean of of = 8.2. Furthermore, it can be seen that for most
samples, solely seven to ten supporting points are needed. In
comparison to the full calibrations, which frequently comprise
Meas. Sci. Technol. 31 (2020) 125301

initialized hyperparameters

 

 

&
ra, 200
= 500
S 100
Hh
0 0
0 500 1000 1500 2000 0
J]
. rm 500
2&
o.
& 250
(av)
WN
He
0
5
5000
wn
&
OQ,
q 2500
wo
mn
He
0 0
0.0095 0.01 0.0105 0
On

p Optimized hyperparameters

F M Heckmeier and C Breitsamter

  

6000
5000
200 400
1 4000
WM
gs
=
5 3000
a
10 15
oj 2000
1000
2.5 5 0
On «10-4 0 10 20

# supporting points

Figure 14. MCM sampling of hyperparameters: initialized (left) and optimized hyperparameters (middle), number of supporting points of

GP for the termination condition (right).

Table 3. Overview of the existing calibration data: probe tip diameter D, calibration Reynolds number Rep, and Mach number M.

min(D) [mm] max(D) [mm] min(Rep) max(Rep) min(M) max(M) # probes
Straight 1.6 6.35 3000 40 000 0.03 0.6 15
L-shaped 1.0 3.2 1000 55 000 0.024 0.95 8
Cobra-shaped 3.0 3000 38 000 0.05 0.6 1
Conical 1.0 3.2 1000 55 000 0.024 0.95 20
Hemispheric 3.0 6.35 3000 28 000 0.03 0.4 4

Table 4. Prior and optimized hyperparameters for the Matérn 3/2 kernel function in the five-hole pressure probe test case.

Initial hyperparameter

hyp
GPa GP GP 4, GP 4,
Co] 50.0 50.0 50.0 50.0
of 10.0 10.0 10.0 10.0
on 0.1 0.1 0.1 0.1

up to 30 calibration points, the introduced calibration approach
applying a GP regression algorithm leads to a reduced number
of calibration points and hence a reduction in calibration time.

4.3. Five-hole pressure probes

The calibration of five-hole probes results in four calibration
surfaces for a, 3, A; and A, as functions of f(ba,bg). Hence,
the shown results in this chapter are the outcomes of mul-
tiple, viz. four simultaneous, GP regressions. The determin-
ation of the supporting points of the updated GPs will be eval-
uated globally, but the updating of every single GP itself is
handled independently. All existing calibration data sets are
read in first. They consist of data of 24 different probes, which
are shaped differently. The probe stem shape varies between

Optimized hyperparameter

hyPopt
GP a. GP GP 4, GP a,
8.06 7.00 7.82 9.20
4.28 4.53 0.21 0.29
2.55-10-> 2.06 - 107° 1.59-10~° 4.02 -10~°

straight, L-shaped and cobra-shaped probe stems and con-
ical and hemispheric probe tips with varying diameters D are
present. The overhang length for the L-shaped probes vary
between (1.5, 9.5)-D. For some probes, calibration data for dif-
ferent inflow Mach numbers are available. Therefore, 45 input
data sets in the Mach number range between M = (0.024, 0.95)
are used to train the initial GP. An overview of the different
calibration data including the range of diameters D, Reynolds
numbers Rep and Mach numbers M is given in table 3.

When concatenating the input data sets, with n =47577
calibration points, the number of points exceeds the limit for
the standard GP regression due to limitation of the neces-
sary O(n>) matrix manipulations. For this reason, the sparse
approximation with m= 1681 locations (b,|bg) is applied as
described in section 2.2 which in turn reduces the costs to
O(mn*). The Matérn 3/2 kernel is used for the four GPs as
Meas. Sci. Technol. 31 (2020) 125301 F M Heckmeier and C Breitsamter

 

  

—rms(agp — Attest)

  

  

H H
5 10° :
Oo oO
WM NM
S q
10-*
0 100 200 300 0 100 200 300
Iteration # Iteration #
10°* |
rs —rms(Argp _ Attest) oy —rms(As gp _ As test)
© ©
a a
© 10-2 oD
WM NM
& q
H H
10-3
0 100 200 300 0 100 200 300
Iteration # Iteration #

Figure 16. RMS error convergence of the GP outputs and the full calibration values with increasing iterations.

Table 5. Spatial reconstruction results for the GP after the 80th iteration compared to the full calibration data.

Aa[ ] ABT] AM [- 1077]
maxabs rms std maxabs rms std maxabs rms std
GP 0.41 0.14 0.15 0.27 0.13 0.13 1.07 0.42 0.40

Full calibration 0.23 0.08 0.08 0.26 0.09 0.08 0.63 0.36 0.21

the covariance function and is initialized with the initial hyper- for the four calibration surfaces. A visualization of the stand-
parameters in table 4. After initialization, the GP is updated ard deviation as displayed in the preceding 1D cases is omitted
with the sparse input values. Figure 15 shows the initial GPs for clearer visualization.

12
Meas. Sci. Technol. 31 (2020) 125301

F M Heckmeier and C Breitsamter

 

  
 

  

“4 Ge

©s5 0 o@@

®Oeoo 6@@®
@ ‘

2Y+@® ©

 

Figure 17. Updated GPs for the four calibration surfaces after the addition of 80 supporting points: +(blue) - GP output, ° (black) - full

calibration, ()(red) - supporting points.

I I Tt

Men,

 

o Test data

20 -| + Gaussian process data
x Full calibration data
15} en
10+ 7
. “eng
2 0O| we
-5L 1
-10) “~
-15 an
-20 | J

“M0

0

1 1 1 1

10 20 30 AO
# ‘Test points

50

 

18
Ws Gaussian process data

16 MH Full calibration data

14

12+ |

 

-0.2
Absolute angle error [°|

0 0.2

Figure 18. Test point reconstruction of the angle a with the updated GP after the addition of 80 supporting points compared to the full

calibration reconstruction.

In order to better compare the output of the GP regres-
sion, the probe under investigation was fully calibrated before-
hand. It is a straight five-hole probe with a hemispheric probe
tip with a tip diameter of D=3 mm. It was calibrated for
three inflow velocities. Two of these calibration data sets
are part of the input data sets and the remaining one is the
test calibration, denoted either as full calibration or with the
index * test.

In the next step, optimized hyperparameters for the four
GPs are found by optimizing the log marginal likelihood.
The resulting hyperparamters which remain unchanged dur-
ing the upcoming updating routine are gathered in table 4 as
well. The computational costs for the initialization step and

13

the optimization of the hyperparameters lie in the order of
(a few) minutes on a state-of-the-art workstation and, hence,
can be considered as negligible in contrast to wind tunnel set-
up costs. In the updating procedure, supporting point loca-
tions are added to the GP. Due to the fact that four GPs have
to be updated simultaneously, a criterion which GP contrib-
utes the next supporting point is defined. For each GP, the
location of the maximum standard deviation of the updated
GP normalized by the standard deviation of the first iteration
is calculated. Depending which of the four GPs experiences
the highest normalized standard deviation, the location of the
additional supporting point for the next iteration for all GPs is
chosen. A termination criterion stopping the iterative updating
Meas. Sci. Technol. 31 (2020) 125301

 

 

 

o Test data “Me,
20} + Gaussian process data ;
x Full calibration data
15 en
10+ we
5L |
a O a
-5
-10 “
=20)-

 

 

0 10 20) 30

# ‘Test points

AO

F M Heckmeier and C Breitsamter

 

T
(i Gaussian process data
(Full calibration data

 

16

 

 

 

-0).2 0 0.9
Absolute angle error [°|

Figure 19. Test point reconstruction of the angle a with the updated GP after the addition of 80 supporting points compared to the full

calibration reconstruction.

 

 
   

rms error

 

(+GP: a

(4

--- Full calibration reference: a
- - Full calibration reference: Bb

  

 

Iteration #

Figure 20. RMS errors of the test point reconstruction of the angles a and § when increasing the number of updating iterations of the GP.

process can be applied. For example, if the maximum nor-
malized standard deviation or the RMS value of the sum of
standard deviations for the four GPs falls below a pre-defined
margin, the criterion is reached and the solution is converged.
Since, in this example, the full calibration for the multi-hole
probe was also done in order to compare it to the results of
the GP, the number of iteration steps was fixed to 300 for
the first investigations. After each iteration, the RMS error
between the GP output data and the full calibration data is
displayed in a semi-logarithmic plot in figure 16. When dis-
cussing the rms(Ggp — Pres) plot, the RMS value reads around
1 for the 10th iteration and drops below 0.2 for around 80
iterations.

Figure 17 visualizes the GP outputs of the 80th iteration of
the four calibration surfaces. Furthermore, the 80 supporting
points and the full calibration test surfaces are shown. Visually,
there are only very small noticeable deviations in the A; and A;
plot. The errors between the a and 6 GP outputs and the full
calibration surfaces seem negligible.

For quantifying the visually perceived deviations in fig-
ure 17, a reconstruction of unknown test points is performed

14

in the next step, also known as generalization. In this process,
47 test data points measured independently of the determin-
ation of the calibration surfaces are post-processed with the
final GP output and the full calibration data. The test points
comprise pressure measurements p, of different angle com-
binations at a fixed Mach number of M=0.1. Figure 18 and
figure 19 show the results of the post-processing step con-
ducted with the GP and the full calibration data. Besides a
visualization of the reconstructed angles, a histogram shows
the absolute angle errors in degrees, calculated with the true
angle values set in the calibration wind tunnel as reference val-
ues.

Table 5 gives an overview of the quantified results of the
reconstruction: apart from the maximum absolute occurring
error among the test results maxabs, the RMS errors rms and
the standard deviation std are formed across all test points for
the angles a and £ as well as for the reconstructed Mach num-
ber M.

To conclude the investigations on the five-hole probe,
a series of reconstructions with different sized GP mod-
els is shown. Thereby, the number of supporting points was
Meas. Sci. Technol. 31 (2020) 125301

increased in steps of 10 up to 300 supporting points. The recon-
struction accuracy for a and ( in terms of the RMS error
of the GP is displayed in the semi-logarithmic plot in fig-
ure 20. With an increasing number of supporting points, the
RMS errors asymptotically approach the reference values of
the full calibration reconstruction. After 80 to 100 support-
ing points, only marginal improvements are noticeable. This
leads to the conclusion that with the application of GP regres-
sion, the number of actually measured points to build a cal-
ibration surface, capable to reconstruct with almost the same
accuracy, can be decreased over one order of magnitude. In the
case that lower requirements are made in terms of reconstruc-
tion accuracy, the number of supporting points can be reduced
by a multiple, furthermore. Hence, calibration set-up costs,
expressed by the number or time of measured points, could be
reduced in this example by the factor of F = 1014/80 = 12.68
for high reconstruction accuracy (angle RMS below 0. 15) and
the factor of F = 1014/40 = 25.35 for lower reconstruction
accuracy (angle RMS below 0.5 ).

5. Concluding remarks

In this paper, the application of Gaussian process regression
on the calibration of aerodynamic probes is shown. Besides
introducing into the theoretical background of the Bayesian
statistics approach, the basic ideas in probe calibration meth-
ods for CTA and pressure probes are presented. The approach
of applying GP regression to aerodynamic calibration data is
introduced in a generic example and shows the potential of
the method. The method is tested on two real data sets: the
1D calibration of a single-wire hot-wire probe and the 3D cal-
ibration of a five-hole probe. The more challenging task of
modeling the four calibration surfaces of the five-hole probe
can be performed very accurately with the newly developed
GP methodology, yielding promising results. A reconstruc-
tion with the GP calibration with a twelfth of the calibration
points, compared to the full calibration, provides a compar-
ably accurate reconstruction of the test points. Moreover, this
procedure can also be performed for probes of different sizes
and probe head shapes in a reliable and robust manner. The
only requirement for the input data is that they are generated
during the calibration of the same type of probe. For example,
calibrations of three-hole probes could not be used to generate
the GP for five-hole probes. Finally, the hypotheses presented
in the introduction are evaluated: The applicability of Gaus-
sian process regression to aerodynamic calibration data from
hypothesis 2 is mainly shown in the introducing example in
section 4.1. The flow chart 7 shows the principle procedure of
the GP calibration. Especially in the pressure probe test in sec-
tion 4.3, hypothesis | can be confirmed by training the initial
GP with more than 47 000 input data points and combining the
similarity of the different probe calibrations. When looking at
the results obtained from the 3D calibration of the five-hole
probe, the savings potential in calibration time becomes obvi-
ous. The prerequisite for achieving this is, obviously, that a
sufficiently large input data set of different probes is avail-
able, viz. various probe shapes with different tip diameters

15

F M Heckmeier and C Breitsamter

which are calibrated in a wide Reynolds numbers range. The
reduction in the number of calibration points by at least one
order of magnitude is demonstrated with comparable recon-
struction accuracy. A speed-up factor of F > 10 can be real-
ized for multi-hole pressure probes. In future developments,
the GP calibration module is planned to be further refined,
optimized and extended to other types of probes.

Acknowledgments

The authors would like to thank the company Vectoflow
GmbH for providing the multi-hole pressure probe calibration
data of numerous different probes. Furthermore, the authors
would like to thank the electricians of the Chair of Aerody-
namics and Fluid Mechanics, Luigi Findanno and especially
Hans-Gerhard Frimberger. Last, we are grateful for the con-
tributions of our colleague Vladislav Rosov.

ORCID iD

Florian M Heckmeier © https://orcid.org/0000-0002-1 130-
729X

References

[1] Rediniotis O K and Vijayagopal R 1999 Miniature multihole
pressure probes and their neural-network-based calibration
AIAA J. 37 666-74

[2] Johansen E S, Rediniotis O and Jones G 2001 The
compressible calibration of miniature multi-hole probes
Trans. of the ASME 123 128-38

[3] Heckmeier F M, Iglesias D, Kreft S, Kienitz S and Breitsamter
C 2019 Development of unsteady multi-hole pressure
probes based on fiber-optic pressure sensors Eng. Res.
Express 1 025023

[4] Gelman A, Carlin J B, Stern H S and Rubin D B 2014
Bayesian Data Analysis Chapman and Hall/CRC 3rd ed
Boca Raton

[5] Rasmussen C E and Williams C K I 2006 Gaussian Processes
for Machine Learning (MIT Press) Cambridge, MA

[6] Chilés J and Delfiner P 2012 Geostatistics: Modeling Spatial
Uncertainty Wiley Series in Probability and Statistics (New
York: John Wiley & Sons, Ltd) ISBN 9781118136171

[7] Krause A, Singh A and Guestrin C 2008 Near-optimal sensor
placements in Gaussian processes: Theory, efficient
algorithms and empirical studies J. Mach. Learn. Res. 9
235-84

[8] Pandit R K, Infield D and Carroll J 2019 Incorporating air
density into a Gaussian process wind turbine power curve
model for improving fitting accuracy Wind Energy
22 302-15

[9] Chen T 2007 Calibration of spectroscopic sensors with
gaussian process and variable selection IFAC Proc. Volumes
40 137-42

[10] Garcfa-Ruiz R A, Blanco-Claraco J L, Lopez-Martinez J and
Callejon-Ferre J 2019 Uncertainty-aware calibration of a
hot-wire anemometer with Gaussian process regression
IEEE Sens. J. 19 7515-24
[11] Agrawal R, Whalley R D, Ng HC H, Dennis D J C and

and Poole R J 2019 Minimizing recalibration using a
non-linear regression technique for thermal anemometry
Exp. Fluids 60 116
Meas. Sci. Technol. 31 (2020) 125301

[12] Rasmussen C E 2004 Gaussian Processes in Machine
Learning (Berlin: Springer) pp 63-71

[13] Bishop C M 2006 Pattern Recognition and Machine Learning
(Berlin: Springer)

[14] Nocedal J and Wright S J 2006 Numerical Optimization (New
York: Springer) 2nd ed

[15] Quinonero Candela J and Rasmussen C 2005 A unifying view

of sparse approximate Gaussian process regression J. Mach.

Learn. Res. 6 1935-59

[16] Snelson E and Ghahramani Z 2006 Sparse gaussian processes
using pseudo-inputs Advances in Neural Information
Processing Systems 18 (Cambridge, MA: MIT Press)
pp 1257-64

[17] Rasmussen C E and Nickisch H 2018 The GPML Toolbox
version 4.2 Tech. Rep.

[18] Bearman P 1969 Corrections for the Effect of Ambient
Temperature Drift on Hot-Wire Measurements in
Incompressible Flow Teddington: National Physical
Laboratory(NPL)

16

F M Heckmeier and C Breitsamter

[19] Hultmark M and Smits A J 2010 Temperature corrections
for constant temperature and constant current
hot-wire anemometers Meas. Sci. Technol.
21 105404

[20] Hewes A, Medvescek J I, Mydlarski L and Baliga B R 2020
Drift compensation in thermal anemometry Meas. Sci.
Technol. 31 045302

[21] Bruun H H 1995 Hot-Wire Anemometry: Principles
and Signal Analysis (Oxford: Oxford University
Press)

[22] Heckmeier F M, Iglesias D, Kienitz S and Breitsamter C 2019
An innovative development of a five-hole pressure probe for
highly unsteady flow phenomena ASME Turbo Expo 2019:
Volume 6: Ceramics; Controls, Diagnostics and
Instrumentation; Education; Manufacturing Materials and
Metallurgy ASME

[23] Rasmussen C E and Nickisch H 2010 Gaussian processes for
machine learning (GPML) toolbox J. Mach. Learn. Res.
11 3011-15
