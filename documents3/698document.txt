NDT&E International 116 (2020) 102327

 

NDTaE

international

NDT and E International ve emneee

‘Thermal © Signal & I

Contents lists available at ScienceDirect

    

ELSEVIER

journal homepage: http://www.elsevier.com/locate/ndteint

 

Check for

Optimization algorithms for ultrasonic array imaging in homogeneous upaates

 

anisotropic steel components with unknown properties

Corentin Ménard® , Sébastien Robert“, Roberto Miorelli*, Dominique Lesselier ”

* CEA-LIST, Department of Imaging and Simulation for Non-Destructive Testing, Bat. 565, PC 120, 91191, Gif-sur-Yvette Cedex, France
> Université Paris-Saclay, CNRS, CentraleSupélec, Laboratoire des signaux et systemes, 91190, Gif-sur-Yvette, France

 

ARTICLE INFO ABSTRACT

 

 

Keywords:

Ultrasonic array

Total Focusing Method
Adaptive imaging
Anisotropic materials
Optimization algorithm
Surrogate-model

In this paper, we investigate the ability of an adaptive ultrasonic method to image point-like reflectors inside
anisotropic and homogeneous nuclear steels with unknown properties, such as V-shape welds or cladded com-
ponents. The optimization scheme combines the Total Focusing Method (TFM) imaging algorithm with a
customized gradient ascent method to improve both the quality and the reliability of ultrasound images. A
statistical analysis of its robustness is performed with simulated echoes and using a surrogate model to speed up
the computation times of the TFM images. Then, the optimization procedure is evaluated with several experi-
mental cases and provides highly enhanced images with a 5 MHz array. The positioning of the artificial defects of
2.0 mm diameter is estimated with less than 1 mm error with respect to their actual position, and the signal-to-
noise ratio is increased by up to 10 dB. The elastic properties are also estimated with less than 10% error when
compared to their actual values.

 

1. Introduction

Ultrasonic arrays are becoming a standard technology in many in-
dustries since they allow the application of high-performance detection
and imaging methods. The Total Focusing Method (TFM) [1] is a recent
example of an imaging method that is becoming a reference in nonde-
structive testing thanks to its ability to provide high-resolution images.
Its basic principle consists in synthetically focusing the inter-element
signals recorded with an array in pulse-echo mode on every point of
the region of interest using a “delay-and-sum” strategy. As the set of
recorded signals physically corresponds to the matrix of the impulse
responses of the medium [2,3], one of the advantages of TFM is that
focusing is achieved a posteriori, without applying delay laws at the time
of acquisition. Thus, adaptive imaging algorithms can be applied on a
single set of data to optimize images in media with uncertain or un-
known properties. For example, in Ref. [4,5] adaptive TFM under
complex and unknown surfaces are proposed, and in Ref. [6], the
principle is extended to multi-mode TFM imaging [7] when the profiles
of the outer and inner surfaces are unknown.

In the present work, TFM is used to image point-like reflectors in
anisotropic butt welds and cladded steel components, whose elastic

* Corresponding author.

properties are not known during inspection. If the ray-based recon-
struction model significantly deviates from the wave propagation in the
physical medium, the sum of delayed inter-element signals becomes
incoherent at every focusing point, leading to strong image degradation
and unreliable diagnosis. We therefore propose an optimization pro-
cedure based on a gradient ascent algorithm to iteratively enhance the
reliability of the TFM images in unknown anisotropic structures. In the
following, the algorithm is referred to as Gradient Ascent Optimization
(GAO). The semi-analytical ray-tracing algorithm [8] of the CIVA soft-
ware is called at each iteration for the TFM reconstruction. The first
image is computed assuming an isotropic propagation (as in most on-site
inspections when the material properties are not well known) and, if a
low-amplitude echo is visible, the procedure is started. During the
optimization, the properties of the inspected structure are modified until
the defect echo amplitude is maximized. Once convergence reached,
both imaging and material characterization are achieved, as a reliable
image of the defect and estimates of the material properties in the vi-
cinity of the flaw are provided. If the material is assumed homogeneous,
then the material characterization is achieved for the whole structure.
This optimization procedure is inspired by the works of Pudovikov et al.
[9] and Juengert et al. [10] where the image of a well known reflector (e.

E-mail addresses: corentin.menard@cea.fr (C. Ménard), sebastien.robert@cea.fr (S. Robert), roberto.miorelli@cea.fr (R. Miorelli), dominique.lesselier@12s.

centralesupelec.fr (D. Lesselier).

https://doi.org/10.1016/j.ndteint.2020.102327

Received 2 March 2020; Received in revised form 29 May 2020; Accepted 9 July 2020

Available online 16 August 2020
0963-8695/© 2020 The Authors.

(http://creativecommons.org/licenses/by-nce-nd/4.0/).

Published by Elsevier Ltd.

This is an open access article under the CC BY-NC-ND license
C. Ménard et al.

g., a flat-bottom hole) is iteratively optimized. The difference with the
following study lies in that our procedure maximizes the detection
amplitude of a reflector without prior information about its properties
(location, geometry, size or orientation). The present approach is an
interesting alternative to destructive characterization techniques, which
require a sample to be taken from the structure in order to characterize
its properties using specific various experimental setups, such as ultra-
sonic transmission measurements with two monolithic transducers [11]
or two transducer arrays [12], pitch-catch ultrasonic measurements
with two arrays [13,14], EBSD (Electron Backscatter Diffraction) scans
[15], SAW (Surface Acoustic Wave) scans [16], etc.

The efficiency of the optimization is experimentally exemplified by
the inspection of a V-shape weld and a cladded steel component. Their
properties are assumed to be homogeneous and anisotropic, with an
orthotropic crystal structure. For the V-shape weld, 5 unknown pa-
rameters govern the 2D wave propagation: 4 stiffness constants and the
orientation of the crystal structure. Regarding the cladded component, 5
unknowns are again considered: the same 4 stiffness constants and the
thickness of the anisotropic layer. In order to evaluate the robustness of
the procedure, a statistical analysis is conducted with simulated echoes.
For this purpose, a surrogate model using a Kernel Ridge Regression
(KRR) bypasses the forward model in CIVA and shortens the computa-
tion times needed for the statistical study. KRR is a fast non-linear
regression algorithm that performs well when interpolating a database
of reasonable size and dimensions [17], which is why it is suited for the
current study. Thanks to the surrogate model, a sensitivity analysis is
also carried out to indicate the relevant parameters to be varied during
the procedure. Finally, the local GAO is tested against a global opti-
mizer: the Particle Swarm Optimization (PSO) [18,19]. PSO is a simple
algorithm to implement, which swiftly produces results for a given
optimization problem and does not require many trials to tune its
hyper-parameters.

The paper is organized as follows: Section 2 describes the optimi-
zation procedure for the TFM imaging; Section 3 is devoted to the study
of its performances and robustness with numerical data and using a
surrogate model; Section 4 discusses the optimization results when
dealing with experimental data.

2. Optimization method

In this section, a few reminders on TFM imaging for anisotropic and
inhomogeneous media in the CIVA software are provided, especially
concerning the computation of the inter-element propagation times to
synthetically focus on every point. The different steps of the optimiza-
tion procedure are then presented and the GAO, customized for this
specific study, is next detailed.

2.1. TFM imaging in anisotropic structures

Noting N the number of array elements, the principle of TFM consists
in coherently summing the N x N signals of the inter-element impulse
response matrix S(t) [20]. A component Sp_,(t) of S(t) corresponds to the
signal received by element m when element n is excited by an electric
pulse. As we are interested in complex and unknown materials, the TFM
method is considered in its simplest form, without weighting factors.
The amplitude at a pixel P located by position vector r (Fig. 1) is written
as:

S- S Sam [tn(r) + tm(r) ] |. (1)

Snm(t) = Sam(t) +j%|Snm(t)] is the analytic signal associated with the
recorded signal s,, (t), where “| -] denotes the Hilbert transform. t,(r)
and ¢,(r) are the propagation times from n to P and from P to m,
respectively, and satisfy t,(r) = t,(r) when n = m, since images will be
computed with direct rays paths without mode conversion in the

NDT and E International 116 (2020) 102327

YT) TY)

 

ROI

. t,(r) *S # »(r) | ‘
. KY ah

Fig. 1. 2D geometry describing the aforementioned notations for TFM imaging:
propagation times ¢,(r) and t,(r) for a couple of emitter/receiver (n,m) and a
pixel P located by r in the ROI, inside an isotropic medium.

following. Thus, the image formation needs the computation of N x
N, x N, propagation times for a resolution of N,. x N, pixels of the region
of interest (ROI). N, and N, stand for the number of pixels along the X
and Z axes, respectively.

In order to image inside anisotropic structures with TFM, the
computation of the N propagation times t¢,(r) is carried out in the CIVA
software by using a semi-analytical forward model, the so-called “pencil
method”. It was implemented by Gengembre et al. [8] to simulate wave
propagation in isotropic or anisotropic media. Further modeling studies
extended this model to continuously variable anisotropic media [21].
This method consists in tracing collections of rays with a small diver-
gence, instead of single rays, in order to account for the intensity
decrease of the wave along its path. The extension to continuously
variable materials involves dividing the propagation path into elemen-
tary sub-interfaces across which the wave travels, and applies the pencil
method at each of these elementary interfaces. Propagation times are
computed in a first step for solving the eikonal equation (for the axial
quantities) and the amplitude is retrieved from solving the transport
equation in a second step (for the paraxial quantities).

The optimization procedure therefore holds in iteratively modifying
the map of propagation times in CIVA, in order to optimize the quality of
the TFM image, step after step.

2.2. Optimization procedure

The synoptic diagram of the optimization procedure is shown in
Fig. 2 and consists of 4 steps. After acquiring the inter-element response
matrix, the theoretical propagation times for TFM are computed with
the pencil method in CIVA (Step 1), using randomly initialized material
properties. Then, based on these propagation times, a TFM image is
formed (Step 2) following Eq. (1). From this image, an estimator of
quality is extracted (Step 3) in order to take the optimization decision. If
the image is still not satisfactory, the optimization algorithm indicates
how to modify the unknown material properties (Step 4) and returns
back to Step 1. The optimization loop stops when the image is consid-
ered optimized enough. The estimator of the image quality at Step 3 is
the maximum amplitude of the echo in the TFM image (Amax). This
indicator tends to increase as the theoretical propagation times converge
towards those of the waves in the physical medium, provided that the
echo corresponds to direct ray paths and that the wave polarization
(longitudinal or transverse) is known. If the estimation of the propaga-
tion times in the medium is not correct, the signals would be summed at
wrong pixels, leading to a decrease in the amplitude of the echo.

2.3. Gradient Ascent Optimization

Step 4 of the optimization procedure uses a local optimizer to pro-
duce optimized images. It can also give fair estimates of the properties of
the inspected material, in the case of a homogeneous anisotropy. This
algorithm is a modified Gradient Ascent Optimization (GAO) [22],
C. Ménard et al.

Acquisition matrix S(t) |

Initialization of the

 

weld model parameters

 

|

Computation of

 

Step 1
propagation times

|

Computation of

 

 

Step 2
the TFM image

|

Extraction of the image

 

 

Step 3
quality descriptor

 

 

 

 
   
 

Image optimal?

 

End of the optimization

 

NDT and E International 116 (2020) 102327

 

Modification of the
Step 4
weld model parameters

 

 

 

Fig. 2. Synoptic diagram of the TFM optimization procedure involving 4 main post-processing steps. Step 1 is the computation of the propagation times from a set of
weld parameters. Steps 2 and 3 consist in the computation of the TFM image and in the measurement of the image quality descriptor, respectively. Step 4 determines
how to modify the material properties to increase the image quality, and is achieved thanks to an optimization algorithm.

which locally follows the gradient of the Amax descriptor to retrieve the
optimum solution corresponding to the global maximum inside the so-
lution space. The GAO is customized with the two enhancements
mentioned in Ref. [22]: a decaying learning rate and a periodic warm
restart. The gradient-based optimization may be written as:

Xj1 = x; +)VF(x;) (2)

n; is the learning rate at iteration step j < N of the gradient ascent,
which follows a decaying law as j increases. A position, designated by
the material property vector x; (in our case, x; € IR°), is associated to an
Amax value f(x;). The warm restart forces the decaying learning rate to
reset after a fixed number of iterations J, or after converging, which
allows the algorithm to escape from local maxima and saddle points.
Since the convergence of the algorithm is not appraised in terms of a loss
function, a few warm restarts are needed to ensure that GAO reaches the
vicinity of the optimum solution at least once. The gradient of the Amax
descriptor is locally estimated using centered finite differences at each
iteration step:

f (xj +h) —f(j — A)

Vi (%i) = 7 .

(3)
where h is an infinitesimal perturbation vector, and x; the position at
which the gradient is computed.

The literature provides a great variety of possible decaying learning
rates [22—25]. In the examples covered in this paper, the learning rate is
chosen so as to benefit from the speed of a linear decrease and from the
accuracy of a cosine decrease:

(: — , cos* (; ' +1,
(4)

l+n, ,

 

1; =o

where 7) and 7, are the values of the learning rate at the beginning and
the end of the decaying phase, respectively. The warm restart and the re-
initialization of the decaying phase happen after J iterations. The new
restart position xo is the last position x; reached during the previous
decaying phase.

3. Numerical study of the robustness of the method using a
surrogate model

In this section, the optimization procedure is evaluated with a noise-
free example. According to Eq. (3), the full gradient estimation at a given
position requires 2 Amax values for each dimension of the problem.
Thus, to estimate the gradient in a 5-dimensional space, 10 TFM images
have to be computed. Since the aim is to perform a statistical analysis,
the procedure has to be extensively tested. For this reason, a surrogate
model is implemented to bypass the time-consuming computation of the
theoretical propagation times and the TFM images (Steps 1 and 2 in
Fig. 2).

We first describe the sample considered in the numerical study,
which is representative of the welding sample in the experimental study.
The KRR surrogate model is detailed next and used for a sensitivity
analysis. Then, some insights on the Particle Swarm Optimization (PSO)
are provided. Finally, the robustness of the procedure is statistically
analyzed and discussed.
C. Ménard et al.
3.1. Case study for simulations

The numerical case study is an anisotropic and homogeneous Inconel
182 weld with an orthotropic crystalline structure. The inspection
configuration is presented in Fig. 3: a linear array is immersed in water
and horizontally placed over the sample featuring 3 side-drilled holes of
2 mm diameter located at different depths. The water column height is
set to 20 mm. The array operates around 5 MHz and is composed of 64
elements of 0.5 mm width with a 0.6 mm pitch. Elements are excited
with a Gaussian-type pulse with 80% bandwidth at —6 dB and sampled
at 100 MHz. Echoes are simulated in CIVA using the method of sepa-
ration of variables [26], without accounting for attenuation. A 2D im-
aging problem with longitudinal waves is assumed, therefore reducing
the optimization problem to 5 material parameters, to describe the
phase velocity Vg, of the Quasi-Longitudinal (QL) waves [27]. In our
case, the density p = 8.26 g.m ° of the medium is assumed to be known:

 

ru +133 +4/(Tu — T33)" +4I\,
J2p

The Christoffel components are given by

(S)

 

Vor =

Th, = Cy, sin’ (0; _— 0) + Cs5cos? (6; _— 0)
133 = Csssin’ (6; —_ 0) + C33c0s° (6; —_ 0) ; (6)
T'y3 = (C13 + Css )cos(0; — 8)sin(6; — 0)

where Cj1, C13, C33 and Css are the 4 unknown elastic constants and Gis
the unknown tilt angle of the crystalline structure around the Y axis. The
9; parameter is the incidence angle of the wave in the medium. The
actual material properties are given in Fig. 3, along with the related
slowness curves of the QL waves of interest.

In order to quicken the procedure, the ROI is limited to an area of
10 x 10 mm? centered around reflector n°2. The image resolution is
Ny x Nz = 5151 pixels with N, = 51 pixels in the lateral direction
(sampling step of 1/5, where i is the wavelength at 5 MHz when we

CLIT rrr rrr rr tir ttirtirTn)

 

Parameters

Homogeneous weld

X
z{
3)

NDT and E International 116 (2020) 102327

assume an isotropic propagation), and N, = 101 pixels (sampling step of
A/10) in the axial direction.

3.2. Surrogate model by Kernel Ridge Regression

The Ridge Regression (RR) is a linear regression algorithm that in-
troduces a regularization term in the interpolation problem to decrease
the variance of the regression, with the trade-off of an increased bias. In
the current study, its implementation is achieved using Scikit-learn, a
Machine Learning Python library [28]. Let us consider a regression
problem on a data set formed by D variables, which are sampled by P
points by dimension on a regular grid. The total number of samples in
the data set is then M = P?. In this database, let us consider the
observable parameter y = (y1,...,Yi,..-Yu), such that y €¢ R™™! (e.g., the
maximum amplitude of the TFM image). We want to predict the value of
y due to variations of some control parameters X = (x1,...xi,...%m), with
X € RY? and x; € R'*? (e.g., the 4 elastic constants and the inclination
angle of the crystalline structure). A standard linear regression would
use the ordinary least square method to compute the weighting vector
w € R°*! so that y = Xw. However, if the number of samples M is too
small, the variance of w may be too large, thus making the prediction for
unseen data unreliable. For this reason, the RR controls the variance of w
by introducing the penalization term yp € R. The RR then consists in
minimizing the cost function J(w):

J(w) = |[Xw — yl|° + u||n|I°. (7)

The use of the Euclidean norm forces weighting coefficients in w to
decrease when they relate to less contributing variables of the problem.
It however does not set them to zero, unlike the Lasso Regression [29].
By solving VJ(w) = 0, it can be shown [17] that the w coefficients are:

w= (X’X+yl) X7y. (8)
The estimation of a new sample y’ located at x’ is then:

Fig. 3. Scheme of the numerical setup (a):
immersion inspection using an array trans-
ducer placed 20 mm above the surface;
Inconel-based V-shape weld mockup with 3
side-drilled holes at depths 20 mm (1), 30
mm (2) and 40 mm (3) from the surface; the
holes are spaced 20 mm apart along the
azimuthal axis and are of 2 mm diameter.
Slowness curves (b): quasi-longitudinal wave
inside the weld with an orthotropic crystal
structure (green) and longitudinal wave in-
side an isotropic medium with velocity 5500
ms! (orange). The 0° angle corresponds to
the Z axis in the setup schema and the 90°
angle to the X axis. In Table (c): actual values

Actual values of the unknown properties. (For interpreta-

 

 

. od)
‘ O (2)
Inconel *, O (
(a)
0.15 0.1 0.05
90° 90°
\ Cy GPa
o° i /
& C13
of
x

 

—_|_ — Reference
0°
Slowness (s.m7!)

 

Isotropic

(b) O (°)

(

(
“45ND 7 C3 (GPa
Css (GPa

tion of the references to color in this figure
legend, the reader is referred to the Web
version of this article.)

) 264
) 140
) 247
) 112
8.0

 
C. Ménard et al.
y=w'x’ =y’ (Xx? + pl) Xx’. (9)

The Kernel Ridge Regression associates the Ridge Regression with the
“kernel trick” to transform the linear regression into a non-linear one.
Let us consider any variable change applied to the i-th parameter x;—>
@(x;). Let us also define an inner product Ky) = ®(x;,)®(x;), where k and l
refer to training sample indices. One can show [30] that Eq. (9) becomes

y =y’(K+yl'k, (10)

where a component x, = x,x’. Consequently, the variable change is of
no concern to perform the regression, only the inner product is required.
This property is called the “kernel trick”. The choice of the kernel de-
pends on the addressed problem.

The choice of the database is a matter of trade-off between the
desired sampling step of the database and the computational cost of the
KRR. In the present case, a regular grid is chosen for its simplicity. A
preliminary study of sections of the 5D space revealed that the variations
of the Amax estimator are qualitatively rather smooth along each
dimension. Moreover, in most cases a loose grid is sufficient as the KRR
benefits from the prior knowledge provided by the kernel choice. It is
found that a database sampling of 10 GPa for the elastic constants and 0.
7° for the tilt angle is sufficient for describing the Amax variations with
satisfactory accuracy. Complexity-wise, the Scikit-learn implementation
uses a Singular Value Decomposition to compute the pseudo-inverse in
Eq. (10), with a computational complexity about O(M7), where M is the
number of samples [31]. A database sampled with M = P? = 16 807
samples is chosen, i.e., P = 7. The limits of the database space are given
in Table 1. They are set in order to provide a sufficiently large explo-
ration area while including the actual material properties.

The choice of the hyper-parameters of the KRR (ridge regularization
term, kernel type and kernel parameters) is a trade-off between the ac-
curacy of the regression and the reliability of its prediction to unseen
data (bias vs variance). The aforementioned database of 16 807 samples
is used in a threefold cross-validation procedure, where 80% of the
samples are randomly chosen to train the KRR, and the remaining 20%
are left for testing the prediction. This method helps avoiding overfitting
and selection bias. The best kernel is then chosen by trials and measuring
the corresponding errors: for each threefold cross-validation, the design
and hyper-parameters of the kernel are modified and a score is given to
quantify the model error. To quantify the accuracy of the regression and
the reliability of the prediction, the coefficient of determination (noted
R’) metric is used during the training and testing phases. Let us define
the mean of the observed data used for the training/testing phase: y =
mm 1 Yis Where mo < M is the number of samples. The coefficient of
determination for the prediction is given by

SSres
Re =1-—* 11
SStot’ 1)
where the residual sum of squares of the prediction is
SStes = Soi —_ yi), (12)

while the total sum of squares is
Table 1

Upper and lower boundaries of the weld parameter space to compute the KRR-
based surrogate model.

Parameters Lower bounds Upper bounds
C11 (GPa) 230 290

C13 (GPa) 90 150

C33 (GPa) 230 290

Cs5 (GPa) 70 130

0) 6 10

NDT and E International 116 (2020) 102327

SS = Yo(vi — YY. (13)

The aim is then to find the kernel design that provides the best co-
efficients of determination for both the regression on the training data
and the prediction on testing data. The closer the R? score to 1 (by lower
values), the better the regression/prediction. The input data X are
standardized to have a null mean value and a unit variance for each
dimension of the problem. This way, none of the dimensions has a
variance larger than the others that could dominate the R? score. The
output y, obtained by simulation, exhibit values that are of unit order.
The best kernel design, compared with linear and polynomial, is found
to be a Gaussian one:

K (x,x7) =exp( — olla, — x\[°) (14)

with o = 3.162-10~* and with a regularization parameter j = 1 for the
ridge penalization. The corresponding training and testing scores are
R*train = Rtest ~ 1.0. The respective exploration range of the o and
hyper-parameters were set to [10~°,10'] and [10~7, 107] with a 0.25
logarithmic step size.

In order to validate the best KRR model, a comparison between
actual unseen samples (i.e., new values of Amax obtained from simu-
lations with CIVA) and their KRR estimates was conducted. The com-
parison was made using a set of 5000 new samples generated with a
Latin hypercube in the weld parameters space. We recall that Amax is
the maximum amplitude of the TFM image in a 10 x 10 mm? region that
only contains the reflector n°2. The actual and estimated Amax values
are normalized and plotted in Fig. 4. The regression is accurately ach-
ieved with a mean absolute error equal to 2.4 + 2.8% for predicting on
unseen samples and can now be substituted to CIVA for generating new
[x, y] samples.

3.3. Sobol sensitivity analysis

Thanks to the KRR, we now have a model .# such that y = W(x),
with x € R!*? the position vector of y in the D-dimensional space. A
sensitivity analysis can then be conducted using Sobol indices [32]. The
aim of this analysis is to quantify the contribution of each input

parameter x”) € R(1 < p < D), or combinations of input parameters, on

 

x KRR estimations
0.8 Actual values
oO
2
3
= 0.6 4
SS
S
x
oO
S o44
Se
S
—
Oo
= o24

 

 

 

0.2 0.4 0.6 0.8
Normalized amplitude

Fig. 4. Comparison between the actual values of the image quality descriptor
Amax (blue solid line) with the estimated values given by the Kernel Ridge
Regression surrogate model (red dots), using 5000 new samples computed by
simulations and randomly generated. (For interpretation of the references to
color in this figure legend, the reader is referred to the Web version of
this article.)
C. Ménard et al.

the variance of the output y € R. In our case, this means identifying the
most relevant material properties for governing the variations of the
Amax descriptor. The analysis is performed using the Python’s library:
SALib [33].

Three kinds of Sobol indices are derived. The higher the index value,
the higher the contribution of the input(s). The first-order indices do
indicate the contribution of an input parameter x”) when it is the only
one to vary:

P Var(y) (15)

The second-order indices indicate the effect of two parameters x”)
and x varying at a time, with p ¥ q:

_ Var [E(y|x”), x ) _ E(y|x” ) _ E(y|x@) ) )

Pq Var(y) (16)

 

Finally, total-effect indices provide information on the overall
contribution of a single input parameter. They take into account the
first-order indices and all higher orders with which the parameter of
interest is involved:

Stp = Sp + S Sng + S- So.gur +... + S12... py. D. (17)
q#P qs
q1FP

In each equation, p, g and r refer to one component of the x vector.

The results of the sensitivity analysis are provided in Fig. 5: for
readability, only indices with values greater than 5-10-° are shown,
which is why C7; is not present. It is observed that the most contributing
parameters to the optimization problem are C55 and C3. The main part
of their contributions comes from their first-order index. The remaining
arises from their interactions with other parameters. The elastic
component C33 contributes in a lesser way to the variance of Amax,
although its contribution is mainly related to its interactions with Cs55
and C;3. Finally, both @ and Cj, exhibit little contributions to the
problem, especially the latter. From these observations, one can deduce
that only Cs5, Ci3 and C33 do have a major contribution to the variance
of Amax, while 6 and C,; could be discarded. It is also noted that the sum
of the indices is not equal to unity: this is due to the 5 input parameters
not being fully uncorrelated [34].

However, the correct location of the echo has also to be considered.
In order to illustrate the effect of the 5 parameters on the echo position,

Sobol indices

me Total indices
mms irst order

mmm Second order

 

0.0 0.2 0.4 0.6 0.8 1.0
Values

Fig. 5. First-order, second-order and total-effect Sobol indices of the optimi-
zation problem. Only the indices whose value is above 5-10~° are displayed.
The others are considered too low to contribute to the Amax variance.

NDT and E International 116 (2020) 102327

images are uniformly and randomly generated by varying the input
parameters inside the database delimited by the parameter values in
Table 1. Out of these images, the coordinates of the Amax pixel are
retrieved and displayed on a synthetic view in Fig. 6. This figure displays
a close-up around the side-drilled hole n°2, the latter being represented
by the black circle. Two cases are considered: (a) the positions of the
Amax pixel when only the three most contributing parameters (C13, C33
and Css) are varying, and (b) the positions when only the two less
contributing parameters (Cj; and 9) are varying. The red marker locates
the Amax pixel position in the image computed with the actual material
properties. Its Amax value is set to O dB and serves as reference ampli-
tude. The green markers represent the Amax pixels when
—3 dB < Amax < 0 GB. The blue markers are the Amax pixels for which
— 6 dB < Amax < — 3 dB. The black markers are the pixels when —
12 dB < Amax < — 6B. In Fig. 6a, the sensitivity of the position of
the echo to the three most contributing parameters is easily observable:
the markers create a scatter plot around the actual position of the echo
and indicate position errors up to 5 mm. Moreover, it can be observed
that the set of points is globally arranged in three separated sub-
domains, which demonstrates the existence of a relation between
Amax and the correct position of the echo: the highest Amax (green
markers) are located in the sub-domain including the actual echo posi-
tion. In Fig. 6b, the variations of the echo position with respect to var-
iations of the two less contributing parameters are also visible. The
variation pattern is explained by C); only contributing to the wave speed
variations along the X axis of the crystalline structure, which is tilted by
9. The variation range of the latter is small enough around the actual
value for the markers to form this pattern. The position error of the echo
is up to 4 mm and the colored labels are again delimited in space.
Therefore, even if they exhibit tiny contributions to the variations of the
Amax value, Ci; and @ do have an effect on the location of the defect
echo. For this reason, these two parameters cannot be discarded from
the optimization procedure.

It is interesting to discuss the distribution of the green markers,
which are to represent the most optimized echo position with respect to
Amax. The pattern shows that an individual optimization may lead to a
wrong echo positioning, as the standard deviation of the distribution is
quite large. However, if we consider the green markers as a swarm and
take its average position, we now obtain a fair estimate of the actual
defect position, while reducing the risk of reaching an outlier. Thus,
during the optimization procedure, the GAO needs to be averaged over
several trials in order to give a correct estimate of the echo position.

It should also be noted that the results of this sensitivity analysis are
strongly case-dependent. For a given material, the values of Sobol
indices may vary depending on the parameters of the inspection
configuration, such as the aperture of the array, its frequency, or its tilt
angle for oblique incidence imaging. In the present case, the indices
would also be different if the analysis were performed with flaws located
away from the transducer central axis, and especially with flaws located
beyond the array aperture. Wherefore, the aforementioned results
cannot be taken as ground truth: they are dependent on this specific
study, for which we only intend to focus the optimization around the
flaw n°2 in the mockup.

3.4. Particle swarm optimization

For reminder, the Particle Swarm Optimization (PSO) algorithm is
implemented to assess the good convergence of the GAO algorithm. The
PSO is a global optimization tool proposed by Kennedy and Eberhart
[18,19] that was applied to the learning phase of neural networks. A
swarm of particles is randomly initialized and evolves in the solution
space. The displacement of each particle is dependent on its previous
inertia, on the best recorded position during its past displacements, and
on the best position of the whole swarm. Let us consider the swarm of
particles represented by the position matrix X; in the D-dimensional
space, at optimization step j. The swarm obeys
C. Ménard et al. NDT and E International 116 (2020) 102327

OK rom,
ihe,

Amax;er (0 dB)

-3 dB < Amax < 0 dB
-6 dB < Amax < -3 dB
-12 dB < Amax < -6 dB

Amax;er (0 dB)

-3 dB < Amax < 0 dB
-6 dB < Amax < -3 dB
-12 dB < Amax < -6 dB

 

X (mm)
(b)

Fig. 6. Illustration of bad material properties estimation on the positioning of the maximum amplitude of the echo with randomly generated images: (a) variations of
the most contributing parameters (C;3, C33 and Css) and variations (b) of the less contributing parameters (C;; and @). Position of the Amax pixel in the image
computed with the actual material properties (red marker); positions of Amax pixels for —3 dB < Amax < 0 dB (green markers); positions for — 6 dB < Amax < —
3 dB (blue markers); positions for —12 dB < Amax < —6 dB (black markers). (For interpretation of the references to color in this figure legend, the reader is referred

 

to the Web version of this article.)

Xiu = Xj + Via, (18)
where V;,; is the inertia of the particles at step j+ 1:

Vier = av; + B(Q, _ X;) + 7(Q, _ X;) (19)

Q, contains the best particle positions: best positions found by each
particle on its path. Q, is the best swarm position: best position ever
found by the whole swarm. The a, 6 and y coefficients are chosen in
order to penalize or not the displacement of a particle with respect to Q,
and Q,. Vo is usually set to be null. This algorithm is based on the
collaboration of individuals to reach a common goal and mimics the
auto-organization behavior of a flock of birds.

Both implementation and customization of this algorithm are easily
achieved and the hyper-parameters tuning phase does not require much
effort. PSO is able to handle optimization problems with many di-
mensions and still provides a fast convergence. In this study, the PSO is
used in its simplest form, thanks to the optimization problem having
only 5 dimensions. Several extensions can be found in the literature to
enhance the PSO: cluster of swarms [35], particle confinement [36],
dynamic inertia coefficient [37], hybridization [38], etc.

In the following, the convergence of the swarm is controlled by the
standard deviation along each dimension of the position matrix X; and
by the standard deviation of the associated y,, while it searches for the
maximum Amax value. The optimization stops when one of the super-
vised standard deviation reaches a selected threshold.

3.5. Results and discussion

The statistical analysis was conducted with 100 trials of the opti-
mization algorithms (GAO and PSO) and using the KRR surrogate model
previously defined. In the case of the GAO, the maximum number of
restarts is set to 10. In the case of the PSO, the swarm is composed of 100
particles and the optimization stops when the standard deviation of X; is
inferior to 1 GPa for the Cj and 0.1° for 6, or when the standard devi-
ation of Y; is inferior to 0.1. The values of the hyper-parameters for the
two algorithms are indicated in Table 2. For PSO, the values of a, B, and y
were chosen based on the study in [39]. The mean error on the material
property estimates is computed with respect to the actual material

Table 2

Hyper-parameter values for both GAO and PSO algorithms.
GAO PSO
J 15 a 0.5
No (Cy) 10 GPa B 0.5
No (0) 0.5° y 0.5

properties. These values are averaged over the 5 dimensions of the
problem. The average error of the GAO is 7.5 + 6.4% while it is 7.3 +
7.8% for the PSO. When compared to the actual material properties,
both GAO and PSO give fair estimates. These non-negligible errors were
expected as the optimization problem is ill-posed. We modify 5 material
properties to account for the wave velocity in the medium during the
optimization. To illustrate that the non-uniqueness of the solution is not
an issue, the slowness curves of the QL waves are presented along with
their corresponding errors in Fig. 7. The error with respect to the actual
slowness is inferior to 1.5% with either GAO and PSO. Consequently, the
optimization is validated when estimating the unknown anisotropic
homogeneous material properties of the inspected structures.

The 100 trials results are averaged to compute the optimized TFM
images. As the anisotropy is homogeneous, the elastic parameters
coming from the optimization procedure around defect n°2 can be used
to compute a large TFM image involving the three defects and the
backwall, as shown in Fig. 8. For comparison purposes, the images
relying on an isotropic medium assumption and on the actual material
properties are also exhibited. The isotropic velocity used to compute the
image is 5500 ms +, which corresponds to the elasticity constants C1; =
C33 = 260 GPa, Ci3 = 100 GPa and Css = 80 GPa. With this sound
speed, the backwall echo is almost well positioned with respect to its
actual position. Both GAO and PSO provide high quality optimized
images. The lateral spreading of the defect echoes is significantly
reduced and the positioning of the defect and backwall echoes is correct,
with respect to the reference image computed with the actual parame-
ters. To better appreciate the image improvement in terms of position
and width of the echoes, the horizontal and vertical echodynamic curves
are also displayed in Fig. 8. These curves represent the evolution of the
C. Ménard et al.

 

NDT and E International 116 (2020) 102327

 

   

 

Slowness (s.m-!) Error (%
ig? vis ts E ) 0.5 i Y) 2.0. Parameters | Actual values | GAO | PSO
a" aN | 90°

C1, (GPa) 264 263 264
3 (GPa) 140 120 114
3 (GPa) 247 253 250
Reference 0° 5 (GPa) 112 118 125

— GAO --=—: GAO error
— pso sey POU eer 6 (°) 8.0 6.8 7.6

(a)

 

 

 

(b)

Fig. 7. Slowness curves of the Quasi-longitudinal waves and corresponding errors (a): slowness with the actual material properties (green), hidden by GAO results
(blue) and PSO results (red); slowness estimation error with GAO (dashed blue) and with PSO (dashed red). Corresponding actual and optimized material properties
values (b). (For interpretation of the references to color in this figure legend, the reader is referred to the Web version of this article.)

maximum amplitude along the X axis (horizontal echodynamic curve)
and along the Z axis (vertical echodynamic curve). For each case, the
amplitudes are normalized with respect to the Amax value around side-
drilled hole n°2. The horizontal echodynamic curve is extracted without
taking into account the backwall echo. Orange dashed lines highlight the
position of defect n°2 around which the optimization was performed.

We observe that both GAO and PSO optimized images look very
similar to the reference image computed using the actual material
properties. There is a small shift of the backwall and flaws echoes with
respect to their actual positions. However the increase of the image
quality is clearly visible. One also observes that the backwall between
—25 mm and —15 mm along the X dimension is not visible. This is due to
the crystalline structure being tilted of 8° around the Y axis.

Quantitatively, the correlations between GAO and reference images,
and between PSO and reference image, are very strong. The value of the
correlation coefficient is almost 1.0 in both cases. With respect to the
image computed with an isotropic assumption, the amplitude gain of
both GAO and PSO images is +13 dB for defect n°2, i.e., the same
amplitude gain obtained with the actual anisotropy parameters (+13
dB). In terms of the Amax descriptor, both algorithms perform well to
produce optimized images. Moreover the positioning errors, given in
Fig. 9, illustrate that both algorithms yield a satisfactory estimate of the
actual position of the flaw. The errors are computed for each one of the
100 trials and averaged. With the GAO, the error is inferior to 1.1 + 0.9
mm for lateral positioning and inferior to 0.7 + 0.5 mm for depth
positioning. With the PSO, the error is inferior to 0.4 + 0.4 mm for
lateral positioning and to 1.1 + 0.7 mm for the depth positioning. Once
again, these errors are due to the non-uniqueness of the solution and to
the fact that no constraint is set about the echo position during the
optimization. As previously mentioned, averaging several trials of
optimization helps at estimating the actual position of the defect in the
structure, though negligible uncertainties remain.

Thereby, the optimization procedure appears to be robust and reli-
able. It is able to correct the degradation of a TFM image inside an un-
known structure and provide fair estimates of the unknown material
properties in the case of homogeneous anisotropy. The accuracy of the
results is satisfactory, given that the image quality description is based
on only one single scalar criterion. The good convergence of the GAO is
assessed when compared to the PSO results: estimation and defect
localization are obtained with almost the same values and errors, and
are close to the actual material properties and the associated TFM image.

4. Experimental results with homogeneous anisotropic samples
Now that the robustness and the reliability of the optimization have

been discussed, two experimental cases are considered. The first case is
the Inconel 182 V-shape weld (p = 8.26 g.m °) that served as template

for the previous numerical study. The inspection configuration remains
unchanged compared to the setup in Fig. 3 (immersion linear array
centered on defect n°2 with a water column height of 20 mm) and the
ROI for the optimization procedure is again a 10 x 10 mm? area centered
on defect n°2. The second experimental case is an isotropic ferritic steel
covered by an anisotropic 316L stainless steel layer (p = 7.96 g.m ). As
shown in Fig. 12 the inspection is also conducted in immersion, and the
optimization procedure consists in maximizing the image amplitude ina
10 x 10 mm? area centered on defect n°1 (1.5 mm diameter), which is
the closest to the cladding layer.

The anisotropy of both structures is assumed to be homogeneous and
only 5 parameters are of interest during the optimization. The elastic
parameters to vary are the same as for the numerical study (C11, Ci3, C33
and C;5). For the V-shape weld, the fifth parameter is the angular shift 0
of the crystal structure around the Y axis, while for the cladded
component the fifth parameter is the anisotropic layer thickness, noted
h. All the experimental results presented hereafter are obtained after
averaging 100 GAO trials or 100 PSO trials with 100 particles, and using
the same values of hyper-parameters as in the numerical case (Table 2).

The data acquisitions were performed with a multichannel Multi-
X++™ (Eddyfi Technologies, Canada) and a 5 MHz linear array (Ima-
sonic, France) composed of 64 elements of 0.5 mm width and with a 0.6
mm pitch. The array elements were excited with a rectangular-type
electric pulse whose time length is 0.2 ps, and signals were digitized
with a sampling frequency of 100 MHz.

A short remark should be added concerning the computation times.
With the CIVA software, a TFM image of size 51 x 101 pixels requires
0.83s to be computed (50 images per minute). Therefore, with the
aforementioned hyper-parameters of the algorithms, one GAO trial lasts
around 35 min and one PSO trial lasts around 42 min. A complete run of
100 GAO then requires 2.5 days, while a complete 100 PSO run needs 3
days. These values are given only for indication purpose as no efforts are
made here to reduce the computational cost.

4.1. Optimization of images in an Inconel V-shape weld

As in the previous section dedicated to simulations, Fig. 10 displays
the TFM images computed with isotropic reconstruction model (a), with
the actual anisotropy (b), with GAO (c) and with PSO (d). Once more, we
observe that the optimization procedure is able to improve the image
quality. The image degradation due to the isotropic assumption is cor-
rected and the final images are very similar to the one computed with
the actual material properties. The Amax increase around defect n°2,
compared to its value in the isotropic assumption image, is of +10 dB for
the images obtained with GAO and PSO, which is the same as the image
computed with the actual anisotropy (+10 dB). The positioning error of
defect n°2 is inferior to 0.6 + 0.4 mm along the X axis and inferior to 0.8
C. Ménard et al.

 

NDT and E International 116 (2020) 102327

 

 

 

a
0 0
m9 faa
3 3
—25 —25
20 20
— 30 | = —~ 30 _
& &
= =
N40 N40 _
50 50
-20 -10 0 10 20 25 0 -20 -10 0 10 20 25 0
Ds (mm) dB xX (mm) dB
C d
0 0
m9 rm
= 3
—25 —25
20 | en 20
-—~ 30 C———— —~ 39
& =
= =
N40 _ N40
50 50
-20 -10 0 10 20 25 0
X (mm) dB
—35 —30 —25 —20 —15 —10 —5 0

Amplitude (dB)

Fig. 8. TFM images with simulated signals in the Inconel V-shape weld: isotropic reconstruction model (a), actual properties (b), gradient-based optimization (c),
particle swarm optimization (d). The black line at the bottom of the images indicates the backwall interface. The red circles represent the side-drilled holes. The
horizontal and vertical curves are echodynamics corresponding to the maximum amplitude along each axis. The orange dashed lines highlight the coordinates of the
maximum amplitude (Amax estimator) for defect n°2. Each image is normalized by the maximum amplitude measured in the 10 x 10 mm? region around side-drilled
hole n°2 (i.e., the amplitude of the echo of defect n°2 is 0 dB for the four images). (For interpretation of the references to color in this figure legend, the reader is

referred to the Web version of this article.)

+ 0.5 mm along the Z axis with GAO. Respectively, the error along X is
inferior to 0.5 + 0.9 mm and to 0.3 + 0.6 mm along Z with PSO. Once
again, the optimization provides high quality images of the inside of the
structure, with uncertainties similar to those obtained with simulated
signals. The values of the estimated weld parameters, along with cor-
responding slowness curves and their errors, are given in Fig. 11. The
estimation error is of 5.5 + 7.8% with GAO and of 6.7 + 8.4% with PSO,
and the errors of the associated slowness curves are inferior to 1.0% and
3.1% for GAO and PSO, respectively. These results are again comparable
to those obtained with simulated signals and validate the procedure to
yield fair estimates of unknown properties in structures with homoge-
neous anisotropy.

From these results, one may ask whether the above estimation errors
can be further reduced by using another estimator of image quality that
includes more information, such as the noise level or the surface of the
echo at —6 dB. This is why a complementary study was conducted by
defining two other parameters: the Signal-to-Noise Ratio defined by

SNR = 20log,)(Amax/Anoise), where Anoise is the RMS value of the
noise (amplitudes below —12dB with respect to Amax) around the defect
echo; and the Echo Spreading Estimator, defined by ESE = Amax/S_¢gg,
where S_¢qg is the surface of the echo at —6 dB. From a set of 5000
images, the aforementioned estimators were extracted. Then, the cor-
relation coefficients of the variations of these estimators across the set of
points are computed with respect to the Amax criterion. Between Amax
and SNR, the correlation coefficient is 0.99, while between Amax and
ESE, it is 0.94. The variations of SNR and ESE are consequently almost
perfectly correlated to Amax, and cannot bring more relevant informa-
tion to reduce the optimization errors. In other words, Amax and SNR
can be interchanged when describing the quality improvement in the
experimental images.

The optimization gives good final results but the echo of defect n°3,
the deepest one, is always degraded. The image of this defect after
optimization around defect n°2 was correct with the simulated data (see
Fig. 8), but not from the experimental point of view because the material
C. Ménard et al. NDT and E International 116 (2020) 102327

 

 

0.2

 

 

 

 

Standard deviation (mm)

Error (mm)
x
N
~
N
Standard deviation (mm)
Error (mm)

0.0
Mean error Standard Mean error Standard

deviation deviation

(a) (b)

Fig. 9. Histogram of the positioning error of the echo of defect n°2 with respect to the reference echo computed with the actual anisotropy parameters: GAO (a) and
PSO (b). The blue and orange bars indicate the mean error of positioning along the X and Z axes, respectively, after 100 optimization trials. The dark cyan and dark
red bars indicate the standard deviation of the mean error of positioning along the X and Z axes, respectively. (For interpretation of the references to color in this
figure legend, the reader is referred to the Web version of this article.)

 

a b
0 0
~25 i
20 20
& &
& =
ee” ~~”
N40 N40
50 50
-20 -10 0 10 20 25 0 -20 -10 0 10 20 25 0
X (mm) dB X (mm) dB

dB

—25

20

30

Z (mm)
i | |

Z (mm)
Ae | |

50
-20 -10 0 10 20 -25 0 -20 -10 0 10 20 -25 0
X (mm) dB X (mm) dB
EE
—35 —30 —25 —20 —15 —10 —5 0

Amplitude (dB)

Fig. 10. TFM images with experimental signals in the Inconel V-shape weld: isotropic reconstruction model (a), actual properties (b), gradient-based optimization
(c), particle swarm optimization (d). The optimization is conducted around defect n°2. Each image is normalized by the maximum amplitude measured in the 10 x
10 mm? region around side-drilled hole n°2 (i.e., the amplitude of the echo of defect n°2 is 0 dB for the four images).
C. Ménard et al.

Error (%)
10 15

Slowness (s.m‘)

0.05 0.5 2.0

 

Parameters

NDT and E International 116 (2020) 102327

GAO | PSO

Actual values

 

02 O15 OL
90°

 

 

90°
Reference 0°
(AS) --=-' GAO error
—— PSC ==—=<« PSO error
(a)

264 265 | 248

140 119 | 126

247 249 | 254

112 118 | 121

8.0 7.0 7.0

Fig. 11. Slowness curves of the quasi-longitudinal waves and corresponding errors in the experimental V-shape weld case (a): actual material properties (green),
hidden by GAO results (blue) and PSO results (red); slowness estimation error with GAO (dashed blue) and with PSO (dashed red). Corresponding actual and
optimized material properties values (b). (For interpretation of the references to color in this figure legend, the reader is referred to the Web version of this article.)

is not strictly homogeneous. A way of improvement would be to consider
the medium as a dual layer material. The image of the first two flaws
would be optimized by varying the properties of the first layer. The third
flaw and the backwall would then be addressed in a second optimization
considering the other layer.

4.2. Optimization of images in a cladded ferritic steel

In this experimental case, a ferritic steel is cladded by an anisotropic
layer of 11.5 mm thick. The experimental setup is schematized in
Fig. 12. The optimization procedure is applied with the ROI centered
around flaw n°1 at 15.5 mm from the surface. The final images are
displayed in Fig. 13: computed with an isotropic reconstruction model
(a), with the actual anisotropy (b), with GAO (c) and with PSO (d). These
results once again show the high quality of the final images obtained
through the optimization procedure. The values of Amax around defect
n°1 in the images obtained with GAO and PSO are 10 dB higher than the
value in the image computed with the isotropic assumption, while the
Amax value is 9 dB higher in the image computed with the actual ma-
terial properties. The position of defect n°1 is accurately estimated, with
errors inferior to 0.1 + 0.1 mm along the X axis and to 0.17 + 0.15 mm

Anisotropic layer:

Ferritic steel

Fig. 12. Scheme of the experimental setup: immersion inspection with a
transducer array placed 20 mm above the surface; ferritic-based steel mockup
with 5 side drilled holes at depths 15.5 mm (1), 23.5 mm (2), 31.5 mm (3),
39.5 mm (4) and 47.5 mm (5) from the surface and of 2.0 mm diameter.
Anisotropic cladding of 11.5 mm thickness and assumed to be homogeneous.

11

along the Z axis with GAO, and errors inferior to 0.1 + 0.1 mm along the
X axis and to 0.53 + 0.27 mm along the Z axis with PSO. In this case,
GAO gives a better estimation of the defect position than PSO.

The interest of this case is to show that the optimization procedure is
able to manage unknown parameters of two different natures: four relate
to the elastic behavior of the material, while the fifth relates to the ge-
ometry of the structure. The estimation of the cladding parameters and
the associated slowness curves, together with their corresponding er-
rors, are provided in Fig. 14. Using GAO, the estimation error of the
material properties is 3.2 + 6.2% and the slowness estimation error is
less than 1.5%. With PSO, the errors are 5.9 + 11.9% for the estimation
the cladding parameters and less than 2.3% for the associated slowness
curve. This efficiency of the optimization is again demonstrated,
although this last case exhibits higher error rates when estimating the
cladding parameters. This may be explained by the fact that the actual
material properties are subject to measurement uncertainties and may
not be perfectly accurate. Therefore, we can conclude that this test case
also validates the optimization procedure.

It is worth noticing that the homogeneity assumption to describe the
whole anisotropic layer works well for the cladded sample, contrary to
the V-shape weld case where a dual layer medium could be a better
description of the structure. Also, a shadowing effect is observed for
defects 2-5, and an optimization around one of these defects requires a
different experimental setup (array with a larger aperture or not
centered on the line of defects).

5. Conclusion

The feasibility of an adaptive procedure for TFM imaging in un-
known anisotropic homogeneous structures was investigated in the case
of point-like defects. A numerical study showed that the Gradient Ascent
Optimization proposed herein yields good results, with very satisfactory
accuracy both for imaging and characterization, given the actual ma-
terial properties and the associated image. Its robustness and reliability
were evaluated, although the optimization problem was ill-posed due to
non-uniqueness of the solution. The positions of the echoes were in good
agreement with the actual positions of the reflectors, despite the opti-
mization being only constrained by the Amax image quality descriptor.
The good convergence of the algorithm was also verified by comparing
with the results of a Particle Swarm Optimization.

Experiments conducted with two nuclear steel components validated
the procedure and exhibited good final results. It was however observed
that the homogeneity assumption can be too strong in some cases.
Further developments are needed to extend the method to more complex
materials, exhibiting inhomogeneous anisotropic properties, and to
C. Ménard et al. NDT and E International 116 (2020) 102327

a b

dB

—25
10

20

30

AQ)

Z (mm)

50

 

 

—20 —15 —10 —9 0
Amplitude (dB)

Fig. 13. TFM images with experimental signals in the cladded ferritic steel component: isotropic reconstruction model (a), actual properties (b), gradient-based
optimization (c), particle swarm optimization (d). The optimization is conducted around defect n°1. Each image is normalized by the maximum amplitude
measured in the 10 x 10 mm? region around side-drilled hole n°1 (i.e., the amplitude of the echo of defect n°1 is 0 dB for the four images).

12
C. Ménard et al.

  

 

Slowness (s.m7!) Error (%)

0.2 0.15 O.1 0.05 0.5 10 1.5 2.0
—9(0)° SL Ree 90°
e°
WM
LL
aD
S
=e

Reference 0°
— CAO --=: GAO error
— Pso --=-: PSO error

(a)

    
    
   
   
   
   

Parameter

NDT and E International 116 (2020) 102327

     

Actual values
258
148 122
240 240
125 124

11.5 11.4

(b)

Fig. 14. Slowness curves of the quasi-longitudinal waves and corresponding errors in the experimental cladded component case: actual material properties (green),
hidden by GAO results (blue) and PSO results (red); slowness estimation error with GAO (dashed blue) and with PSO (dashed red). Corresponding actual and
optimized material properties values (b). (For interpretation of the references to color in this figure legend, the reader is referred to the Web version of this article.)

welds with various chamfer geometries. It is also planned to extend this
study to the TFM imaging of crack-like defects or lacks of fusion that are
typically found on the weld chamfers.

CRediT authorship contribution statement

Corentin Ménard: Conceptualization, Software, Writing - original

draft, Validation, Methodology. Sébastien Robert: Conceptualization,
Validation, Methodology, Supervision. Roberto Miorelli: Validation,
Supervision, Formal analysis. Dominique Lesselier: Supervision,
Validation.

Declaration of competing interest

The authors declare that they have no known competing financial

interests or personal relationships that could have appeared to influence
the work reported in this paper.

Acknowledgment

This study is part of European project ADVISE, that has received

funding from the Euratom research and training programme 2014-2018
under grant agreement No 755500. The authors would like to thank the
ADVISE project partners, with special credits to Electricité De France
(EDF) for providing mock-ups to all consortium partners.

Appendix A. Supplementary data

Supplementary data to this article can be found online at https://doi.

org/10.1016/j.ndteint.2020.102327.

References

[1]

[2]

[3]

[4]

[5]

[6]

Holmes C, Drinkwater BW, Wilcox PW. The post-processing of ultrasonic array data
using the total focusing method. Insight Non-Destruct Test Condit Monit 2004;46
(11):677-80.

Prada C, Fink M. Eigenmodes of the time reversal operator: a solution to selective
focusing in multiple-target media. Wave Motion 1994;20:151-63.

Fink M, Cassereau D, Derode A, Prada C, Roux P, Tanter M, Thomas JL, Wu F.
Time-reversed acoustics. Rep Prog Phys 2000;63(12):1933-95.

Le Jeune L, Robert S, Dumas P, Membre A, Prada C. Adaptive ultrasonic imaging
with the total focusing method for inspection of complex components immersed in
water, 41st Annual Review of Progress in Quantitative Nondestructive Evaluation,
Boise, USA. AIP Conf. Proc., vol. 1650; July 2014. p. 1037-46. 2015.

Hoyle E, Sutcliffe M, Charlton P, Rees J. Virtual source aperture imaging with auto-
focusing of unknown complex geometry through dual layered media. NDT E Int
2018;98:55-62.

Robert S, Calmon P, Calvo M, Le Jeune L, Iakovleva E. Surface estimation methods
with phased-arrays for adaptive ultrasonic imaging in complex components, 41st

13

[7]
[8]
[9]

[10]

[11]

[12]

[13]

[14]

[15]

[16]

[17]

[18]

[19]

[20]

[21]

[22]

[23]

[24]

[25]

Annual Review of Progress in Quantitative Nondestructive Evaluation, Boise, USA.
AIP Conf. Proc., vol. 1650; July 2014. p. 1657-66. 2015.

Zhang J, Drinkwater BW, Wilcox PD, Hunter AJ. Defect detection using ultrasonic
arrays: the multi-mode total focusing method. NDT Int 2010;43(2):123-33.
Gengembre N, Lhémery A. Pencil method in elastodynamics: application to
ultrasonic field computation. Ultrasonics 2000;38:495-9,

Pudovikov S, Bulavinov A, Pinchuk R. Innovative ultrasonic testing (UT) of nuclear
components by sampling phased array with 3D visualization of inspection results,
JRC-NDE 2010 8th international conference on NDE in relation to structural
integrity for nuclear and pressurized components. Berlin, Germany. In: JRC
Scientif. Techn. Reports JRC 64886; April 2010. p. 910-7. 2011.

Juengert A, Dugan S, Homann T, Mitzscherling S, Prager J, Pudovikov S,
Schwender T. Advanced ultrasonic techniques for nondestructive testing of
austenitic and dissimilar welds in nuclear facilities, 44th annual review of progress
in quantitative nondestructive evaluation. Provo, USA. AIP Conf. Proc., vol.
110002; July 2017. 1949, 2018.

Chassignole B, Recolin P, Leymarie N, Gueudré C, Guy P, Elbaz D. Study of
ultrasonic characterization and propagation in austenitic welds: the MOSAICS
project, 41st annual review of progress in quantitative nondestructive evaluation,
boise, USA. AIP Conf. Proc., vol. 1650; July 2014. p. 1486-95. 2015.

Tant KMM, Galetti E, Curtis A, Mulholland AJ, Gachagan A. A transdimensional
bayesian approach to ultrasonic travel-time tomography for nondestructive testing.
Inverse Probl 2018;34(9). 095002.

Fan Z, Mark AF, Lowe MJS, Withers PJ. Nonintrusive estimation of anisotropic
stiffness maps of heterogeneous steel welds for the improvement of ultrasonic array
inspection. IEEE Trans Ultrason Ferroelectrics Freq Contr 2015;62(8):1530-43.
Zhang J, Hunter AJ, Drinkwater BW, Wilcox PD. Monte Carlo inversion of
ultrasonic array data to map anisotropic weld properties. IEEE Trans Ultrason
Ferroelectrics Freq Contr 2012;59(11):2487-97.

Stojakovic D. Electron backscatter diffraction in materials characterization. Process
Appl Ceram 2012;6(1):1-13.

Mark AF, Li W, Sharples S, Withers PJ. Comparison of grain to grain orientation
and stiffness mapping by spatially resolved acoustic spectroscopy and EBSD.

J Microsc 2017;267:89-97.

An S, Liu W, Venkatesh S. Face recognition using Kernel Ridge regression,
conference on computer vision and pattern recognition, Minneapolis, USA. In: Ieee
Conf. Comput. Vis. Pattern Recog; June 2007. p. 1-7. 2007.

Kennedy J, Eberhart R. Particle swarm optimization, int. Conf. On neural networks,
perth, Australia, November 1995. Ieee Int. Conf. On neural networks Proc., vol. 4;
1995. p. 1942-8.

Clerc M, Kennedy J. The particle swarm - explosion, stability, and convergence in a
multidimensional complex space. IEEE Trans Evol Comput 2002;6(1):58-73.
Lopez Villaverde E, Robert S, Prada C. Ultrasonic imaging of defects in coarse-
grained steels with the decomposition of the time reversal operator. J Acoust Soc
Am 2016;140(1):541—-50.

Gardahaut A, Jezzine K, Cassereau D, Leymarie N. Simulation of ultrasonic wave
propagation in welds using ray-based methods, 12th Anglo-French Physical
Acoustics Conference, Fréjus, France, January 2013. J. Phys.: Conf. Ser., vol. 498;
2014. p. 1-7.

Loshlilov I, Hutter F. SGDR: stochastic gradient descent with warm restarts, 5th
international conference on learning representations. France, Toulon, April 2017
arXiv 2017:1608.03983.

Ruder S. An overview of gradient descent optimization algorithms. arXiv 2016:
1609.04747.

Bengio Y. Practical recommendations for gradient-based training of deep
architectures. In: Neural networks: Tricks of the trade. second ed. Springer Berlin
Heidelberg; 2012. p. 437-78.

Smith LN. No more pesky learning rate guessing games. arXiv 2015:1506.01186.
C. Ménard et al.

[26]

[27]

[28]

[29]

[30]

[31]

Darmon M, Leymarie N, Chatillon S, Mahaut S. Modelling of scattering of
ultrasounds by flaws for NDT, ultrasonic wave propagation in non homogeneous
media. Springer Berlin Heidelberg; 2009. p. 61-71.

Royer D, Dieulesaint E. Elastic waves in solids I, Free and guided propagation.
Springer-Verlag Berlin Heidelberg; 2000. chap. 4.

Pedregosa F, Varoquaux G, Gramfort A, Michel V, Thirion B, Grisel O, Blondel M,
Prettenhofer P, Weiss R, Dubourg V, Vanderplas J, Passos A, Cournapeau D,
Brucher M, Perrot M, Duchesnay E. Scikit-learn: machine learning in Python.

J Mach Learn Res 2011;12:2825-30.

Tibshirani R. Regression shrinkage and selection via the Lasso. J Roy Stat Soc B
1996;58(1):267-88.

Saunders C, Gammerman A, Vovk V. Ridge regression learning algorithm in dual
variables, International Conference on Machine Learning. Madison, USA. In:
Proceedings of the 15th International Conference on Machine learning; July 1998.
p. 515-21. 1998.

Géron A. Hands-on machine mearning with Scikit-learn, Keras, and TensorFlow.
second ed. O’Reilly Media; 2019. chap. 4.

14

[32]

[33]

[34]

[35]

[36]
[37]

[38]
[39]

NDT and E International 116 (2020) 102327

Saltelli A, Ratto M, Andres T, Campolongo F, Cariboni J, Gatelli D, Saisana M,
Tarantola S. Global sensitivity analysis, the Primer. John Wiley and Sons; 2008.
chap. 4.

Herman J, Usher W. SALib: an open-source Python library for sensitivity analysis.
J Open Sourc Software 2017;2(9).

Li G, Rabitz H, Yelvington PE, Oluwole OO, Bacon F, Kolb CE, Schoendorf J. Global
sensitivity analysis for systems with independent and/or correlated inputs. J Phys
Chem A 2010;114(19):6022-32.,

El Dor A, Clerc M, Siarry P. A multi-swarm PSO using charged particles in a
partitioned search space for continuous optimization. Comput Optim Appl 2012;
53:271-95.

Eberhart R, Simpson P, Dobbins R. Computational intelligence PC tools. Academic
Press Professional; 1996.

Chatterjee A, Siarry P. Nonlinear inertia weight variation for dynamic adaptation
in particle swarm optimization. Comput Oper Res 2006;33:859-71.

Talbi EG. A taxonomy of hybrid metaheuristics. J Heuristics 2002;8:541-64.
Trelea IC. The particle swarm optimization algorithm: convergence analysis and
parameter selection. Inf Process Lett 2003;85:317-25.
