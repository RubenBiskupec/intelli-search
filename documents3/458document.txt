Designs, Codes and Cryptography (2020) 88:2597-2621
https://doi.org/10.1007/s10623-020-00804-0

®

Check for
updates

On the inverses of Kasami and Bracken-—Leander exponents

Lukas Kélsch'®

Received: 28 March 2020 / Revised: 8 September 2020 / Accepted: 11 September 2020 /
Published online: 6 October 2020
© The Author(s) 2020

Abstract

We explicitly determine the binary representation of the inverse of all Kasami exponents
K, = 27" — 2" +1 modulo 2” — 1 for all possible values of n and r. This includes as an
important special case the APN Kasami exponents with gcd(r,n) = 1. As a corollary, we
determine the algebraic degree of the inverses of the Kasami functions. In particular, we show
that the inverse of an APN Kasami function on F” always has algebraic degree wk ifn =0
(mod 3). Forn #0 (mod 3) we prove that the algebraic degree is bounded from below by 3.
We consider Kasami exponents whose inverses are quadratic exponents or Kasami exponents.
We also determine the binary representation of the inverse of the Bracken—Leander exponent
BL, = 27" +2" +1 modulo 2” — 1 where n = 4r and r odd. We show that the algebraic

degree of the inverse of the Bracken—Leander function is nt

Keywords Kasami exponent - Bracken—Leander function - Modular inversion - Algebraic
degree - APN functions

Mathematics Subject Classification 11T06 - 11Y99 - 94A60
1 Introduction

Vectorial Boolean function play a big role in cryptography because of their importance in the
construction of S-boxes in block ciphers. To ensure resistance against differential attacks,
S-boxes should have low differential uniformity [14].

Definition 1 A function f : Fan — F has differential uniformity d, if

d= max l{x: f(x) + f(x +a) = bd}.
El on

ack on,

 

 

 

 

 

 

A function with differential uniformity 2 is called almost perfect nonlinear (APN) on F:.

Clearly, the differential uniformity is always a multiple of 2 so APN functions have the lowest
possible differential uniformity and give the best protection against differential attacks. In

Communicated by P. Charpin.

EX) Lukas K6lsch
lukas.koelsch @ uni-rostock.de

University of Rostock, Rostock, Germany

Q) Springer
2598 L. Kolsch

 

Table 1 List of known APN exponents over Fyn with n = 2t + | up to inversion and cyclotomic equivalence

Exponent Conditions Algebraic degree Inverse determined in
Gold ar 4] ecd(r,n)=l1r <n/2 2 [14]
Kasami 227 or 41 gcd(r,n)=1r <n/2 r+ This paper
Welch 2' +3 3 [10]
t
Niho 222-1 t even 2 [10,15]
3t+1
27-272 -1 t odd t+1
Inverse 22t | n—1 Obvious
Dobbertin 24 +297 429742" -1 S5r=n r+3 [10]

addition to applications in cryptography, APN functions are connected to coding theory
and reversed Dickson polynomials [2,8,14]. Generally, finding families of APN functions is
difficult and remains a challenge in this research area. One of the best understood classes of
APN functions are APN monomials (see Table 1). If the monomial x t> x§,1<1<2"-2
is APN on 9, we call / an APN exponent on IF9n. We denote by wt(/) the binary weight
of /, i.e. the number of ones in its binary expansion. The binary weight of / is precisely the
algebraic degree of the function x +» x!. The algebraic degree is an important cryptographic
property since mappings with low algebraic degree are potentially more vulnerable to attacks
like higher-order differential attacks [9] or algebraic attacks [4]. It is well known that the
differential uniformity of a permutation is invariant under taking the inverse. In particular, if /
is an APN exponent and invertible in Z2n_, then the inverse / —! of 7 modulo 2” — 1 isan APN
exponent as well. We say that / and /’ are cyclomotic equivalent if l'! = 2'1 (mod 2” — 1)
for some 7. Differential uniformity is also invariant under cyclotomic equivalence. If / and
l' are cyclotomic equivalent then the binary representation of /’ is just a cyclic shift of the
binary representation of J. Additionally, if /’ is invertible modulo 2” — 1 then //~! = 27'/7!
(mod 2” — 1). To fully classify the APN monomials, it is thus necessary to determine the
inverse of the known APN exponents (if they exist). It is known that APN exponents are
invertible if and only if n is odd (see e.g. [1, Proposition 9.19]). Determining the explicit
binary representations of the inverses of the known APN exponents is thus an interesting
problem. The precise binary representations immediately also give the algebraic degree of
the function x +> x’. This has been done for all known APN exponents except for the
Kasami exponents (see Table 1). This paper will close this gap and find an explicit expression
for the inverses of all Kasami exponents (if they exist). We will also deal with the non-APN
Kasami exponents.

The objective is thus the following: Find the inverse of K, = 27” — 2" + 1 modulo 2” — 1
for all r,n. Compared to other APN exponents, determining the inverses of the Kasami
exponents is particularly challenging because they are independent from the field size. APN
exponents with this property are called exceptional APN exponents. It was shown in [6] that
Gold and Kasami exponents are the only exceptional APN exponents. Finding the inverses
of Gold exponents is relatively easy because of their low binary weight. In contrast, the
algebraic degree of the Kasami exponents is unbounded which makes the determination of
the inverses much harder.

In [10], a method to find the inverse of a fixed exponent / modulo 2” — 1 for arbitrary n
was given. This technique was used to determine the inverses of the second Kasami exponent
K2 = 13. Unfortunately, it is unclear how to use this approach to determine the inverses of

Q) Springer
On the inverses of Kasami and Bracken-Leander exponents 2599

 

Table 2 List of exponents yielding 4 differentially uniform permutations over Fyn with n = 2t up to inversion
and cyclotomic equivalence

 

Exponent Conditions Algebraic degree Inverse determined in
Gold 27 +1 t odd, gcd(r,n)=2r<n/2 2 [10], This paper
Kasami 277 2 +1 todd, gcd(r,n)=2r <n/2 r+ This paper
Inverse 2” —2 n—-1 Obvious
Bracken—Leander 27" +2" +1 4r=n,r odd 3 This paper

all (infinitely many) Kasami exponents. In fact, just determining the binary weight of the
inverses of Kasami exponents is mentioned as an open problem in [10].

As mentioned earlier, invertible APN exponents do not exist in even dimension. In fact,
no APN permutations in even dimension n 4 6 have been discovered yet, so permutations
in even dimension with differential uniformity 4 are of great interest and have been the
subject of much research. In this case, it is also interesting to consider monomials with
differential uniformity 4. For a complete list of known families of 4—differentially uniform
permutation monomials in even dimension see Table 2. In the next section, we will find
the binary representation of the inverses of all invertible Gold exponents and in the fourth
section, we will also determine the binary representation of the inverse of the Bracken—
Leander function. With this, the inverses of all known exponents that produce monomials
with differential uniformity 2 in odd dimension or 4 in even dimension are determined.

Our approach in this paper is new and uses as the key tool the modular add-with-carry
approach that was first formally introduced by Hollmann and Xiang [7].

Theorem 1 [7, Theorem 13] Let a,s € {1l,...,2” — 2} andl © N. We denote by a =
(dn—1,--., 40) and s = (Sy_-1,..., S89) the binary expansions of a and s. Let | = i tj2/

witht; € Z. Further, lett, = >> jtj>0 ti andt_ = )- jt; <0 ti: The following are equivalent:
(a) s =l-a (mod 2” — 1)
(b) There exists a sequence c = (Cy-1,.-..,Co) withc € {t_,t- + 1,...,t, — 1} (called
the carry sequence) such that
2cj —Cj-1 + 5; = So tjai-j (1)
j

holds for alli. Here, the indices are seen as elements in Zn.

The carry sequence in (b) is unique.

Remark 1 Note that the representation! = 5° jti 2/ with integer coefficients rt; in Theorem |
is not unique. In fact, this is one of the strengths of this theorem since it makes it possible
to choose a representation that has more structure than the (usual) binary representation.
This makes a big difference especially for the Kasami exponents. Indeed, the r-th Kasami
exponent K, can be written (as it is done usually) as K; = 277 9 41, i.e. with, = to = 1
and t, = —1. This is certainly a much simpler representation than the binary representation
that has r + 1 ones. In the general case, it seems to be desirable to choose a representation
such that both t, and t_ have low absolute value so that the range of possible values for the
carry sequence is small.

The basic idea of finding the inverse of some value / modulo 2” — 1 is now quite simple:
We use Theorem | and set s = 1. Then we try to find sequences a and c that satisfy

Q) Springer
2600 L. Kolsch

Eq. (1). While we apply the approach in this paper only to the Gold, Kasami and Bracken—
Leander exponents, the idea can in principle be used for arbitrary values of /. However,
the corresponding sequences a and c are highly dependent on the choice of /, so a general
treatment seems to be impossible. Still, this approach gives a good framework to find inverses
in Zinn _ 1 .

2 The Gold exponents

To “warm up” and to illustrate our method using Theorem 1, we (re-)derive the inverses
of the invertible Gold exponents G; = 2” + 1 in Zon_,. The inverses of the APN Gold
exponents (i.e. with the condition gcd(r, n) = 1) are explicitly given in [14]. Moreover, the
algebraic degree of the inverses of all Gold exponents is known [10, Theorem 3.7.]. However,
the explicit binary expansion of the inverses of the non-APN Gold exponents has not been
determined yet. In this section, we apply the add-with-carry approach to find the binary
expansion of the inverses of all invertible Gold exponents.
Applied to the Gold exponent, Theorem | yields the following.

Theorem 2 Leta,s € {l,...,2” — 2} and G; = 2’ + 1 be the r-th Gold exponent. We
denote by a = (dn_-1,..., 49) and S = (Sn_1,..., 89) the binary expansions of a and s. The
following are equivalent:

(a) s =G,-a (mod 2” — 1)
(b) There exists a carry sequence c = (Cn_1,..., C9) with c; € {0, 1} such that

2c; — CGj-1 +8; =G-+ +a; (2)
holds for alli. Here, the indices are seen as elements in Zy.

The carry sequence in (b) is unique.
The following lemma characterizes all invertible Gold exponents.

Lemma 1 (e.g. [12, Lemma 11.1.]) Let r and n be positive integers. The Gold exponent
G, = 2" + 1 is invertible in Zyn_, if and only if acd) is odd.

2.1 The APN Gold exponents

We first deal with the APN Gold exponents G,; = 2’ + 1 over F2” with gcd(r,n) = 1.
We will use some notation from [11], where the modular add-with-carry approach was used
to find the Walsh support of the Kasami functions. In particular, we will use the notion of
r-ordered sequences.

Since gcd(r,n) = 1 we can reorder the sequences a and c in Theorem 2 in the following
way:

ao, a_y, a_?2r, sy a_—(n—1)r and CO; C_r, C_2r; sy C_(n—1)r-

Here, we view again the indices as elements in Z,. This ordering is technically a decimation
of the sequence by —r. Since we will be using this ordering a lot, we will call it the r-ordering
of a sequence and also denote these sequences by

dao, a), a2,..-,a4n-1 and CO; C1, C2,---,Cn—-1,

Q) Springer
On the inverses of Kasami and Bracken-Leander exponents 2601

where we will always make sure to specify whether we use the regular ordering or the
r-ordering.

By Lemma 1, G;, is invertible if and only if n is odd. We denote by e the least positive
residue of the inverse of r modulo n. Using r-ordered sequences, the key equation in Theorem
2 takes on the following simpler form:

Theorem 3 Letn € N,a € {1,...,2”—2} and G, be the r-th Gold exponent with gcd(r, n) =
1. Let e be the least positive residue of the inverse of r modulo n and (ao, ..., An—1) be the
r-ordered sequence of the binary representation of a, i.e. a = a aj2~'" (mod 2” — 1).
The following are equivalent:

(a) a is the inverse of G, modulo 2” — 1.

(b) There exists an r-ordered carry sequence c = (Co, Cj, ..-,Cn—1) With c; € {0, 1} such
that

2co — Ce +1 =a, +. a9 (3)

2Cj — Cite = Gi41 + Gi (4)

holds for alli € Zn, i # O.
The carry sequence in (b) is unique.

Now, we can use Theorem 3 to give a simple alternative proof for the inverse of the
APN Gold exponents. As pointed out earlier, the idea is to guess the structure of the carry
sequence from examples for low n and then compute the inverse from the carry sequence.
We will make a detailed example to give an intuition for this process. Note that the case of
APN Gold functions is easier than other cases (especially the Kasami cases in later section),
but the approach will always remain the same.

Example 1 Letn = 7,r = 3 and consider the invertible APN Gold exponent G3 = B+i=
9. We have 3-5 = 1 (mod 7), so e = 5. The inverse of 9 modulo 2’ — 1 is 113 =
26 4.29 424+ 2° and the binary sequence of 113 in regular ordering is (a6, a5,..., 0) =
(1,1, 1,0, 0,0, 1) and in r-ordering (ao, ..., a6) = C1, 1,0, 1, 0, 1, 0). We have aj = ap =
1 so by Eq. (3) necessarily co = c5 = 1. If i 4 O we have a; + a;+1 = | and thus by Eq. (4)
Cj = Cj45 = 1. We conclude that the carry sequence consists exclusively of ones.

From this example (and possibly other examples for low 1) we guess that the carry sequence
always consists only of ones. Let us now consider the Eqs. (3) and (4) for cg = cy =

- = Cy—| = | and arbitrary n. It necessarily yields aj = ajp = | and aj4,; +q = 1.
From this, we immediately conclude that the r-ordered sequence of the inverse G. l is
(do,..-,@n—1) = C1, 1,0, 1,0, 1,..., 0, 1, 0). Since both Eqs. (3) and (4) are satisfied, this
must be the r-ordered sequence of the inverse of the Gold exponent. We have thus proven
the following:

Proposition 1 [14, Proposition 5] Let G,; = 2’ + 1 with gcd(r, n) = 1 and n odd. Then G,
is invertible in Zgn_ 1 and the least positive residue of its inverse is

n—1
z
—1 _ 2ir
G, = ) 2.
i=0
In particular, wt(G~!) = n+l so the algebraic degree Of X x2" over Fon is 21
Dp ’ r —_ 2 ’ 8 8 Qn 2 °

Q) Springer
2602 L. Kolsch

Proof By the considerations above, the r-ordered sequence of the inverse G, 1 is
(aj,..-,A@,-1) = CI, 1,0, 1,0, 1,...,0, 1, 0). We conclude

n—1
2

Gl=i+ So 2S So 2S °27" (mod 2"—1).
i€{0,...,.n—1} i€{0,...,.2—1} i=0
i odd i even

O

The main takeaway from the example is that the carry sequence has a simpler structure
than the sequence (dg, ..., @n—1) of the inverse. This observation will also hold for all other
exponents considered in this paper. Indeed, while it is still possible to discern the structure of
the APN Gold exponents with relative ease without looking at the carry sequence, this will
be close to impossible in the case of the Kasami exponents.

2.2 The non-APN Gold exponents

We now deal with the more general case of Gold exponents G, with gcd(r,n) > 1.
Since gcd(n,r) > 1, we cannot use the r-ordering of sequences that we used in the
previous proposition. We expand the concept in a natural way.

Definition 2 Let a = (dy_1,..., a9) be a sequence of integers and r be a positive integer.
Set d = gcd(n,r). We define the associated (d x 7)-matrix M,z,r by

ao a_r a—?r eee a_(4_1)r
a| a\—r a|—2r tee @|—(4—-1)r
Mar = . . ’
Gd—1  Gd-\-r  4d-1-2r_ +++ Ad—-1-(4-Wr

where the indices are seen as elements in Z,,. We call M,,, the r-matrix of a. If a is a binary
sequence, then we call M,,, also the r-matrix of the corresponding element in Zn_, or
{O,1,...,2” — 2}.

Since the r-matrices are constructed from sequences, we use the slightly unusual con-
vention of indexing from 0, 1.e. the first row/column will be called row/column 0. With this
convention, the r-ordered sequences considered in the previous section are just a special case
of r-matrices with only one row. Again in accordance to the notation used earlier, we denote
by e the least positive residue of the inverse of ada modulo

nN
. gcd(n,r)°
We now use r-matrices to rephrase Theorem 2.

Theorem 4 Leta ¢€ {1,...,2” — 2}, n € N and G, be the r-th Gold exponent with
gcd(r,n) = d and e be the least positive residue of the inverse of 5 modulo 7. Moreover, let

40,0 a0, 1 ao,2 see do," —]
41,0 ay, a\,2 Lee ay 2]
Mar = .
G@d—1,0 G@d-1,1 Gd-1,2 +++ 4d-1,"—-1

_ ny ,
be the r-matrix of a, 1.e.a = yi “0 aj,j2'-/” (mod 2” — 1). The following are
equivalent:

Q) Springer
On the inverses of Kasami and Bracken-Leander exponents 2603

(a) a is the inverse of G, modulo 2” — 1.
(b) There exists an r-matrix for the carry sequence c of the form

C0,0 CO,1 C0,2 tee Co, 7-1
C1,0 C11 C12 tee C1,45-1
Mer = .
Cd-1,0 Cd—-1,1 Cd-1,2 +++ Cqd-1,4-]

with c;,; € {O, 1} such that the following equations hold:

2c0,0 — Cd-1,e + 1 = 40,1 + 40,0 (5)
n
2c0,j; — Cd—1,j+e = 40,j41 + 40,; forallj € {l,..., a7 1} (6)
n
2ci,j — Ci-1,j =4i,j41 + 4i,; foralli € {1,...,d—1},j € {0,..., a7 1}.
(7)

The carry sequence (and thus its associated r-matrix) in (b) is unique.

Proof The Theorem follows immediately from Theorem 2 and the definition of the r-matrix.
The predecessor of the values c_,,, 18 determined as follows: Observe that c_x,;;-1 =
Cecd(n,r)—1—kor if and only if —kjr — 1 = gcd(n,r) — 1 — kgr (mod n), which is equiv-
alent to —(k, —k) adn) = 1 (mod adn? so the predecessor of c_x,7 18 Cged(n,r)—1—kor
with ky =k, +e. O

With Theorem 4, we can give the explicit binary representation of all inverses of Gold
exponents.

Proposition 2 Letn <€ N and G, be the r-th Gold exponent with gcd(r,n) = d > 1 and 5
_ ny ,
odd. Let e be the least positive residue of the inverse of 5. Then G, be ar “0 aj,j2' 7"

(mod 2” — 1) where the values a;,; are the entries of the (d x 7) matrix

0 0 1 0 1 0. .... 0 1
0 0 1 0 1 0. .... 0 1
Mar = :
0 0 1 O 1 O 0 1
1 1! O 1 0 1 1 O
In particular, wt(G>!) = na gt?

Proof The r-matrix of the corresponding carry sequence is the (d x 7)-matrix

QO 1 1 1

0 1 1 1
Mer = (ci,;) =

0

1

We now just have to verify Eqs. (5) to (7). For Eq. (5), we get 2c9,0 —Ca—1,e +1 = a0,1+40,0 =
0. For Eq. (6), we have 2c, ; — cad—1,j+e = 40,j+1 + 40,; = 1 for all values of 7 > 0. For
Eq. (7), we have 2c;,; — ci-1,j = @i,j41 + a,j = Oif 7 = OandO <i < d—l,

Q) Springer
2604 L. Kolsch

2Cj,j —Ci-1,j = Qj, j+1 ti, j = 2if j = Oandi =d-—1 and 2c; ; —Cj-1, j = Qi, j+1 Qi, j =]
in all other possible cases. Thus, all equations are satisfied.

The value of wt(G, ') can be determined easily by counting the ones in the matrix
Ma,r- oO

Recall that all invertible Gold exponents satisfy
and 2 cover all invertible Gold exponents.

Note that the gcd(r, n) = 1 case can even be recovered as a special case from Proposition 2.
Indeed, the last row of the r-matrices M,,, and M,.; are precisely the r-sequences we saw
in the gcd(r, n) = 1 case in Proposition 1.

adn) y odd by Lemma 1, so Propositions |

3 The Kasami exponents

Applied to the Kasami exponent K, = 27” — 2” + 1, Theorem 1 yields the following.

Theorem5 Leta,s € {l,...,2” — 2} and K, be the r-th Kasami exponent. We denote by
a = (dn_-1,---, 49) and Ss = (Spn_1,..., 89) the binary expansions of a and s. The following
are equivalent:

(a) s = K,-a (mod 2” — 1)
(b) There exists a carry sequence c = (Cn-1,..., C9) with c; € {—1, 0, 1} such that

2c; — Ci-1 + Sj = Gj—2r — Aj—r + Qj (8)
holds for alli. Here, the indices are seen as elements in Zn.
The carry sequence in (b) is unique.

We extend the definition of the weight of a sequence to the sum of all of its elements. For
binary sequences, this corresponds exactly to its binary weight. In particular, this allows us
to talk about the weight of the carry sequence. Using this convention, the following Lemma
gives an additional condition on the carry sequence.

Lemma 2 [7, Lemma 5] With the notation of Theorem 5, we have the following:
(a) cy + Gr € {-1, 0, 1}. In particular, | wt(c)| < 5.
(b) wt(c) + wt(s) = wt(a). In particular, for s = 1 we have wt(c) = wt(a) — 1.

The following Proposition shows when a Kasami exponent is invertible modulo 2” — 1.

Proposition 3 [10, Lemma 3.8] Letn be a positive integer and K, = 27" — 2" +1 be the
r-th Kasami exponent. K,. is invertible modulo 2” — 1 if and only if one of the following cases
occurs:

is odd,
is even, r is even and gcd(r, n) = gcd(3r, n).

° sear) n)

° acd)

We first deal with the case gcd(r, n) = 1, then with the case a Soden) a odd and finally with
the case acd) even. Technically, the case gcd(r,n) = | is included in the case dtr)
odd. However, we single out this case for two reasons: Firstly, it is particularly interesting
since those Kasami exponents are precisely the APN exponents. Secondly, the case drm)
odd is very technical, but can be described much easier by applying the results for the special
case gcd(r,n) = 1.

Q) Springer
On the inverses of Kasami and Bracken-Leander exponents 2605

3.1 The case gcd(r, n) = 1

We first deal with the APN Kasami exponents K, = 27” —2" +1 over Fy» with gcd(r, n) = 1.
For this case, the modular add-with-carry approach was already applied in [11] to determine
the Walsh support of the Kasami function x H x*.

By Proposition 3, K; is invertible if and only if n is odd. We denote by e the least positive
residue of the inverse of r modulo n. Observe that K; and K,—, are cyclotomic equivalent
exponents on Fyn. Indeed, (277) — 2”-" + 1)277 = 277 — 2" + 1 (mod 2” — 1). Then
K>!=2-*K a (mod 2” — 1), so it suffices to determine the inverse of one of these two
values. Since n is odd, we can thus assume without loss of generality that e is odd.

Since gcd(r,n) = 1 we can reorder the sequences a and c in Theorem 5 using the r-
sequences introduced in the previous section. Using r-ordered sequences, the key equation
for the Kasami exponents in Theorem 5 takes on the following form:

Theorem6 Letn € N,a é€ {1,...,2” — 2} and K, be the r-th Kasami exponent with
gcd(r,n) = 1. Let (ag, ..., Gn—1) be the r-ordered sequence of the binary representation of

a,lea= a aj2~'" (mod 2” — 1). The following are equivalent:

(a) a is the inverse of K, modulo 2” — 1.

(b) There exists an r-ordered carry sequence c = (CQ, C{,---,Cn—1) With cy € {—1,0, 1}
such that

2co — Ce +1 = a2 — a, +. a0 (9)

2Cj — Cite = Gi42 — Gi41 + Qj (10)

holds for alli € Zn, i # O.
The carry sequence in (b) is unique.

Experimental results show that the inverses of the APN Kasami exponents often have

binary weight nh In this case, Lemma 2 immediately shows that the r-ordered carry

sequence has weight ot and must be a cyclic shift of the sequence (0, 0, 1,0, 1,...,0, 1).
Since the carry sequence of the inverse uniquely determines the inverse, these cases can then
be solved with comparatively little effort.

In this section, we will always use r-ordered sequences to represent inverses of Kasami
exponents because this notation makes the description much easier. Consequently, the

inverses will be written in the form K, —_— ia a;2~'" (mod 2” — 1) for a sequence
a = (ao, ...,@n—1). Of course, a translation into the more standard binary representation

is easy by reordering the sequence a, i.e. K, l= yy a_je2' (mod 2” — 1) (recall that e

denotes the inverse of r modulo n).

Proposition 4 Let n odd, K; be the r-th Kasami exponent with gcd(r, n) = 1. Let e be the
least positive residue of the inverse of r modulo n. The inverse of K, modulo 2” — 1 is

n—1
K,!= So aj27” (mod 2” — 1),
i=0
where a = (do, ..., Gn—1) is determined as follows:

e Ife = 6k +1, thena = (1,x, y) andx = (1,0,1,0,...,1,0, 1,0) is a sequence of
lengthn —e and y = (1,1, 1,0,0,0, 1,1, 1,0,0,0,...,1,1, 1,0, 0, 0) is a sequence
of length 6k.

Q) Springer
2606 L. Kolsch

e Ife = 6k +5, thena = (0, x, 1,1, y) and x = (0, 1,0, 1,...,0, 1, 0, 1) is a sequence
of length n —e +2 and y = (0,0,0, 1,1, 1,0,0,0,1,1,1,...,0,0,0, 1,1, 1) is a
sequence of length 6k.

 

In both cases, we have wt(K,!) = nt
Proof Lete = 6k + 1. Setc = (0,1,0,1,...,0,1,0, 1,0), ie. c; = 0 if i is even, and
cj = | otherwise. We show that a and c satisfy the conditions in Theorem 6. Equation (9)

can be easily verified. For Eq. (10), we have the following:

Case 1: i odd, i +e < n: We have cj = 1, cj4e = 0, aj = aj42 = 1 andaj4; = 0.

Case 2: i even,i +e <n: We have cj = 0, cite = 1, Gi = Aj42 = O andaj4; = 1.

Case 3: i odd, i + e > n: We have cj = cj4e = 1. Depending on the value of 7, the triple
(dj, Ai+1, 4j+2) takes on the values (1, 0, 0), (0, 0, 1) or C1, 1, 1).

Case 4: i even, i +e > n: We have cj; = cj+e = 0. Depending on the value of 7, the triple
(dj, Aj+1, 4j+2) takes on the values (0, 0, 0), (0, 1, 1) or C1, 1, 0).

So Eq. (10) holds for all 7.

Now let e = 6k + 5. Set c = (0,0, 1,0, 1,0,1,0,1,...,0,1),ie.c; = Oifi =Oori
odd and c; = 1 otherwise. We again show that Eqs. (9) and (10) are satisfied. Observe that
Eq. (9) holds. We check the following cases of Eq. (10) fori > 0:
Case 1: i odd, i +e <n: We have cj = 0, ci4e = 1, GG = Gi42 = O and aj+) = 1.
Case 2: i even,i +e <n: We have c; = 1, cj4e = 0, Gj = Gj42 = 1 andaj+) = 0.
Case 3: i odd, i +e > n: We have cj = cj+e = 0. Depending on the value of 7, the triple
(dj, Aj+1, 4j+2) takes on the values (0, 0, 0), (0, 1, 1) or C1, 1, 0).
Case 4: i even, i +e > n: We have c; = cj+e = 1. Depending on the value of 7, the triple
(dj, Ai+1, 4j+2) takes on the values (1, 0, 0), (0, 0, 1) or C1, 1, 1).

So Eq. (10) holds for all 7. oO

The Kasami APN functions and their inverses are also almost bent functions. It is known
that the algebraic degree of almost bent functions is at most tl [2]. We have shown that the
inverses of the Kasami APN functions defined by the exponents considered in Proposition 4
attain this bound.

The only case left to check is e = 6k +3 (recall that we could assume e odd without loss of
generality). This case is a lot more involved and has to be divided into several subcases. The
key difference to the cases considered above is that wt(K, lx wk fore = 6k+3, so finding
the correct carry sequence is more complicated. However, the strategy of the proof remains
the same: Based on experimental results, we guess a carry sequence that then determines the
inverse.

 

Proposition 5 Letn odd, K, be the r-th Kasami exponent with gcd(r, n) = 1. Lete = 6k +3
be the least positive residue of the inverse of r modulo n. Define s,t € Nbyn = se +t with
0 <t <e. Further, let x; = (0,0,0, 1,1, 1), x2 = (0, 1, 1, 1,0, 0) be sequences of length
6 and

X= (0, l, 1,x1,..., x1, 0, 0, 0, x2,..., x2)
—_—_—_ —_—_

k-times k-times
y = (0, 0, 0, x2,..., x2, 0, 1, 1,x1,...,X1)
— —

k-times k-times

be sequences of length 2e. Then

n—-1
K l= So aj27” (mod 2” — 1),
i=0

Q) Springer
On the inverses of Kasami and Bracken-Leander exponents 2607

where a = (do, ..., Gn—1) is determined as follows:

(a) Ift =6u +1 then

a= (xX1,...,X1, y,.--,y ,0,0,0,x2,...,%2,0,1,1,%1,..., x1, z,0) +, 0,...,0),
—JS_—————"’ —-—’ —>>-—=-————’ —>-—=-———’
u-times  (s—2)/2-times k-times u-times

where z = (0, 1,0, 1,...,0, 1, 0, 1) is a sequence of length e — 3 — 6u.
(b) Ift = 6u +2 then

a= (0,1,%1,...,x%1, y,...,y ,0,0, z, 1, z2),
u-times (s—1)/2-times
where z = (1,0, 1,0..., 1,0, 1, 0) is a sequence of length 6u and z2 = (x2, X1,..., X1)
a
(e—6u—9) /6
-times
is a sequence of length e — 6u — 3.
(c) Ift = 6u +4 then
a = (0,0,0,x2,...,xX2, x,...,x ,0,1,1,0,z, 1,0, 1,1, 1,x1,..., x1, 0)
ee ee a
u-times (s—1)/2-times (e—6u—9)/6
-times
where z = (0, 1,0, 1,...,0, 1, 0, 1) is a sequence of length 6u.
(d) Ift =6u +5 then
a = (0,1, 1,0, 0, x2,...,x2, x,...,x ,0,1,1,x1,...,%1,0,x1,...,%x1, Z)
A ee a a
u-times (s—2)/2-times k-times u-times

where z = (0, 1,0, 1,...,0, 1, 0, 1) is a sequence of length e — 1 — 6u.

In the cases (a) and (d) we have wt(K,!) = a and in the cases (b) and (c) wt(K~!) =

n—S

>:
Proof For all four cases, we explicitly give the carry sequence c (in r-ordering) and check
that Eqs. (9) and (10) are satisfied. The carry sequences for all cases are quite similar and
are composed of the same “building blocks’. The verification is simple but tedious, so we
will show the correctness of the first case in detail and for the other cases we will just
state the carry sequence and omit the verification. We define the auxiliary sequences sj =
(0, 1,0,1,...,0, 1) of length 6u and sz = (0,0, 1,0, 1,0, 1,0,1,...,0, 1) of length e
6k + 3.

Case (a): Set

c= (S1, 82, o++, 92, Q).
—
s-times

Equation (9) can be easily verified. For Eq. (10) we have to distinguish (many) different cases
depending on the value of 7. We go through each block in the sequence a.

Case a.l: i > 0 is in the first block of x,’s. If 7 is even then we have cj; = cj+e = O
and (dj, 4)41, 442) € {(0, 1, 1), 1, 1,0), (0, 0, 0)}. If 7 is odd then c; = cj4e = 1 and
(aj, 441, 4142) € {(0, 0, 1), , 1, 1), C1, 0, O)}.

Case a.2: 7 is in the block of y’s. Leti = 6u+q.Ifg = 1,2,e+ 1,e+2 (mod 2e) then
Cj = Ci+e = O. In these first two cases we have (q;, dj+1, di+2) = (0, 0, 0) and in the latter
two (dj, Gi+1, 4142) = (0, 1, 1) and (qj, aj+1, 4i42) = C1, 1, 0), respectively. Let g; be the

Q) Springer
2608 L. Kolsch

least positive residue of g modulo 2e. If 3 < gq, < e and gq, odd we have c; = cj+e = 0
and (q@;, dj+1, 442) € {(0, 1,1), (1, 1, 0), (0, 0, O)}. If 3 < gy < e and q; even, we have
Cj = Ci4+e = 1 and (qj, aj+1, Gi+2) € {(0, 0, 1), T, 1, 1), C1, 0, 0)}. Ifg1 > e +2 and q; odd
we have cj = Cj+e = | and (qj, aj41, 442) € {(0, 9, 1), A, 1, 1), A, 0, 0)} andifg; > e+2
and g; even we have c; = cj4e = O and (q;, dj+1, di+2) € {(0, 1, 1), C1, 1, 0), (0, 0, 0)}.
Case a.3: 7 is in the position of the three zeros after the block of y’s. For the first two
Zeros (1.e. 2 = 6u + e(s — 2) andi = 6u + e(s — 2) + 1) we have c; = cj4+e = O and
(aj, 4j41,4)42) = (0,0,0). Fori = 6u + e(s — 2) +2 we have cj = cj4+e = | and
(Gj, 4j+1, 4142) = (0, 9, 1).

Case a.4: i is in the block of x2’s,1.e.7 € {6u + e(s —2)+3,...,6u+e(s —2) + 6k +2}.
If i is odd, we have cj = cj4e = 1 and (qj, aj41, a4j42) € {(0, 0, 1), C1, 1, 1), C1, 0, 0)} and
if i is even cj; = Cj4e = O and (qj, aj+1, ai+2) € {(0, 1, 1), C1, 1, 0), (0, 0, O)}.

Case a.5:1 € {6u+e(s—2)+6k+3,..., 6u+e(s—2)+6k+5}. Ifi = 6u+e(s—2)+6k+3
then c; = 0, Ci4e = Cn—1 = Oand (q;, aj41, Gi42) = (0, 1, 1). For? = 6u+e(s —2)+6k+4
we have c; = 0, Ci+e = Co = O and (4;, Gj41, 4742) = C1, 1, 0) and fori = 6u + e(s — 2) +
6k +5 we have cj = 1, cj4e = cy = 1 and (4), Gj41, 4j42) = C1, 0, 0).

Case a.6: i is in the second block of x1’s, i1.e.i € {6u + e(s — 2) + 6k + 6,...,12u +
e(s — 2) + 6k + 5}. If i is even, we have cj; = cite = 1 and (Gj, 4j41,d4j42) €
{(O, 1, 1), (1, 1, 0), (O, 0, 0)}. Ifiisoddandi 4 12u+e(s—2)+6k+5 wehave cj = cj+e = 0
and (qa;, 4j41, 442) € {(0, 0, 1), 7, 1, 1), 7, 0,0)}. Ifi = 12u + e(s — 2) + 6k +5 then
ci = 1, ci4e = O and (qj, aj41, ai42) = C1, 9, 1).

Case a.7: i 1s in the subsequence z, 1.e.7 € {12u+e(s —2) +6k +5, 6u+e(s —1)+6k+ 1}.
If i is even then c; = 0, cj4e = 1 and (qj, aj41, 442) = (0, 1, 0). If i is odd then c; = 1,
Cite = O and (qj, aj41, 442) = C1, 9, 1).

So Eq.(10) holds for alli 4 0.

We state the r-ordered carry sequences for the other cases:

Case (b):
c= (-l, 1, s1, 52, 1.5 52).
ee
s-times
Case (c):
c= (0, 0, 1, sy}, $2, o++, 92, QO).
a
s-times
Case (d):
c= (0, 0, 1,0, 1, S1, 82, +5592).
——
s-times

O

Note that Proposition 5 lists all possible options. Indeed, the cases t = 6u and t = 6u +3
do not occur because in these cases n = se + ¢ is divisible by 3, so e = 6k + 3 is never
invertible modulo n.

Corollary 1 Letn € N and K, be the r-th Kasami exponent with gcd(n, r) = 1. Let K>! be
the inverse of K- modulo 2" — 1. Then wt(K;!) = nt for n = 0 (mod 3). Moreover, we
have

ne ifn =1 (mod 3)

—]
wt(K, -) > st ifn =2 (mod 3).

Q) Springer
On the inverses of Kasami and Bracken-Leander exponents 2609

The lower bound is attained if and only if e = 3.

Proof If n = O (mod 3) then e is not divisible by 3 since gcd(e,n) = 1. The result then
follows from Proposition 4.

For the other cases, using the notation of Proposition 5, the binary weight wt(K,~') is
minimal when s is maximal. Forn = se +t with 0 < t < e this clearly implies minimizing
e,soe = 3 andt € {1, 2}. For these cases we have

 

n—1
— +1 .
1, —j = he ift=1
wt(K. °) = no?

— ifr =2

 

 

and the result follows. Oo

It is known that a vectorial Boolean function f is always CCZ-equivalent to its inverse f~!.
It is however not clear when a function is EA-equivalent to its inverse. Since EA equivalence
preserves the algebraic degree, we get the following easy corollary.

Corollary 2 Let n € N odd and K,. be the r-th Kasami exponent with gcd(n,r) = 1 and

< 5.Let f = xr be the r-th Kasami function on Fa. If n = 0 (mod 3) andr # ot
then f is not EA equivalent to f—'. Ifn #4 0 (mod 3) andr < he then f is not EA-
equivalent to f~!.

3.2 The case 5¢ gcdnw 5H odd

We now deal with the Kasami exponents K, with gcd(n, r) > 1 and a sed Gr odd. While these
Kasami exponents are not APN, they still have some interesting properties. For example, for
gcd(r,n) = 2 and 5 odd, the function x +> x** (and thus also its inverse) is a permutation
with differential uniformity 4 (see Table 2).

Since gcd(n, r) > 1, we cannot use the r-ordering of sequences that we used in the previ-
ous section. Just like in the case of Gold functions, we will thus use r-matrices (introduced
in Definition 2).

In accordance to the notation used in the previous subsection, we denote by e the least
positive residue of the inverse of ada modulo a sod) ae Since gcd(n, r) = gcd(n —r, 1),
adn) odd and K;. is cyclotomic equivalent to K,_,, it again suffices to determine the
inverses of K, where e is odd.

Using r-matrices, Theorem 5 takes on the following form.

Theorem7 Leta é€ {1,...,2” — 2}, n € N and K, be the r-th Kasami exponent with
gcd(r,n) = d and e be the least positive residue of 5 modulo 5. Moreover, let

40,0 a0, 1 ao,2 see do," —]
41,0 ay, a\,2 Lee ay 2]
Mar =
G@d—1,0 G@d-1,1 Gd-1,2 +++ 4d-1,"—-1

| i,
“9 ai,j2' /" (mod 2” — 1). The following are

be the r-matrix of a, i.e. a = yi
equivalent:

(a) a is the inverse of K, modulo 2” — 1.

Q) Springer
2610 L. Kolsch

(b) There exists an r-matrix for the carry sequence c of the form

C0,0 0,1 C02 +++ CO,4-1
C1,0 C11 C1,2 Lee Cy,4-]
M., = .
Cd-1,0 Cd-1,1 Cd-1,2 +++ Cd-1,4-1

with c;,; € {—1, 0, 1} such that the following equations hold:
20,0 — Cd—1,e + 1 = 40,2 — 40,1 + 40,0 (11)
2c0,; — Cd-1,j+e = 40,j4+2 — 40,j+1 +40,; forall j €{1,..., “ — 1} (12)
21,7 -—Ciaj =4i,j42 -aijpi tar; forallie{l,...,d—1,j€{0,..., “ —1}. (13)

The carry sequence (and thus its associated r-matrix) in (b) is unique.

Proof The Theorem follows immediately from Theorem 5 and the definition of the r-matrix.
The process is identical to the corresponding case for the Gold function in Theorem 4. Oo

Again, we find M,,, and M,., such that Eqs. (11)—(13) hold. These verifications become
quite tedious (especially since we have to distinguish several cases). However, the basic
idea does not change: The r-matrices of the carry sequences have a visible structure that
can be used to determine the inverse. It turns out that the inverse of K, on modulo 2” — 1
with gcd(r,n) = d is closely related to the inverse of K~ modulo 24 — 1 which was
already determined in the previous section. To improve readability, we first deal with the
case adn) = 6v + 3 fora v € No separately.

Proposition6 Letn € N and K,. be the r-th Kasami exponent with gcd(r,n) = d > 1
and 5 = 6v + 3. Let e be the least positive residue of the inverse of 5 modulo 7. Then

_ n_y i, .
Kvl= yD “0 aj,j2'~/" (mod 2” — 1) where the values a;,; are the entries of the
matrix Mg;

where the rows a, and az are defined as follows:

(a) Ife =6k +1:

a, = (0,0, X1,...,X] ,X2...,X2, 0)
a et
aiden? -times k -times
ar = (1, x3, %4..., X4).
—
k -times
(b) Ife = 6k +5:
a) = (0, 1, 0, 0, 0, X4,-++5X4, l, 1,0, 0, x6..., x6, 0)
a —
a -times k -times

Q) Springer
On the inverses of Kasami and Bracken-Leander exponents 2611

az = (0, x5, x2...,%2),
—
k -times
where XxX] = (0, 0, l, l, l, 0), X2 = (0, 0, 0, l, I, 1), X4 = Cd, I, l, 0, 0, 0), X6 =
(O,1,1,1,0,0) are sequences of length 6, x3 = (1,0,1,0...,1,0,1,0) is a sequence
of length 7 —eand x5 = (0,1,0,1,...,0, 1) is a sequence of length 7 —e,

In both cases we have wt(K;!) = nose

Proof Case (a): The r-matrix of the corresponding carry sequence is

¢c

Mer = (ci,;) =

/

where c” = (co,...,¢"1) = (0,1,0,1,...,0,1,0,1,0) and c’ = (ce — 1, Ce44,...,
CH_1,€0,Cly +66, Ce—1)-

Using Theorem 7, we just have to verify Eqs. (11)—(13). For our choice of M,.-, we have
in Eq. (11) 2c0,0 — Ca-1,e + 1 = 2(ce — 1) — ce +1 = ce — 1. Similarly, in Eq. (13) we have
for0 <i <d—J1and j = 0 the relation 2c; ; — cj-1,j; = 2(ce — 1) — (ce — I) = ce — I.
From these two observations, we conclude

Ce—-1l=aj.2—aj,; +a; foralli € {0,...,d —2}. (14)

For j 4 0 we have fori = 0 (consulting Eq. (12)) 2co, ; —ca—1,e4j = 2(Ce+j) —Ce+j = Ce+j-
Looking at Eq. (13) for 7 # O andi 4 0, we have 2c;,; — cj-1,j = 2Ce+j — Ce+j = Ce+j-
We conclude

n
Ce+j = Qj, j+2 — Gi, j+i + G,j for alli E{0,...,d-—l}, J etl... 5 — 1. (15)

Let us now consider the casei = d — 1, j # 0. Then Eq. (13) becomes 2cg_1,j — cq—2,j =
2c; — Ce4; and we get

n

2c; — Ce+j = Ad-1,j42 — 4d-1,j41 +aa-1,; forall j € {l,..., 77 1}. (16)
Finally, for the casei = d — | and j = 0 we have (again considering Eq. (13)) 2cg_—1,0 —
Cd—2,0 = 2c9 — (Ce — 1) = 2c9 — Ce + 1. We conclude

2co — Ce + 1 = ag—1,2 — Ad—1,1 + Ad-1,0 (17)

Observe that, by Proposition 4, a2 is the r-ordered sequence of the inverse of K r modulo

27 — | with the corresponding carry sequence c”. Theorem 6 then shows that Eqs. (16)
and (17) are satisfied. We check Eqs. (14) and (15) by hand. In both equations we do not
consider the last row of M,,, and since all but the last row in M, ; are identical, it suffices to
check the first row.

Equation (14) holds because ce = | and ao,2 = ao,1 = 40,0 = 0. We check Eq. (15): Ife+
j <nand j odd, then ce+ ; = Oand (ao, ;, a0, +41, 40,;4+2) € {(0, 0,0), C1, 1, 0), (0, 1, 1)}. If
e+j <nand j even, thence; = land (ao, ;, a0, j+41, 40, j+2) € {U, 9, 0), C1, 1, 1), (0, 0, 1)}.
Ife+j = nand j isoddthence+ ;=1 and (ao, ;, do, ;+1, 40, ;+2) {C, 0, 0), C1, 1, 1), (0, 0, 1)}
and if e + j > n and j is even then coz; = O and (ao,j,a0,)41,40,)42) €
{(0, 0, 0), (1, 1, 0), (0, 1, 1)}.

Q) Springer
2612 L. Kolsch

Case (b): The proof is similar to the proof of the first case. We define the r-matrix of the
corresponding carry sequence

/

Mer = (ci,;) =
Cc
cl

where c” = (co,..., cn_y) = (0,0,1,0,1,0,1,...,0,1,0,1) and & = (c. -
1, Ce41,---, C21, €0, C1, +++, Ce—1). This leads to precisely the same equations (14)-(17).
Again, by Proposition 4, az and c” are the r-ordered sequences of the inverse of the Kasami
exponent K z modulo 24 — 1 and the corresponding carry sequence, respectively. The validity
of Eqs. (16) and (17) follows. Equations (14) and (15) can be checked just as in the previous
case; we omit the calculations.

By adding all entries in M,.;, we see that in both cases the weight of the carry sequence
is dries +l1= nase? Lemma 2 then implies wt(K,!) = nase Oo

Note that the case e = 6k + 3 does not occur because e is invertible modulo 7 = 6v + 3.
We now deal with the remaining cases 57 = 6v + | and 7 = 6u +5.

Proposition 7 Letn € N and K, be the r-th Kasami exponent with gcd(r,n) = d and 7 odd.

Let e be the least positive residue of the inverse of 5 modulo 7 and 5 =se+t,O<t<e.

_ ny ,
Then K~! = yD “0 aj,j2'-/” (mod 2” — 1) where the values a;,; are the entries of

the matrix

Here, ay is the sequence of the inverse of K : modulo 2¢—lin r-ordering as determined in the
previous section and az is as follows. We use the auxiliary sequences x, = (0, 0,0, 1, 1, 1),
x2 = (1, 1,0, 0,0, 1), x3 = (0, 1, 1, 1, 0, 0) of length 6 and

y = (0, 0, 0, x3, ..., x3, 0, 1, 1,x1,...,X1)
— —

k-times k-times
z= (0, 1, 1,x,,..., x1, 0,0, 0, x3,..., x3)
—— ~—

k-times k-times

of length 12k + 6.
(a) Ife =6k+land>=6v+1

a2 = (x1,...,x1,0).
—
v-times
(b) Ife =6k+ land 5 =6v+5
a2 = (x2, oe -»X2, l, l, 0, 0, QO).
—
v-times

Q) Springer
On the inverses of Kasami and Bracken-Leander exponents 2613

(c) Ife =6k+5and>=6v+1

az = (O, x1,..., 1).
ae
v-times
(d) Ife =6k+5and5=6v+5
az = (0, l, 1,x1,...,%1, 0,0).
a
v-times
(e) Ife =6k+3andt =6u+1
ay = (X1,...,X1, y,..., y, 0).
u-times 5 -times
(f) Ife =60k+3andt = 6u+2
a2 = (0,1, x1,...,x1, y,..., y, O, O, O, x3, ..., X3).
——S —S_-/ ee
u-times ssl -times k-times
(g) Ife =6k+3andt =6u+4
az = (0, 0, 0, x3,...,.%3,Z,...,2,90, l, 1,x1,...,%1, 0).
Ne ee
u-times st -times u-times
(h) Ife =6k +3 andt =6u+5
az = (0, l, 1,0, 0, x3,...,%3,Z,...,2Z).
ne
u-times 5 times

In the cases (a)-(d) we have wt(K>!) = ng? in the cases (e) and (h) wt(K,!) =
So and in cases (f) and (g) wt(K;-!) = nods ate

Proof In all cases the r-matrix of the carry sequence c has identical rows, i.e.

Cc
Mer = ’
c
where c’ = (co,..., cn_1) is the r-ordered carry sequence for the inverse of K z modulo

2¢ — 1 determined in the proofs of Propositions 4 and 5. With this carry sequence, the
Eqs. (11)-(13) of Theorem 7 take on the following form:

2co — Ce + 1 = 0,2 — a0,1 + 40,0 (18)
n
2Cj — Cj+e = 40,j42 — 40,j41 + 40,; forall y € {1,..., a7 1} (19)
n
Cj = Qj, j+2 — Gi, j+i 1 Gi, j for all i E{l,...,d-l},J €10,...,5 — I.
(20)

The validity of Eqs. (18) and (19) follows from Theorem 6 and the choice of a; and c’. So
we only need to verify Eq. (20) for each case. We will show the verification for the first case,
the other cases are identical in nature.

Q) Springer
2614 L. Kolsch

In Case (a) we have c’ = (0, 1,0, 1,..., 0, 1, 0) from Proposition 4, i.e. c; 1s Oif j iseven
and | of 7 is odd. When 7 is odd, then (q;,;, aj, j+1, di,j+2) € {(0, 9, 1), 1, 1, 1), C, 0, 0)}
and if j is even then (qj, ;, 4i,j)+1, di,j+2) € {(O, 0, 0), (1, 1, 0), (0, 1, 1)} for alli > 0, so
Eq. (20) holds.

Using Lemma 2, we have

wt(K,') = wt(c) +1 =dwt(c!) +1 = d(wt(K;") —1) +1,

where K, is the least positive residue of the inverse of K r modulo 27 — 1. The results
on the binary weights then follow from the results 1 in Propositions 4 and 5. For example for

the cases (a)-(d), Proposition 4 yields wt(K p= = a"! This leads to wt(K,- y= qL— a s ‘41 = =

n—d+2
QJ .

O
Propositions 6 and 7 show that K,- ' has a strong structure because its r-matrix has d — 1
identical rows. By the definition of the r-matrix, this means that K- ' has 7 runs of (d — 1)
consecutive ones or zeroes.
The results presented in this section yield the following result for the binary weight of the
inverse of Kasami exponents.

Corollary3 Letn € N and K,. be the r-th Kasami exponent with gcd(n, r) = d and 7 odd.
Let K>! be the inverse of K; modulo 2" — 1. Then wt(K~!) = ni" forn = 0 (mod 3)
and wt(K~!) < ng? forn + () (mod 3). Moreover, we have

 

n—d+3 fu =
4 if4=1 (mod 3)
wt(K, °) = n3d-43

Proof Forn = 0 (mod 3) the result follows from Proposition 6.

For the other cases, using the notation of Proposition 7, the binary weight wt(K, ) is
minimal when e is divisible by 3 and s is maximal. For n/d = se +t with O < t < e this
clearly implies minimizing e, soe = 3 andt € {1, 2}. With Case (e) and (f) from Proposition
7, we have

 

1 _ n+2d ?)= n—d+3 iff —1
wt(K,') > zn nd +o n—2d-43
x(n -aye t+ 2)= 5 iff =2
and the result follows. oO
3.3 The case 5¢ gcdin.) pn even

We now deal with the case even. Proposition 3 implies that if K; is invertible modulo

nN
gcd(n,r)
2” — | then both n andr are even and sed@r) on 7) is not divisible by 3. We will again denote by
Note that since is even, e must be odd.

e the inverse of modulo

r n
gcd(n,r) gcd(n,r) ° adn)

Proposition 8 Letn € N and K,. be the r-th Kasami exponent with gcd(r, n) = d, r even, 7
_ ny ,
even and not divisible by 3. Then K~! = yD S° “0 aj,j2'/" (mod 2” — 1) where the

Q) Springer
On the inverses of Kasami and Bracken-Leander exponents 2615

values a;,; are the entries of the matrix

where a,,x, y are as follows. We use the auxiliary sequences x, = (1, 1,0,0,0, 1) and
x2 = (1,0, 0, 0, 1, 1) of length 6.

(a) If 7 = 6k +2 then
a, = (1,1, x1,...,x1),x =(1,0,1,0,...,1,0), y = (0, 1,0,1,...,0, 1).
— Ie
k -times
(b) If 7 = 6k +4 then
ay = (1,0, 1,1, x2,...,x2),x =(0,1,0,1,...,0,1), y = (1,0, 1,0,..., 1,0).
— ee

k -times

In both cases we have wt(K,!) = ne

Proof Case (a): The r-matrix of the carry sequence is

O 1 0 1. .... 0 1
1 O 1 O.... 1 O
Mer = (ci,;) =
0 1 0 1. ... 1
1 0 1 O.... 1 O

We check Eqs. (11)—(13) from Theorem 7.

Equation (11) holds because co,9 = 0, cq—1,e = 0 (recall that e is odd) and ap.2 = ao.) =
ao,o = I.

We verify Eq. (12): If 7 is odd then co; = Ca—1,j+e = 1 and (ao, ;, 40,41, 40,j+2) €
{(, 0,0), 0,1, 1), (0,0, 1D}. If 7 > O is even, then co; = ca-1,j4e = O and
(ao, j40,;+15 40,42) € (CL, 1,0), 0, 1, 1), (0, 0, 0)}.

Lastly, we verify Eq. (13): Ifi + 7 is even then c;,; = 0, cj-1,; = 1, ai, j42 = a,j; = 0
and Qj j+l1 = 1. Ifi + 7 is odd then Cij = 1, Ci-1,j = 0, Qj, j+2 = 4,j = 1 and Qj, j+l = 0.

Case (b): In this case, the r-matrix of the carry sequence is

1 O 1 O 1 O
0 1 0 1 0 1
Mer = (ci,;) =
1 O 1 O 1 O
0 1 0 1 0 1

Equation (11) is valid since coo = 1, cg—1,e = 1 and ap,9 = ao,2 = | and ap,; = 0. The
verification process for Eqs. (12) and (13) is identical to Case (a) with odd and even swapped.
O

Q) Springer
2616 L. Kolsch

3.4 Kasami inverses with special structure

We now investigate cases where the inverses of Kasami exponents have some special structure.
These cases will also illustrate the results in the previous sections and show how to get from
the representation using r-matrices to the “usual” binary representation.

In [10, Proposition 3.13], it was shown that the inverse of K, modulo 2°" _ Lis cyclotomic

. . . ar
equivalent to the Kasami exponent K2,. It was conjectured that K, ' modulo 2% — 1 for
b|r and 5 { b is always cyclotomic equivalent to a Kasami exponent. This conjecture can be
proven using Proposition 7.

r

Proposition9 Let d = 5 with b|r,n = 5d and K, ' be the least positive residue of the
inverse of K; modulo 2” — 1. Then

274K5q~— (mod 2” — 1) ifb =1 (mod 5)
e-l = 274Kq (mod 2” — 1) ifb =2 (mod 5)
" —— 1274-Ka (mod2”—1) = ifb=3 (mod 5)

2°4-" Kyqg (mod 2"—1) ifb=4 (mod 5).

Proof We use the notation of Proposition 7. We have d = gcd(n,r) = 5 and 5 = S. Further,
we have 5 = b. The only two possible odd values for e are e = | and e = 3 that are attained
for b = 1 (mod 5) and b = 2 (mod 5), respectively. These correspond to case (b) and (f)
in Proposition 7. We get K~! = yD Yio aj,;2'~/" (mod 2” — 1) where the values aj, ;
are the entries of the matrix M, if e = 1 and M> if e = 3:

1 It O 1 O 0 1 0 0 41

1 1 0 O O 0 1 O 0 O
M,=]{. . »Mo =

1 1 O O O 0 1 0 0 O

We now write K. ' in its usual binary representation. To do this, we write from right to left
in the following way: We start with the first column, and then proceed in steps of length e to
the left (cyclically). So, for the case e = 1, we start with column 0 of Mj, then column 4,
then 3, then 2 and then 1, resulting in:

K;! = (1,1,...,1,1,0,0,...,0,0,1,0,0,...,0,0,1,1,...,1, 1)
a ee a es
d-times 2d—1-times d-times d-times

and for the case e = 3 the order of the columns is 0, 2, 4, 1, 3, resulting in:

K,! = (0,0,...,0,0,1,1,...,1,1,0,0,...,0,0, 1,0,0,...,0, 0)
Se ee ee a
d-times d-times d—1-times 2d-times

In the first case, we have K~ 1 = 274k,, (mod 2” —1) and in the second case K , l= 24K,
(mod 2” — 1). If e = 2 and e = 4 (corresponding to the values b = 3 (mod 5) and b = 4
(mod 5)) we use the relation K- l= 2-7 K vl (mod 2” — 1) and apply the procedure above
to Ky_+.- oO

In fact, in [10] several nice formulas for the inverses of K, modulo 24” — 1 for small
fixed values of k have been found. Our framework gives an explanation why these inverses
have a strong structure: We have ED = k, so the r-matrices always have k columns. By
Propositions 6 and 7, all but one row in the r-matrix are identical, so we get long runs of

Q) Springer
On the inverses of Kasami and Bracken-Leander exponents 2617

zeroes and ones (as observed in the proof of Proposition 9). All of these formulas can also
be obtained using our framework. In particular, it was shown in [10] that ifn = a with
b|r and gcd(3, b) = 1 then the inverse of K, modulo 2” — | has the lowest possible weight
2. Using the results we obtained in the previous sections, we give an alternative proof and
show additionally that (apart from sporadic cases for low values of 1) these are the only cases

where the inverses of Kasami exponents have weight 2.

Proposition 10 Let K,. be invertible modulo 2" — 1 withn => 6 and K,- ! be the least positive
residue of the inverse of K, modulo 2" — 1. Then wt(K,- ') = 2 ifand only ifn = i with
b|r and gcd(b, 3) = 1. In these cases we have

K-l= 2"-14.93-! (mod 2”—1)  ifb=1 (mod 3)
r ~ Vor-l49%-l (nod 2"—1) ifb=2 (mod 3).

Proof We go through the results in the earlier sections and check when wt(K,- ') = 2 is
fulfilled. In Proposition 6, we have wt(kK,~ ly = noes where d = gcd(r,n). We have
1st" = 2 if and only if n = 3d. So,n = + for some b with gcd(b,3) = 1. We
differentiate the two possible cases e = | and e = 2 corresponding to b = | (mod 3) and
b = 2 (mod 3), respectively. If e = 1, we are in Case (a) of Proposition 6 and the matrix
Mz,r looks as follows:

Mar =|- ,
0 0 0
1 1 O

Consequently, K7! = 23-1 423-17 = 2"-1 423-1 (mod 2” — 1). Here we used that
= % (mod n) since b = | (mod 3). If e = 2, we apply the same procedure to K;,_,, so
Ky). =23-1423-1-@-) = 2"-1 4.237! (mod 2” — 1) since here r = “f (mod 7).
Then K,! = 2-27 KT = 2-14 97-1 (mod 2” — 1).
We now check Proposition 7. In the Cases (a)-(d) we have wt(K, 1) =
wt(K~!) = 2 if and only if d = n — 2. Since d|n and n > 4, this is not possible.
In the Cases (e) and (h) we have (using the notation from the proposition) wt(K,- 1) =
nds D+" so wt(K, |) = 2 if and only if n — d(s + 1) = 2. Since d|n, this implies d|2.

Using the bound in Corollary 3, we infer that wt(K,- !) s 2ifn > 6. In the Cases (f) and (g)
n—d(s+2)+2
2

n—d+2
—T-, SO

we have wt(K~!) = . Again we get d|2 and the same argument as before yields
r

 

wt(K,!) > 2.
In Proposition 8 the inverses have always binary weight nt? sO no new cases
are found. Oo

Note that the condition n > 61s necessary. Indeed, for n = 5 we get sporadic cases: Consider
K» = 13 over F55. We have gcd(5, 2) = 1 and 2-3 = 1 (mod 5), so e = 3 and the inverse
of 13 modulo 2° — 1 has weight 2 by Corollary 1.

4 The Bracken-Leander exponent

We now determine the inverse of the Bracken—Leander exponent BL, = 27” +2" +1 modulo
2*" — 1 with r odd. In this case, the exponent is not independent from the field size. Because

Q) Springer
2618 L. Kolsch

of this, finding the inverse is much easier. We again use the modular add-with-carry approach.
Theorem | applied to the Bracken—Leander exponents yields the following condition for the
carry sequence.

Theorem 8 Let r odd, n = 4r, a ¢€ {1,...,2” — 2} and BL, be the Bracken—Leander
exponent. We denote by a = (an_1,..., 49) the binary expansion of a. The following are
equivalent:

(a) ais the inverse of BL, modulo 2” — 1.

(b) There exists a carry sequence c = (Cn_1,..-, C9) with c; € {0, 1, 2} such that
2co — c-1 + 1 = a_2, +a_+ +9 (21)
2cj — Ci-1 = Gi-2r +ai-r + qj foralli > 0. (22)

Here, the indices are seen as elements in Z,.

The carry sequence in (b) is unique.

Observe that gcd(r,n) = r and ZaG5 = 4. The case here is thus similar to the =a7>5
even case of the Kasami functions. We again use r-matrices so that Eqs. (21) and (22) have

an easier structure.

Theorem 9 Letr odd,n = 4r,a € {1,...,2”—2} and BL, = 27" +2" +1 be the Bracken-
Leander exponent. We denote by a = (ayn_1,..., a9) the binary expansion of a. Moreover,
let

a0,0 a0,1 ao,2 ao0,3
41,0 a1,1 a1,2 a1 ,3
Ma,r =
Gr—-1,0 4r—-1,1 4r—-1,2 4r—-1,3
be the r-matrix of a, i.e. a = 9 *-0 di, j2! ~J” (mod 2” — 1). The following are equiv-
alent:

(a) a is the inverse of K, modulo 2” — 1.
(b) There exists an r-matrix for the carry sequence c of the form

C0,0 CO,1 C0,2 C0,3

C1,0 C1,1 C1,2 C1,3
Mer =

Cr-1,0 Cr—1,1 Cr—1,2 Cd-1,3

with c;,; € {O, 1, 2} such that the following equations hold:

2c0,0 — Cr—1,1 + 1 = a0,2 + 40,1 + 40,0 (23)
2C0,j; — Cr—1,j+1 = 40,j42 + 40,j41 +40,; for j € {1, 2, 3} (24)

2c); — Ci-1,j = 4i,j42 + 4i,j41 t+ aj,; foralli € {1,...,r—1}, 7 € {0, 1, 2, 3}.
(25)

The carry sequence (and thus its associated r-matrix) in (b) is unique.

It is easy to derive some strong necessary conditions from the equations. For example
Eq. (25) implies that, if cj,; = 0 for some i > 0, then necessarily cj-1,; = aj,j42 =

Q) Springer
On the inverses of Kasami and Bracken-Leander exponents 2619

dj,j+1 = 4,; = 0, which inductively leads to cy; = aj j42 = Gi j41 = Gj = O for
all 0 < i’ < i. With some examples for small values of n, it is then quite easy to guess the
correct r-matrices for the sequence a and its associated carry sequence c.

Proposition 11 Letr odd, n = 4r and BL, = 27" +2" +1 be the Bracken—Leander exponent.
Then BL 1 9 *-0 aj,j2'-/” (mod 2” — 1) where the values a;,; are the entries of
the matrix

1 1 1 O

0 0 0 O

1 1 1 1

0 0 0 O
Mar =

1 1 1 1

1 1 1 1

We have wt(BL~!) = ne

Proof The r-matrix of the corresponding carry sequence is

222 2

1 11 1

222 2

1 11 1

(ci,j) =

222 2

1 1 1 1

222 2
We verify Eqs. (23)—-(25). Equation (23) holds because co,9 = c-—1,1 = 2 and ao,o = a0,1 =
ao,2 = 1. Equation (24) holds because co; = c;—1,j41 = 2 and (a0,;, d0,j;41,40,j42) €
{(1, 1,0), Gd, 0, 1), (0, 1, 1} if 7 € {1, 2, 3}.

It only remains to check Eq. (25). For i odd, we have c;,; = 1, cj-1,; = 2 and aj,; =
Qj,j+1 = 4,j42 = 0. Fori > 0 even, we have c;,; = 2, cj_-1,; = 1 and aj; = aj,j41 =
aj,j+2 = 1, so Eq. (25) is satisfied.

To determine wt(BL>), we count the number of ones in M,,,, so wt(BL>!) = 4rtt —
1= 2. Oo

2

5 Conclusion

In this paper, we introduced a new approach to find inverses of elements in Zon_1, using the
modular add-with-carry approach. With this technique, we determined the inverse of all Gold
exponents G, = 2” + 1 and Kasami exponents K, = 27” — 2” + 1 modulo 2” — 1 (if they
exist) as well as the inverse of the Bracken—Leander exponent BL, = 2?r +2" + 1 modulo
2*" — 1 with r odd. With our contribution, the binary representations of the inverses of all
known APN exponents as well as the inverses of all exponents that give rise to 4-differentially
uniform permutations in even dimension are found. The more general problem of inverting
a given element / in Zn_ for all n is still not well understood. It is a natural question if the

Q) Springer
2620 L. Kolsch

approach using the modular add-with-carry algorithm can be generalized to other exponents.
For every invertible /, we can find a defining set of equations for the binary representation of
1! and the corresponding carry sequence in the style of Eq. (1) in Theorem 1. The difficulty
then lies in finding the sequences that satisfy the equations. This has to be done on a case by
case basis.

Inversion in Z_ 1s not only interesting for questions relating to differential uniformity.
For example, if / is a complete permutation polynomial (CPP) exponent over Fg (i.e. there
exists ana € FF, such that ax! and ax! +x are permutation polynomials), then also its inverse
1—! modulo g — 1 is a CPP exponent [13]. Several CPP exponents in even characteristic have
been found (e.g. [3,16,17]). For a complete classification of CPP exponents, finding explicit
formulas for the corresponding inverses is an interesting research problem.

The modular add-with-carry approach can be easily modified to work also in the ring Zpn—1
for a prime p > 2 [5, Theorem 4.1]. In particular, it can be used to tackle the problem of
inversion in Zpn_1 (corresponding to inversion of monomials in odd characteristic). However,
the equations in the style of Eq. (1) that have to be checked become more complicated.

Acknowledgements I sincerely thank the reviewers for their careful reading of the paper, pointing out several
typos and some helpful suggestions about the presentation of the results. Moreover, I would like to thank
Gohar Kyureghyan for fruitful discussions and encouragement in the pursuit of this problem.

Funding Open Access funding enabled and organized by Projekt DEAL.

Open Access This article is licensed under a Creative Commons Attribution 4.0 International License, which
permits use, sharing, adaptation, distribution and reproduction in any medium or format, as long as you give
appropriate credit to the original author(s) and the source, provide a link to the Creative Commons licence,
and indicate if changes were made. The images or other third party material in this article are included in the
article’s Creative Commons licence, unless indicated otherwise in a credit line to the material. If material is
not included in the article’s Creative Commons licence and your intended use is not permitted by statutory
regulation or exceeds the permitted use, you will need to obtain permission directly from the copyright holder.
To view a copy of this licence, visit http://creativecommons.org/licenses/by/4.0/.

References

1. Carlet C.: Vectorial Boolean Functions for Cryptography. Encyclopedia of Mathematics and Its Applica-
tions, pp. 398-470. Cambridge University Press, Cambridge (2010).

2. Carlet C., Charpin P., Zinoviev V.: Codes, bent functions and permutations suitable for DES-like cryp-
tosystems. Des. Codes Cryptogr. 15(2), 125-156 (1998).

3. Charpin P., Kyureghyan G.M.: Cubic monomial bent functions: a subclass of MM. SIAM J. Discret. Math.
22(2), 650-665 (2008).

4. Courtois N.T.: Fast algebraic attacks on stream ciphers with linear feedback. In: Boneh D. (ed.) Advances
in Cryptology - CRYPTO 2003 (Berlin, Heidelberg), pp. 176-194. Springer, Berlin (2003).

5. Helleseth T., Hollmann H.D.L., Kholosha A., Wang Z., Xiang Q.: Proofs of two conjectures on ternary
weakly regular bent functions. IEEE Trans. Inf. Theory 55(11), 5272-5283 (2009).

6. Hernando F., McGuire G.: Proof of a conjecture on the sequence of exceptional numbers, classifying
cyclic codes and APN functions. J. Algebra 343(1), 78-92 (2011).

7. Hollmann H.D., Xiang Q.: A proof of the Welch and Niho conjectures on cross-correlations of binary
m-sequences. Finite Fields Appl. 7(2), 253-286 (2001).

8. Hou X.D., Mullen G.L., Sellers J.A., Yucas J.L.: Reversed Dickson polynomials over finite fields. Finite
Fields Appl. 15(6), 748-773 (2009).

9. Knudsen L.R.: Truncated and higher order differentials. In: Preneel B. (ed.) Fast Software Encryption
(Berlin, Heidelberg), pp. 196—211. Springer, Berlin (1995).

10. Kyureghyan G.M., Suder V.: On inversion in Zon _1. Finite Fields Appl. 25, 234—254 (2014).
11. Langevin P., Leander G., Mcguire G., Zalinescu E.: Analysis of Kasami-Welch functions in odd dimension

using Stickelberger’s theorem. J. Comb. Number Theory 2(1), 55-72 (2011).

Q) Springer
On the inverses of Kasami and Bracken-Leander exponents 2621

12.
13.

14.

15.

16.

17.

McEliece R.J.: Finite Field for Scientists and Engineers. Kluwer Academic Publishers, Norwell (1987).
Niederreiter H., Robinson K.H.: Complete mappings of finite fields. J. Aust. Math. Soc. A 33(2), 197-212
(1982).

Nyberg K.: Differentially uniform mappings for cryptography. In: Helleseth T. (ed.) Advances in
Cryptology—EUROCRYPT ’93 (Berlin, Heidelberg), pp. 55-64. Springer, Berlin (1994).

Portmann M., Rennhard M.: Almost perfect nonlinear permutations. Semester Project - SwissFederal
Institute of Technology Zurich (1997).

Tu Z., Zeng X., Hu L.: Several classes of complete permutation polynomials. Finite Fields Appl. 25,
182-193 (2014).

Wu G., Li N., Helleseth T., Zhang Y.: Some classes of monomial complete permutation polynomials over
finite fields of characteristic two. Finite Fields Appl. 28, 148-165 (2014).

Publisher's Note Springer Nature remains neutral with regard to jurisdictional claims in published maps and
institutional affiliations.

Q) Springer
