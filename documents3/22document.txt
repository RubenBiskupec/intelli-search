Medical Image Analysis 66 (2020) 101810

 

     

ELSE

Contents lists available at ScienceDirect

Medical Image Analysis

 

journal homepage: www.elsevier.com/locate/media

 

Image-level detection of arterial occlusions in 4D-CTA of acute stroke
patients using deep learning chest

Midas Meijs*, Frederick J.A. Meijer, Mathias Prokop, Bram van Ginneken,

Rashindra Manniesing

Diagnostic Image Analysis Group, Department of Radiology and Nuclear Medicine Radboud University Medical Center Geert Grooteplein 10, 6525 GA,

Netherlands

ARTICLE INFO

Article history:

Received 5 November 2019
Revised 10 August 2020

Accepted 11 August 2020
Available online 5 September 2020

Keywords:

4D-CTA

Stroke

Deep Learning

Convolutional Neural Networks

ABSTRACT

The triage of acute stroke patients is increasingly dependent on four-dimensional CTA (4D-CTA) imaging.
In this work, we present a convolutional neural network (CNN) for image-level detection of intracranial
anterior circulation artery occlusions in 4D-CTA. The method uses a normalized 3D time-to-signal (TTS)
representation of the input image, which is sensitive to differences in the global arrival times caused by
the potential presence of vascular pathologies. The TTS map presents the time within the cranial cavity at
which the signal reaches a percentage of the maximum signal intensity, corrected for the baseline inten-
sity. The method was trained and validated on (n = 214) patient images and tested on an independent set
of (n = 279) patient images. This test set included all consecutive suspected-stroke patients admitted to
our hospital in 2018. The accuracy, sensitivity, and specificity were 92%, 95%, and 92%. The area under the
receiver operating characteristics curve was 0.98 (95% CI: 0.95- 0.99). These results show the feasibility

of automated stroke triage in 4D-CTA.

© 2020 The Authors. Published by Elsevier B.V.

This is an open access article under the CC BY license (http://creativecommons.org/licenses/by/4.0/)

1. Introduction

Four-dimensional computed tomography angiography (4D-CTA)
is an imaging modality that enables the visualization of cerebral
hemodynamics and plays an increasingly important role in the di-
agnostic assessment of different neurovascular disorders including
acute cerebral stroke (Kortman et al., 2015). In 4D-CTA, the vascu-
lature can be assessed, while the derived CT perfusion maps pro-
vide a visualization of the permeability of the brain tissue. Vessel
occlusions caused by an embolus or thrombus are an important
cause of cerebral stroke resulting in ischemic damaged brain tis-
sue. Damaged brain tissue can be differentiated between infarct
core and penumbra, the latter can recover if blood supply is re-
stored in time. Clot removal via endovascular therapy (EVT) has
shown to improve patient outcome with proximal large vessel oc-
clusions within 6 hours after onset of symptoms (Campbell et al.,
2015; Berkhemer et al., 2015; Saver et al., 2015; Goyal et al., 2015;
Jovin et al., 2015; Bracard et al., 2016). Follow-up studies (Albers
et al., 2018; Nogueira et al., 2018; Ma et al., 2019) showed that
EVT can also be effective in the period 6-24 hours after onset of

* Corresponding author.
E-mail address: midas.meijs@radboudumce.nl (M. Meijs).

https://doi.org/10.1016/j.media.2020.101810

symptoms when patients with a large vessel occlusion are selected
based on the extent of the infarct core and penumbra, which can
be assessed on perfusion maps calculated from 4D-CTA.

The interpretation of these 4D-CTA images, either directly by vi-
sual assessing the vascular morphology and its contrast changes to
identify occlusions (Meijer et al., 2019) or indirectly by assessing
the perfusion maps to identify perfusion deficits caused by these
occlusions, is time-consuming and prone to observer variability
(Shankar et al., 2016; Becks et al., 2019). Perfusion maps are also
known for their large variability in itself (Goyal et al., 2013) with
many factors playing a role, including protocol acquisition settings
and the choice of software package for the calculations (Kudo et al.,
2013). In this work we therefore aim to automate the detection
of intracranial anterior circulation artery occlusions directly in 4D-
CTA.

Only a few related studies were found and those were per-
formed on non-contract CT (NCCT) or static CTA (Santos et al.,
2014; 2016). In those studies, a semi-automatic thrombus detec-
tion method was presented by manually placing two seed points
at the contralateral side which were used to segment the vascula-
ture. The vasculature was then registered to the affected side and
a region growing algorithm was applied within a generated mask
to detect and analyze the thrombus. A downside of this method is
that user interaction is required.

1361-8415/© 2020 The Authors. Published by Elsevier B.V. This is an open access article under the CC BY license (http://creativecommons.org/licenses/by/4.0/)
2 M. Meijs, FJ.A. Meijer and M. Prokop et al./Medical Image Analysis 66 (2020) 101810

In recent years, medical imaging has seen an increase of deep
learning applications (Litjens et al., 2017) achieving near human
performance in many domains (Gulshan et al., 2016; Esteva et al.,
2017; Ehteshami Bejnordi et al., 2017; Lakhani and Sundaram,
2017). Only two studies were found using deep learning for oc-
clusion or thrombus detection. One proposed a convolutional neu-
ral network (CNN) applied to NCCT based on information from
the affected and contralateral side together with atlas informa-
tion (Lisowska et al., 2017), and another used 2D maximum inten-
sity projections (MIPs) with ResNet-50 for case prediction on CTA
(Stib et al., 2018). Some deep learning methods were developed by
industry (Chatterjee et al., 2019), but lack methodological and eval-
uation details. None of the related work, either using conventional
or deep learning method, were developed for 4D-CTA.

In this work, we propose a deep learning approach for the au-
tomated detection of intracranial anterior circulation artery occlu-
sions in 4D-CTA.

2. Materials
2.1. Study population

The collection of a retrospective cohort of patients was ap-
proved by our local medical ethical committee and informed con-
sent was waived. Scans from all patients that were admitted to
our hospital between January 15¢ 2014 and December 315t 2018
with the suspicion on acute ischemic stroke were collected and
anonymized. The data collected between January 1° 2014 and
December 31° 2017 was used for training and validation of the
method. All consecutive patients from 2018 who received a 4D-
CTA for the suspicion on acute ischemic stroke were collected as
a separate test set. Patients were included as positive data if they
received a 4D-CTA and if they were diagnosed with an intracra-
nial anterior circulation arterial vessel occlusion (i.e. ICA, MCA or
ACA). Vascular occlusions in the posterior circulation (i.e. vertebral
arteries, basilar arteries or PCA) were not included as the level of
evidence for performing EVT in these occlusions is not yet based
on randomized control trials (Powers et al., 2018). Patients without
vascular occlusions were included as negative data.

2.2. Scanning protocol

All patients were scanned on a 320-row detector CT scanner
(Aquilion One, Canon Medical Systems Corporation, Japan). The 4D-
CTA acquisition protocol consisted of 19 volumetric scans. Each
scan was made at 80 kV and 0.5 seconds rotation time with 16 cm
z-coverage. At the start of the protocol a single high dose acquisi-
tion at 200 mAs was performed, followed by 13 100 mAs acquisi-
tions at 2 seconds interval, followed by 5 75 mAs acquisitions at 5
seconds interval. A 50 mL contrast agent bolus (300 mg iodine/mL
Iomeron, Bracco Imaging, Italy) was intravenously injected in the
antecubital vein at the start of the first acquisition. Image recon-
struction was done using a smooth kernel (FC41) resulting in im-
age sizes of 512x512x320 voxels with voxel sizes of 0.43x0.43x0.5
mm.

2.3. Reference standard

The reference standard of the presence of an intracranial ves-
sel occlusion was based on the radiology report taking into ac-
count the patient history and all available imaging data including
the NCCT, CTA, 4D-CTA and derived perfusion maps. In a previous
study (Becks et al., 2019), we showed that including the 4D-CTA
and derived perfusion maps in the evaluation, readers achieved
high accuracy in detecting intracranial vascular occlusions. Label-
ing was done at image-level.

3. Methods

A deep learning approach based on a convolution neural net-
work (CNN) is proposed. Memory limitations of the current high-
end GPU cards make it impossible to use the full 4D-CTA images
as input for the network. Therefore, a normalized time-to-signal
(nTTS) map of the 4D-CTA was derived capturing the temporal in-
formation in a down-sized 3D space. In the following, each step of
the deep learning approach is explained in detail.

3.1. Input

The cranial cavity was first segmented (Patel et al., 2017) and
then smoothed using a Gaussian filter (kernel size of 20 voxels and
6 time points) to reduce spatial and temporal noise. The tissue at-
tenuation curve per voxel describes contrast changes over time in
Hounsfield Units (HU). For each voxel in the cranial cavity a point
on this curve is searched where the attenuation reaches a percent-
age a of the maximum signal intensity, corrected for the baseline
intensity (Eq. (1)). In the proposed method a@ was set to 0.8.

threshold =I+a. Umax _ Imin) (1)

Here, Ijni7 and Imax are the minimum and maximum HU in the
temporal direction for the current voxel. The TTS was then found
by linearly interpolating the found I;preshoig and the known acquisi-
tion time points as

TTS =1)+ B- (T% — 1h), (2)
with

_ threshold ~~ Ip
Po hh °)

Here, Tp, T;, Ip and I, are the acquisition time points and in-
tensity values around I;presnoig Tespectively, as shown in the tissue
attenuation curve plot in Fig. 1.

The TTS maps were normalized for the different absolute arrival
times between patients, as follows. The first and last time point in
the TTS histogram with bin-size = 0.01 s which reached 20% of the
maximum histogram value defined T,,;,, and Tmax. The TTS values
were then normalized to relative arrival times:

nITS =TTS- —— (4)

Tinax _ Trin
An example of the resulting nITS map overlaid on the 4D-CTA im-
age is shown in Fig. 2. The nITS map was finally down-sized to
68x68x68 voxels using nearest neighbor interpolation and used as
input for the CNN.

3.2. Convolutional neural network

The input size for the CNN were volumes of 68x68x68 voxels.
The CNN consisted of three blocks of two 3D convolutions with
batch normalization (BN) and rectified linear unit (ReLU) activation
followed by 2x2x2 max-pooling. Each convolution decreases the
spatial resolution with 2 voxels. After the last block, two 3D con-
volutional filters were added to reduce the spatial size to 1 voxel
(1x1x1). Two fully connected filters with drop-out (p = 0.5) were
added after the last convolution. Finally, a softmax function was
calculated over the final filter to obtain a classification probability
indicating the presence of an occlusion. A schematic overview of
the network architecture is shown in Fig. 3.

3.3. Data augmentation
In order to make the network more generalizable and to pro-

vide the network with more training examples, three different
types of augmentations were used, which were representative of
M. Meijs, FJ.A. Meijer and M. Prokop et al./ Medical Image Analysis 66 (2020) 101810 3

300

   
  
    

275

250
225
200
175

Intensity [HU]

150
125
100

80% of Maximum Intensity

 

— Attenuation curve
Ty ° Acquisition point

 

0 5 10 15 20

30. #35 #40 #45 #250 #55

Time [s]

Fig. 1. Example of tissue attenuation curve from which I;nresnoiq is determined and interpolated to the time-to-signal. Here, a is set at 0.8 (80% of the maximum intensity,

corrected for the baseline intensity).

 

Fig. 2. Example of the nITS map, colorized, overlaid on the 4D-CTA image. Red
indicates an early arrival time and blue indicates a late arrival time. The late arrival
time, compared to the contralateral side, can be seen in the left hemisphere due to
a M2 vascular occlusion. All arrivals times were normalized between 0 and 1.

variations expected in a larger data set. First, rotation around a
randomly chosen axis in the range of —30circ to +30°, second, flip-
ping around the y-axis of the image and third, intensity scaling by
multiplication with a random number between 0.9 and 1.1. The oc-
currence of the augmentations was set to 90%.This means that each
sample individually has a 90% chance of being augmented. Only
one augmentation was applied to a sample, meaning multiple aug-
mentations were not combined (e.g. rotation and flipping were not
applied at the same time). The prevalence of the different augmen-
tations was evenly distributed.

3.4, Training and evaluation

The network was trained with an equal amount of positive
and negative cases sampled from the training set. The network

was trained for 500 iterations. For each iteration 5 batches of
12x68x68x68 patches were provided to the network. The net-
work was trained on a NVIDIA GTX1080 GPU. Cross-Entropy was
used for the loss calculation and ADAM (Kingma and Ba, 2014)
was used to minimize the loss with an initial learning rate
of 10-°.

The best performing network was determined based on 1200
evaluation patches evenly sampled from the 30 images from the
validation set. These patches were augmented similar to the train-
ing set, resulting in 400 different augmentation per images. The
evaluation on the test set was done separately after establishing
the best performing network on the validation set. A receiver op-
erating characteristics (ROC) curve, with 95% confidence intervals,
was Calculated and the sensitivity, specificity, positive predictive
value, and negative predictive value were reported at a specific op-
erating point.

3.5. Additional experiments

In order to compare the value of the nITS maps, a baseline
experiment was conducted using the Time-to-Peak as input for
the CNN. The same network architecture and training strategy de-
scribed in Sections 3.2 to 3.4 was used, but with the TTP as input
image. The TTP was calculated and cropped in a similar manner as
the nTTS, using Formula 1 with a = 1.0.

4. Results
4.1. Patient characteristics

In total, 584 patients (age: 66.55 + 15.0, male: 271) with a
4D-CTA acquisition were collected of which 166 patients had an
intracranial anterior circulation artery occlusion. Patients with oc-
clusions extending into other branches were labeled as the most
proximal branch (e.g. a patient with an M1 occlusion that ex-
tended into the M2 branch was labeled as M1). Patients were di-
vided into separate training, validation and test sets. Different lo-
cations of the occlusions were distributed evenly over the train-
ing and validation set. From the 198 negative 4D-CTAs, a ran-
dom subset was taken, equal to the positive training and valida-
tion set and distributed over the training and validation set. The
separate test set was collected consecutively and contained 59 pa-
tients with an intracranial anterior circulation artery occlusion and
220 without. A schematic overview of the study data is shown
in Fig. 4.
4 M. Meijs, FJ.A. Meijer and M. Prokop et al./Medical Image Analysis 66 (2020) 101810
68 x 68 x 68
128 x
32 x 32 x 32 256 X
14x 14x 14 512 x
5x5x5 1024 x Probability

>>>

64 128 128 256

—_—> Conv3D, BatchNorm, ReLu, kernel-size = 3, stride = 1

——) MaxPool, kernel-size = 2

256 512 512 1024 1024 1024 2

——) Fully Connected Layer, Dropout (p = 0.5)
——)}> Fully Connected Layer, Softmax

Fig. 3. Network architecture. Input volume of 68x68x68, followed by 3 blocks of two 3D convolutions with batch-normalization (BN) and rectified linear unit (ReLU) acti-
vation, and max-pooling, followed by two 3D convolution. After the convolutional filters, two fully connected filters and a soft-max layer. The number of filters is indicated

above the convolutions.

Patients suspected of stroke
with 4D-CTA

2014 - 2018
n= 584

 

ICA Occlusion
n=28

2014 - 2017
n= 305

M1 Occlusion
n=36

n= 34 n= 107
Vv
Random subset

M3/M4 Occlusion n= 107

n=7

ACA Occlusion
n=2

Training set (n = 184)
ICA = 23, M1 = 31
M2 = 31, M3/M4 = 5
ACA = 2, Negatives = 92

 

Validation set (n = 30)
ICA =5,M1=5
M2 = 3, M3/M4 = 2
Negatives = 15

 

ICA Occlusion
n=10

M1 Occlusion
n=26

No occlusion
n=220

M2 Occlusion
n=17

Occlusion
n=59

M3/M4 Occlusion
n=5

ACA Occlusion
n=1

Test set (n = 279)
ICA = 10, M1 = 26

M2 = 17, M3/M4 = 5
ACA = 1, Negatives = 220

 

Fig. 4. Overview of study data. Distribution of the training, validation and test sets with different types of intracranial vessel occlusions and negative data.

4.2. Image-level detection of arterial occlusions

The optimal accuracy after 5 hours of training was 0.97 over the
1200 validation patches. Preprocessing of the 4D-CTA image (i.e.
Gaussian filtering and nTTS calculation) took less than 4 minutes
per case. Prediction by the CNN took less than half a second. An
example case is shown in Fig. 5. Fig. 6 shows a tri-planar view of
additional cases, including false positive and false negative results.
Fig. 7 shows the ROC curves for the experiment using the nTITS
map and the TIP map in green and red, respectively. This results
in an area under the curve of 0.98 for the detection of an anterior
circulation vessel occlusion using the nITS map and an area un-
der the curve of 0.76 using the TIP map. At the selected operating
point, the sensitivity was 0.95 and specificity 0.92 translating to 3
false negative cases for experiment 1 using the nTTS map. For ex-

periment 2, using the TTP maps, an operating point at a sensitivity
of 0.71 is chosen resulting a specificity of 0.66, 17 false negatives
and 74 false positives. The positive and negative predictive values
as well as the 95% confidence intervals can be found in Table 1.
The three false negative cases in experiment 1 were patients with
an occlusion in the distal MCA, M3, and M4 branch, respectively.

5. Discussion

In this work, we have presented an image-level labeled deep
learning approach for the automated detection of intracranial an-
terior circulation artery occlusions on 4D-CTA in acute stroke. The
sensitivity and specificity proved 95% and 92% on an independent
consecutive test set of 279 cases, translating to 3 false negatives
and 18 false positives. The overall computation time was less than
M. Meijs, FJ.A. Meijer and M. Prokop et al./ Medical Image Analysis 66 (2020) 101810

Table 1

Diagnostic accuracy of convolutional neural networks trained with nITS maps (Experiment 1) and

TIP (Experiment 2) as input. The 95% confidence interval is shown within brackets.

Sensitivity (95% Cl)

Specificity (95% CI)

Positive Predictive Value (95% CI)
Negative Predictive Value (95% Cl)
Area under curve (AUC) (95% CI)

Experiment 1 (nTTS map)

0.95 (0.86-0.99)
0.92 (0.87-0.95)
0.76 (0.67-0.83)
0.99 (0.96-1.00)
0.98 (0.95-0.99)

Experiment 2 (TTP map)

0.71 (0.58-0.82)
0.66 (0.60-0.73)
0.36 (0.31-0.42)
0.90 (0.85-0.93)
0.76 (0.68-0.83)

 

Fig. 5. Example of the normalized TTS map, colorized, overlaid on the 4D-CTA im-
age. Red indicates an early arrival time and blue indicates a late arrival time. The
late arrival time, compared to the contralateral side, can be seen in the right hemi-
sphere due to a M1 M1 segment vessel occlusion. The probability estimated by the
network of an occlusion being present for this case was 0.999.

4 minutes per case. The network showed good performance with
an area under the ROC curve of 0.98 (95% CI: 0.95 0.99).

The test set was an independent cohort of all patients from
2018, therefore, the obtained result is indicative of the perfor-
mance that could be reached in real clinical practice.

The current endovascular therapy is aimed at removing of an-
terior circulation large vessel occlusions. Our method is able to
detect patients eligible for this treatment and even patients with
proximal and distal occlusions in the M2 and M3 segments. Ac-
cording to the recently updated guidelines for acute stroke man-
agement (Powers et al., 2018), analysis of randomized control tri-
als have shown that these patients may benefit from EVT as well
when carefully selected. Patients with posterior circulation occlu-
sions have not been included, as the evidence of the benefit is, at
this point, only based on clinical experience of experts.

Although our method does not provide a direct localization of
the occlusion, patients without vascular occlusions are identified
with high confidence given the NPV of 0.99. Among these patients,
other findings, such as old ischemic regions or preexisting condi-
tions were present. Patients classified with vascular occlusions can
then be further evaluated for the exact location of the vessel oc-
clusion on CTA. Furthermore, calculated nITTS maps show an intu-
itive representation of the arrival time in the brain, similar to the
presentation of the perfusion maps. This provides immediate feed-

 

Fig. 6. Examples of correctly and incorrectly classified cases. Red indicates an early
arrival time and blue indicates a late arrival time. Top left: true positive with a M1
segment vessel occlusion. Bottom left: false negative with a distal MCA occlusion
on the left side. Top and bottom right: true negative and false positive cases, re-
spectively.

back, where the observers attention is drawn to the late arrival
caused by the vascular occlusion, as shown in Figs. 2 and 5. Fur-
ther tissue viability estimation may be done using perfusion maps,
but this was beyond the scope of our method. As these images are
normalized, a comparison between patients may be more straight-
forward. Additionally, Fig. 6 shows the difficulty remaining analyz-
ing these images, where in the bottom row the network misses the
distal occlusion present in the left bottom image and incorrectly
labels the right bottom image as an occlusion.

The deep learning method is trained using image-level la-
beled data. Compared to related work, e.g. on thrombus detection
(Santos et al., 2014) where the hyperdense region on NCCT is be-
ing detected or segmented, our method has the advantage that no
manual annotation at voxel-level is required to develop the system.
Acquiring manual annotations at voxel-level is a time-consuming
and labor-intensive procedure prone to observer variability. More-
over, by using image-level labels we can process an entire case,
down-sized to 68x68x68 voxels, without the definition or segmen-
tation of regions-of-interest, affected hemispheres or user interac-
tion.

To our knowledge, this is the first method for the detec-
tion of intracranial anterior circulation occlusions using 4D-CTA.
Most related work is on thrombus detection in NCCT or CTA
and these methods require manual interaction by placing seed
points (Santos et al., 2014) or extracting a region on interest
6 M. Meijs, FJ.A. Meijer and M. Prokop et al./Medical Image Analysis 66 (2020) 101810

ROC Curve

— nTTS (Az = 0.98)[0.95 - 0.99]
—_ TTP (Az = 0.76)[0.68 - 0.83]

 

00 O01 02 03 04 05 06 07 08 09 1.0

1 - Specificity

Fig. 7. ROC curves on the test set with 95% confidence interval bands. In green,
experiment 1 using the nITS map as input. In red, experiment 2 using the TTP map
as input.

(Lisowska et al., 2017), Other deep learning approaches (Stib et al.,
2018) use ResNet-50 with cropped 2D CTA orthogonal MIPs as in-
put, but by generating a MIP valuable information may be lost.
Several medical software companies are working on automatic
large vessel occlusion detection (Chatterjee et al., 2019). However,
most of the companies use NCCT or CTA for the detection and do
not specify methodological details of their method, making a direct
comparison difficult.

The nITS map reduces the size and complexity of the 4D-
CTA image while maintaining relevant temporal information.As the
nITS is interpolated between the acquisition time point of the
imaging protocol, it has a higher precision with respect to the ar-
rival times. This is also shown in the results of the TIP experiment
in Fig. 7. The reduction of size and complexity allows for fast com-
putation and reduces the need for high-end GPU hardware. The
nITS map was calculated by applying a Gaussian blurring in all
dimensions, thereby reducing spatial and temporal noise. The con-
trast bolus arrival time can differ between patients, making gener-
alization between patients difficult. Here we propose a normaliza-
tion step by scaling the arrival times to the beginning of the con-
trast agent flow for each patient specifically. Doing so, the relative
arrival times can be compared between patients and the network
can interpret the temporal information of the 4D-CTA images be-
tween patients, regardless of absolute contrast arrival time.

The network used was a 3D CNN with a single probability as
output. The 3D input and 3D convolutions provide a larger inte-
gration of contextual information compared to 2D. This is bene-
ficial because vascular pathologies can be more difficult to detect
in 2D planes without center multiplanar reconstructions or inten-
sity projections. Other network architectures like long short-term
memory (LSTM) or recurrent neural networks (RNN) could be con-
sidered given the sequential nature of the 4D-CTA. However, a suit-
able representation of the extra dimensions would be necessary as
these networks require 1D or 2D inputs.

In this study, we focused on the detection of intracranial an-
terior circulation vessel occlusions in 4D-CTA scans for acute is-
chemic stroke. A limitation of this work is that there is no classifi-
cation or localization of the different types of occlusions. This may
be achieved by adding a segmented vasculature map (Meijs et al.,
2017; 2018) over the nITS map as input for the CNN. Also, no pa-
tients with bilateral vessel occlusions were present in the data set.
Furthermore, all cases were scanned on the same type of scanner

at a single center, therefore, future work will include more patient
data from different CT scanners and hospitals to increase the ro-
bustness and generalizability of the method and include patients
with posterior occlusions. The architecture can also be trained to
detect other cerebral pathologies that cause a disturbance of the
normal temporal information, such as arteriovenous malformations
or brain tumors, without major changes in network design. The re-
sults presented show the feasibility of automated stroke triage in
4D-CTA. Although the method could provide a first-line detection,
an observer study is necessary to assess its value in clinical prac-
tice.

6. Conclusion

We present the first deep learning approach to automatically
detect intracranial anterior circulation artery occlusions in 4D-CTA
of acute ischemic stroke at image-level. The presented method
achieves a sensitivity and specificity of 95% and 92% with an area
under the ROC curve of 0.98.

Declaration of Competing Interest

The authors declare that they have no known competing finan-
cial interests or personal relationships that could have appeared to
influence the work reported in this paper.

CRediT authorship contribution statement

Midas Meijs: Conceptualization, Methodology, Software, Valida-
tion, Formal analysis, Investigation, Data curation, Writing - origi-
nal draft, Writing - review & editing, Visualization. Frederick J.A.
Meijer: Conceptualization, Methodology, Resources, Data curation,
Writing - original draft, Writing - review & editing, Supervi-
sion. Mathias Prokop: Resources, Writing - original draft, Writ-
ing - review & editing, Project administration, Funding acquisition.
Bram van Ginneken: Methodology, Resources, Writing - original
draft, Writing - review & editing. Rashindra Manniesing: Concep-
tualization, Methodology, Validation, Formal analysis, Data cura-
tion, Writing - original draft, Writing - review & editing, Super-
vision, Project administration, Funding acquisition.

Acknowledgements

This work was supported by research grants from the Dutch
Technology Foundation (NWO), the Netherlands and Canon Med-
ical Systems Corporation, Japan.

References

Albers, G. W., Marks, M. P., Kemp, S., Christensen, S., Tsai, J. P., Ortega-Gutierrez,
S., McTaggart, R. A., Torbey, M. T., Kim-Tenser, M., Leslie-Mazwi, T., Sarraj, A.,
Kasner, S. E., Ansari, S. A., Yeatts, S. D., Hamilton, S., Mlynash, M., Heit, J. J.,
Zaharchuk, G., Kim, S., Carrozzella, J., Palesch, Y. Y., Demchuk, A. M., Bammer,
R., Lavori, P. W., Broderick, J. P., Lansberg, M. G., 2018. Thrombectomy for stroke
at 6 to 16 hours with selection by perfusion imaging.

Becks, R.J., Manniesing, R., Vister, J., Pegge, S., Steens, S.C., van Dijk, E.J., Prokop, M.,
Meijer, FJ., 2019. Brain CT perfusion improves intracranial vessel occlusion de-
tection on CT angiography. J. Neuroradiol. 46 (2), 124-129. doi:10.1016/j.neurad.
2018.03.003.

Berkhemer, O.A., Fransen, P.S., Beumer, D., van den Berg, L.A., Lingsma, H.F.,, Yoo, AJ.,
Schonewille, W,J., Vos, J.A.. Nederkoorn, PJ., Wermer, M.J., et al., 2015. A ran-
domized trial of intraarterial treatment for acute ischemic stroke. New Engl. J.
Med. 372 (1), 11-20.

Bracard, S., Ducrocq, X., Mas, J.L., Soudant, M., Oppenheim, C., Moulin, T.,
Guillemin, F, et al., 2016. Mechanical thrombectomy after intravenous alteplase
versus alteplase alone after stroke (thrace): a randomised controlled trial.
Lancet Neurol. 15 (11), 1138-1147.

Campbell, B. C. V., Mitchell, P. J., Kleinig, T. J., Dewey, H. M., Churilov, L., Yassi, N.,
Yan, B., Dowling, R. J., Parsons, M. W., Oxley, T. J., Wu, T. Y., Brooks, M., Simpson,
M. A., Miteff, F., Levi, C. R., Krause, M., Harrington, T. J., Faulder, K. C., Steinfort,
B. S., Priglinger, M., Ang, T., Scroop, R., Barber, P. A., McGuinness, B., Wijeratne,
T., Phan, T. G., Chong, W., Chandra, R. V., Bladin, C. F., Badve, M., Rice, H., de
M. Meijs, FJ.A. Meijer and M. Prokop et al./ Medical Image Analysis 66 (2020) 101810 7

Villiers, L., Ma, H., Desmond, P. M., Donnan, G. A., Davis, S. M.,, E. -I. I., 2015.
Endovascular therapy for ischemic stroke with perfusion-imaging selection 372,
1009-1018. 10.1056/NEJMoa1414792.

Chatterjee, A., Somayaji, N.R., Kabakis, I.M., 2019. Abstract wmp16: Artificial intelli-
gence detection of cerebrovascular large vessel occlusion-nine month, 650 pa-
tient evaluation of the diagnostic accuracy and performance of the viz. ai lvo
algorithm. Stroke 50 (Suppl_1). AWMP16-AWMP16

Ehteshami Bejnordi, B., Veta, M., van Diest, P.J., van Ginneken, B., Karssemeijer, N.,
Litjens, G., van der Laak, J.A.W.M., the CAMELYON16 Consortium, Hermsen, M.,
Manson, Q.F., Balkenhol, M., Geessink, O., Stathonikos, N., van Dijk, M.C., Bult, P.,
Beca, F., Beck, A.H., Wang, D., Khosla, A., Gargeya, R., Irshad, H., Zhong, A.,
Dou, Q., Li, Q., Chen, H., Lin, H.-J., Heng, P-A., Hafs, C., Bruni, E., Wong, Q.,
Halici, U., Oner, M.U., Cetin-Atalay, R., Berseth, M., Khvatkov, V., Vylegzhanin, A.,
Kraus, O., Shaban, M., Rajpoot, N., Awan, R., Sirinukunwattana, K., Qaiser, T.,
Tsang, Y.-W., Tellez, D., Annuscheit, J., Hufnagl, P., Valkonen, M., Kartasalo, K.,
Latonen, L., Ruusuvuori, P., Liimatainen, K., Albarqouni, S., Mungal, B., George, A.,
Demirci, S., Navab, N., Watanabe, S., Seno, S., Takenaka, Y., Matsuda, H., Anmady
Phoulady, H., Kovalev, V., Kalinovsky, A., Liauchuk, V., Bueno, G., Fernandez-
Carrobles, M.M., Serrano, I., Deniz, O., Racoceanu, D., Vendancio, R., 2017. Di-
agnostic assessment of deep learning algorithms for detection of lymph node
metastases in women with breast cancer 318, 2199-2210. doi:10.1001/jama.
2017.14585.

Esteva, A., Kuprel, B., Novoa, R.A., Ko, J., Swetter, S.M., Blau, H.M., Thrun, S., 2017.
Dermatologist-level classification of skin cancer with deep neural networks. Na-
ture 542 (7639), 115-118.

Goyal, M., Demchuk, A.M., Menon, B.K., Eesa, M., Rempel, J.L., Thornton, J., Roy, D.,
Jovin, T.G., Willinsky, R.A., Sapkota, B.L., Dowlatshahi, D., Frei, D.F, Kamal, N.R.,
Montanera, W.J., Poppe, A.Y., Ryckborst, K.J., Silver, F.L., Shuaib, A., Tampieri, D.,
Williams, D., Bang, O.Y., Baxter, B.W., Burns, P.A., Choe, H., Heo, J.-H., Holmst-
edt, C.A., Jankowitz, B., Kelly, M., Linares, G., Mandzia, J.L., Shankar, J., Sohn, S.-I.,
Swartz, R.H., Barber, P.A., Coutts, S.B., Smith, E.E., Morrish, W.F,, Weill, A., Sub-
ramaniam, S., Mitha, A.P., Wong, J.H., Lowerison, M.W., Sajobi, T.T., Hill, M.D., E.
T. I, 2015. Randomized assessment of rapid endovascular treatment of ischemic
stroke 372, 1019-1030. doi:10.1056/NEJMoa1414905.

Goyal, M., Menon, B. K., Derdeyn, C. P., 2013. Perfusion imaging in acute ischemic
stroke: Let us improve the science before changing clinical practice 266, 16-21.
10.1148/radiol.12112134.

Gulshan, V., Peng, L., Coram, M., Stumpe, M.C., Wu, D., Narayanaswamy, A., Venu-
gopalan, S., Widner, K., Madams, T., Cuadros, J., Kim, R., Raman, R., Nelson, P.C.,
Mega, J.L., Webster, D.R., 2016. Development and validation of a deep learning
algorithm for detection of diabetic retinopathy in retinal fundus photographs.
316, 2402-2410. doi: 10.1001 /jama.2016.17216.

Jovin, T.G., Chamorro, A., Cobo, E., de Miquel, M.A., Molina, C.A., Rovira, A., San
Roman, L., Serena, J., Abilleira, S., Ribo, M., Millan, M., Urra, X., Cardona, P.,
Lopez-Cancio, E., Tomasello, A., Castano, C., Blasco, J., Aja, L, Dorado, L., Que-
sada, H., Rubiera, M., Hernandez-Perez, M., Goyal, M., Demchuk, A.M., von Kum-
mer, R., Gallofre, M., Davalos, A., R. T. I, 2015. Thrombectomy within 8 hours
after symptom onset in ischemic stroke. 372 (24), 2296-2306. doi:10.1056/
NEJMoa1503780.

Kingma, D., Ba, J., 2014. Adam: A method for stochastic optimization. CoRR
abs/1412.6980.

Kortman, H.G,J., Smit, EJ., Oei, M.T.H., Manniesing, R., Prokop, M., Meijer, FJ.A.,
2015. 4d-CTA in neurovascular disease: a review 36, 1026-1033. doi:10.3174/
ajnr.A4162. Pub. 2013.10.08

Kudo, K., Christensen, S., Sasaki, M., Ostergaard, L., Shirato, H., Ogasawara, K., Win-
termark, M., Warach, S., Investigators, F., 2013. Accuracy and reliability assess-
ment of CT and MR perfusion analysis software using a digital phantom 267,
201-2011. doi:10.1148/radiol.12112618.

Lakhani, P., Sundaram, B., 2017. Deep learning at chest radiography: automated clas-
sification of pulmonary tuberculosis by using convolutional neural networks.
Radiology 284 (2), 574-582.

Lisowska, A., Beveridge, E., Muir, K., Poole, I., 2017. Thrombus detection in ct
brain scans using a convolutional neural network. In: BIOIMAGING, pp.
24-33.

Litjens, G., Kooi, T., Ehteshami Bejnordi, B., Setio, A.A.A., Ciompi, F., Ghafoorian, M.,
van der Laak, J., van Ginneken, B., Sanchez, C., 2017. A survey on deep learning
in medical image analysis 42, 60-88. doi:10.1016/j.media.2017.07.005.

Ma, H., Campbell, B.C., Parsons, M.W., Churilov, L., Levi, C.R., Hsu, C., Kleinig, TJ.,
Wijeratne, T., Curtze, S., Dewey, H.M., et al., 2019. Thrombolysis guided by per-
fusion imaging up to 9 hours after onset of stroke. New Engl. J. Med. 380 (19),
1795-1803.

Meijer, FJ.A., Schuijf, J.D., de Vries, J.. Boogaarts, H.D., van der Woude, W.-J.,
Prokop, M., 2019. Ultra-high-resolution subtraction CT angiography in the
follow-up of treated intracranial aneurysms. Insight. Imag. 10, 2. doi:10.1186/
$13244-019-0685-y.

Meijs, M., Patel, A., van de Leemput, S., Prokop, M., van Dijk, EJ., de Leeuw, F-E.,
Meijer, FJ.A., van Ginneken, B., Manniesing, R., 2017. Robust segmentation of
the full cerebral vasculature in 4D CT images of suspected stroke patients 7.
doi:10.1038/s41598-017-15617-w.

Meijs, M., Patel, A.. van de Leemput, S.C. van Ginneken, B., Prokop, M., Man-
niesing, R., 2018. Fast, robust and accurate segmentation of the complete cere-
bral vasculature in 4D-CTA using deep learning.

Nogueira, R.G., Jadhav, A.P., Haussen, D.C., Bonafe, A., Budzik, R.F, Bhuva, P., Yava-
gal, D.R., Ribo, M., Cognard, C., Hanel, R.A., Sila, C.A., Hassan, A.E., Millan, M.,
Levy, E.I., Mitchell, P., Chen, M., English, J.D., Shah, Q.A., Silver, F.L., Pereira, V.M.,
Mehta, B.P., Baxter, B.W., Abraham, M.G., Cardona, P. Veznedaroglu, E.,
Hellinger, FR., Feng, L., Kirmani, J.F., Lopes, D.K., Jankowitz, B.T., Frankel, M.R.,
Costalat, V., Vora, N.A., Yoo, AJ., Malik, A.M., Furlan, AJ., Rubiera, M., Aghae-
brahim, A., Olivot, J.-M., Tekle, W.G., Shields, R., Graves, T., Lewis, RJ.,
Smith, W.S., Liebeskind, D.S., Saver, J.L., Jovin, T.G., 2018. Thrombectomy 6 to
24 hours after stroke with a mismatch between deficit and infarct. 378, 11-21.

Patel, A., van Ginneken, B., Meijer, FJ.A., van Dijk, EJ., Prokop, M., Manniesing, R.,
2017. Robust cranial cavity segmentation in ct and ct perfusion images of
trauma and suspected stroke patients 36, 216-228. doi:10.1016/j.media.2016.12.
002.

Powers, W,J., Rabinstein, A.A., Ackerson, T., Adeoye, O.M., Bambakidis, N.C.,
Becker, K., Biller, J.. Brown, M., Demaerschalk, B.M., Hoh, B., et al., 2018.
2018 guidelines for the early management of patients with acute ischemic
stroke: a guideline for healthcare professionals from the american heart as-
sociation/american stroke association. Stroke 49 (3), e46-e99. doi:10.1161/STR.
0000000000000158.

Santos, E.M., Marquering, H.A., Berkhemer, O.A., van Zwam, W.H., van der Lugt, A.,
Majoie, C.B., Niessen, W,J., investigators, M.C., et al., 2014. Development and val-
idation of intracranial thrombus segmentation on ct angiography in patients
with acute ischemic stroke. PLoS One 9 (7), e101985.

Santos, E.M., Niessen, W.J., Yoo, A.J., Berkhemer, O.A., Beenen, L.F., Majoie, C.B., Mar-
quering, H.A., investigators, M.C., et al., 2016. Automated entire thrombus den-
sity measurements for robust and comprehensive thrombus characterization in
patients with acute ischemic stroke. PLoS One 11 (1), e0145641.

Saver, J. L., Goyal, M., Bonafe, A., Diener, H.-C., Levy, E. I., Pereira, V. M., Albers, G.
W., Cognard, C., Cohen, D. J., Hacke, W., Jansen, O., Jovin, T. G., Mattle, H. P.,
Nogueira, R. G., Siddiqui, A. H., Yavagal, D. R., Baxter, B. W., Devlin, T. G., Lopes,
D. K., Reddy, V. K., de Rochemont, R. d. M., Singer, O. C., Jahan, R.,, S. P. I, 2015.
Stent-retriever thrombectomy after intravenous t-PA vs. t-PA alone in stroke.

Shankar, J.J.S., Langlands, G., Doucette, S., Phillips, S., 2016. CT perfusion in acute
stroke predicts final infarct volume-inter-observer study. Canad. J. Neurologic.
Sci. 43 (1), 93-97.

Stib, M.T., Dong, M.P., Kim, Y.H., Subzwari, S.S., Triedman, H.J., Wang, A., Yao, A.D.,
Zhu, L.L., Boxerman, J.L., Baird, G., Cetintemel, U., Eickhoff, C., McTaggart, R.A.,
2018. Deep learning in emergent large vessel occlusion detection using maxi-
mum intensity projections via CT angiography.
