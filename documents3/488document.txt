The Journal of Supercomputing (2020) 76:10090-10121
https://doi.org/10.1007/s11227-020-03224-y

m)

Check for
updates

Image-based stroke rat brain atrophy volume and infarct
volume computation

Yung-Kuan Chan'® - Chun-Fu Hong? Meng-Hsiun Tsai’ - Ya-Lan Chang -
Ping-Hsuan Sun!

Published online: 13 March 2020
© The Author(s) 2020

Abstract

Stroke is one of the leading causes of death as well as results in a massive eco-
nomic burden for society. Stroke is a cerebrovascular disease mainly divided into
two types: ischemic stroke and hemorrhagic stroke, which, respectively, refer to the
partial blockage and bleeding inside brain blood vessels. Both stroke types lead to
nutrient and oxygen deprivation in the brain, which ultimately cause brain damage
or death. This study focuses on ischemic stroke in rats with middle cerebral artery
occlusion (MCAO) as experimental subjects, and the volumes of infarct and atrophy
are calculated based on the brain slice images of rat brains stained with 2,3,5-triph-
enyl tetrazolium chloride. In this study, a stroke rat brain infarct and atrophy vol-
umes computation system (SRBIAVC system) is developed to segment the infarcts
and atrophies from the rat brain slice images. Based on the segmentation results,
the infarct and atrophy volumes of a rat brain can be computed. In this study, 168
images of brain slices cut from 28 rat brains with MCAO are used as the test sam-
ples. The experimental results show that the segmentation results obtained by the
SRBIAVC system are close to those obtained by experts.

Keywords Stroke - Middle cerebral artery occlusion (MCAO) - 2,3,5-Triphenyl
tetrazolium chloride (TTC) - Brain infarct - Brain atrophy

1 Introduction

Stroke is now the leading cause of acquired adult disability worldwide [29].
Stroke is caused mainly by the internal cerebrovascular obstruction or hemor-
rhagic that causes the brain lack of nutrient and oxygen, leading to brain injury or

Chun-Fu Hong and Meng-Hsiun Tsai have equal contribution to this article. The two authors are
listed based on their surname.

b<] Yung-Kuan Chan
ykchan @nchu.edu.tw

Extended author information available on the last page of the article

Q) Springer
Image-based stroke rat brain atrophy volume and infarct volume... 10091

death eventually. Stroke is classified majorly into two types: ischemic stroke and
hemorrhagic stroke, in which ischemic stroke accounts for 70-80% of all stroke
incidences. According to the statistics of World Health Organization (WHO),
there were about 15.2 million people died of stroke and ischemic heart disease in
2016 and these diseases are still the leading causes of death over the last decade
[42]. In 2013, global prevalence of stroke was 25.7 million, in which 10.3 mil-
lion people suffered first attack [10]. In the USA, stroke ranked as No. 5 among
all causes of death in 2014 and 1s also a leading cause of long-term disability
and cognitive impairment; according to the estimates in 1999, there were about
795,000 American experienced a new or recurrent stroke, in which 610,000 peo-
ple were first attacks and others were recurrent incidences [4]; according to the
data during 2011-2014, the overall stroke prevalence was estimated 7.2 million
American over 20 years of age, accounting for 2.7% of the population [4]; from
2012 to 2013, the estimated overall cost of stroke was US$33.9 billion [4, 26]; it
is projected that, by 2030, 3.88% of the US population over 18 years of age will
have had a stroke, and the real total direct annual stroke-related medical costs, in
2010, are estimated to increase from $71.55 billion to $184.13 billion between
2012 and 2030 [31]. Age is one of the essential risk factors for stroke. The prob-
ability of suffering a stroke attack is nearly doubled every 10 years over age 55
[41]. Due to the increasing growth of aging population worldwide, it has been a
critical challenge to reduce the cost of stroke diagnosis and treatment. Therefore,
many investigators are highly interested in the research of stroke fields.

In general, the brain has a high demand for oxygen and glucose, 1.e., even
though the brain tissue represents only about 2% of the whole body weight, it
requires 20% of the body’s total oxygen consumption, and adult cerebral blood
flow takes up 15% of the cardiac output [6, 27]. The delivery of oxygen and glu-
cose to the brain via cerebral blood flow is essential for normal brain functions.
Clinically, the most common type of stroke belongs to ischemic infarcts. Among
the several major vessels in the brain, infarction frequently occurs in the greatest
branch of internal carotid artery called middle cerebral artery. The sudden loss
of cerebral blood supply, even a few minutes, initiates a series of cellular and
molecular cascades that lead to irreversible ischemic brain damage, eventually
leading to stroke [39].

Although some therapies and drugs have been developed to inhibit or treat ischemic
stroke [7, 32], there is no effective strategy or medication treatment yet to completely
prevent or cure the disease. Intravenous thrombolysis using recombinant tissue plas-
minogen activator (rtPA), for example, is now the only approved medical treatment for
acute ischemic stroke. However, the administration of rtPA is limited up to 4.5 h after
stroke and its applicable rate is only up to 5% of all patients [11]. Even though for stroke
patients, the sooner tPA is given to, the greater the benefit they have, and only approxi-
mately one quarter of patients receive timely door-to-needle time < 60 min [12]. There-
fore, there is an urgent need for developing new medical treatments for acute ischemic
stroke. However, successful translation of preclinical stroke research is rare, which may
be attributed partially to the complexity of stroke pathobiology or to the inadequate
choice of animal model. Even though the limited application of animal experiments in

Q) Springer
10092 Y.-K. Chan et al.

stroke study, several animal models have been applied in stroke research, providing a
better understanding of stroke pathophysiologic mechanisms.

Rodent models have long been employed as one of the important methods for
understanding ischemic stroke mechanism [3, 18, 25]. For example, middle cerebral
artery occlusion (MCAO), one of the animal models that can closely simulate human
ischemic stroke and account for >40% ischemic stroke animal experiments, is applied
in this study to compensate for the flaw of animal model determination. Staining
ischemic brain slice with 2,3,5-triphenyl tetrazolium chloride (TTC) has been consid-
ered as a common and reliable method for visualizing the infarct region of an animal
brain to reveal the severity of stroke level [3, 18]. Commonly, images of TTC-staining
brain slice of MCAO-treated ischemic rats are examined by well-trained experts who
are familiar with discriminating TTC-staining images, and the infarcted regions are
then determined and analyzed. These rodent stroke animal models can not only provide
valuable information of pathophysiology of ischemic brain injury, but also aid in the
development of novel neuroprotectvie or antioxidant agent against stroke. For example,
Xu et al. [43] used MCAO mice model to examine the therapeutic potential of Huma-
nin (HNG) in stroke mice. Brain slices of HNG pretreated and posttreated stroke mice
were stained with TTC, and the infarct region of these images were then determined.
Their results showed that HNG protects against cerebral ischemia/reperfusion injury
in mice. Thus, these animal models can help develop stroke translational research from
bench to bedside.

The examination of images of TTC-stain rat brain slice is time-consuming and labor
intensive, and sometimes subjective bias may exist due to manual investigation. There-
fore, in this study a stroke rat brain infarct and atrophy volumes computation (SRBI-
AVC) system is provided to segment the infarcts and atrophies in rat brain slice images.
Then, the brain infarct and atrophy volumes of the rat can be computed via the segmen-
tation results. Methods including background removal, gamma correction, brain cer-
ebral central line detection, and genetic algorithm will be applied to segment the brain
infarct and atrophy regions in the rat brain slice images and to precisely estimate the
infarct and atrophy volumes. In segmenting rat brain infarction, not only gamma correc-
tion but also local gamma correction are proposed to stretch the contrast of an image.
This system can provide a potential tool for the development of stroke medication.

The remainder of this paper is organized as follows. The next section will intro-
duce related works for literature reviews and the ischemic rat stroke images which
will be used as the testing data in this paper. Section 3 describes the SRBIAVC Sys-
tem in details. In Sect. 4, two machine learning methods are provided to decide the
fittest values for the parameters used in the SRBIAVC System. The experimental
results are illustrated in Sect. 5. The conclusions are given in the last section.

2 Related works and materials
2.1 Literature reviews

In addition to the selection of animal model, how to appropriately interpret the ani-
mal experimental results is another important issue. Some studies, for example,

Q) Springer
Image-based stroke rat brain atrophy volume and infarct volume... 10093

employed well-trained animal physiologist to determine the area of rat ischemic
stroke, and some employed public image procession program such as ImageJ to
determine its severity [5, 13, 14, 34]. In the preclinical animal studies of stroke drug
development, there are massive demands for stroke image analysis. However, few
attempts have been made to develop automatic calculation algorithms to deal with
this problem [13, 23, 24]. Therefore, it is critical to develop methods that can assess
the effects of drugs or treatments on stroke animal models.

In general, the size of infarct region is often examined to determine the sever-
ity of brain damage after stroke. Hence, it is reasonable to assess the effects of a
regimen by comparing differences in brain infarct regions between stroke patients
with or without the treatment. Furthermore, the estimation of differences in the daily
progression of infarct regions can aid doctors to diagnose patients’ stroke condi-
tions. Therefore, the correct estimation of infarct volume is a very important issue
on stroke therapy. Traditionally, infarct volume is estimated manually by conduct-
ing calculations on images of brain slices. However, these time-consuming tasks
do not yield precise approximations of infarct volume as the estimation of infarct
area is often hindered by factors such as background, lighting, and corpus callosum.
Currently, many methods have been applied to detect the infarct region and various
studies have constructed many algorithms aiming to correctly compute the infarct
volume [22—24, 28, 35]. This study is to develop an automatic identification system
to distinguish infarcts and calculate their volume by utilizing experimental stroke rat
brain images.

Recently, there are many researches focused on medical image segmentation
and recognition, in which artificial intelligence has the potential to help civilization
flourish—as long as we manage to keep the technology beneficial to image analysis
[15, 16]. Peng et al. [33] proposed an ELBP (extend local binary pattern), a rota-
tion invariant texture; however, ELBP cannot describe the local structural informa-
tion but gradient orientation difference can. ELBP was hence combined with the
feature of gradient orientation difference to describe the local brightness and struc-
ture of a chest CT image. Then, SVM was used to recognize lung disease. In 2011,
Somasundaram and Kalaiselvi [38] used an adaptive intensity thresholding method
to convert a magnetic resonance image of head and brain scan into a binary image,
and the mathematical morphology and a 3D approach were applied to eliminate
noise. After that, the binary images were processed into mask images, and fine brain
slices were then obtained. Lee et al. [24] developed a program called InfarctSizer
that can automatically detect the infarct region and compute the infarct volume of
TTC-stained brain slice images from mice treated with MCAO. In their study, the
infarct region was determined by collecting the pixels with values greater than the
average RGB value of the total brain image, and the infarct volume proportional to
the pixel intensity was calculated. Vanderbeck et al. [40] applied liver biopsy images
to identify the non-alcoholic fatty liver disease. Each liver biopsy sample was
stained with an H&E stain. An image was obtained by scanning the sample. Then,
a gray-level image was created from the green channel of the image. The gray-level
image was smoothed by the average filter, and the gamma correction method was
employed to increase the contrast of the gray-level image. After that Otsu’s method
was used to convert the gray-level image into a binary image. K-means clustering

Q) Springer
10094 Y.-K. Chan et al.

algorithm and 4-neighborhood connectivity were employed to remove the back-
ground of the image. A supervised machine learning classifier was applied to cat-
egorize the white regions in liver biopsies.

From the literature mentioned above, obviously one can find that most of the
medial image processing follows the steps to pre-select the masks in segmentation
stage such as using gamma correction to heighten the contrast, and using Otsu’s
thresholding method and mathematical morphology or LBP (local binary pattern) to
extract the ROI (region of interest) in the image.

2.2 Materials

Ischemic rat stroke images were obtained from Taichung Veteran General Hospital.
In this study, rats with ischemic stroke were introduced by performing MCAO and
were used as experimental subjects [2]. All animal experimental procedures were
approved by the Institutional Animal Care and Use Committee of Taichung Veteran
General Hospital. For MCAO procedures, anesthesia was induced with 4% isoflu-
rane (Baxter, U.S.A.) and maintained with 2% isoflurane. A midline cervical inci-
sion was made to isolate the right bilateral common carotid artery. A small incision
was subsequently made in the proximal portion of the external carotid artery, and
a 25-mm-long 3-0 nylon monofilament suture was gently inserted (approximately
18 mm) into the internal right carotid bifurcation. After 60 min MCAO, the nylon
surgical thread was removed to allow complete reperfusion of the ischemic area.
The infarction size would be determined by the severity of ischemic brain injury.
In worst case, the infarct zone may cover half of the whole brain [37]. Twenty-eight
adult male Wistar rats were used in this study. All of the rats were subjected to the
MCAO procedure. On the day of operation, ten of the 28 rats were sacrificed for
brain removal. Coronal sections of each brain were obtained by cutting them into
six 2 mm-thick slices, which were labeled as “day-1.” Following the same proce-
dures, six rats were randomly selected for brain removal and sectioned on day-7,
day-14, and day-28, and the obtained brain slices were labeled accordingly. In order
to distinguish the infarct regions from normal regions in the rat brain, the slices
were stained with 2% TTC (Sigma, Germany) for 30 min at 37 °C in the dark. After
the stain developed, tissue blocks were placed into 10% phosphate-buffered forma-
lin for 45 min. TTC does not stain brain regions with neuronal loss, and therefore,
infarcted tissues remain white in these areas [37]. The six slices obtained from each
brain were vertically arranged and recorded in Fig. 1, in which each column of brain
images represents one rat.

3 The SRBIAVC system

Figure 2 portrays the framework of the SRBIAVC System. Each rat brain is cut
into six slices. A slice image is taken from one brain slice. RBS segmentation
step is to extract the rat brain slice (RBS) from a slice image. Drawing cerebral
central line step is to draw the cerebral central line to cut the RBS into cerebral

Q) Springer
Image-based stroke rat brain atrophy volume and infarct volume... 10095

 

(a) (b) (c) (d)

Fig. 1 The slices of rat brains for a Day-1, b Day-7, c Day-14, and d Day-28

Rat brain image

RBS Segmentation

Fig.2 The framework of the
SRBIAVC system

  
 

 

 
  

Drawing central line

 
 
 

 
 
 

Extracting Corpus Callosum Extracting Infarct

 

  
 

Removing Corpus Callosum from Infarct

Computing Infarct and Atrophy Volumes

hemisphere and ipsilateral hemisphere. Extracting corpus callosum step is to seg-
ment the corpus callosum from the cerebral hemisphere. Extracting infarct step
is to segment the infarct from the ipsilateral hemisphere. The step of removing
corpus callosum from infarct is to eliminate the corpus callosum from the seg-
mented infarct. The step of computing infarct and atrophy volumes is to compute
the volumes of the infarct and the atrophy based on the segmented infarct, cer-
ebral hemisphere, and ipsilateral hemisphere.

 

g) Springer
10096 Y.-K. Chan et al.

3.1 RBS segmentation

An RGB image is composed of red, green, and blue independent color channels; an
HSV image consists of hue, saturation, and bright color channels. In this study, an
RGB (resp. HSV) color image is first separated into red, green, and blue (reps. hue,
saturation, and bright) color components. The intensities of color channel C of all
the pixels in the color image can compose a gray-level image J, for C=R, G, B, H,
S, and V.

Figure 3 reveals that /,, is less affected by the texture of image background; thus
in this study, J;, is applied to remove image background. In order to more effectively
distinguish the brain from the background, the gray levels of J,, is stretched via the
following formula:

L,G)) = tH) = MIN x 255, (1)
max, — ming

where /,,(i, 7) denotes the gray level of the pixel located at coordinates (i, j) in [y;
min, and max,, are, respectively, the minimal and maximal gray levels of the pix-
els in J,,, After stretching the contrast, J,, in Fig. 3e is converted into the image in
Fig. 4a.

In Fig. 4a, the gray levels of some pixels in brain slices are greater than and oth-
ers are less than the gray levels of the pixels in background. The SRBIAVC system

hence changes L, into [, by the following formula:
Ty) = GD) — Ma (2)

where M,, is the mean of the gray levels of all the pixels in I, Figure 4b demon-
strates the result obtained by running this operation on Fig. 4a.

In Fig. 4b, the gray level of the pixel in background region is mostly lower than
that in slice region. Otsu thresholding operation [30] is a commonly used image
binarization operation. In this study, Otsu thresholding operation is applied to

   

eed,

(a) - |

Fig.3 The gray-level images J, for C=R, G, B, H, S, and V: a Original image b Ip, ¢ Ig, d Ip, e Ly, f Is,
and g ly

  

g) Springer
Image-based stroke rat brain atrophy volume and infarct volume... 10097

  

(a) (b) (c) (d)

Fig.4 RBS segmentation: a image I, b image Ip c a structure element for erosion and dilation, and d
the obtained binary image J,

calculate a suitable threshold 7;, for binarizing I, The pixels with gray levels larger
then 77, are regarded as white pixels (their gray levels are set to “/”’); otherwise,
they are considered to black pixels (their gray level are set to “0”’). Otsu threshold-
ing operation can convert [, into a binary image /,. Since there may be some minor
white or black spots in J, erosion operation [17, 36] and then dilation operation [17,
36] with a 5X5 structure element shown in Fig. 4c are used to eliminate the noise
(minor white and black spots) and smooth the contour of RBS. Figure 4d is the J,
obtained by running Otsu thresholding operation and noise removing on the image
in Fig. 4b. Each white region in Fig. 4d describes a rat brain slice (RBS). We call the
smallest rectangle containing the whole RBS the RBS rectangle of the brain slice.
Figure 5 depicts the RBS rectangles obtained from some rat brain slice images.

3.2 Drawing cerebral central line

The aim of the SRBIAVC system is to segment the infarct from each RBS. The cor-
pus callosum, such as the regions indicated by the blue outlines in Fig. 6, resembles
the infarct in color and is often misidentified as the infarct during image segmenta-
tion. Since the corpus callosum is bilaterally symmetrical in a normal rat brain, the
SRBIAVC system solves the problem by dividing the brain into two hemispheres
based on its cerebral central line. The cerebral hemisphere with infarct is called the
ipsilateral hemisphere, whereas the hemisphere with normal function is called the
contralateral hemisphere. The SRBIAVC system will segment the brain infarct and
corpus callosum from the ipsilateral hemisphere, and extracts the corpus callosum
from the contralateral hemisphere. Then, the area of the infarct obtained in the ipsi-
lateral hemisphere subtracting the area of the corpus callosum in the contralateral
hemisphere is considered as the actual area of infarct.

D) Springer
10098 Y.-K. Chan et al.

 

Fig. 7 A schematic diagram of the cerebral central line

Let us call the RBS in the top half of the RBS rectangle the upper half RBS, and
that in the lower half of the RBS rectangle the lower half RBS. As indicated by the
blue arrows in Fig. 7, there is a groove at the center of the upper half RBS, and nor-
mally, drawing a vertical line from this point would align with the cerebral central
line (see the yellow lines in Fig. 7a). Since the image may be taken with different
shooting angles, the RBS in the brain slice image may be slanted so it may cause
the shift and rotation variations of the cerebral central line (see the RBSs in Fig. 7b,
c). To deal with this problem, the SRBIAVC system looks for the concave point in
the upper half RBS and the convex point in the lower half RBS. The cerebral central

g) Springer
Image-based stroke rat brain atrophy volume and infarct volume... 10099

line is then formed by connecting the concave point and the convex point. The steps
to detect the convex point and the concave point are described in detail below.

3.2.1 Convex point detecting

The SRBIAVC system cuts the RBS rectangle into upper-left (UL), lower-left (LL),
upper-right (UR), and bottom-right (BR) four equal-sized regions (such as the yel-
low dotted lines in Fig. 8a). It finds the highest points ULTP and URTP (such as the
blue points in Fig. 8a) of the RBSs in UL and UR regions, and then considers the
lowest point on the RBS contour between ULTP and URTP to be the top central
groove T, (such as the red points in Fig. 8a).

3.2.2 Concave point detecting

Next, the SRBIAVC system draws a vertical line L, which passes through 7, and
at D, crosses the RBS contour in the lower half RBS (see Fig. 8b). Let D, be the
lowest point on the RBS contour at the left side of D,, and D, the lowest point on
the RBS contour at the right side of D, in the lower half RBS. Also let Dj, Yin)
be the highest point along the RBS contour from D, to D,, and D,y(X,,, y,,) be the
highest point along the RBS contour from D, to D,. D.(%,, y,) 18 considered to the
concave point where D.(x,, y,) is on the RBS contour in the lower half RBS and x, =
(Xn + Xm) / 2. The SRBIAVC system draws a line L,.. to connect 7, and D.. L,, hence
separates the RBS into the left half region and the right half region (see Fig. 8b). We
call L,,. the cerebral central line of the RBS. The green line in Fig. 8c is the cerebral
central line of the RBS.

The obtained cerebral central line divides the RBS into two halves. The corpus
callosum and the infarct are generally brighter than others in the RBS. Let D,, be
the difference of the average gray levels in two halves of the RBS, and S,, be the
average gray level in the RBS. If |D,,/D,,| is greater than a given threshold 7, = 0.2,
the SRBIAVC system considers that the rat brain is stocked. After that, the half of

     

“a y D. 7 ,
@) (b) (c)

Fig.8 The steps in finding the cerebral central line of RBS

Q) Springer
10100 Y.-K. Chan et al.

the RBS with a greater average gray level is regarded as the ipsilateral hemisphere,
and the other is considered to the contralateral hemisphere.

3.3 Extracting infarct

The SRBIAVC system then intends to extract the infarct from each the ipsilateral
hemisphere. In Fig. 9, a color ipsilateral hemisphere RB, is converted into three
gray-level ipsilateral hemispheres Rj, G74, By, which, respectively, consist of the
R, G, and B color components of all the pixels in RB,,,. From Fig. 9, one can obvi-
ously observe that G,,, provides a higher contrast between infarct and non-infarct in
ipsilateral hemisphere. Hence, the SRBIAVC system will extract the infarct from
Gin.

The SRBIAVC system employs gamma correction operation [1, 44] to stretch the
contrast of G;,,, and generates a gray-level image G¢:

Gyy(x, y) — Minyy \"™
Ciny) = Minn Vy 955
Maxiy —_ Min

Go(x, y ) = ( (3)
where Min,,, and Max, are the minimal and maximal gray levels in G;,, and y;;; 1s a
given constant. Figure 10a shows the results obtained by running the gamma correc-
tion operation on G,,, in Fig. 9c.

Next, Otsu thresholding operation [30] is applied to provide a threshold Tp, for
Gg to create a binary image Go. If G,-[x, y] is greater than Tp, then Go[x, y]=1
(respecting a white pixel), which indicates that G,[x, y] is an infarct pixel; other-
wise, Go[x, y]=0 (respecting a black pixel), which indicates that G,[x, y] is a non-
infarct pixel. Taking the images in Fig. 11a as examples, the pink areas should be
the less severe infarct. Since the mild infarction may lead to brain necrosis in the
future, the SRBIAVC system also considers the regions outlined by the green closed
curves in Fig. 11b is the infarct regions. Therefore, in this study, Ty is replaced with
T., = To—kgX oo where Koy is a given constant, and og is the standard deviation of
the gray levels of all the pixels in Gp. Figure 10b shows the result obtained by run-
ning the binarization operation on Gg in Fig. 10a.

  

(a) (b) (c) (d)

Fig.9 Convert a color ipsilateral hemisphere image RB,,, into three gray-level ipsilateral hemispheres
Rin, Gry, Bry: a Original image (RB), b Riq, ¢ Gy d Bry

D) Springer
Image-based stroke rat brain atrophy volume and infarct volume... 10101

  

(d)

Fig.10 The steps to identify infarct: a gamma correction, b binarization operation, c mode filter, d
merged image

 

 

Fig. 11 A schematic diagram of image binarization: a the results of binarization by To, b the binarization
results by using T 5 including the regions surrounded by white and green closed curves

There exist some small white spots and black holes in Fig. 10b. The SRBIAVC
system applies mode filter to eliminate the small white spots and black holes. For
each pixel Go[x, y], it gives a window W, consisting of mg X mg pixels in Go where
Golx, y] is the central pixel of W>. Let n, and no, respectively, be the numbers of
1-bits and 0-bits in Wo. If n)>no, Go[x, y] =1; otherwise G_[x, y]=0. Figure 10c
demonstrates the result obtained by running the mode filter on the image in Fig. 10b.
The contour obtained from Fig. 10c is then applied in Fig. 9a and the result is shown
in Fig. 10d.

3.4 Extracting corpus callosum

This subsection is to segment the corpus callosum from the contralateral hemisphere
RBcy. Each pixel in a color image RB; can be separated into red, green, and blue
color components. The values of color component c of all the pixels in the RGB
color contralateral hemisphere compose a gray-level image ccy for c=R, G, and
B. Figure 12b-—d show the Roy, Gey, and Be, of the contralateral hemisphere in
Fig. 12a. As shown in Fig. 12, Ga, has a better contrast. Therefore, the SRBIAVC
system will extract the corpus callosum from Gey.

D) Springer
10102 Y.-K. Chan et al.

Similarly, gamma correction is applied to enhance the contrast of G;;,, and then,
Otsu thresholding operation is employed to transform Gc, into a binary image.
Global gamma correction works well on the images containing objects with a uni-
form intensity on a contrasting background. However, it cannot give a good result
for the image with a low contrast between the object and the background for a noisy
image or for the image across which the background intensity varies significantly.
Figure 13a illustrates the results provided by the global gamma correction operation.
There is a low contrast for part of the corpus callosum in Fig. 13a. In this study, a
local gamma correction is hence provided to highlight the contrast of the corpus
callosum.

For each pixel Go,(x, y), the local gamma correction operation is given a
McyXMcy Window Woy in Gey, where Goy(x, y) 1s the central pixel of Woy. Let
Mincy, Maxcy and Meanc;, be the minimal gray level, the maximal gray level, and
the mean of gray levels in G;,. Then, the local gamma correction operation converts
Gey into Gig by the following formula:

1
( Gory (%.y)—-Mincy ) YCH
Maxcy—Mincy °
( Goy(x%.y)-Mincy
Maxcy—Mincy

if Gey (x,y) > meancy, and

Gig(x, y) = (4)

Y
) mx 255, otherwise Goy(x, y) < meangy.

where ycy 1S a given constant. Figure 11b shows the result obtained by the local
gamma correction operation on G_,, to create a gray-level image Gj.

There are some small bright regions which are not the corpus callosum in
Fig. 11b. The SRBIAVC system hence uses gray-level opening operation [17, 36]
to remove the small bright spots where the structure element is a 5X5 small win-
dow in which all the gray levels are zero. Figure 13c displays the result obtained by
running the gray-level opening operation on the image in Fig. 13b. After that, Otsu
thresholding operation is used to compute the fittest threshold from the gray levels
of all the pixels in the image and then to change the image into a binary image G,
based on the threshold. Figure 13d is the binary image G, obtained by executing
Otsu thresholding operation on the image in Fig. 13c. In addition, the small regions

 

Fig. 12 The contralateral hemisphere in different color components: a original image RBcy, b Roy, €
Gcy, and d Boy

D) Springer
Image-based stroke rat brain atrophy volume and infarct volume... 10103

(e)

 

Fig. 13 The steps of identifying the corpus callosum: a the segmentation result obtained by global
gamma correction operation, b the result obtained by local gamma correction operation, c the result
obtained by opening operation, d converting Gc, into a binary image, e after removing small regions, f
after removing the long strip closed to the boundary of the brain, g the segmentation result

with the area less then 7, are eliminated from G,. Figure 13e is the G, after getting
rid of the small regions from Fig. 13d.

There may be the arachnoid mater, long white strips near the boundary of the
brain (see Fig. 13e). If the average minimal distance of each pixel in one region in
G,, to the contour of the brain is less than a threshold 7, then the region is elimi-
nated. Figure 13f is the result after removing the long white strips closed to the con-
tour of the brain in Fig. 13e. Figure 13g displays the result obtained by applying the
contour in Fig. 13f to the image in Fig. 12a.

3.5 Removing corpus callosum from infarct

Since the color of corpus callosum is very close to the color of the infarct in a rat
brain, the SRBIAVC system cannot effectively separate the corpus callosum from
the infarct in the ipsilateral hemisphere; while the color of corpus callosum is quite
different from others in the contralateral hemisphere, extracting the corpus callosum
in contralateral hemisphere is much easier. Moreover, the corpus callosum is bilat-
erally symmetrical in the normal brain. The SRBIAVC system hence replaces the
corpus callosum in ipsilateral hemisphere with the corpus callosum in contralateral
hemisphere.

Q) Springer
10104 Y.-K. Chan et al.

Assume that the ipsilateral hemisphere is the right hemisphere of an RBS Rp. If
R,(x, y) is in the contralateral hemisphere and a corpus callosum pixel R,(x+d, y) is in
the cerebral central line, the SRBIAVC system sets Rp(x+ 2d, y) to a corpus callosum
pixel, too. Assume that the ipsilateral hemisphere is the left hemisphere of an RBS Rp.
If R(x, y) is in the contralateral hemisphere and a corpus callosum pixel R,(x+d, y)
is in the cerebral central line, the SRBIAVC system also sets Rp(x-d, y) to a corpus
callosum pixel. Figure 14a is the segmented infarcts (in the right half side) combined
with the segmented corpus callosum (in the left half side). Figure 14b is the segmented
infarct after removing the corpus callosum. Figure 14c is the segmentation result.

3.6 Computing infarct and atrophy volumes

The SRBIAVC system calculates the volumes of the stroke and atrophy of a rat brain
based on the segmented RBS and infarcts on the six slices of a rat brain. Let A;;, Aj,...,
Aj, respectively, be the areas of the segmented infarcts in the six slices. The infarct vol-
ume V, of the rat brain is defined as:

6

Vi= )IA,, x TH, (5)
j=l

where 7H is the thickness of each slice, and in this study TH =2 mm.

The left half and the right half of a normal rat brain are bilaterally symmetrical.
It means that the volumes of the left half and the right half of a normal rat brain are
very close. Since the volume of ipsilateral hemisphere may shrink, the proportion of
the infarct volume to the volume of contralateral hemisphere is more helpful for a doc-
tor. The proportion of the infarct volume to the volume of contralateral hemisphere can
be defined as:

6
Ay,

Vi= =m (6)

6
__,A
J=1 Wj

  

(a) (b) (c)
Fig.14 The steps of removing corpus callosum from infarct: a the segmented infarct (on the right half)

combined with the segmented corpus callosum (on the left half), b the infarct after removing corpus cal-
losum, c the segmented infarct

D) Springer
Image-based stroke rat brain atrophy volume and infarct volume... 10105
where A,;, Aj», -.-, Apo, tespectively, are the areas of the segmented contralateral
hemisphere in the six slices of the bat brain. Since the volume of ipsilateral hemi-
sphere may shrink, it is very difficult to measure the original volume of the ipsilat-
eral hemisphere. The SRBIAVC system hence determines the percentage P, of the
atrophy volume in ipsilateral hemisphere by

6 6
P= dint Any, _ dint Aw,

a (7)
6
dj=! Ay,

3.7 Time complexity

Assume that S, is the size of the input image. The time complexity of each step in
the SRBIAVC system is described as follows:

(a) In step RBS Segmentation: The SRBIAVC system spends time S;, to filter out
the hue color component of the input image and create a new image /,,, and
time 2 x S; to execute Eqs. (1) and (2). It also takes time 255° to perform Otsu’s
thresholding method. Hence, the time complexity of this step is O(3 x S7).

(b) In step Drawing Cerebral Central Line: The time complexity in this step is far
less than S;.

(c) In step Extracting Infarct: The SRBIAVC system spends time S//2 to filter out
the green color component of image RB,,, and create a new image G,,,, and time
S/2 to execute Eq. (3). It also takes time 255° to perform Otsu’s thresholding
method. Hence, the time complexity of this step is O((2 x S,)/2).

(d) In step Extracting Corpus Callosum: In this step, the SRBIAVC system takes
time S,/2 to run gamma correction and 255° to perform Otsu’s thresholding
method.

(e) In step Removing Corpus Callosum from Infarct: Time S$//2 is consumed to
remove the corpus callosum.

(f) In step Computing Infarct and Atrophy Volumes: Time S; is taken to compute
the areas of Infarct and Atrophy.

Therefore, the SRBIAVC system spends time about 6x S, to extract the brain
infarct and atrophy and compute their areas.

4 Fittest parameters determining

In this study, two algorithms are provided to decide the fittest parameters used in
the SRBIAVC system. In this section, we will describe them in details.

Q) Springer
10106 Y.-K. Chan et al.

4.1 Genetic algorithm-based parameters determining

In this study, a genetic algorithm [19]-based parameters detector (GABPD) is
provided to determine the fittest values of the parameters used in the SRBIAVC
system; we call it the SRBIAVC system with GABPD. If there are n,, parameters
in a system, the GABPD gives each chromosome n,, substrings 87, ,..., Sn, which,

respectively, consist of n,;, Nj, ...,n, binary bits and their corresponding decimal
P
values are V;, V>, ..., Vv, . Each chromosome composes of n);+n,+:::+n, binary
P P

bits and v; is employed to describe the value of the i-th parameter in the system.
Hence, each chromosome will give n, values mapping to all the parameters in the
system, and then, the system can provide a performance based on the test data
collected in advance. The performance is considered to the fitness of the
chromosome.

In the initial step, GABPD randomly generates N, chromosomes. We call the
N, chromosomes the reserved chromosomes. To evolve the best solution, GABPD
repeatedly and alternately executes three operations mutation, crossover, and selec-
tion, until the fitness of all the reserved chromosomes is similar or the number of
iterations is equal to a given constant MAX_NO_RUN.

For the crossover operation, GABPD randomly assigns NV. chromosome pairs
from the reserved chromosomes. For each chromosome pair (Ch,, Ch,), a binary
string Sy, consisting of n;+n>+-,+ Nn, binary bits, is offered. GABPD then ran-

domly selects (nj) +n j++,+ N, 2 binary bits in Sy, and sets all the selected bits to /-

bits, and sets others in S,, to O-bits. After that, GABPD runs the following formula
to create a new chromosome Ch:

Ch = (Ch, ASy)V(ChyA7S y)),

where / is the logical AND operator, ~ is the logical OR operator, and Su is the
logical NOT operator.

For the mutation operation, for each of the N, reserved chromosomes, GABPD
uses a random number generator to specify one bit b for each of its substrings, and
replaces b with 7b to generate a new chromosome, where - signifies the logical
NOT operator. Therefore, in this operation, NV; new chromosomes are created.

For the selection operation, 0.9xN, chromosomes with the best fitness are
selected from the reserved chromosomes and the chromosomes generated by the
crossover and mutation operations. The selection operation also randomly creates
0.1xN,; chromosomes. Moreover, the 0.9 WN; selected chromosomes and 0.1 x WN;
created chromosomes are used as the reserved chromosomes in next iteration. The
GABPD repeatedly and alternately executes the operations crossover, mutation, and
selection, until the fitness of all reserved chromosomes is very simliar, or the num-
ber of iterations 1s equal to a given constant MAX_NO_RUN.

GABPD trains the fittest parameters used in a system based on the accumulated
historical data. When given a chromosome, the values of the parameters used in the
system can be determined. The system then extracts the ROI (region of interest) via
the values of the parameters. Let X be the segmentation result and Y the ground truth

Q) Springer
Image-based stroke rat brain atrophy volume and infarct volume... 10107

(the result drawn by the experts). Jaccard coefficient (JC) [20] can be used to meas-
ure the segmentation result:

_ |xXnyY|

~~ |XUY|

 

The average Jaccard coefficients obtained by the systems based on the parameters
decided by the chromosome are considered to the fitness of the chromosome.

GABPD is helpful for a system with multiple parameters. In the SRBIAVC sys-
tem, the parameters y, kg, mg are used in the extracting infarct step, and the param-
eters ¥cy, T,, T,, are employed in the extracting corpus callosum step. In this study,
GABPD is hence applied to determine the fittest parameters used in the extracting
infarct step and in the extracting corpus callosum step:

4.1.1 The fittest values of y, kg Mo

To determine the fittest the parameters used in the extracting infarct step, y,, Ky, and
Mo 18 mapped to $s), 55, 83, where n; = n, = 6,n3; = 3, 7, = v;X 0.05, kg =Vv>x 0.05,
and my = 3+13.

4.1.2 The fittest values of y,,, 7, T,

To determine the fittest parameters used in the corpus callosum step, yc, T,, T 7 1s
related to s,, S5, 53, and n, = n,=6, and n; = 3. yqqy = v)X 0.05, T, = vx 0.05, and
Ty = 34+V3.

4.2 PSO-based parameters determining

In this study, a particle swarm optimization (PSO) algorithm [9]-based parameters
detector (PSOBPD) is also provided to determine the fittest values of the parameters
used in the SRBIAVC system; we call it the SRBIAVC system with PSO. Particle
swarm optimization (PSO) searches the optimal solution by iteratively improving a
set of candidate solutions with regard to a given quality measure. Each particle has
its own position, and the i-th particle position in ¢-th iteration can be expressed as
X(t) = (%(0), X20)... Xin), where x, (t) is the position of the d-th dimension of
the i-th particle in the ¢-th iteration. Assume V,(t) = (v;,(0), v,2(0), ..., Vin) is the
velocity of the i-th particle in the ¢-th iteration, where v,,(t) is the velocity of the d-th
dimension of the i-th particle in the ¢-th iteration; Pbest; is the obtained local best
solution of the i-th particle obtained thus far, and Gbest is the global best solution
obtained until now from all the particles in the population.

The new velocities and positions of the i-th particle in the f-th generation are
evolved by the following equations:

Vigit + 1) = co X Vig(t) +c, X rand, X (Pbestig(t) — x;q(t)) + Cy X rand, X (Pbest,4(t) — Xiq(t)),

Xjq(t + 1) = Xiqh) + Viq(t + 1),

Q) Springer
10108 Y.-K. Chan et al.

where Cy is an inertial parameter affecting the movement propagation given by last
velocity value, and two acceleration coefficients c, and c,, respectively, are the
importance of personal best value and the importance of social best value; rand,
and rand, are two random numbers between [0, 1]. Shi and Eberhart [21] indicated
that choosing Cy € [0.5, 1.2] results in faster convergence, hence, in this study, we set
Co= 1. Generally, c; and c, are set to 2. The PSOBPD can be implemented by the fol-
lowing Algorithm PSOOQ:

Algorithm PSO()
Randomly initialize gbest, Num, particles X(0) and their Vi(0) and Pbest;
For 1 to MAX _NO_ITERATUON
For i=1 to Num,
For d=I to Nr
Vid(t+]) = coXvja(t) + c7Xrand)x(Pbhestja(t) - xidt)) + c2xrand2x(Pbestid(t) - xia())
Xia(tt+1) = xid(t) + vid(t+D)
if the fitness of X,(t+J) is better than the fitness of XA) than
Phest;= X(t+1)
Ghest = MAX,” (Pbest;)

In this study, each particle X,(t) is a candidate solution, and x,t) describes the
value of the i-th parameter in the SRBIAVC system. Hence, each particle X,(t) will
give n, values representively mapping to all the parameters in the system, and then
the system can provide a performance based on the test data collected in advance.
The performance is considered to the fitness of the particle. In addition, Num, 1s set
to 10.

5 Experiments and discussions

In this study, 168 ischemic stroke rat brain images with sizes between 185 x 134 and
360 X 261 pixels provided by Taichung Veteran General Hospital are used as the test
images. Twenty-eight rats were subjected to the MCAO procedure approved by the
Institutional Animal Care and Use Committee of Taichung Veteran General Hos-
pital. On the day of operation, ten of the 28 rats were sacrificed for brain removal.
Each brain was cut into six coronal sections, each of which was a 2 mm-thick slices
and was labeled as “day-1.” Following the same procedures, six rats were randomly
selected for brain removal and sectioned on day 7 and the obtained brain slices
were labeled as “day-7.” Similarly, other six rats were randomly selected for brain
removal and sectioned on day 14 and the obtained brain slices were labeled as “day-
14.” The brains of the remaining six rats were also removed and sectioned on day 28
and the obtained brain slices were labeled as “‘day-28.”

The first experiment intends to investigate the performance of removing the
image backgrounds of the 168 ischemic stroke rat brain images. The experimental
results show that the average dice similarity (DS) provided by the SRBIAVC system
in removing the image background of the 168 ischemic stroke rat brain images is
98% which is much higher than the DS =85.95% obtained by J. Lee’s method [23].

Q) Springer
Image-based stroke rat brain atrophy volume and infarct volume... 10109

 

(a) (b) (d)

Fig. 15 The results of image background removal: a original images, b ground truth given by medical
experts, c obtained by J. Lee’s method, d obtained by the SRBIAVC system

Figure 15 displays the results obtained by J. Lee’s method and the SRBIAVC system
in removing the image background of some ischemic stroke rat brain images.

The SRBIAVC system automatically draws the cerebral central line but J.
Lee’s method requires the user to draw the cerebral central line by himself. Let
line L,.. be the cerebral central line drawn by the SRBIAVC system and line L, be
the ground truth drawn by the expert. Assume that 7, and D, are the convex point
and the concave point on L.. and T’, and D are the convex point and the concave
point on Ly In this study, MAX(IT,-T, |, |D.—D7/ |) is defined as the difference
between L,,. and Ly .. The average of the difference between L,. and L’.. is only
5.48 pixels. Figure 16 illustrates some cerebral central lines drawn by the SRBI-
AVC system and the expert.

However, the brain slices in Fig. 17 do not contain a recognizable groove.
Figure 17a depicts the cerebral central lines drawn by the SRBIAVC system and
Fig. 17b illustrates the cerebral central lines drawn by the expert. The SRBIAVC
system cannot give good cerebral central lines for both brain slices.

In next experiment, GABPD is employed to train the fittest parameters y, ko,
and mp, used in the extracting infarct step based on the brain slice images of two
rats which were randomly selected from the 28 adult male Wistar rats. Moreover,
the brain slice images of other 26 adult male Wistar rats were used as the test-
ing images. In this experiment, GABPD gives the fittest parameters y, = 0.95, ky
=0.65, Mg = 5.

D) Springer
10110 Y.-K. Chan et al.

 

day-1

 

 

 

day-14

 

 

 

 

 

 

Fig. 16 Some cerebral central lines drawn by the SRBIAVC system and the expert, where row L,. is the
cerebral central line drawn by the SRBIAVC system and row Li _ is the ground truth drawn by the expert

Apart from Jaccard coefficient (JC), dice similarity (DS) is frequently used to
evaluate the object segmentation result [8]. DS is defined as:

_ 2|xn¥Y|
|X| + [YI

where X is the segmentation result and Y is the ground truth. In this study, both of JC
and DS are used to measure the performance of object segmentation. Based on the

D) Springer
Image-based stroke rat brain atrophy volume and infarct volume... 10111

 

 

 

Fig.17 The brain slices containing the difficult recognizable groove: a the cerebral central lines drawn
by the SRBIAVC system, b the cerebral central lines drawn by the expert

fittest parameters y, = 0.9, ky = 0.65, my = 5 and the testing images, the SRBIAVC
system obtains the experimental results: the average JC=72.08% and the average
DS = 81.83%. Figure 18 demonstrates the segmented infarct regions in the ipsilateral
hemisphere of the brain slice images of some day-1 and day-14 rats. However, the
SRBIAVC system is sensitive to the mild infarct (pink area) in the extracting infarct,
so that it cannot give a good result for extracting the infarcts in Fig. 19.

In experiment 4, similarly GABPD is employed to train the fittest parameters 777,
T,, and T,, used in the extracting corpus callosum step based on the same training
data and testing data adopted in experiment 3. In this experiment, GABPD gives
the fittest parameters ypy=1.95, T,=0.05, T;=21. Based on the fittest parameters
YcH=1.95, T,=0.05, T,;=21, and the testing images, the experimental result shows
that the SRBIAVC system can obtain the average JC=71.08% and the average
DS =77.48%. Figure 20 displays the segmented corpus callosums in the contralat-
eral hemispheres of the brain slice images of some rats. However, the accuracy of
this method is compromised when the color of the corpus callosum resembled that
of its surroundings, as shown in Fig. 21. As demonstrated in the middle panel of
Fig. 21, the white areas pointed by the yellow arrow are misidentified to be the cor-
pus callosum.

Experiment 5 is to explore the performances of infarct segmentation after remov-
ing corpus callosum. The experimental result shows that the SRBIAVC system
obtaining the average JC = 75.54% and the average DS = 82.22% is much better than
J. Lee’s method providing the average JC =51.43% and the average DS = 64.14% in

g) Springer
10112 Y.-K. Chan et al.

 

 

Ground truth

 

Fig. 18 The segmented infarcts in the ipsilateral hemisphere for the brain slice images of rats day-1 and
day-14

 

 

 

Fig. 19 The bad infarct segmentation: a The infarcts extracted by the SRBIAVC system, b ground truth

infarct segmentation after removing corpus callosum. Figure 22 depicts some infarct
segmentation results after removing corpus callosum from the rat brain slice images.

Experiment 6 is to compute the infarct volumes and the atrophy volumes. Fig-
ure 23a illustrates the results computing the infarct volumes of 28 adult male

D) Springer
Image-based stroke rat brain atrophy volume and infarct volume... 10113

 

 

(b)Ground truth

Fig.20 The segmented corpus callosums in the contralateral hemispheres of the brain slice images of
some rats

 

 

 

Fig.21 The bad corpus callosum segmentation

Wistar rats by the SRBIAVC system with PSO, the SRBIAVC system with
GABPD, J. Lee’s method, and the expert. Figure 23b demonstrates the results
computing the infarct volumes of the rat brains according to their labels. The
experimental results shows that the proportions of the infarct volumes to the con-
tralateral hemisphere volumes computed by the SRBIAVC system with GABPD
are quite closed to those computed by the expert.

J. Lee’s method does not describe how to compute the atrophy volume. Therefore, in
this experiment, only the atrophy volumes computed by the SRBIAVC system and the
expert are displayed. Figure 24a shows the results computing the atrophy volumes of
28 adult male Wistar rats by the SRBIAVC system and the expert. Figure 24b displays
the results computing the atrophy volumes of the rat brains according to their labels.

D) Springer
10114

Y.-K. Chan et al.

 

    

SRBIAVC system

 

J. Lee’s method

Ground truth

 

Fig.22 The experimental results of infarct segmentation after removing corpus callosum

D) Springer
Image-based stroke rat brain atrophy volume and infarct volume... 10115

 

 

 

 

Fig.22 (continued)

g) Springer
10116 Y.-K. Chan et al.

Infarct Volumes

 

 

35
5
= 30
i
°o
& 25
a
2 20 Y
s 15
= 10 a
2 5 \ L RAW oa p
&
=
= 0
123 45 6 7 8 9 101112 13 1415 1617 18 19 20 21 22 23 24 25 26 27 28
Rat No.
e==== the expert ess SRBIAVC with GABPD
SRBIAVC with PSO. @==J. Lee's method
(a)
Average Infarct Volumes in Different Periods
25.00%
& 20.00% ———*
—
i
°o
Q
o
aA 15.00%
= Jaetak Lee’s method
=
S 10.00% the proposed method
2 —_ The experts
&
= 5.00%
—_
0.00%
1 day 7 days 14 days 28 days
Different Periods
(b)

Fig. 23 a the proportions of infarct volumes to the contralateral hemisphere volumes computed by the
SRBIAVC system (red line), J. Lee’s method (blue line), and the expert (gray line); b the proportions of
infarct volumes to the contralateral hemisphere volumes of the rat brains according to their labels (color
figure online)

Similarly, the experimental results show that the proportions of the atrophy volumes
to the contralateral hemisphere volumes computed by the SRBIAVC system are very
closed to those computed by the expert.

D) Springer
Image-based stroke rat brain atrophy volume and infarct volume... 10117

16%
14%
12%
10%
8%
6%
4%
2%
0%

 

Proposed method

 

The experts

 

Atrophy volume proportion

1 3 5 7 9 I1 13 15 17 19 21 23 25 27

Rat No.

(a)
12%
om fe
~
' a ae

0%
1 7 14 28

 

Proposed method

 

The experts

4%

Atrophy volume proportion

Different periods
(b)

Fig. 24 a the proportions of atrophy volumes to the contralateral hemisphere volumes computed by the
SRBIAVC system (blue line) and the expert (red line); b the proportion of atrophy volumes to the con-
tralateral hemisphere volumes of the rat brains according to their labels (color figure online)

6 Conclusions

To assess the effectiveness of stroke treatment and diagnosis, the SRBIAVC sys-
tem 1s proposed to take the place of the manual method in computing the infarct
volumes and the atrophy volumes of rat brains. First, the SRBIAVC system uses
H color layer of an HSV color rat brain slice image, in which there is the most
significant difference of the contrast between the RBS and image background, to
extract the RBS in the image.

To eliminate the influence of the corpus callosum on infarct volume estimation,
in this paper, a cerebral central line detection method is provided to automatically
divide the brain into ipsilateral and contralateral hemispheres. Then, the corpus cal-
losum volume in the contralateral hemisphere is subtracted from the infarct volume
in the ipsilateral hemisphere. Since the contrast between the infarct region and the
background is more apparent in the G color layer, this layer is used in infarct region

D) Springer
10118 Y.-K. Chan et al.

segmentation. To make the infarct region segmentation easier, a local gamma cor-
rection method is proposed to enhance the contrast of an image.

In image background removal, the SRBIAVC system obtaining the experimen-
tal result DS =98% is much better than J. Lee’s method obtaining the experimental
result DS = 85.95%. In cerebral central line detection, J. Lee’s method requires the
user manually to draw the cerebral central line, while the SRBIAVC system draws
the cerebral central line automatically. The experimental results showed that the
average distance between the cerebral central lines drawn by the SRBIAVC system
and by the experts is 4.479 pixels.

As mentioned previously, examining TTC-staining images of ischemic rat brain
Slice is time-consuming and labor intensive, and some subjective bias may appear.
Even though some automated methods were invented to overcome the possible bias
produced by manual examination, several flaws remain to be taken into account.
For example, determining the cerebral central line or outlining the infarct region in
ischemic brain images usually achieves manually. Comparing with J. Lee’s study,
our SRBIAVC system can determine the central line and outline the infarct region
automatically. The SRBIAVC system also removes corpus callosum area when cal-
culating ischemic infarct region to avoid interferencing the accuracy. The SRBIAVC
system further employs two algorithms to determine the fittest parameter values in
the extracting infarct step. Therefore, the proportion of infarct volume obtained by
the SRBIAVC system is much closer to the results calculated by experts compar-
ing with J. Lee’s method. In addition, the atrophy volumes computed by the SRBI-
AVC system are in close proximity to that calculated by the experts, while J. Lee’s
method does not offer atrophy volume calculations. In summary, the SRBIAVC sys-
tem is recommended for assessing the effectiveness of stroke therapy, development
of stroke medications, and diagnosis of stroke conditions.

Even though our results show that all of these measures can improve the accuracy
of infarct region detection effectively, there are still some limitations as well. First,
although the SRBIAVC system can automatically draw the cerebral central line of
the brain slice images, some images are not regularly shaped and the center groove
cannot be easily recognized (Fig. 17). Second, such as in Fig. 19, the SRBIAVC
system is sensitive to the mild infarct area in the extracting step, so if the brain slice
images are not well-stained or not easily distinguished, it cannot give a good result
for extracting the infarcts. Therefore, future studies can dedicate to develop new
algorithms to overcome these shortcomings and provide more precisely evaluating
programs for stroke animal models analysis.

Compliance with ethical standards
Conflict of interest None.

Open Access This article is licensed under a Creative Commons Attribution 4.0 International License,
which permits use, sharing, adaptation, distribution and reproduction in any medium or format, as long as
you give appropriate credit to the original author(s) and the source, provide a link to the Creative Com-
mons licence, and indicate if changes were made. The images or other third party material in this article
are included in the article’s Creative Commons licence, unless indicated otherwise in a credit line to the

Q) Springer
Image-based stroke rat brain atrophy volume and infarct volume... 10119

material. If material is not included in the article’s Creative Commons licence and your intended use is
not permitted by statutory regulation or exceeds the permitted use, you will need to obtain permission
directly from the copyright holder. To view a copy of this licence, visit http://creativecommons.org/licen
ses/by/4.0/.

References

11.

12.

13.

14.

15.

16.

17.

18.

19.

20.

Amiri SA, Hassanpour H (2012) A preprocessing approach for image analysis using gamma correc-
tion. Department of Computer Engineering Shahrood University of Technology Iran

Aspey B, Cohen S, Patel Y, Terruli M, Harrison M (1998) Middle cerebral artery occlusion in the
rat: consistent protocol for a model of stroke. Neuropathol App! Neurobiol 24(6):487—497

Bederson JB, Pitts LH, Germano SM, Nishimura MC, Davis RL, Bartkowski HM (1986) Evalua-
tion of 2,3,5-triphenyltetrazolium chloride as a stain for detection and quantification of experimental
cerebral infarction in rats. Stroke 17(6):1304—1308

Benjamin EJ, Blaha MJ, Chiuve SE, Cushman M, Das SR, Deo R, Floyd J, Fornage M, Gillespie
C, Isasi C (2017) Heart disease and stroke statistics-2017 update: a report from the American Heart
Association. Circulation 135(10):e146—e603

Borlongan C, Sumaya I, Moss D, Kumazaki M, Sakurai T, Hida H, Nishino H (2003) Melatonin-
secreting pineal gland: a novel tissue source for neural transplantation therapy in stroke. Cell Trans-
plant 12(3):225—234

Cipolla MJ (2009) The cerebral circulation. Morgan & Claypool Publisher, San Rafael

Cardenes R, de Luis-Garcia R, Bach-Cuadra M (2009) A multidimensional segmentation evaluation
for medical image data. Comput Methods Programs Biomed 96(2):108-124

Dice LR (1945) Measures of the amount of ecologic association between species. Ecology
26(3):297-302

Eberhart RC, Shi Y, Kennedy J (2001) Swarm Intelligence. Elsevier

Feigin VL, Krishnamurthi RV, Parmar P, Norrving B, Mensah GA, Bennett DA, Barker-Collo S,
Moran AE, Sacco RL, Truelsen T (2015) Update on the global burden of ischemic and hemorrhagic
stroke in 1990-2013: the GBD 2013 study. Neuroepidemiology 45(3):161—176

Fluri F, Schuhmann MK, Kleinschnitz C (2015) Animal models of ischemic stroke and their appli-
cation in clinical research. Drug Des Dev Ther 9:3445

Fonarow GC, Smith EE, Saver JL, Reeves MJ, Bhatt DL, Grau-Sepulveda MV, Olson DM, Her-
nandez AF, Peterson ED, Schwamm LH (2011) Timeliness of Tissue-Type Plasminogen Activator
Therapy in Acute Ischemic StrokeClinical Perspective: Patient Characteristics, Hospital Factors, and
Outcomes Associated With Door-to-Needle Times Within 60 Minutes. Circulation 123(7):750-—758
Friedlander F, Bohmann F, Brunkhorst M, Chae J-H, Devraj K, Kohler Y, Kraft P, Kuhn H, Lucaciu
A, Luger S (2017) Reliability of infarct volumetry: its relevance and the improvement by a software-
assisted approach. J Cereb Blood Flow Metab 37(8):3015—3026

Gelderblom M, Leypoldt F, Lewerenz J, Birkenmayer G, Orozco D, Ludewig P, Thundyil J, Aru-
mugam TV, Gerloff C, Tolosa E (2012) The flavonoid fisetin attenuates postischemic immune cell
infiltration, activation and infarct size after transient cerebral middle artery occlusion in mice. J
Cereb Blood Flow Metab 32(5):835—843

Gladence LM, Karthi M, Anu VM (2015) A statistical comparison of logistic regression and differ-
ent Bayes classification methods for machine learning. ARPN J Eng Appl Sci 10(14):5947-5953
Gladence LM, Ravi T, Dhas YM (2015) An enhanced method for disease prediction using ordinal
classification-APUOC. J Pure Appl Microbiol 9:345—349

Haralick RM, Sternberg SR, Zhuang X (1987) Image analysis using mathematical morphology.
IEEE Trans Pattern Anal Mach Intell 4:532—550

Hatfield R, Mendelow A, Perry R, Alvarezs L, Modha P (1991) Triphenyltetrazolium chloride
(TTC) as a marker for ischaemic changes in rat brain following permanent middle cerebral artery
occlusion. Neuropathol Appl Neurobiol 17(1):61—67

Holland JH (1992) Adaptation in natural and artificial systems: an introductory analysis with appli-
cations to biology, control, and artificial intelligence. MIT press, Cambridge

Jaccard P (1901) Etude comparative de la distribution florale dans une portion des Alpes et des Jura.
Bull Soc Vaudoise Sci Nat 37:547-579

Q) Springer
10120 Y.-K. Chan et al.

21.

22.

23.

24.

25.

26.

27.

28.

29.

30.

31.

32.

33.

34.

35.

36.
37.

38.

39.

40.

Al.

42.

43.

44.

Jana GA, Pan MS, Sural S, Chattaraj PK (2019) Modified particle swarm optimization algorithms
for the generation of stable structures of carbon clusters, Cn (n = 3-6, 10). Front Chem 7:485

Kim C, You B-J, Jeong M-H, Kim H (2008) Color segmentation robust to brightness variations by
using B-spline curve modeling. Pattern Recogn 41(1):22—37

Lee J, Le Saint S, Lee J-K, Han K (2007) A new algorithm for computing infarct volume in a rat
stroke model. In: International Conference on Convergence Information Technology. IEEE

Lee J, Lee J-K, Han K (2011) InfarctSizer: computing infarct volume from brain images of a stroke
animal model. Comput Methods Biomech Biomed Eng 14(06):497—504

Liszczak T, Hedley-Whyte E, Adams J, Han D, Kolluri V, Vacanti F, Heros R, Zervas N (1984)
Limitations of tetrazolium salts in delineating infarcted brain. Acta Neuropathol 65(2):150—157

Ma VY, Chan L, Carruthers KJ (2014) Incidence, prevalence, costs, and impact on disability of
common conditions requiring rehabilitation in the United States: stroke, spinal cord injury, trau-
matic brain injury, multiple sclerosis, osteoarthritis, rheumatoid arthritis, limb loss, and back pain.
Arch Phys Med Rehabil 95(5):986—995

Magistretti P, Pellerin L (1996) Cellular mechanisms of brain energy metabolism. Relevance to
functional brain imaging and to neurodegenerative disorders. Ann N Y Acad Sci 777(1):380-—387
McBride DW, Tang J, Zhang JH (2016) Development of an infarct volume algorithm to correct for
brain swelling after ischemic stroke in rats. Acta Neurochir Supp! 121:103—109

Murray CJ, Vos T, Lozano R, Naghavi M, Flaxman AD, Michaud C, Ezzati M, Shibuya K, Salomon
JA, Abdalla S (2012) Disability-adjusted life years (DALYs) for 291 diseases and injuries in 21
regions, 1990-2010: a systematic analysis for the Global Burden of Disease Study 2010. The Lancet
380(9859):2 197-2223

Otsu N (1979) A threshold selection method from gray-level histograms. IEEE Trans Syst Man
Cybern 9(1):62—66

Ovbiagele B, Goldstein LB, Higashida RT, Howard VJ, Johnston SC, Khavjou OA, Lackland DT, Licht-
man JH, Mohl S, Sacco RL (2013) Forecasting the future of stroke in the United States: a policy state-
ment from the American Heart Association and American Stroke Association. Stroke 44(8):2361—2375
Paczkowska E, Kucia M, Koziarska D, Halasa M, Safranow K, Masiuk M, Karbicka A, Nowik M,
Nowacki P, Ratajczak MZ (2009) Clinical evidence that very small embryonic-like stem cells are
mobilized into peripheral blood in patients after stroke. Stroke 40(4):1237—1244

Peng S-H, Kim D-H, Lee S-L, Lim M-K (2010) Texture feature extraction based on a uniform-
ity estimation method for local brightness and structure in chest CT images. Comput Biol Med
40(11-12):931-942

Ren C, Yan Z, Wei D, Gao X, Chen X, Zhao H (2009) Limb remote ischemic postconditioning pro-
tects against focal ischemia in rats. Brain Res 1288:88—94

Saha BN, Ray N (2009) Image thresholding by variational minimax optimization. Pattern Recogn
42(5):843-856

Serra J (1983) Image analysis and mathematical morphology. Academic Press Inc., Cambridge
Shen C-C, Yang Y-C, Chiao M-T, Cheng W-Y, Tsuei Y-S, Ko J-L (2010) Characterization of endog-
enous neural progenitor cells after experimental ischemic stroke. Curr Neurovasc Res 7(1):6—14
Somasundaram K, Kalaiselvi T (2011) Automatic brain extraction methods for Tl magnetic reso-
nance images using region labeling and morphological operations. Comput Biol Med 41(8):716—725
Taxin ZH, Neymotin SA, Mohan A, Lipton P, Lytton WW (2014) Modeling molecular pathways of
neuronal ischemia. Prog Mol Biol Transl Sci 123:249-275

Vanderbeck S, Bockhorst J, Komorowski R, Kleiner DE, Gawrieh S (2014) Automatic classification
of white regions in liver biopsies by supervised machine learning. Hum Pathol 45(4):785—-792

Wolf PA, D’agostino RB, Belanger AJ, Kannel WB (1991) Probability of stroke: a risk profile from
the Framingham Study. Stroke 22(3):312—318

World Health Organization. (2018, 2018.05.24). The top ten causes of death-Fact sheet N310.https
-//www.who.int/en/news-room/fact-sheets/detail/the-top-10-causes-of-death

Xu X, Chua CC, Gao J, Hamdy RC, Chua BH (2006) Humanin is a novel neuroprotective agent
against stroke. Stroke 37(10):2613-—2619

Zhang D, Park W-J, Lee S-J, Choi K-A, Ko S-J (2012) Histogram partition based gamma correction
for image contrast enhancement. In IEEE 16th International Symposium on Consumer Electronics
(ISCE). IEEE

Publisher’s Note Springer Nature remains neutral with regard to jurisdictional claims in published
maps and institutional affiliations.

Q) Springer
Image-based stroke rat brain atrophy volume and infarct volume...

Affiliations

10121

Yung-Kuan Chan'® - Chun-Fu Hong? Meng-Hsiun Tsai’ - Ya-Lan Chang! -

Ping-Hsuan Sun!

Chun-Fu Hong
cfhong @nqu.edu.tw

Meng-Hsiun Tsai
mht @nchu.edu.tw

Ya-Lan Chang
a5u83x06777 @ gmail.com

Ping-Hsuan Sun
bensonsun8649 @ gmail.com

Taiwan, ROC

National Quemoy University, Kinmen, Taiwan, ROC

Department of Management Information Systems, National Chung Hsing University, Taichung,

Q) Springer
