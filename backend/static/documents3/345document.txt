Wang et al. EURASIP Journal on Image and Video
Processing (2020) 2020:3

https://doi.org/10.1186/s13640-019-0488-6

RESEARCH Open Access

The Vese-Chan model without
redundant parameter estimation for

EURASIP Journal on Image
and Video Processing

Check for
updates

 

multiphase image segmentation

Jie Wang!, Zisen Xu2, Zhenkuan Pan!”, Weibo Wei! and Guodong Wang|

Abstract

The Vese-Chan model for multiphase image segmentation uses m binary label functions to construct 2”
characteristic functions for different phases/regions systematically; the terms in this model have moderate degrees
comparing with other schemes of multiphase segmentation. However, if the number of desired regions is less than
2™ there exist some empty phases which need costly parameter estimation for segmentation purpose. In this paper,
we propose an automatic construction method for characteristic functions via transformation between a natural
number and its binary expression, and thus, the characteristic functions of empty phases can be written and
recognized naturally. In order to avoid the redundant parameter estimations of these regions, we add area constraints
in the original model to replace the corresponding region terms to preserve its systematic form and achieve high
efficiency. Additionally, we design the alternating direction method of multipliers (ADMM) for the proposed modified
model to decompose it into some simple sub-problems of optimization, which can be solved using Gauss-Seidel
iterative method or generalized soft thresholding formulas. Some numerical examples for gray images and color
images are presented finally to demonstrate that the proposed model has the same or better segmentation effects as
the original one, and it reduces the estimation of redundant parameters and improves the segmentation efficiency.

Keywords: Multiphase image segmentation, Vese-Chan model, Parameter estimation, Binary label function,
Alternating direction method of multipliers

1 Introduction
Multiphase image segmentation under variational frame-
work has found a lot of applications including multi-target
detection and recognition, 3D segmentation and recon-
struction in medical images, remote sensing images, etc.
[1, 2], due to its property of multiple cue integration.
The aim of multiphase image segmentation is to parti-
tion images into different regions without any overlaps
and without any unlabeled region (called in the sequel
vacuum) automatically. It is a natural extension of the two-
phase image segmentation based on the variational image
analysis paradigm.

The Mumford-Shah model [3] is fundamental to vari-
ational image segmentation; it is a region-based model

 

*Correspondence: zkpan@126.com

'College of Computer Science and Technology, Qingdao University, Qingdao
266071, China

Full list of author information is available at the end of the article

g) Springer Open

 

which approximates an image to a piecewise smooth one
and edges. To circumvent the difficulty of its implementa-
tion, Chan and Vese [4] proposed the classical Vese-Chan
model under variational level set framework [5] based on
reduced Mumford-Shah model with piecewise constant
image assumption. The Chan-Vese model introduced one-
level set function to construct two characteristic functions
for two regions. Using the same concept, [6] introduced
n-level set functions to partition 1 regions for Potts model
[7], but a simplex constraint must be added to avoid vac-
uum and overlapping problem. In order to improve com-
putational efficiency from the viewpoint of model, Pan et
al. [8] proposed to use (7 — 1)-level set functions to design
n characteristic functions satisfying the simplex constraint
naturally. Vese and Chan [9] proposed a strategy using
m-level set functions to design = 2” characteristic func-
tions for different regions with less evolution equations to
be solved. Furthermore, Chung and Vese [10] proposed a

© The Author(s). 2019 Open Access This article is distributed under the terms of the Creative Commons Attribution 4.0
International License (http://creativecommons.org/licenses/by/4.0/), which permits unrestricted use, distribution, and
reproduction in any medium, provided you give appropriate credit to the original author(s) and the source, provide a link to the

Creative Commons license, and indicate if changes were made.
Wang et al. EURASIP Journal on Image and Video Processing

more efficient scheme using only one smooth function to
partition different regions.

Motivated by the relationship between the Heaviside
function of a level set function and a binary label function,
the piecewise constant level set function method was
adopted to two-phase image segmentation [11] combined
with convex relaxation and thresholding techniques with
high efficiency. The models for multiphase image segmen-
tation using variational level set method as mentioned
in the previous paragraph have been extended to the
counterparts using piecewise constant level set function
method successively, such as, [12] used 1 binary label
functions to partition 1 regions, [13] used m binary label
functions for 1 = 2” regions, and [14] used one piecewise
constant level set function for all regions. Comparatively,
Vese-Chan type scheme uses less label functions than [12],
and its characteristic functions have lower degree than
[14]. Obviously, lower degree characteristic functions are
convenient to achieve minimum of the energy functional.
To achieve higher computation efficiency for the opti-
mization problems, Goldstein and Osher [15] proposed
the split Bregman method, and Duan et al. [16] proposed
some fast projection methods without re-initialization.

Our research in this paper starts from Vese-Chan model
via binary label functions [11], and the goal is to improve
the computational efficiency through modifying its orig-
inal model with fewer parameters to be estimated. Using
Vese-Chan model, the number 7 of regions is deter-
mined by binary label function number m (ie., 1 = 2”).
For instance, if we partition 9 regions, we need 4 binary
functions to construct 16 characteristic functions, and
thus 7 regions are empty; however, the parameters in
these empty regions must be estimated when using
the original model. To avoid the parameter calculations
in these redundant regions, [17] proposed a modified
scheme for characteristic functions after 2”~! regions
that include two parts to discard the last empty regions,
which can overcome the problem of redundant parameter
estimations.

In this paper, we use a unified characteristic function
expression for all regions including redundant regions, but
we add some simple area constraints of redundant regions
to avoid estimations of redundant parameters, thus reduc-
ing costs. Although we transform the original model
into a constrained optimization problem, we use ADMM
[18-20] to solve it easily and systematically without
additional constructions of characteristic functions for
empty regions.

The outline of the paper is as follows. In Section 2,
we present some classical models of variational image
segmentation, covering the Potts model and Vese-Chan
model for multiphase image segmentation using binary
label functions. In Section 3, we propose the modified
Vese-Chan model and design its ADMM. In Section 4,

(2020) 2020:3

Page 2 of 17

experimental results of gray images and color images are
given to illustrate the efficiency of the proposed model in
this paper. Concluding remarks are drawn finally.

2 Some previous works of variational image
segmentation
2.1 Image segmentation under variational framework
The Mumford-Shah model and the Potts model are fun-
damental to variational image segmentation. The former
one is to partition an image f (v) : Q — R into piece-
wise smooth parts u(x) : Q* — R and edges I such
that Q = Q' UL and Q° OT = Q, its energy functional
minimization problem is stated as

Min lz (u,T)=a | (f — u) dx
ul Qs

+6 | |Vul?dx + y f as},
25 Tr

where a, 8, y are penalty parameters. The second one is
to partition the image domain Q into

(1)

N
Q= U Q;
j=1

l=

and QQ; Q; = ©. (2)

Its energy functional minimization problem is
“ 2
Min Min ja | — u;) dx
min ain food i
nN
+y >> |aQi ;
i=1

where |0{2;| stands for the boundary length of each sub-
region.

In order to solve these problems in image domain, one
approach is assigning a characteristic function for each
region and making use of its total variation to replace
length terms. If zero level set {x : 6 (x) = 0} of a level set
function ¢ (x) is used to describe the curve for region par-
tition implicitly, its Heaviside function H (@ (*)) can be
used to define characteristic functions of regions. ¢ (x)
and H (¢ (x)) are defined respectively as

(3)

>0O x inside

ob (x) = 0 xonlT, (4)
< 0 x outside I
_jJlg¢@@m2zo
Hp (*)) = 0 otherwise ° (5)
Then, the length of a closed curve I is
pas= | WH cide. (6)
r Q

Using level set method, Chan and Vese [4] proposed the
Vese-Chan model for two-phase segmentation under vari-
ational level set framework based on reduced Mumford-
Shah model with piecewise constant image assumption,
and it is stated as
Wang et al. EURASIP Journal on Image and Video Processing

Min lz (U1, U2,0) = ay [ (f — u1)H (p)dx

Uj U2,

$a [ (f — u)? (1 — Hd) dx (7)
ty [ivi eyias}.

If @ (x) is defined as a signed distance function, it must
fulfill the following Eikonal equation

[Vel =1. (8)

For the case of multiphase segmentation, if each region
is assigned a characteristic function x;(x) € {0,1},
(i= 1,..,n), (ie, xj (*) =1 for x EQ; x;(«) =0 for
x ¢ Q;), the Potts model (3) can be rewritten as

N
2
Min Min | — uu) xd
Min in| d , i) i
N
ty | wala.
j=1 ° i

In order to fulfill the condition (2), x; (x) must satisfy
the following simplex constraint

Di A@=L
i=1

Using variational level set method, each region is
described by one-level set function ¢; (x), then, its charac-
teristic function can be denoted by the Heaviside function
of oj (x) (ie, xi («) = H (Gj (x))). Replacing x; (x) with
H (¢; («)) in Eqs. (9) and (10) leads to the Potts model
under variational level set framework.

Motivated by the Four-Color Theorem, Vese and Chan
[9] proposed a strategy to partition 1 regions using m-level
set functions with 1 = 2”, which can avoid the problem of
vacuum and overlaps, and where the model is expressed as

(10)

gm
Min lz (u,o) =a >| (f — ui)” xidx
Hd j=1 72

, (11)
try [ Iva (ola]
ja?
where x; is characteristic function with the form
Mm
xi = | | Y@), ¥@) = H@) or 1-H). (12)

j=1

For instance, ifm = 2, x1 = H(¢1)H(¢2), x2 =
H ($1) 1 —A ($2)), x3 = C-H (b1))H (¢2), x4 =
(1 — AH (¢1)) 1 — A (¢2)).

(2020) 2020:3

Page 3 of 17

2.2 Variational convex model for multiphase image
segmentation

Taking into account the relationship of level set function

and characteristic function, [11] rewrote the Chan-Vese

model via a binary label function @ € {0, 1}

Min
U1 ,U2,p€{0,1}

lz (U1, 42,0) = 1 [ (f — u1) dx

ton | (f—m)?a-dde 3)

+ y | Vola
Q

During automatic computation, ¢ is relaxed to a con-
vex version @ € [0,1], which is recovered to its binary
label function finally. For the case of multiphase image
segmentation, [13] introduced m binary label functions
gj € {0,1}, (j = ],...., m) to define n = 2” characteris-
tic functions for region partitioning, leading to the new
Vese-Chan model in convex form

gm
Min lz (u,o) =a >| (f — ui)” xidx
ud j=1 72

, (14)
+y >| IVejlds,
jar?
where the form of characteristic function is
M
X=] ]Y@), YO) = gor 1-4. (15)
j=l

Whenever the number of image regions is taken as
Ne (21,2), the problem of the automatic estima-
tion of redundant parameters u; arises, and this in turn
increases the computation cost due to inherent redun-
dancy. Assuming that the number of redundant regions
start from N + 1, Li et al. [17] proposed a scheme
to avoid redundant parameter estimation using various
characteristic function formulas. Their energy functional
minimization problem is as follows

N
Min {E09 =a >> | (f — uj)? xNax
wd i=1 0°
+d [ \voylast,
ja?

where u = {ui} pe= {Oj} > xn is characteristic func-

tion of the ith region. If N = 2”, x is defined evenly

xP" =a" (gy), (17)

j=l
Wang et al. EURASIP Journal on Image and Video Processing

if2”-!<N <2”,

m ™m ;_
x* =(-D* 0 (4-0 ')
j=l
fori =1,--- ,2io

m) My - , (18)
xN = (0 1 (gj 07")
J=
fori = 2i9 + 1,--- ,N
where m, = m—1,i9 = N — 21, i) =i-—io, 7" =

Mm . .
be", pn = {0,1}. This scheme can handle dif-
i=1

j
ferent situations for different numbers of image regions.

However, it destroys the original symmetric forms with
complicated different characteristic functions. For exam-
ple, there are different forms of characteristic function for
N = 5and N = 7, which are as follows

x? = $1 6293;
X> = b1¢2 (1 — 43)

X3 = ¢1 (1 — $9) ; (19a)
Xr =(1—- $1) do

Xe = (1— $1) 1 — dp)

x1 = o162¢3

xX, = o162 (1 — $3)

x3 = o1(1— 2) $3

X, = $1 (1 — $2) (1 — $3) , (19b)

XZ = (1 — $1) drs
x6 = (1 — $1) d2 (1 — $3)
x4 = (1— $1) (1 — $2)

which will reduce the generality of characteristic func-
tion for different region numbers and increase the com-
putation time. In the next section, we propose another
modified Vese-Chan model to overcome these problems.

(2020) 2020:3

Page 4 of 17

3 Methods

3.1. Characteristic functions based on binary
decomposition

According to the original scheme by [9], the intersection

of m binary functions can generate n = 2” characteristic

functions for region partition. Let the binary expression of

characteristic functions x; be ia ..- b'1, where the

value of bi is related to the binary expression about the

subtraction of index by one (i.e., i — 1) for the ith region

Q;, then the characteristic function of Q; is

mM
| pi-}
x =T] (4 '+Cv" 4), (20)
j=l
where ¢ € {0,1}, be — {0,1},i = 1,---,2™,
j=1,---,m. Taking m = 3 for example, 8 regions are

partitioned as shown in Fig. 1, and the relevant character-
istic functions are listed in Table 1.

3.2 The classic optimization scheme of the Vese-Chan
model

Equation (14) stated a multiphase segmentation Vese-
Chan model using m binary label functions to define
2” characteristic functions, which is usually solved by
alternative optimization method.

The idea of alternative optimization is to solve mini-
mum problem of a variable by fixing others. Firstly fix
to optimize u, we obtain

“i= lof xidx
Jo xide ’

When u is fixed, we compute ¢ by gradient descent
method, which is shown below

0g (VO) 2 ax:
uN (a) 2H) ag

i=1

(i=1,---,2”). (21)

 

Fig. 1 Eight regions partitioned by three binary label functions

 

 

 
Wang et al. EURASIP Journal on Image and Video Processing

Table 1 Relationship between binary region number and
characteristic function

 

m i]
Q; bi! b>! by! Characteristic function x; = T] (o- + (-1)9 ¢))
j=l

 

2,0 0 0 x1 =¢1¢2¢3

Q20 0 1 x2 =¢16201 — $3)

230 1 0 x3=1( — $2)¢3

Q40 1 1 x¥4= $10 — $2)0 — $3)

251 0 0 xX5=( — $1)d2¢3

21 0 1 xX¥65=C— $1)b20 — $3)

Q7 1 1 0 xX7=O-—¢1)0 — $2)¢3

2g 11 1 x¥s=O-—¢1)0 — $2)0 — $3)

 

where V - (75:) is the curvature term of ¢. We use the
upwind differential scheme [16] to compute this term

(a)
IVbx.y|

 

 

 

 

 

 

_ vt. ( Vy ) (23)
[Vo dbx,y
= Dixy Px+1y + A2x,yPx—Ly
+ A3x,yPx,y-+1 + dax,yPxy—1 _ Dy,yPeey
where
1
Any =
(Sates ) + (ee ) 4 €
1
dd, —= [7 NN
(Seapets ) + (Soe ) 4 €
1
Oxy =
( Pry bP ) + ( Pati“ Ps dy ) 4 €
1
age, = [7 NN
(Spe) 4 (Seat eout) 4
Day = Ai x,y + Ad, + A35., + day,
(24)

In Eq. (24), x and y represent coordinates in the image,
h is spatial step, and € is a small positive value.

For the optimization of variable ¢, the curvature term of
@ will be obtained if the alternative optimization method
is used directly, causing complex difference scheme
and low computational efficiency. However, the ADMM
method can avoid computing the curvature term and sim-
plify the solving process by introducing auxiliary variables
and Lagrange multipliers.

(2020) 2020:3

Page 5 of 17

3.3. The modified model for gray images and its ADMM
For a gray value image f(x) : Q — RwithN < 2”
regions, there exist 2” — N redundant regions in the range
[V+ 1,2”]. To avoid the redundant parameter estima-
tions, we add area constraints on these regions

| x1 (¢) dx =0,(1=N+1,...,2). (25)
Q
We cast the Vese-Chan model into
~ 2
Min {E: (u,b) =a >| (f — ui) xi (p) dx
i=1 (26)

ty Voyla
jar?

with constraints (25), where u= {ui} , consists of
parameters need to be estimated, ¢ = {Oj} 4 consists of
binary label functions.

In order to improve the efficiency, ADMM is used in
our method. We introduce auxiliary variable w = V¢,
Lagrange multipliers A;, 4; and positive penalty param-
eters 0, uw. We add constraints (25) into Eq. (26), which
can be rewritten as the following form of alternative
optimization

(ui, p+, wit) — arg Min
u,~,w

E, (ug,w) =a > Jo (f — ui) xi @)dex
ty Iq |wi|dx
+e JQ dj - (Wj — Voi dx (27)
> Jog |wj — Vol ax

gm
+ fodixr(b) dx
[I=N+1

gm
+6 3 fo cu@))?dx
[I=N+1

where k is the iteration step.

Using the idea of alternative optimization, Eq. (27) is
transformed into the following sub-problems of optimiza-
tion in each loop

(ui) = arg Min EF; (u, bk, w*) ; (28a)
Uu

(o'+) =arg Min E1 (ui d,w'), (28b)

(wi+) = arg Min F; (ui, p+, w) . (28c)
Ww
Wang et al. EURASIP Journal on Image and Video Processing

Using variational method to Eq. (28a), fix o* and wk to
optimize u<+!, we obtain

itl a Joh xi (b)dx
To xi (P)dx

For the problem (28b), since @ € {0,1} is a non-convex
function, we first transform ¢@ € {0,1} to ¢@ € [0,1] with
convex relaxation and then fix ut! and w* , and the sub-
problem of optimization with respect to #**! is as follows

(i=1,---,N). (29)

1) _— Mi
(6)

kt p yk) a © _kHY
Balu!) aS fa fl) nto

+> [ody WF — Voix
j=l

9m
+ [oahu () dx
I=N+1

gm
+2 3 fo cag))?dx
I=N+1

(30)
we obtain the Euler-Lagrange equation of gr
A+B+C=0 x EQ
— (ak + wk — Vj) =0 x € dQ (31)

N 2 m

where A = Y a(f — uf") re B= (Vv aky
i=1 j=l

ov (wk —V6)),C= Yo (ak + ux) A. gf

l=N+1
can be solved by Gauss-Seidel iterative method, then

ok! = Max (Min (a, 1) ,0) . (32)
For Eq. (28c), to fix u<+! and $+! to optimize w+! , we
obtain the Euler-Lagrange equation
Wi

v + Af + O(wj — Voi) = 0, (33)

|

when lw; ~ 0. Equation (33) can be expressed as a fol-
lowing generalized soft thresholding formula in analytical
form

 

 

rk
ak Voxtti og

wp max (lvoe) 20)
veh 9

 

(34)

(2020) 2020:3

Page 6 of 17

The Lagrange multipliers wt and a +! can be updated
as the following

k+1 _ yk k+l oak
aft = ak +0 (wht! — voit)
(35)
Ap = AE + oxi)
In order to represent the boundary of segmented

images, it is necessary to transform @; after convex relax-
ation to binary label function as the following

$= 1 @=T
1 |0 g<t’

where t € (0,1). The parameter Tt is usually chosen as
T= 7 The stopping criterion is based on the relative

(36)

energy error formula le — E\\Ey! <e, where € isa

small positive value.
The ADMM of modified model for gray images can be
described as Algorithm 1.

Algorithm 1 ADMM of modified Vese-Chan model for
gray images
Initialize: u° = f°, w° = Vo°, r° = 0, step = 500;

1: for (k = 0;k <= step;k + +) do

2: uxt} are given by (29);

3: gx are given by (31),(32);
4: weit are given by (34);

5: wt, apt are given by (35);
6: if ee — Ey\Ey! < «then
7: break

8: end if

9: end for

 

3.4 The modified model for color images and its ADMM
Different from a scalar image, a color image consists of
three layers, so parameter estimation is needed for each
layer in different regions. Let f = (fis fas fs) e€ R® be
a color image, uw; = (Uj, Uj2,Uj3) be the piecewise con-
stant parameters to be estimated in the ith region, ¢
consists of m binary functions as the previous sub-section,
and the variational model for multiphase color image
segmentation is

N 3
Min {2 (u,g) =a) | (fs — Uip) xi (p) dx
, i=1 p=1
4 yy | \vejlas,
ja 7?
(37)

it is also subjected to the constraints (25).
Wang et al. EURASIP Journal on Image and Video Processing

To design its ADMM method, we introduce auxiliary
variable w= V@ , Lagrange multipliers A;, A; and posi-
tive penalty parameters 0, 4. Then we add constraints (25)
into Eq. (37) and transform it into the following form of
alternative optimization

(ui, pt, wht) = arg Min
u,d,w
N 3 9
E(u, ¢,w) =a > Y fo (fp — up) xi (pdx
i=1 p=1
M
TY dX Iq |wjldx
J=
M
+o fod: (Wj — Vode
i=]
, — 2
+5 » Ja |w; — Voj|"dx
J=
gm
+ YO fortxr) dx
I=N+1
9m
+6 y folu@))dx
I=N+1

(38)

Using the same procedure as the last sub-section in each
loop of optimization, we get successively
t= JoSpxi (p)dx

? To xi (p) dx ,

wos k+1
Fixing Uj,

(39)

and w*, we obtain the Euler-Lagrange

equation of ¢*+! as the following

Aj+B+C=0 xEQ
—(Ak+wk-V¢j)-2=0 x02’ (40)
N 3 2
where Aj = ay > (%- ui) oHNeD We design

i=1 p=1
Gauss-Seidel iterative method from Eq. (40) to compute
k+1
gk,
j

weit can be solved from Eq. (34). The Lagrange multi-

pliers yet and art can be updated as Eq. (35).
The ADMM of the modified model for color images can
be described as Algorithm 2.

4 Results and discussion

In this section, we present two groups of numerical exper-
iments for segmented images including gray images and
color images to study the effectiveness and efficiency of
our method. For Eqs. (27) and (38), if the number of
regions N = 2”, this method represents traditional 2’”-
phase segmentation with ADMM. If N < 2”, it represents
the proposed method in this paper. The initial binary label
function ¢ is initialized as m circles, there are two cases,
in the circle #° = 1 otherwise ¢° = 0. In our experiments,
We seta =1lu=1h=t1e = 10-%¢ = 107°. All

(2020) 2020:3

Page 7 of 17

Algorithm 2 ADMM of modified Vese-Chan model for
color images
Initialize: u? = f°, w° = Vo", r° = 0, step = 500;

1: for (k = 0;k <= step;k ++) do

2: ui are given by (39);
3: gx are given by (40),(32);
4: wk? are given by (34);

j
wt, apt are given by (35);

6: if Eh — Ey! |Eyh < e then
7: break

8: end if

9: end for

experiments are performed using MATLAB R2016a on a
Window 7 platform with an Intel(R) Core(TM) i5-4590
CPU at 3.30GHz and 4.00GB memory.

4.1 Numerical experiments for gray image segmentation
Firstly, we compare the Vese-Chan model without redun-
dant regions by using classic optimization method shown
in Section 3.2 and ADMM method in Section 3.3 to study
advantages of the latter method. Besides, we compare
Algorithm 1 with the original Vese-Chan model in [9]
and TV regularization method in [17] for images with
redundant regions.

4.1.1 Comparisons between the classic optimization
method and ADMM

Figure 2 a shows a synthetic image with four phases, so
we use two binary label functions to design characteris-
tic functions. Figure 2b and c are segmentation results
for classic optimization method and ADMM method,
respectively, which contains four meaningful phases
(Fig. 2d—g, h-k). We conclude that the above two methods
obtain the same segmentation effectiveness.

In Fig. 3, we compare the classic optimization method
and ADMM method for a brain MR image. The four
phases of two methods are displayed in the second row
and the third row, respectively. The ADMM method can
give the better segmentation result from the comparison
of Fig. 3f and g.

Table 2 demonstrates the iterations and computational
time for Figs. 2a and 3a. ADMM method consumes less
computational time and iterations than the classic opti-
mization method. We can conclude that using ADMM
method can improve computational efficiency for image
segmentation.

4.1.2 Comparisons between Algorithm 1 and other methods
Figure 4 a shows a picture consists of a little bottle, a
cup, and background, which occupy three regions. Using
Vese-Chan scheme for division, we need two binary label
 

 

Wang et al. EURASIP Journal on Image and Video Processing (2020) 2020:3 Page 8 of 17

 

 

(h) (i)

Fig. 2 Comparison of the classic optimization method and ADMM. a The input synthetic image. b The segmentation result of classic optimization
method. ¢ The segmentation result of ADMM. d-g Different regions obtained via the classic optimization method. h-k Different regions obtained
via ADMM

 

 

(i) (k)

 

Fig. 3 Four-phase segmentation of the classic optimization method and ADMM. a The input brain MR image. b The segmentation result of classic
optimization method. ¢ The segmentation result of ADMM. dg Different regions obtained via the classic optimization method. h-k Different
regions obtained via ADMM

 

 

 
Wang et al. EURASIP Journal on Image and Video Processing

Table 2 Iterations and computational time for Figs. 2a and 3a

 

 

 

Image Size Iterations Computational time(s)
Classic ADMM Classic ADMM
optimization optimization

Figure 2a 256 x 256 85 20 17.18 1.12

Figure 3a 142 x 146 245 22 36.96 2.10

 

functions to design characteristic functions. The original
Vese-Chan method uses N = 4 with one empty region,
TV regularization method and our method use N = 3
without empty regions. Three methods get the same seg-
mentation results as shown in Fig. 4b—d, which contain
three meaningful regions (Fig. 4e—g, i-k, and m—o) and
one empty region (Fig. 4h, 1, and p). The differences of
their computation efficiency are listed lately together with
other experiments.

Figure 5 presents a three-phase segmentation problem
also, but the image is a synthetic one with noises as
shown in Fig. 5a. Figure 5 b—d show the segmentation

(2020) 2020:3

Page 9 of 17

results via the original Vese-Chan method, TV regulariza-
tion method, and our method, respectively. Comparison
between four characteristic functions of every method
(Fig. 5e—p) shows that three methods obtain the same
segmentation result.

In Fig. 6, we compare the original Vese-Chan method,
TV regularization method, and our method for a three-
phase CT image slice of brain, and the segmentation
results using these three methods are given in Fig. 6b—d,
respectively. Different regions of three methods are shown
in the last three rows. From experiment results, we con-
clude that three methods can obtain the similar segmen-
tation effectiveness.

Figure 7 a shows a synthetic image consists of six
regions, and we need three binary label functions to
design characteristic functions. The original Vese-Chan
method uses N = 8 with two empty regions, TV
regularization method, and our model use N = 6 without
empty regions. Three methods get the same segmentation
results as shown in Fig. 7b—d, which can obtain the same

 

 

(m) (n)

 

obtained via our method

 

(0) (p)

Fig. 4 Comparison of original Vese-Chan method, TV regularization method, and our method using two label functions. a The input nature image. b
The segmentation of original Vese-Chan method. ¢ The segmentation of TV regularization method. d The segmentation of our method. e-h
Different regions obtained via the original Vese-Chan method. i-l Different regions obtained via TV regularization method. m-p Different regions

 
 

Wang et al. EURASIP Journal on Image and Video Processing (2020) 2020:3

Page 10 of 17

 

 
   
     
  

  

(d)

  
 

ae
cn
cn

(m) (n) O (p)

(f)

(3)

 

Fig. 5 Three-phase segmentation of original Vese-Chan method, TV regularization method, and our method. a The input synthetic image. b The
segmentation of original Vese-Chan method. ¢ The segmentation of TV regularization method. d The segmentation of our method. e-h Different
regions obtained via the original Vese-Chan method. i-I Different regions obtained via TV regularization method. m-p Different regions obtained

via our method

 

 

(p)

 

Fig. 6 [hree-phase segmentation for a CT image slice of brain. a The input CT image slice of brain. b The segmentation of original Vese-Chan
method. ¢ The segmentation of TV regularization method. d The segmentation of our method. e-h Different regions obtained via the original

Vese-Chan method. i-I Different regions obtained via TV regularization method. m-p Different regions obtained via our method

 

 

 

 
Wang et al. EURASIP Journal on Image and Video Processing

(2020) 2020:3

Page 11 of 17

 

 

(i)

regions obtained via our method

 

(a)

 

(d)

 
 

 

(h)

 

(1)

Fig. 7 Six-phase segmentation of original Vese-Chan method, TV ulation method and our method. a The input synthetic image. b The
segmentation of original Vese-Chan method. ¢ The segmentation of TV regularization method. d The segmentation of our method. e-l Different

 

 

meaningful phases. Therefore, we only show six different
regions obtained via our method in Fig. 7e-j.

We record iterations and computational time of three
methods for Figs. 4a, 5a, 6a, and 7a in Table 3. From
Table 3, we reach that TV regularization method and our
method both consume less computational time than origi-
nal Vese-Chan method, and the reason of which is the first
two methods reduce estimation of redundant parameters.
Our method can obtain the highest computational effi-
ciency. Next, we will study the reasons for this result.

TV regularization method uses an acceleration method,
and our method also uses ADMM acceleration method. In
order to further explore the efficiency of our method, we
compare four methods, including TV regularization with-
out acceleration method (TV-RWAM), our method with-
out ADMM, TV regularization method, and our method.
The first two methods use upwind differential scheme
as shown in Section 3.2 to compute label function @.
Figure 8 presents a six-phase segmentation problem, the
image is a remote sensing one of coastline as shown in

Fig. 8a. Figure 8 b—e show the segmentation results via
the above four methods, respectively. Figure 8f-i are gray
images according to four final segmentations. The itera-
tions and computational time of four methods are showed
in Table 4.

From Table 4, our method without ADMM consumes
less iterations and computational time than TV regular-
ization without acceleration method, because we add area
constraints of redundant regions and simplify the expres-
sion of characteristic functions. Besides, our method
consumes less computational time than TV regulariza-
tion method, and the reason of which is we use ADMM
method to compute energy optimization, improving the
computational efficiency.

4.2 Numerical experiments for color image segmentation
Color image segmentation is an extension of gray
image segmentation. We compare the original Vese-Chan
method and TV regularization method with our method
presented in Section 3.4 for color images.

Table 3 Iterations and computational time for Figs. 4a, 5a, 6a, and 7a

 

 

 

Image Size Binary label Iterations Computational time(s)
function
Original TV regularization = Our Original TV regularization = Our
Vese-Chan method method Vese-Chan method method
method method
Figure4a 160x160 2 83 5/ 46 244 1.56 1.11
Figure5a 160x160 2 72 49 38 2.61 1.98 1.36
Figure6a 150x150 2 64 44 37 1.52 1.06 0.54
Figure 7a 455x451 3 7) 50 24 49.94 25.12 16.2]

 
Wang et al. EURASIP Journal on Image and Video Processing

(2020) 2020:3

Page 12 of 17

 

via the final segmentation results

 

 

NNN
Nae

Fig. 8 Comparison of TV regularization method and our method both solved without/with acceleration method. a The remote sensing image of
coastline. b-e The segmentation of TV-RWAM, our method without ADMM, TV regularization method and our method. f-i Gray images obtained

 

 

Figure 9 presents a three-phase segmentation problem,
the color image is a part of flower as shown in Fig. 9a.
Figure 9b—d show the segmentation results via the above
three methods respectively. Figure 9e—h show different
regions via the original Vese-Chan method. Because the
TV regularization method and our method obtain the
same result, we only show different regions about our
method (Fig. 9i-l). Comparison between empty regions
(Fig. 9h and 1) shows that our method and TV regulariza-
tion method give better segmentation result.

Figure 10a presents a six-phase synthetic color image,
the segmentation results using the original Vese-Chan
method, TV regularization method and our method are
given in Fig. 10b—d, respectively, which obtain the same
meaningful regions. Therefore we only show six meaning-
ful regions via our method in Fig. 10e-j.

Figures 11a, 12a, and 13a are synthetic color images with
nine, ten and eleven different regions respectively, so we

Table 4 Iterations and computational time for Fig. 8a

 

 

Method Iterations Computational time(s)
TV-RWAM 220 29.24
Our method without ADMM 216 24.68
TV regularization method 135 17.95
Our method 90 10.29

 

need four binary label functions to design characteristic
functions. We use three methods: the original Vese-Chan
method, TV regularization method and the proposed
method. The first one uses N = 16 for three images,
causing seven, six and five empty regions separately. Our
method uses N = 9, N = 10 and N = 11 without empty
regions respectively. For Fig. lla, results are shown in
Fig. 11b—d. Three methods obtain the same segmentation
results. As a representative, Fig. 1le—m show nine differ-
ent regions obtained via our method. Figure 12b—d show
segmentation results for a ten-phase image. The first eight
different regions for Fig. 12 are the same as Fig. 11, and
two other regions as shown in Fig. 12e—f. The segmenta-
tion results for Fig. 13a are shown in Fig. 13b—d, and its 11
different regions include Figs. 1le—l, 12e, and 13e-f.

We record total iterations and computational time of
the above three methods for Figs. 9a, 10a, lla, 12a,
and 13a in Table 5, from which we can conclude that
compared to the original Vese-Chan method and TV
regularization method, and our method can improve com-
putational efficiency for color images. With increase of
the empty regions of images, it is more obvious that
the computational efficiency is improved. Besides, the
iterations and computational time are positively corre-
lated with the image sizes.

From the above experiments, we can conclude that the
computational cost of our method includes two parts:
Wang et al. EURASIP Journal on Image and Video Processing (2020) 2020:3 Page 13 of 17

 

 

(i) (j) (k) (1)

Fig. 9 [hree-phase segmentation of a color image. a The input color image. b The segmentation of original Vese-Chan method. ¢ The
segmentation of TV regularization method. d The segmentation of our model. e-h Different regions obtained via the original Vese-Chan method.
i-l Different regions obtained via our method

 

 

 

 

(i) (j) (k) (1)

Fig. 10 Six-phase segmentation of a color image. a The input color synthetic image. b The segmentation of original Vese-Chan method. ¢ The
segmentation of TV regularization method. d The segmentation of our method. e-I Different regions obtained via our method

 

 

 

 
Wang et al. EURASIP Journal on Image and Video Processing

(2020) 2020:3

Page 14 of 17

 

  

oe

(a

(f)

 

 

 

 

Fig. 11 Nine-phase segmentation of a color image. a The input color synthetic image. b The segmentation coin Vese-Chan method. ¢ The
segmentation of TV regularization method. d The segmentation of our model. e-m Nine meaningful regions obtained via our method

 

o, ©,

ml
Ea ¢

(k) (m)

 

 

 

parameter computations for ¢, w, A and parameter esti-
mations for u, both of which are relative to the image sizes.
Besides, the former one is also relative to the number
of binary label function m. When there exist redundant
regions in the images, (ie., N < 2”), parameter estima-
tions are relevant to N.

The number of regions N can be detected according to
the number of target objects in the image. In the paper, the
segmented images are simple and easy to determine the
value of N. However, if the image is complex, the value of
N is difficult to determine, which is a limit that needs to
be solved in the future.

 

 

(b)

(e)

 

 
  

(a)

M

 

Fig. 12 Ten-phase segmentation of a color image. a The input color synthetic image. b The segmentation of original Vese-Chan method. ¢ The
segmentation of TV regularization method. d The segmentation of our model. e-f Two meaningful regions obtained via our method

 

hd
y

 

(d)

 

(f)

 

 
Wang et al. EURASIP Journal on Image and Video Processing

(2020) 2020:3

Page 15 of 17

 

 

X

 

(b)

bh

 

(a)

(c)

y

€e- S €e-

(d)

(e) (f)

Table 5 Iterations and computational time for Figs. 9a, 10a, 11a, 12a,and 13a

Fig. 13 Eleven-phase segmentation of a color image. a The input color synthetic image. b The segmentation of original Vese-Chan method. ¢ The
segmentation of TV regularization method. d The segmentation of our model. e-f Two meaningful regions obtained via our method

 

 

 

 

Image Size Binary Iterations Computational time(s)
label
function
Original TV regularization Our Original TV regularization Our
Vese-Chan method method Vese-Chan method method
method method
Figure 9a 200x236 2 80 4] 35 3.66 1.51 1.02
Figure 10a 200x194 3 98 72 40 6.73 3.82 2.44
Figurella 270x180 4 100 66 28 48.15 19.20 9.53
Figure 12a 300x200 4 122 87 55 59.91 29.17 22.02
Figure 13a = 330x220) 4 149 101 72 70.32 38.60 32.01

 

 
Wang et al. EURASIP Journal on Image and Video Processing

5 Conclusions

In order to improve the computation efficiency of the
Vese-Chan model for multiphase image segmentation in
a systematic form, we have designed a modified Vese-
Chan model by introducing some simple area constraints.
The forms of characteristic functions are unified, and the
redundant parameter estimations are not needed, there-
fore, the cost of computation is reduced. Obviously, the
computational efficiency is higher with the increase of
the empty regions. Additionally, we formulate the ADMM
for the proposed model to further improve efficiency.
Some numerical examples for gray image and color image
multiphase segmentation are presented to demonstrate
that the proposed model has the same or better segmen-
tation effects and higher efficiency. Our method can be
applied into motion segmentation, surface segmentation,
and 3D reconstruction in the future work.

Abbreviations
ADMM.: Alternating direction method of multipliers; TV-RWAM: TV
regularization without acceleration method

Acknowledgements
The authors thank the editor and anonymous reviewers for their helpful
comments and valuable suggestions.

Authors’ contributions

All authors took part in the discussion of the work described in this paper. The
author JW carried out the experiments of the paper and wrote the paper. The
author ZX participated in experiments. The author ZP designed the algorithms
of this work and revised the paper. The author WW and GW helped conduct
the experiments. All authors read and approved the final manuscript.

Authors’ information

Jie Wang was born in 1994. She is a postgraduate student of College of
Computer Science and Technology, Qingdao University, Qingdao, China. Her
current research interests include variational image restoration and
segmentation. Email: wangjqdy@163.com.

Zisen Xu was born in 1965. He received Master degree in College of
Information Engineering, Qingdao University, Qingdao, China in 2007. He is a
Senior Engineer in The Affiliated Hospital of Qingdao University, Qingdao,
China. His current research interests include medical engineering and
post-processing of medical image.

Zhenkuan Pan was born in 1966. He received his Ph.D. degree in Engineering
Mechanics from Shanghai Jiao Tong University, Shanghai, China in 1992. He is
a Professor in College of Computer Science and Technology, Qingdao
University, Qingdao, China. His current research interests include dynamics
and optimization of multibody systems, medical simulation and variational
image processing.

Weibo Wei was born in 1981. He received his Ph.D. degree from Nanjing
University of Science and Technology, Nanjing, China in 2006. He is an
Associate Professor in College of Computer Science and Technology, Qingdao
University, Qingdao, China. His current research interests include image
processing, biometric identification, automatic target recognition and
tracking. Email: njustwwb@163.com.

Guodong Wang was born in 1980. He received his Ph.D. degree in Pattern
Recognition and Intelligent System in Huazhong University of Science and
Technology, Wuhan, China in 2008. Now he is an Associate Professor in
College of Computer Science and Technology, Qingdao University, Qingdao,
China. His research interests include variational image science, face
recognition, intelligent video surveillance, 3D reconstruction and medical
image processing and analysis. Email: doctorwgd@gmail.com.

Funding
This work was supported by the National Natural Science Foundation of China
(Grant No.61772294).

(2020) 2020:3

Page 16 of 17

Availability of data and materials
Please contact author for data requests.

Competing interests
The authors declare that they have no competing interests.

Author details

'College of Computer Science and Technology, Qingdao University, Qingdao
266071, China. *The Affiliated Hospital of Qingdao University, Qingdao 266003,
China.

Received: 15 May 2019 Accepted: 18 December 2019
Published online: 14 January 2020

References

1. F.Li, S. Osher, J. Qin, M. Yan, A multiphase image segmentation based on
fuzzy membership functions and L1-norm fidelity. J. Sci. Comput. 69(1),
82-106 (2016)

2. L.S. Cigaroudy, N. Aghazadeh, A new multiphase segmentation method
using eigenvectors based on K real numbers. Circ. Syst. Sig. Process. 36(4),
1445-1454 (2017)

3. D.Mumford, J. Shah, Optimal approximations by piecewise smooth
functions and associated variational problems. Commun. Pur. Appl. Math.
42(5), 577-685 (1989)

4. _T.F. Chan, L. A. Vese, Active contours without edges. IEEE Trans. Image
Process. 10(2), 266-277 (2001)

5. H. Zhao, T. Chan, B. Merriman, S. Osher, A variational level set approach to
multiphase motion. J. Comput. Phys. 127(1), 179-195 (1996)

6. C.Samson, L. Blanc-Féraud, G. Aubert, J. Zerubia, A level set model for
image classification. Int. J. Comput. Vis. 40(3), 187-197 (2000)

7. R.B. Potts, in Mathematical Proceedings of the Cambridge Philosophical
Society, vol. 48. Some generalized order-disorder transformations
(Cambridge University Press, 1952), pp. 106-109. https://www.cambridge.
org/core/journals/mathematical-proceedings-of-the-cambridge-
philosophical-society/article/some-generalized-orderdisorder-
transformations/5FD50240095F40BD123171E5F76CDBEO

8.  Z.Pan,H.Li, W. Wei, Z. Guo, C. Zhang, A variational level set method of
multiphase segmentation for 3D images. Chin. J. Comput. 32(12),
2464-2474 (2009)

9, L.A. Vese, T. F. Chan, A multiphase level set framework for image
segmentation using the Mumford and Shah model. Int. J. Comput. Vis.
50(3), 271-293 (2002)

10. G. Chung, L. A. Vese, in International Workshop on Energy Minimization
Methods in Computer Vision and Pattern Recognition. Energy minimization
based segmentation and denoising using a multilayer level set approach
(Springer, 2005), pp. 439-455. https://link.springer.com/chapter/10.1007
%2F11585978_2

11. X. Bresson, S. Esedoglu, P. Vandergheynst, J.-P. Thiran, S. Osher, Fast global
minimization of the active contour/snake model. J. Math. Imaging Vision.
28(2), 151-167 (2007)

12. F.Li,M.K.Ng, T. Y. Zeng, C. Shen, A multiphase image segmentation method
based on fuzzy region competition. SIAM J. Imaging Sci. 3(3), 277-299 (2010)

13. J. Lie, M. Lysaker, X.-C. Tai, A binary level set model and some applications
to Mumford-Shah image segmentation. IEEE Trans. Image Process. 15(5),
1171-1181 (2006)

14. J. Lie, M.Lysaker, X.-C. Tai, A variant of the level set method and applications
to image segmentation. Math. Comput. 75(255), 1155-1174 (2006)

15. T. Goldstein, S. Osher, The split Bregman method for L1-regularized
problems. SIAM J. Imaging Sci. 2(2), 323-343 (2009)

16. J. Duan, Z. Pan, X. Yin, W. Wei, G. Wang, Some fast projection methods
based on Chan-Vese model for image segmentation. EURASIP J. Image
Video Process, 2014(1), 7 (2014)

17. F.Li,C. Shen, C. Li, Multiphase soft segmentation with total variation and
H1 regularization. J. Math. Imaging Vision. 37(2), 98-111 (2010)

18. T. Goldstein, B. O'Donoghue, S. Setzer, R. Baraniuk, Fast alternating
direction optimization methods. SIAM J. Imaging Sci. 7(3), 1588-1623 (2014)

19. M. Myllykoski, R. Glowinski, T. Karkkainen, T. Rossi, Anew augmented
Lagrangian approach for L1-mean curvature image denoising. SIAM J.
Imaging Sci. 8(1), 95-125 (2015)

20. L. Tan, Z. Pan, W. Liu, J. Duan, W. Wei, G. Wang, Image segmentation with
depth information via simplified variational level set formulation. J. Math.
Imaging Vision. 60(1), 1-17 (2018)

 
Wang et al. EURASIP Journal on Image and Video Processing (2020) 2020:3 Page 17 of 17

Publisher’s Note
Springer Nature remains neutral with regard to jurisdictional claims in
published maps and institutional affiliations.

 

Submit your manuscript to a SpringerOpen”®
journal and benefit from:

> Convenient online submission

> Rigorous peer review

> Open access: articles freely available online
> High visibility within the field

> Retaining the copyright to your article

 

Submit your next manuscript at > springeropen.com

 

 

 
