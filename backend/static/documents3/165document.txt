NP} | Computational Materials

ARTICLE OPEN

www.nature.com/npjcompumats

® Check for updates

Causal analysis of competing atomistic mechanisms in
ferroelectric materials from high-resolution scanning
transmission electron microscopy data

Maxim Ziatdinov @®', Christopher T. Nelson @', Xiaohang Zhang (@", Rama K. Vasudevan’, Eugene Eliseev @*, Anna N. Morozovska (@®,

Ichiro Takeuchi? and Sergei V. Kalinin@®'™

Machine learning has emerged as a powerful tool for the analysis of mesoscopic and atomically resolved images and spectroscopy
in electron and scanning probe microscopy, with the applications ranging from feature extraction to information compression and
elucidation of relevant order parameters to inversion of imaging data to reconstruct structural models. However, the fundamental
limitation of machine learning methods is their correlative nature, leading to extreme susceptibility to confounding factors. Here,
we implement the workflow for causal analysis of structural scanning transmission electron microscopy (STEM) data and explore
the interplay between physical and chemical effects in a ferroelectric perovskite across the ferroelectric—antiferroelectric phase

transitions. The combinatorial library of the Sm-doped BiFeO3 is grown to cover the composition range from pure ferroelectric BFO
to orthorhombic 20% Sm-doped BFO. Atomically resolved STEM images are acquired for selected compositions and are used to
create a set of local compositional, structural, and polarization field descriptors. The information-geometric causal inference (IGCI)
and additive noise model (ANM) analysis are used to establish the pairwise causal directions between the descriptors, ordering the
data set in the causal direction. The causal chain for IGCIl and ANM across the composition is compared and suggests the presence
of common causal mechanisms across the composition series. Ultimately, we believe that the causal analysis of the multimodal data
will allow exploring the causal links between multiple competing mechanisms that control the emergence of unique functionalities

of morphotropic materials and ferroelectric relaxors.

npj Computational Materials (2020)6:127 ; https://doi.org/10.1038/s41524-020-00396-2

INTRODUCTION

Functionality of material systems such as morphotropic phase
boundary systems'™, ferroelectric relaxors’®, spin and cluster
glasses” '*, charge ordered manganites'*"'’, are determined by
the complex interplay between structural, orbital, chemical, spin,
and other degrees of freedom'®*'”. Traditionally, these materials
system has been explored via the combination of macroscopic
physical property measurements and scattering techniques, with
the theoretical counterpart being provided via combination of
analytical and numerical methods. Given that the physics of these
materials is ultimately linked to the emergence of frustrated
degenerate ground states driven by competing interactions,
analyses based on the macroscopically averaged descriptors such
as concentrations, order parameter fields, etc. provide only limited
insight into the generative and especially causal physics of these
materials systems.

Progress in the high-resolution imaging techniques have
allowed visualization of these materials systems to the atomic
level. Techniques such as scanning tunneling microscopy have
provided insight into electronic structure of surfaces and super-
conductive and magnetic order parameters*’*'. Scanning trans-
mission electron microscopy (STEM) enabled studies of chemical
composition down to the single atom level?*~** and, via
quantitative mapping of structural distortions, enabled visualiza-
tion of order parameter fields such as polarization? ~®, tilts??->!

y

[29.3235 [39-37

and mechanica and chemica strains. However, this
emergence of data brings the challenge of analysis of systems
with multiple spatially distributed degrees of freedom, including
determination of both the functional laws connecting the
functionalities and structure and the causal links that define the
cause and effect relationship in the nonstationary and non-
ergodic systems.

Recently, machine learning (ML) has emerged as a powerful tool
for the analysis of mesoscopic and atomically resolved images and
spectroscopy in electron and scanning probe microscopy** *'. The
applications ranging from feature extraction** to information
compression and elucidation of relevant order parameters** to
inversion of imaging data to reconstruct structural models have
been demonstrated. However, the fundamental limitation of the
vast majority of machine learning methods is their correlative
nature, leading to extreme susceptibility to confounding factors
and observational biases***°. While in classical statistical methods
methodologies to address confounder- or selective bias induced
phenomena such as Simpson paradox are established*®, the
complex and often nontransparent nature of modern machine
learning tools such as deep neural networks renders them
extremely prone to misinterpretation. We pose that correlative
machine learning provides a reliable and powerful tool in cases
when the causal links are well established, as is atom finding in
SPM and STEM and analysis of 4D STEM data when this condition
is satisfied. Notably, ML applications in theory generally fall under

 

'The Center for Nanophase Materials Sciences, Oak Ridge National Laboratory, Oak Ridge, TN 37831, USA. ?Computational Sciences and Engineering Division, Oak Ridge National
Laboratory, Oak Ridge, TN 37831, USA. *Department of Materials Science and Engineering, University of Maryland, College Park, MD 20742, USA. “Institute for Problems of
Materials Science, National Academy of Sciences of Ukraine, Krjijanovskogo 3, Kyiv 03142, Ukraine. °Institute of Physics, National Academy of Sciences of Ukraine, 46, pr. Nauky,

Kyiv 03028, Ukraine. “email: sergei2@ornl.gov

Published in partnership with the Shanghai Institute of Ceramics of the Chinese Academy of Sciences

nN 1 nature partner
PD journals
np}

M. Ziatdinov et al.

 

 

10° |
\ A
°° A
it nwlu hal AN A\ dul ak bw
‘ yy
10 i Lh
hak dl my {| won hb
St an 13 on mn
= dn? a i
a ff wi}
© 10° r |
> 1s hl a f\ SN voi te
2 40° ft Wl
= tly mi Nf Natubn Maki
40’ / w Vi
i
aol 9. | M
i ‘anf \ i
10° j \y
ulus Wil tabat nN \ Whwlied sis
10° f vi
Lido ke if Kon hw WAL shi a
f Y
10' |
alot MUM hun
10°

20

Fig. 1

 

Experimental characterization of Sm,Bi,_,FeO3 films. a X-ray diffraction results obtained from a Sm,Bi,_,FeO3(120 nm) sample

fabricated on a (001) SrTiO3 substrate, where 0< x <0.2. The results are equally spaced for clarity with the bottom curve corresponding to
BiFeO3 and the top curve corresponding to Smo2Bio.gFeO3. b-d representative piezoresponse force microscopy (PFM) images for a highly
doped region (x ~ 0.2), an intermediately doped region (x = 0.08), and an undoped region (x ~ 0), respectively.

this category since the causal links are postulated. Alternatively,
ML methods work well when the confounding factors are
effectively frozen via the narrowness of experimental conditions
or experimental system. However, both these conditions are
violated for experimental studies, when causal relationships are
known only partially (and are in fact often the target of study) and
confounding and observational bias factors (composition uncer-
tainty, microscope tuning, contaminations) are abundant.

One approach to explore the generative physical models from
the microscopic data is based on the fit to the relevant
mesoscopic or atomistic models, i.e., discovering the generative
physical models. On the mesoscopic level, direct match between
the solution between Ginzburg-Landau equations and order
parameter fields determined from the atomically resolved data
can be used to determine the interface terms via corresponding
boundary conditions*’, as well as the nature of coupling and
gradient terms*”. Statistical distance minimization can be used to
directly match the discrete data to lattice model, eg., to
reconstruct the interaction parameters*®~'. However, even when
the functional laws describing the system are known, this level of
the description is not sufficient to establish the causal mechan-
isms active in the system. As a simple example, the knowledge of
the ideal gas law does not establish whether pressure is cause or
an effect of the volume change unless the character of the process
is established.

In many cases, it can be argued that the causal effects can be
estimated based on the energy scales of corresponding phenom-
ena, e.g., Magnetic properties driven by relatively weak energy
scales are unlikely to affect atomic structure. However, this is not
the case when the energy scales are comparable, or when

npj Computational Materials (2020) 127

depolarization and global effects become significant. For example,
while the magnetization energy density per volume can be small,
concentration of magnetically- induced mechanical stresses can
lead to stress corrosion at the domain walls. Specifically, for
ferroelectric materials it is generally assumed that cationic order is
frozen at the state of material formation, and then polarization
field evolves to accommodate average polarization instability and
local pinning. However, it is known that ions can redistribute to
compensate polarization, with examples including segregation at
the domain walls, memory effects, etc*°*. Hence, for none-
quilibrium and non-ergodic materials the question of cause and
effect become paramount. For example, does polarization align to
the cationic disorder or does polarization instability at the
morphotropic phase boundaries drive the cationic disorder?

More generally, being able to answer causal questions is
required both for meaningful applications of machine learning
techniques and inferring the materials physics, since causal
knowledge allows avoiding correlative, but incorrect conclusions,
explore counterfactuals and interventions””, i.e., realistic strategies
for materials development. Correspondingly, we argue that
analyzing causal relationships from the observations of atomically
resolved degrees of freedom is key for understanding the physics
of non-ergodic systems.

Here, we implement the workflow for causal analysis of STEM data
and explore the interplay between physical and chemical effects in a
ferroelectric perovskite across the ferroelectric—antiferroelectric phase
transition. The combinatorial library of the Sm-doped BiFeO3 (BFO) is
grown to cover the composition range from pure ferroelectric BFO to
orthorhombic 20% Sm-doped BFO°*°’. Atomically resolved STEM
images are acquired for selected compositions and are used to

Published in partnership with the Shanghai Institute of Ceramics of the Chinese Academy of Sciences
0.67A

 

7% Sm

 

M. Ziatdinov et al.

np)

 

20% Sm

Pyy

Fig.2 Atomic resolution HAADF STEM imaging of Sm,Bi,_,FeO3. Datasets for 0% Sm (a) 7% Sm (b) and 20% Sm (c) are shown. For each, the
top left panel is the HAADF image, top right is the corresponding map of the polar displacement vector P, bottom left and right are the x- and
y- axis components of P. Color scales are identical across the compositions according the legends in (a). Scalebars are 10 nm. P vectors and

components have scale limits of +0.67 A.

create a set of local compositional, structural, and polarization field
descriptors. The information-geometric causal inference (IGCI) and
the additive noise model (ANM) are used to establish the pairwise
causal directions between the descriptors, ordering the data set in
the causal direction. The causal chain for IGCIl and ANM across the
composition is compared, suggesting the similarity of causal
mechanisms across the Sm-BFO compositions.

RESULTS AND DISCUSSION
Combinatorial library

The combinatorial library of Sm,Bi,_,FeO3 (0<x<0.2) was
fabricated on a SrTiO3 (001) substrate. The chemical composi-
tions at different positions across the substrate were character-
ized by wavelength dispersive spectroscopy measurements.
X-ray diffraction results (Fig. 1) indicate that the (002) peak of
the Sm,Bi,_,FeO3 layer gradually moves towards a higher angle
as the Sm doping concentration (x) increases. As shown in
Fig. 1b-d, the representative piezoresponse force microscopy
images indicate that the domain structure in the combinatorial
library changes from strip domains in the pure BiFeO3 side to
mosaic-like domains at an intermediate doping level (x = 0.08),
and eventually no domain structure can be identified for the
highest doping level (x = 0.2).

The TEM samples were prepared for three sites along the
gradient composition sample with nominal compositions of 0%,
7%, and 20% Sm doping (see “Methods”). STEM data was collected
from the [100] pseudocubic zone axis using High-Angle Annular
Dark Field (HAADF) detector imaging as shown in Fig. 2, thereby
providing the projected atomic structure as well as compositional
information by the atomic column intensity (which scales by
~Z'”). As the concentration of Sm increases through the sample
series there is an observed phase transition from the prototypical
rhombohedral ferroelectric phase’? of BiFeO3 (Fig. 2a) to an
antiferrodistortive orthorhombic phase’” at 20% Sm (Fig. 2c). The
transition is readily observable in maps of the polar atomic
displacement between the A-site and B-site cation sublattices, P,
which is shown for the three compositions in Fig. 2.

For the pure BiFeO3 phase P is a proxy for the electrical dipole
moment and the distribution in Fig. 2a illustrates the polydomain
structure characteristic of an r-phase ferroelectric including a 109°
(vertical) and 180° (inclined) domain walls. The distribution of P in
the 20% Sm composition depicts the large oscillation of Py (see
inset) corresponding to the antiferrodistortive orthorhombic
structure (Fig. 2c). The intermediate 7% Sm composition exhibits

Published in partnership with the Shanghai Institute of Ceramics of the Chinese Academy of Sciences

Table 1. Unit cell descriptors.

Sym. U.C. parameter descriptions Calculation
(Azzy —A\ xy ) T (As.xy —Aaxy )

(Aazy —A\ xy ) T (As.xy —A2,xy )

 

In-plane lattice vector

 

Out-of-plane lattice vector

2
~~ (Azzy —A\ xy ) + (As.xy —Aaxy )
2

ab delta vector

Internal angle atan(ab)

Tetragonality 1b]

Volume of convex hull
Ai xy, A2,xy; A3 xy and Aa.xy

Internal volume

Mean atomic HAADF
intensity

A, +A2 +A3+A4 + By
5

 

(Ai +A2)—(A3 + Aa)

A-site Asymmetry Aj, Ap vs. 5

A3, Ag
Asymmetry Aj, A3 vs. Az, Aq

 

(A; +A3)—(A2 + Aa)
2

(Ai +Aa)—(A2 +43)
2

A, +A A3 +A
(A 25 3 4) _ B,

 

 

Asymmetry Aj, Aq vs. Az, A3

 

Asymmetry A-site vs. B-site

 

A, xy + A2xy + A3xy + Aaxy
4

Polar displacement vector — Buy

a mixed structure, with the small domains identifiable to both
structures appearing in the near interface region (Fig. 2b).

To describe the local materials behaviors, we parametrize the
data choosing the perovskite unit cell as the basis. We introduce a
set of descriptors for the local material behavior based on the
properties and distribution of the five cation atomic columns in
each unit cell. These are outlined in Table 1, along with the
corresponding calculations. Unit-cell parameters are defined from
local neighborhood atomic columns of HAADF STEM data
corresponding to a five cation perovskite-type cell: corner A-
sites A,, Az, A3, Ag, and central B-site B, (labels in Fig. 3a).
Parameters include structural descriptors from positional data
regarding unit cell size and shape (a, b, a/b, 8, Vol), compositional
information from atomic HAADF intensity and distribution (1;, /2, /3,
I4, Is), and electrical polarization information from  non-
centrosymmetric displacement of the A- and B-site sublattices
(P). Examples for several of these descriptors for a HAADF STEM
unit cell are illustrated in Fig. 3a. We here define a and b as the
two lattice vectors of the unit cell connecting A-site corner
positions, their internal angle 8, magnitude ratio a/b, and total cell

npj Computational Materials (2020) 127
np}

M. Ziatdinov et al.

 

>

    

Unit Cell

  

osition

Com

Structure

Polarization

   

D 20% Sm_

    

Fig. 3 Unit cell descriptor maps. a Descriptors are derived for each B-site centered 5-atom perovskite unit cell in the HAADF STEM images.
Selected descriptors are shown for the 0% b 7% c and 20% d compositions corresponding to local compositional (/;, /;), structural (a, b, Vol, 8),
and polarization (P) information. Descriptors are mapped onto unit cell grid coordinates, each datapoint corresponds to 1 unit cell (~4 A).
Spatial dimensions are not depicted at matched scales across the compositions (labeled scale bars below /, plots are 40 unit cells) but data

scales are matched (see Supplementary Figs 1-3).

volume Vol. |, corresponds to the mean atomic column intensity
and scales with the sample mass-thickness. />-/, correspond to
internal asymmetries. Notably, /, corresponds to the intensity ratio
between cation sublattices, thus readily distinguishes the Sm,Bi,
_,FeQO3 film and SrTiO3 substrate. Our choice of basis also includes
several internal gradient terms including A-site intensity asymme-
tries in /,-l4 and the gradient of the a and b vector between
opposed edges of the unit cell (denoted as abA). Moreover,
additional gradient terms can be derived using a larger basis or
calculated across multiple neighbor cells.

Real-space distributions of selected local physical and chemical
descriptors of materials structure and functionality are shown in
Fig. 3 for the three compositions. The plots are depicted in unit-
cell space, each data point corresponding to the local unit cell
descriptor in an a, b addressed grid. The selected descriptor maps
are categorized as compositional parameters (top) associated with
the unit cell intensity represent a convolution of the (slowly
changing) film thickness and local composition; structural para-
meters (mid) including lattice parameters, unit cell volume, and
internal angle; and polarization components (bottom) describing
the ferroelectric functionality. Using the unit-cell basis the
alternating P, component from an atom-level mapping (Fig. 1c)
is not observed here in Fig. 2d, but is instead captured by
structural descriptors a and @. Not depicted are internal descriptor
or cross-unit cell gradient terms, distribution maps for internal
gradient descriptors can be found in Supplementary Information
Figs. 1-3.

General theory of ferroelectrics

To provide the physical context for causal analysis of the
observables in the STEM experiment, we note that in general
thermodynamics of ferroelectric materials can be described via
Landau-Ginzburg—Devonshire theory, where the energy of

npj Computational Materials (2020) 127

material can be represented as free energy functional
G= / d?x(AGarp + AGee + AGare + AGgoc + AGst + AGe). — (1)

describe the antiferrodistortive (AFD), ferroelectric (FE), and
antiferroelectric (AFE) long-range orders. AFD order is described
by an axial vector, @,, that is perpendicular to the rotation plane of
the oxygen octahedral tilts. FE and AFE long-range orders, which
interact with AFD order, and transform to one another depending
on the Sm content, are described by FE and AFE order parameters,
P; =4(P7+P?) and A; =4(P?—P?), where P? and PP are the
polarization components of two (or more) equivalent sublattices
“a” and “b”. Antiferromagnetic order is not included in Eq. (1), since
its impact on AFD, FE, and AFE orders is negligibly small, as a rule.

The individual AFD, FE, and AFE contributions are generally
representable as the expansions in powers (2-4 for the second
order, or 2-4-6 for the first order phase transitions) of
corresponding order parameters, gradient terms defining the
spatial behavior of the order parameter fields, coupling terms with
the conjugate fields (electric, strain, strain gradient), and
biquadratic coupling terms describing the interactions between
order parameters. The important aspect of Ginzburg-Landau
theory is that the free energy of material is generally nonlocal,
since the order parameter and depolarizations fields can be found
only from the solution of the boundary value problem. Therefore,
in the most general description, the individual observables are
linked through the integral transforms, representing extremely
complex forms of parameter coupling.

Here, we note that under some general conditions including
macroscopic uniformity, this relationship can be simplified to yield
the local nonlinear relationship between state variables, with the
nonlocal effects being represented via the unknown mean local
fields. These nonlinear and nonlocal partial differential equations
can be linearized around the specific ground state to give the

Published in partnership with the Shanghai Institute of Ceramics of the Chinese Academy of Sciences
 

 

A Px Py Vol Is
Px
Py f°
Vol | Sd ae
IN
| \
Is | " |
©

 

 

M. Ziatdinov et al.

np)

 

B Px Py Vol Is

Fig.4 Correlation analysis. The correlation analysis of the STEM polarization, structural, and chemical descriptors for the a rhombohedral and

b mixed phase (partial list).

linear relationship between the observed and non-observable
parameters. Secondly, we note that in the presence of the strong
composition fluctuations and nanodomains, the local fields will be
the superposition of slowly varying (on the atomic level)
depolarization fields and disorder related fields. Here, we aim to
explore the causal relationships from the observed descriptor
fields.

Statistical analysis

The initial insight into the statistical properties of this material
system can be deduced from the analysis of joint pairwise
distributions as shown in Fig. 4. Figure 4a shows the pairwise
distributions for the set of parameters P,, P, V, and /; for the
rhombohedral ferroelectric phase. Note that the full data set and
analyses are contained in the accompanying Jupyter notebook.
Here, the diagonal elements contain the distribution functions for
individual parameters. Notably both P, and Py distributions have
four peaks, suggesting the more complex polarization distribution
that can be expected in the system of ferroelectric domains
(positive and negative) and substrate (0). In particular, P,
component shows pronounced peak splitting for the nonzero
polarization orientation. The distribution functions for molar
volume Vol and chemical variability /; show two clear peaks
corresponding to ferroelectric materials and substrate respec-
tively. Note that the width of the /, distribution is much broader,
reflecting the higher variability or noise level in data.

The pairwise distributions between the descriptors are shown
on the upper and lower triangular matrices. Here, the full data in
the upper diagonal provides the general insight into the outliers.
The kernel density estimates in the lower diagonal provide the
insight into the statistically significant parts of the distributions.
The pairwise distribution between P, and Py has three peaks
clearly corresponding to the two dominant domain orientations
and the substrate. Similar structures are visible for P,-Vol and P,-
Vol distributions, clearly showing the similar molar volumes for the
ferroelectric phase and dissimilar molar volume for the substrate.
Finally, the distribution function between /; and P,, Py, Vol show
complex multimodal distributions. It should be noted here that for
ferroelectric phase the observations within the ferroelectric
domain will impose the observational bias on the data; hence

Published in partnership with the Shanghai Institute of Ceramics of the Chinese Academy of Sciences

ideally the imaged volume should contain multiple domain or,
alternatively, exceed the correlation length for observed variables.

Similar analysis for the 7% Sm mixed phase is shown in Fig. 4b.
In this case, the distribution functions peaks are clearly non-
Gaussian, reflecting complex nature of the mixed phases. Similarly,
pair distribution functions clearly show the asymmetry in the peak
shapes, etc. Similar behavior is observed for the 20%
orthorhombic phase.

Even cursory examination of the distributions in Fig. 4 (or full
versions available from the notebook) illustrates that these are
generally not marginalizable, i.e., joint distributions between the
parameters cannot be represented as the product of the marginal
distribution functions. This in turn suggests the presence of the
functional or causal link between the parameters. However, while
some of these links can be speculated about (i.e., it can be argued
that chemical fluctuations control order parameter distributions),
multiple counter-examples such as cation redistribution during
the aging of ferroelectric materials, etc. suggest that these
“natural” explanations are not necessarily correct. Hence, we aim
to analyze the causal distributions from the observational data.

Causal analysis

Generally, analysis of causal relationships is one of the most
complex problems in ML. For two observed variables, the number
of possible causal relationships is limited and methodologies to
establish directionality of causal link and presence of possible
confounders are available. For more complex cases, the analysis of
directed acyclic causal graphs has been explored by Pearl
group***°. However, analysis of the cause and effect relationships
in the presence of cycles and feedbacks represents significantly
more complex problem, and numerical schemes to address these
have been reported only recently by Mooij and others®°.

Here we explore two step approach for analysis of the possible
causal relationships between the STEM observables. First, the
causal directions are analyzed for all pairs of variables to yield
pairwise causal relationships and represented as a “causal sieve”
matrix. By construction, the matrix is antisymmetric with 1 and —1
elements. Secondly, the properties of graph which adjacency
matrix is given by the “causal sieve” are explored.

npj Computational Materials (2020) 127
np}

M. Ziatdinov et al.

 

Rhombohedral BiFeO3
Px Py

Vol a/b h Is Px = Py

 

Vol a/b Ih Is Px Py

B Px Py

Vol
a/b

ANM

Ih

Intermediate Phase

Vol a/b hh

 

Orthorhombic Sm-BiFeO3
Vol a/b hh Is Px Py

Vol a/b h Is

 

Is Px Py Vol a/b hh Is

Vol
a/b
Ih

Is

 

Fig.5 Causal sieve matrices. a The information-geometric causal inference (IGCI) and b additive noise model (ANM) analyses for three Sm-

BFO compositions.

To describe causal direction for two variables, we use and
compare the IGCI°' and the ANM®. The IGCI method is based on
the assumption of the independence of the “cause” distribution
and the conditional distribution of the “effect” given the
cause®'’°*°*. It can be shown, using an empirical slope-based
estimator, that X causes Y if

N—

4 —V; 1 4 — YX
Y og Pet — Sag 1% co
11 — Xj

(2)
= Vin — yi

 

 

and vice versa, where the (x;, yj) pairs are ordered ascendingly
according to x in the first term and according to y in the second
term. IGCI was first assumed to be applicable only to noise-free
observations where Y = f(X) and X=f ~'(Y) but was later shown
(empirically) to work on noisy data as well®. The Eq. (2) was used
for all the IGCl-based analysis of the cause-effect pairs in the
current paper.

As a second pairwise causality check, we use the ANM estimator
for finding a causal direction from the observed data. The simple
idea behind the ANM method is that the effect is a function of its
cause plus a noise term independent of the cause®”. In the ANM
one performs the nonlinear regression fitting, first for X on Y and
then for Y on X, and calculates the difference between test scores
for the independence of residuals in both cases. The negative
difference value implies that X causes Y, while the positive value
implies that Y causes X.

For our analysis, we used a Gaussian process (GP) regressor with
the squared exponential kernel. Because the exact inference of the
GP regressor parameters is intractable for the datasets with ~10*
points, we used the inducing points-based sparse GP approxima-
tion®’ with variational free energy (VFE) inference method, as
implemented in Pyro’s probabilistic programming language®®. The
inducing points were selected uniformly from the observation
data points with a step of ~20. In addition to the GP regressor, we
also added an option for choosing a two-layer neural network as a
regressor (see the accompanying Jupyter notebook). The inde-
pendence of residuals test was done by calculating the

npj Computational Materials (2020) 127

Hilbert-Schmidt Independence Criterion®? with the Gaussian
kernel whose width was set to the median distance between
points in input space.

The IGCI typically takes advantage of some specific features of
the dataset, whereas the ANM tend to yield good results as long
as the additive assumption holds’’. Before applying to the
experimental observations, both IGCl and ANM methods were
first tested on the publicly available database of labeled
cause-effect pairs°®> and the resultant accuracy in predictions
(~64% and ~66%, respectively) was comparable to the results
reported for the same database in the machine learning
literature-*. We then calculate a matrix of pairwise dependencies
for the list of descriptors derived from the experimental
descriptions.

The causal sieve matrices for three explored compositions are
shown in Fig. 5 for a selected subset of variables to enable ease of
visualization. The analysis of the full set of structural, chemical, and
polarization parameters is available in the accompanying note-
book. Here, the positive 1 value means that the column value is
identified as the cause, whereas the row variable is the effect, Col
-> Row. Interestingly, the structures of the IGCI causal matrices in
the studied cases are always such that for N matrix one row
contains N positive entries, another row contains N — 1 positive
entries, etc. This implies that the descriptors can be formally
ranked in the order of causal importance. Note that it does not
imply that the system can be represented by linear causal chain.
Rather, here we treat this behavior as observation.

Remarkably, the IGCI results are very similar across three
different compositions. For rhombohedral and orthorhombic
phases, the chemical composition parametrized as /, is identified
as a cause variable affecting all other parameter but not affected
by them. Second in importance is the molar volume Vol. For the
intermediate phase, the Vo/ variable is higher in the “causal
importance” than /,. In all three cases, the (/;, Vol) variables are
followed by polarization components (P,, P,), differential chemical
composition /;, and finally by tetragonality a/b.

Published in partnership with the Shanghai Institute of Ceramics of the Chinese Academy of Sciences
Orthorhombic FIP > RD Ts >[a/>]
B

Rhombohedral Py > (Px, a/b, Ti) > Vol > Is
3 Intermediate hi? a/b>? RDF Vol? RD Is

Orthorhombic (Py, Ii) > Is D (Px, a/b) > Vol

Fig. 6 Causal chain analysis. Causal chains for three Sm-BFO
compositions based on a IGCI and b ANM methods. Note that
position of the descriptor in the chain suggest the likely cause and
effect relationship, but still can be sensitive to the presence of
confounders or observational bias.

The more direct way to visualize and compare the causal
relationship is by arranging the observables as the causal chains as
shown in Fig. 6 for all three compositions. As seen in Fig. 6, the
dependence chain has significant overlaps between different
compositions and analysis via IGCl and ANM. For IGCI, the
chemical variables such as local composition and molar volume
are clearly higher in the causal chain. In addition, the polarization
components are arranged as (Py, P,) > /5 for all three composi-
tions. This observation suggests that /, (differential contrast
between A and B site cation intensity) is related to the physical
distortion rather than chemical composition. Finally, tetragonality
is the weakest variable for all the three phases and is ranked
below the chemical and polarization components. While we are
hesitant to derive definitive conclusions from this analysis in the
lack of a large body of comparative studies, we note that this
behavior generally comports to that expected from physics of
material (except for /; variable)

For the ANM model, the analysis is less straightforward. Here,
for the intermediate and orthorhombic phases, the chemical
composition is identified as a more casually significant variable.
This is in the agreement with the IGCI results. On the other hand,
for the ferroelectric phase, one of the polarization components
has the higher rank affecting molar volume tetragonality, etc. We
note that this behavior is likely to be due to the nature of the ANM
criterion, relying on the regression between the variable pairs.
Given the fundamental difference between the ferroelectric and
non-ferroelectric phase (presence of domains), this affects
regression results and necessitates transition to Bayesian
estimators.

To summarize, we have implemented pairwise causal analysis of
the atomic scale structural, chemical, and polarization phenomena
in the Sm-doped BiFeO3 using scanning transmission electron
microscopy data as descriptors. The causal sieve approach is
implemented using the IGCI and ANM to establish the pairwise
causal relationships between observables. The results can be
represented as an ordered array of causal importance. For Sm-BFO
compositions series studied here it is generally found via IGCI that
the chemical effects including local composition and molar
volume are higher on the causal chain and are not affected by
polarization. The polarization effects are secondary, and differ-
ential chemical contrast and tetragonality are the weakest. The
ANM analysis results are more difficult to interpret; here we argue
that functional relationship between the variables are fundamen-
tally different in dissimilar phases and therefore GP interpolation
approach produces fundamentally different responses. This
behavior will be explored in the future.

Overall, we note that optimization and discovery of new
materials as well as understanding of fundamental physical
mechanisms can be significantly accelerated if the causality of
corresponding mechanisms can be understood, allowing

Published in partnership with the Shanghai Institute of Ceramics of the Chinese Academy of Sciences

M. Ziatdinov et al.

 

exploration of counterfactuals and interventions and avoiding
correlative but incorrect conclusions. The fundamental physics
offers a large set of knowledge on functional relationship between
the materials parameters; however, real material systems often are
characterized by only partially known physics or presence of non-
equilibrated non-ergodic processes. We expect that in these cases
causal analysis can provide the knowledge of cause and effect
relationships necessary for materials optimization, design, and
especially discovery.

METHODS
Materials

The combinatorial library of Sm-doped BiFeO3 and the SrRuO3 layer were
both fabricated through pulsed laser deposition. Specifically, after reaching
the base pressure (~2.0x 10 ®Torr) of the deposition chamber, the SrTiO;
(001) substrate was heated up to 600 °C, and an oxygen flow was introduced
to the chamber to maintain a desired deposition pressure (~100 mTorr). A
laser energy density of ~0.8J/cm? and an ablation frequency of 20 Hz were
adopted for the deposition of the films. During the deposition of the
Bi, _,Sm,FeO3 layer, a BIFeO3 target and a SmFeO3 target were alternatively
ablated, and a shadow mask was controlled to move accordingly to obtain a
uniform composition gradient across the substrate.

Samples characterization

TEM samples were prepared by FIB liftout and local low energy Ar ion
milling, down to 0.5 keV, in a Fischione NanoMill. STEM was performed at
200kV on a NION UltraSTEM. The three compositions were imaged
consecutively to help maintain consistent imaging/microscope conditions.
A correction algorithm was applied to correct for slow-scan axis scanning
aberrations by reconstruction from two orthogonal source images
according to’'. All three datasets were defined with the [100] pseudocubic
a-vectors along the thin film in-plane axis and the b-vector along the film
growth axis. The atomic column positions (Aj xy, Az xy, A3,xy, Aaxyr Bi xy inputs
for polar displacement maps in Fig. 1 and descriptors a, b, aA, bA, 6, Vol,
and P) were determined by simultaneous 2D Guassian fits of local 5-atom
perovskite unit cells. Atomic column HAADF intensity (Aj, Az, A3, Ag, and B,
inputs for /,-/, descriptors) was measured as the local Gaussian weighted
9-pixel intensity centered at the atom fit position. The source datasets
were deliberately misaligned several degrees from the scan axes to aid the
identification of residual scanning artifacts. Display images (Fig. 1) and
vector coordinates (a, b, aA, bA, and P) were subsequently rotated to align
the mean a-vector to the horizontal axis. Calculation for the descriptors
was performed according to Table 1. Unit cell grid maps for selected
descriptors are shown in Fig. 2 and in totality in the Supplementary Figs. 1-3)
along with corresponding plotting information.

DATA AVAILABILITY

Data is available via the accompanying notebook (see code availability statement).

CODE AVAILABILITY

The code and data can be accessed via an executable Google Colab notebook at
https://colab.research.google.com/github/ziatdinovmax/Notebooks-for-papers/blob/
master/ferroics-causal-analysis.ipynb.

Received: 30 March 2020; Accepted: 24 July 2020;
Published online: 21 August 2020

REFERENCES

1. Grinberg, I., Suchomel, M. R., Davies, P. K. & Rappe, A. M. Predicting morphotropic
phase boundary locations and transition temperatures in Pb- and Bi-based per-
ovskite solid solutions from crystal chemical data and first-principles calculations.
J. Appl. Phys. 98, 094111 (2005).

2. Damjanovic, D. Ferroelectric, dielectric and piezoelectric properties of ferro-
electric thin films and ceramics. Rep. Prog. Phys. 61, 1267-1324 (1998).

3. Woodward, D. |, Knudsen, J. & Reaney, |. M. Review of crystal and domain
structures in the PbZr,Ti;..03 solid solution. Phys. Rev. B 72, 104110 (2005).

npj Computational Materials (2020) 127
Np)

M. Ziatdinov et al.

 

10.
11.
12.
13.
14.
15.
16.
17.
18.
19.
20.
21.
22.

23.

24.
25.
26.
27.
28.

29.

30.

31.

32.

33.

34.

35.

36.

npj Computational Materials (2020) 127

. Zeches, R. J. et al. A strain-driven morphotropic phase boundary in BiFeO(3).

Science 326, 977-980 (2009).

. Glinchuk, M. D. & Stephanovich, V. A. Dynamic properties of relaxor ferroelectrics.

J. Appl. Phys. 85, 1722-1726 (1999).

. Tagantsev, A. K. & Glazounov, A. E. Does freezing in PbMg1/3Nb2/303 relaxor

manifest itself in nonlinear dielectric susceptibility? Appl Phys. Lett. 74,
1910-1912 (1999).

. Glinchuk, M. D. & Stephanovich, V. A. Theory of the nonlinear susceptibility of

relaxor ferroelectrics. J. Phys. -Condes. Matter 10, 11081-11094 (1998).

. Glazounov, A. E. & Tagantsev, A. K. Direct evidence for Vogel-Fulcher freezing in

relaxor ferroelectrics. Appl. Phys. Lett. 73, 856-858 (1998).

. Katzgraber, H. G., Gary, F. B. & Zimanyi, G. T. Fingerprinting hysteresis. Physica B

343, 10-14 (2004).

Vugmeister, B. E. & Rabitz, H. Coexistence of the critical slowing down and glassy
freezing in relaxor ferroelectrics. Phys. Rev. B 61, 14448-14453 (2000).

Binder, K. & Reger, J. D. Theory of orientational glasses models, concepts, simu-
lations. Adv. Phys. 41, 547-627 (1992).

Binder, K. & Young, A. P. Spin-glasses—experimental facts, theoretical concepts,
and open questions. Rev. Mod. Phys. 58, 801-976 (1986).

Tokura, Y. & Nagaosa, N. Orbital physics in transition-metal oxides. Science 288,
462-468 (2000).

Imada, M., Fujimori, A. & Tokura, Y. Metal-insulator transitions. Rev. Mod. Phys. 70,
1039-1263 (1998).

Fiebig, M., Miyano, K., Tomioka, Y. & Tokura, Y. Visualization of the local insulator-
metal transition in PrO.7Ca0.3MnO3. Science 280, 1925-1928 (1998).

Urushibara, A. et al. Insulator-metal transition and giant magnetoresistance in
LA,..SR,MNO3. Phys. Rev. B 51, 14103-14109 (1995).

Tokura, Y. Critical features of colossal magnetoresistive manganites. Rep. Prog.
Phys. 69, 797-851 (2006).

Dagotto, E. Complexity in strongly correlated electronic systems. Science 309,
257-262 (2005).

Dagotto, E., Hotta, T. & Moreo, A. Colossal magnetoresistant materials: the key
role of phase separation. Phys. Rep. 344, 1-153 (2001).

Wang, Y. et al. Observing atomic collapse resonances in artificial nuclei on gra-
phene. Science 340, 734 (2013).

Allan, M. P. et al. Identifying the ‘fingerprint’ of antiferromagnetic spin fluctua-
tions in iron pnictide superconductors. Nat. Phys. 11, 177-182 (2015).

Muller, D. A. et al. Atomic-scale chemical imaging of composition and bonding by
aberration-corrected microscopy. Science 319, 1073 (2008).

Browning, N. D., Chisholm, M. F. & Pennycook, S. J. Atomic-resolution chemical
analysis using a scanning transmission electron microscope. Nature 366, 143-146
(1993).

Batson, P. E. Simultaneous STEM imaging and electron energy-loss spectroscopy
with atomic-column sensitivity. Nature 366, 727-728 (1993).

Catalan, G. et al. Flexoelectric rotation of polarization in ferroelectric thin films.
Nat. Mater. 10, 963-967 (2011).

Nelson, C. T. et al. Spontaneous vortex nanodomain arrays at ferroelectric het-
erointerfaces. Nano Lett. 11, 828-834 (2011).

Jia, C.-L. et al. Unit-cell scale mapping of ferroelectricity and tetragonality in
epitaxial ultrathin ferroelectric films. Nat. Mater. 6, 64-69 (2007).

Sun, Y. et al. Subunit cell-level measurement of polarization in an individual polar
vortex. Sci. Adv. 5, eaav4355 (2019).

Borisevich, A. et al. Mapping octahedral tilts and polarization across a domain
wall in BiFeO3 from Z-contrast scanning transmission electron microscopy image
atomic column shape analysis. ACS Nano 4, 6071-6079 (2010).

Kan, D. et al. Tuning magnetic anisotropy by interfacially engineering the oxygen
coordination environment in a transition metal oxide. Nat. Mater. 15, 432-437
(2016).

Borisevich, A. Y. et al. Suppression of octahedral tilts and associated changes in
electronic properties at epitaxial oxide heterostructure interfaces. Phys. Rev. Lett.
105, 087204 (2010).

Sun, C. et al. Atomic and electronic structure of Lomer dislocations at CdTe
bicrystal interface. Sci. Rep. 6, 27009 (2016).

Tang, Y. L., Zhu, Y. L. & Ma, X. L. On the benefit of aberration-corrected HAADF-
STEM for strain determination and its application to tailoring ferroelectric domain
patterns. Ultramicroscopy 160, 57-63 (2016).

Fitting, L., Thiel, S., Schmehl, A., Mannhart, J. & Muller, D. A. Subtleties in ADF
imaging and spatially resolved EELS: a case study of low-angle twist boundaries
in SrTiO3. Ultramicroscopy 106, 1053-1061 (2006).

Arredondo, M. et al. Direct evidence for cation non-stoichiometry and cottrell
atmospheres around dislocation cores in functional oxide interfaces. Adv. Mater.
22, 2430-2434 (2010).

Grieb, T. et al. Determination of the chemical composition of GaNAs using STEM
HAADF imaging and STEM strain state analysis. Ultramicroscopy 117, 15-23
(2012).

37.

38.

39.

40.

41.

42.

43.

AA,

45.

46.

47.

48.

49.

50.

51.

52.

53.

54.

55.

56.

57.

58.

59.

60.

61.

62.

63.

64.

65.

66.

67.

68.

Muller, D. A., Nakagawa, N., Ohtomo, A., Grazul, J. L. & Hwang, H. Y. Atomic-scale
imaging of nanoengineered oxygen vacancy profiles in SrTiO3. Nature 430,
657-661 (2004).

Rashidi, M. & Wolkow, R. A. Autonomous scanning probe microscopy in situ tip
conditioning through machine learning. ACS Nano 12, 5185-5189 (2018).

Li, Q. et al. Quantification of flexoelectricity in PbTiO3/SrTiO3 superlattice polar
vortices using machine learning and phase-field modeling. Nat. Commun. 8, 1468
(2017).

Ziatdinov, M., Maksov, A. & Kalinin, S. V. Learning surface molecular structures via
machine vision. Npj Comput. Mater. 3, 31 (2017).

Ziatdinov, M. et al. Building and exploring libraries of atomic defects in graphene:
scanning transmission electron and scanning tunneling microscopy study. Sci.
Adv. 5, eaaw8989 (2019).

Ziatdinov, M. et al. Atomic-scale observation of structural and electronic orders in
the layered compound alpha-RuCl3. Nat. Commun. 7, 13774 (2016).

Ziatdinov, M., Nelson, C., Vasudevan, R. K., Chen, D. Y. & Kalinin, S. V. Building
ferroelectric from the bottom up: the machine learning analysis of the atomic-
scale ferroelectric distortions. Appl. Phys. Lett. 115, 052902 (2019).

Bareinboim, E. & Pearl, J. Causal inference and the data-fusion problem. Proc. Nat!
Acad. Sci. USA 113, 7345-7352 (2016).

Shpitser, |. & Pearl, J. Complete identification methods for the causal hierarchy. J.
Mach. Learn. Res. 9, 1941-1979 (2008).

Pearl, J. Causality: Models, Reasoning and Inference. (Cambridge University Press,
2009).

Borisevich, A. Y. et al. Exploring mesoscopic physics of vacancy-ordered systems
through atomic scale observations of topological defects. Phys. Rev. Lett. 109,
065702 (2012).

Vicek, L. et al. Learning from imperfections: predicting structure and thermo-
dynamics from atomic imaging of fluctuations. ACS Nano 13, 718-727 (2019).
Vicek, L., Maksov, A., Pan, M. H., Vasudevan, R. K. & Kahnin, S. V. Knowledge
extraction from atomically resolved images. ACS Nano 11, 10313-10320 (2017).
Vicek, L., Sun, W.W. & Kent, P.R.C. Combining configurational energies and forces
for molecular force field optimization. J. Chem. Phys. 147, 161713 (2017).

Vicek, L., Vasudevan, R. K., Jesse, S. & Kalinin, S. V. Consistent integration of
experimental and ab initio data into effective physical models. J. Chem. Theory
Comput. 13, 5179-5194, https://doi.org/10.1021/acs.jctc.7b00114 (2017).
Tagantsev, A. K., Stolichnov, |., Colla, E. L. & Setter, N. Polarization fatigue in
ferroelectric films: basic experimental findings, phenomenological scenarios, and
microscopic features. J. Appl. Phys. 90, 1387-1402 (2001).

Mooij, J. M., Peters, J., Janzing, D., Zscheischler, J. & Scholkopf, B. Distinguishing
cause from effect using observational data: methods and benchmarks. J. Mach.
Learn. Res. 17, 102 (2016).

Troyanchuk, I. O. et al. Phase transitions, magnetic and piezoelectric properties of
rare-earth-substituted BiFeO3 ceramics. J. Am. Ceram. Soc. 94, 4502-4506 (2011).
Borisevich, A. Y. et al. Atomic-scale evolution of modulated phases at the
ferroelectric-antiferroelectric morphotropic phase boundary controlled by flexo-
electric interaction. Nat. Commun. 3, 775 (2012).

Maran, R. et al. Interface control of a morphotropic phase boundary in epitaxial
samarium modified bismuth ferrite superlattices. Phys. Rev. B 90, 245131 (2014).
Maran, R. et al. Enhancement of dielectric properties in epitaxial bismuth ferrite-
bismuth samarium ferrite superlattices. Adv. Electron. Mater. 2, 1600170 (2016).
Kubel, F. & Schmid, H. Structure of a ferroelectric and ferroelastic monodomain
crystal of the perovskite BiFeO3. Acta Crystallogr. Sect. B-Struct. Commun. 46,
698-702 (1990).

Tao, H., Lv, J., Zhang, R., Xiang, R. & Wu, J. Lead-free rare earth-modified BiFeO3
ceramics: phase structure and electrical properties. Mater. Des. 120, 83-89 (2017).
Rubenstein, P.K., Bongers, S., Scholkopf, B. & Mooij, J. From Deterministic ODEs to
Dynamic Structural Causal Models. (Auai Press, 2018).

Janzing, D. et al. Information-geometric approach to inferring causal directions.
Artif. Intell. 182, 1-31 (2012).

Peters, J., Mooij, J. M., Janzing, D. & Scholkopf, B. Causal discovery with con-
tinuous additive noise models. J. Mach. Learn. Res. 15, 2009-2053 (2014).
Daniusis, P. et al. In Proc. 26th Conference on Uncertainty in Artificial Intelligence
(UAI) 07:01-08 (Catalina Island, California, 2010).

Janzing, D., Steudel, B., Shajarisales, N. & Schdlkopf, B. Justifying Information-
Geometric Causal Inference. In Measures of Complexity, 253-265 (Springer, 2015).
Peters, J., Janzing, D. & Schélkopf, B. Elements of Causal Inference: Foundations and
Learning Algorithms. (MIT press, 2017).

Hoyer, P.O., Janzing, D., Mooij, J.M., Peters, J. & Schdlkopf, B. Nonlinear causal
discovery with additive noise models. In Advances in Neural Information Proces-
sing Systems, 689-696 (2009).

Quifnonero-Candela, J. & Rasmussen, C. E. A unifying view of sparse approximate
Gaussian process regression. J. Mach. Learn. Res. 6, 1939-1959 (2005).

Bingham, E. et al. Pyro: deep universal probabilistic programming. J. Mach. Learn.
Res. 20, 973-978 (2019).

Published in partnership with the Shanghai Institute of Ceramics of the Chinese Academy of Sciences
69. Gretton, A. et al. A Kernel Statistical Test of Independence. In Advances in Neural
Information Processing Systems, 585-592 (2007).

70. Goudet, O. et al. Learning Functional Causal Models with Generative Neural
Networks. In Explainable and Interpretable Models in Computer Vision and Machine
Learning, 39-80 (Springer, 2018).

71. Ophus, C., Nelson, C. T. & Ciston, J. Correcting nonlinear drift distortion of
scanning probe and scanning transmission electron microscopies from image
pairs with orthogonal scan directions. Ultramicroscopy 162, 1-9 (2016).

ACKNOWLEDGEMENTS

This effort (electron microscopy, feature extraction) is based upon work supported by
the U.S. Department of Energy (DOE), Office of Science, Basic Energy Sciences (BES),
Materials Sciences and Engineering Division (S.V.K., C.N.) and was performed and
partially supported (M.Z., R.K.V.) at the Oak Ridge National Laboratory’s Center for
Nanophase Materials Sciences (CNMS), a U.S. Department of Energy, Office of Science
User Facility. The work at the University of Maryland was supported in part by the
National Institute of Standards and Technology Cooperative Agreement
70NANB17H301 and the Center for Spintronic Materials in Advanced infoRmation
Technologies (SMART) one of centers in nCORE, a Semiconductor Research
Corporation (SRC) program sponsored by NSF and NIST. A.N.M. work was partially
supported by the European Union’s Horizon 2020 research and innovation program
under the Marie Sktodowska-Curie (grant agreement No 778070). The authors
express deepest gratitude for Prof. Judea Pearl (UCLA) and Dr. Vint Cerf (Google) for
introduction in the field of causal machine learning and productive discussion.

AUTHOR CONTRIBUTIONS

S.V.K. proposed the concept and led the paper writing. M.Z. performed all the
Statistical and causal analysis of data and co-wrote the paper. C.N. performed STEM
experiments and analyzed experimental data to extract descriptors. X.Z. and I.T.
prepared the samples. R.K.V. aided and analysis and paper writing. E.E. and A.N.M.
aided in providing the physical context for causal analysis.

Published in partnership with the Shanghai Institute of Ceramics of the Chinese Academy of Sciences

M. Ziatdinov et al.

 

Competing interests
The authors declare no competing financial or nonfinancial interests.

ADDITIONAL INFORMATION

Supplementary information is available for this paper at https://doi.org/10.1038/
$41524-020-00396-2.

Correspondence and requests for materials should be addressed to S.V.K.

Reprints and permission information is available at http://www.nature.com/
reprints

Publisher’s note Springer Nature remains neutral with regard to jurisdictional claims
in published maps and institutional affiliations.

Open Access This article is licensed under a Creative Commons

BY Attribution 4.0 International License, which permits use, sharing,
adaptation, distribution and reproduction in any medium or format, as long as you give
appropriate credit to the original author(s) and the source, provide a link to the Creative
Commons license, and indicate if changes were made. The images or other third party
material in this article are included in the article’s Creative Commons license, unless
indicated otherwise in a credit line to the material. If material is not included in the
article’s Creative Commons license and your intended use is not permitted by statutory
regulation or exceeds the permitted use, you will need to obtain permission directly
from the copyright holder. To view a copy of this license, visit http://creativecommons.
org/licenses/by/4.0/.

This is a U.S. government work and not under copyright protection in the U.S.; foreign
copyright protection may apply 2020

npj Computational Materials (2020) 127
