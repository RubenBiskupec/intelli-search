       

 
     

® Available online at www.sciencedirect.com
Cheek for ScienceDirect J
&

LSEVIER Journal of the Franklin Institute 357 (2020) 13923-13940
www.elsevier.com/locate/jfranklin

os ae

SF en

     

E

Some novel aspects of the positive linear observer
problem: Differential privacy and optimal /; sensitivity

Aisling McGlinchey*”, Oliver Mason®>*

* Department of Mathematics and Statistics/Hamilton Institute, Maynooth University, Co. Kildare, Ireland
bLero, the Science Foundation Ireland Research Centre for Software, Ireland

Received 26 March 2020; received in revised form 10 August 2020; accepted 4 October 2020
Available online 10 October 2020

 

Abstract

We present several results concerning the /; sensitivity, a crucial parameter for differential privacy, of
a positive linear observer. Specifically, for compartmental systems we derive explicit analytic expressions
for positive observers that minimize a bound for the /; sensitivity. Results are given for single-output
systems and classes of multiple-output systems. For single-output general positive systems, we charac-
terize the optimal /; sensitivity bound of a positive observer with given convergence rate. We also make
some initial observations on sensitivity for more general classes of positive observers.
© 2020 The Authors. Published by Elsevier Ltd on behalf of The Franklin Institute.
This is an open access article under the CC BY license (http://creativecommons.org/licenses/by/4.0/)

 

1. Introduction

Motivated by applications in areas such as transportation, population dynamics, and com-
munications, there has been a lot of interest in the theory of positive systems over recent
decades. The linear time invariant (LTI) system

x(t +1) = Ax(t) (1)
y(t) =Cx(t),

* Corresponding author at: Department of Mathematics and Statistics/Hamilton Institute, Maynooth University, Co.
Kildare, Ireland.
E-mail address: oliver.mason@mu.ie (O. Mason).

https://doi.org/10.1016/).jfranklin.2020.10.004
0016-0032/© 2020 The Authors. Published by Elsevier Ltd on behalf of The Franklin Institute. This is an open
access article under the CC BY license (http://creativecommons.org/licenses/by/4.0/)
A. McGlinchey and O. Mason Journal of the Franklin Institute 357 (2020) 13923-13940

is positive if A € R’*”, C € R“”” are both nonnegative matrices [1]. A positive (Luenberger)
observer for Eq. (1) is defined by

x(t +1) = (A-—LOC)x(t) + Ly(t) (2)

where the matrix L is such that A — LC and LC are nonnegative and the spectral radius of
A —LC satisfies p(A — LC) < 1 [2,3]. Fundamental results concerning existence of positive
observers have been presented in references such as [2—6]. Recently researchers have sought
to develop results for observers with specific forms [7], for nonlinear positive systems [8,9],
systems with missing information [10], and to extend the theory of observers to the related
class of max-plus linear systems [11]. On the other hand, there are fundamental and important
problems concerning the limitations/difficulties of using positive observers in performance op-
timization and state feedback design; see for instance the work of [12,13]. Another interesting
and important line of work related to positive observers concerns the development of meth-
ods that combine state estimation with fault detection and/or disturbance signal estimation;
for recent work in this direction see [14,15].

Compartmental systems are an important subclass of positive systems arising in applications
such as transportation and population dynamics [16,17]. The seminal reference on observer
design for this system class is [6], while recent results on the dual problem of stabilizing a
continuous time compartmental system can be found in [18]. Applications of compartmental
systems such as transportation networks or smart buildings use personal data and there is
a need to add privacy protections to such systems to address public concerns over personal
privacy. In the recent past, differential privacy (DP) [19] has been applied to a variety of
control problems. For example, the design of differentially private Kalman Filters was con-
sidered in [20] while differentially private observer design for general, nonlinear systems was
first considered in [21]; motivating examples from epidemiology and social network analysis
for the addition of differential privacy to observers can be found in [21].

To make an observer of the form (2) differentially private, we add appropriate noise N
to the observer state x so that changes to the measured signal y caused by a small number
of individuals are difficult to detect. In this way the privacy of the individuals concerned is
protected. The ‘randomized mapping’ [22] from the signal y to x + N is called a mechanism.
A mechanism can satisfy strict or non-strict differential privacy and can be constructed using
noise from various distributions such as the Gaussian or Laplace distributions. We focus on
strict differential privacy and Laplace mechanisms for a variety of reasons. First, the Laplace
mechanism is the most widely used DP mechanism in practice. Second, the fundamental
results in [20] underpinning mechanism design for control systems concern the Gaussian and
Laplace distributions. As our interest in this paper is for strict DP, the Laplace is the natural
choice as the results of [20] do not support the use of Gaussian mechanisms for strict DP.

The crucial step in constructing a DP Laplace mechanism is deciding the magnitude of
noise to add to x; equivalently determining the variance of the associated Laplace distribution.
This is determined by a key parameter of the system (2) known as its /; sensitivity [21]. In
general, it is very difficult to calculate exactly the sensitivity of a system. However, in [23] a
bound for the /; sensitivity of Eq. (2) was derived which can be used to determine how
much noise is needed for differential privacy. This reference was the first paper to address the
problem of DP positive observer design; a corresponding bound for the case of J» sensitivity
and Gaussian mechanisms for non-strict DP was presented in [24]. In the current paper, we
consider the problem of finding an observer gain L that minimizes the bound in [23]; such

13924
A. McGlinchey and O. Mason Journal of the Franklin Institute 357 (2020) 13923-13940

a gain is optimal in that it will lead to a mechanism with minimal noise (variance) which is
thus the most accurate possible.

The structure of the paper is as follows. In Section 2, we recall the relevant background
to our work. In Section 3, we present our main results on optimal positive observers for
compartmental systems; results are given for the single output and multiple output cases.
In Section 4, we consider the problem of minimising the /, sensitivity bound for a single
output system where the norm of the observer system matrix is specified. We briefly note
in Section 5 that it is possible to improve on the optimal sensitivity for classical observers
by considering the more general class [4]. Finally, in Section 6, we present our concluding
remarks and some ideas for future work.

2. Background and technical preliminaries

IK” denotes the vector space of n-tuples of real numbers and IR”*” the space of mxn
matrices with real entries. For x € IR": x=>0 means that x;>0 for 1<i<n. R', denotes the
nonnegative orthant IR’. := {x € R" | x = O}. Similarly, for A ¢ R”*": A=>O means that a; > 0
for 1<i<m and 1<j<n. We will sometimes use the notation [A]; to denote the 7, j entry
of a matrix A. Rv" denotes the cone of nonnegative matrices. A> B denotes that A — B > 0
is a nonnegative matrix. A’ denotes the transpose of A.

For a vector c € IR’, the support of c, supp(c) is given by supp(c) = {j : c; # O}. Through-
out, we use ||x|| to denote the 7; norm of x € R” and for T € R”*”, ||T|| denotes the /; induced
norm of T. It is well known [25] that this is given by

7 = max Inj, (3)
i=1

Our main results concern the case where the system (1) is compartmental [16-18]. A
matrix A in R%*" is compartmental if )>"_, aj; <1 for all 1<j<n. If the system matrix A
in Eq. (1) is compartmental, then Eq. (1) is a compartmental system.

Differential privacy and linear observers

We very briefly recall the most relevant facts concerning differential privacy in the context
of this paper. For reasons of space, we omit much of the fundamental details on probability;
for more details and background, see [20].

For differential privacy, we first must choose a similarity relation on the space of signals
y(-). Following [21], given two constants K>0, 0<a <1, the signals y, y are said to be
similar, y~y’ if there is some fo >O with

y(t) =y(t) O<t<t (4)
Iya) -—y@|| < Ka t >.

The similarity relation captures changes in the signal due to the behaviour of a small number
of individuals at time fo. The parameters K and a@ need to be chosen in advance and depend
on the application context and level of protection required. K describes how large an initial
change is permitted while a describes the speed with which this change decays to zero.

The sensitivity of the system (2) is the key parameter that determines the magnitude of
the noise required in order to achieve differential privacy. We use x, to denote the observer
signal corresponding to the output y.

13925
A. McGlinchey and O. Mason Journal of the Franklin Institute 357 (2020) 13923-13940

Definition 2.1. The /; sensitivity of the observer (2) is given by:
A:= sup{||x, _ xy || -y™ y}. (5)

A real-valued Laplace random variable with mean O and scale parameter b> 0 has proba-
bility density function (pdf) f(x) = tent. Given ¢ > 0, an ¢ differentially private mechanism
for the observer (2) can be constructed by adding noise from a Laplace distribution to each
component of x(t) at each time t>0. The key fact is the following.

Proposition 2.1 [20]. Let Eg. (2) have sensitivity A and ¢>0 be given. Choose b> 4,
and define the mechanism X, by adding a Laplace random variable with mean O and scale
parameter b, to each component of x(t) for all t. Then X, is € differentially private.

Proposition 2.1 highlights the important role played by the sensitivity A of the system
in determining the amount of noise required for differential privacy. Exact computation of
the sensitivity can be difficult and complex. However, a differentially private mechanism for
Eq. (2) can be constructed using the Laplace distribution provided we have an upper bound
for the 7; sensitivity of Eq. (2).

Recall that Eq. (2) is a positive observer for the positive system (1) if and only if the
following conditions are satisfied [3]: G@) LC>0; Gi) A—LC > 0; Gu) A—LC is Schur-
stable, p(A — LC) < 1. In order to ensure that an observer of the form (2) has a finite /,
sensitivity with respect to the similarity definition (5), we require that ||A — LC|| < 1. Thus
we are considering a more restricted form of the positive observer problem. In [23] the
following bound for the /; sensitivity of a linear observer was derived.

Theorem 2.1. Consider the observer (2) with ||A — LC|| < 1 and let K>0, 0<a <1 be given.
The sensitivity A of Eg. (2) with respect to the similarity relation (4) satisfies the following
bound:

vk ( ILI )
< —_—_———.. (6)
1—a\1—|A—LC|

To minimize the amount of noise added to the observer state x, we want an observer gain
L that minimizes the upper bound in Theorem 2.1. As K and q@ are fixed parameters, we
focus on minimizing the function

 

|Z

P(L) := ———___,
©) 1 — ||A—LC|

(7)
for L satisfying 0<LC<A, ||A — LC|| < 1.

It is worth noting that the function ® is essentially the /; norm of the zero-initial-state
observer (2). Hence, it quantifies the sensitivity of this system to perturbations in the signal y
in terms of the 7; norm on the associated sequence spaces. An interesting direction for future
work would be to exploit this observation to investigate whether results on robust observer
design, and the dual problem of robust state feedback, can be related to the problems of
differential privacy discussed here. In later examples, we shall help clarify the (somewhat
complicated) relationship between ®(L) and the norm of the observer gain ||Z]|. In particular,
we show that for some system classes, reducing ||L|| can increase ®(L) but the opposite may
also occur.

13926
A. McGlinchey and O. Mason Journal of the Franklin Institute 357 (2020) 13923-13940

3. Compartmental systems

We now assume Eq. (1) is a compartmental system and seek to minimize the function ®,
in Eq. (7), over observer gain matrices L that define a positive observer for Eq. (1). First note
that if ||A||<1, we can choose L = 0 giving ®(L) = 0; as this case is trivial for the problem
we are studying here, we assume that ||A|| = 1 (remember A is compartmental).

3.1. Single output systems: p = 1

We first consider the case where p = 1 so that C = c’ for some nonnegative column vector
c. Given a compartmental matrix A ¢ R‘"” with ||A|| = 1 and a column vector c € R"., we
say that (A, c) is a feasible pair if there exists some nonnegative / ¢€ IR’. with ||A — Ic? || < 1,
A —lIc’ > 0. Note that when p = 1, the conditions Jc’ >0, 1>0 are equivalent [3]. We denote
the set of all such / by 7,4... We first characterize feasible pairs for the compartmental case.

Lemma 3.1. Let a compartmental matrix A € R'*" with ||A|| = 1, and c € R‘, be given. Let
J :={j 2 Yo, aij = 1}. Then (A, c) is a feasible pair if and only if the following conditions
are satisfied.

(1) J © supp(c).
(ii) There exists some i with 1<i<n such that aj, >0 for all j < supp(c).

Proof. First assume that (i) and (ii) hold. Choose some k such that a,j >0 for all j € supp(c)
and set x = min{—“ : J € supp(c)}. Clearly, x >0. Now define / ¢€ IR’. by

x i=k
b= fp i xk. (8)

It follows immediately that for i#k, aj; — ljc; = aj; = O for all 7. Moreover, for i =k, agj —
i,c; = ax; =O for j¢supp(c). For jeEsupp(c), the definition of x implies that ay; — [cj =
aj — xc; =O and so A— Ic’ > 0. Furthermore, x>0O and J C supp(c); these conditions
imply that for j € J,

So Gi — licj) = (S>«.) —xej =1—xe; <1.
i=] i=l

From the definition of 7, we conclude that ||A — Ic? || < 1 and hence (A, c) is a feasible pair.

Conversely, assume that (A, c) is a feasible pair and let />0 be such that A — Ic’ >0
and ||A — Ic’ || < 1. As ||A|| = 1, it follows that 7 is non-empty and that 140. Let j € J be
given. Then )~"_, aj; = 1 and, as ||A —/c’|| < 1, we must have }~"_, (aij — lic;) < 1. This
implies that c; >0 and hence j € supp(c). This proves (i). As /40, we can choose some i with
[;>0. Then as a;; — lic; => O for all 7, 7 we must have a; > 0 for all 7 ¢supp(c). This proves
(11) and completes the proof of the Lemma. LI

When p = 1, the gain matrix L is simply a column vector / € IR"; hence, for this subsection
we slightly alter our notation for for the function ® in Eq. (7) and write ®(/) for / in F4 .

In our next result, we give an explicit analytic characterisation of this minimum value of
@(/) for 1 € Fac.

13927
A. McGlinchey and O. Mason Journal of the Franklin Institute 357 (2020) 13923-13940

Theorem 3.1. Let a compartmental matrix A € R‘"" with \|A|| = 1, and c € R‘ be given
such that the set F,,. is non-empty. Let J := {j : )\"_, aij = 1. There exists le Fac Such
that

@(1) > O(/) = (9)

min jez C;

Proof. We first note that for any / € F4<,

|A le! || = max ) (aij — hiej) = max (x «) 7M I)
a sl oT i=1
> ij |} — lelle; | = 1 — [Z|] minc;.
> vas| (Soa) | I) III min,

i=1

This implies that 1 — ||A — Ic? || < ||/|| minjez cj; and hence that

d(/) > ——_.
MiN jez Cj

Thus to complete the proof, we need to show that there exists some i in Fac with (I )=
1

 

MiN jez Cj"
Denote by J/* the set {1,...,m}\ 7% and, for each ke J*, let a, = ye a;, denote the
corresponding column sum. Let jo be any index such that c;, = min{c; : 7 € 7} and let

1 — a,

C jy — Ck

 

M =min | ke Tic, < ep}.

Then as a, <1 for all k € 7°, M>0O. By assumption, /4 is non-empty. Thus, by Lemma 3.1,
J © supp(c) and we can choose some ig such that a;,; > 0 for all 7 <supp(c). Define the

vector / € IR‘ by:
9 i + in
l= min ((™) U ( jE supp(c)}) 1 = Io.

We note the following readily verifiable facts.

(i) 1 > 0; Id] <M.
(il) aj; — Lic; = O for all 1 <i, j<n.
(iii) So (aij — Lic j) < 1 for 1<j<n. This follows from the facts that A is compartmental,
iZ 0, and 7 C supp(c).

To finish the proof, we will show that for I constructed above, ||A — ict || = +. First note

Cig”
that for any k € J, by the choice of jo, 1 — |[l|cj, = 1 — Well ce.
Now consider k € 7°. Then az <1 so if ce >cj, 1—[lllejp > ox — lll Ilex. Finally, if
ke J*, and cy < Cjp,

 

A A 1
Z| < M => ||| <
Jo” “&k
=> ay — |[E lex < 1 — [lL llej.

13928
A. McGlinchey and O. Mason Journal of the Franklin Institute 357 (2020) 13923-13940

Putting the previous calculations together, we see that
n
Aw T _ Aw _ Aw
|A — Ie" = mmax, Dai = [WFlej = 1 = Mlle jp.
i=

It now follows immediately that

n 1 1
o(/) = — = ——_.,
Cjjo MIN je 7 Cj
which completes the proof. UL

Constructing the optimal I: It is relatively straightforward to construct the optimal observer
gain by following the steps in the proof of Theorem 3.1.

1. First find the minimum value of the entries of c corresponding to indices in 7; choose
one such entry cj.

2. Compute M which is the minimum of the quotients (1 — a; )/(cj, — cg) over indices k
in J/* for which the denominator is positive. If no such index exists, set M = ov.

3. Choose a row ig of A with a;,; > 0 for all 7 with c;>0 and set b= min{-% : > cj > O}.

4. Finally, define [ by setting its i9th entry equal to the minimum of b and M and all other
entries zero.

Example 3.1. Let

1/3 O 1/2
A={0 1/2 1/4], c=(0 1. 3/4).
1/3 OO 1/4

Clearly this is a feasible pair and 7 = {3} so cj, = c3 = 3/4. Next we compute M which
is given by (1/3)/(3/4) = 4/9. Clearly, i9 = 2 and b= 1/3. Putting this together we see
that / = (0, 1/3, 0)? and it can be easily verified that O( J=5 + which is the optimal value
established in Theorem 3.1.

Remark: Theorem 3.1 gives an explicit, analytic expression for the minimum of the sen-

sitivity bound for a single-output compartmental system: dcaynin sy Further, it provides a

constructive way of obtaining the gain vector i that achieves this minimum.

3.2. Extension to multiple output systems (p> 2)

We next consider the more general case where p>2. Given a compartmental matrix A €
R'*” with ||Aj| = 1 and C € R“*", if there exists some L satisfying

0<LC <A; ||A—LC] <1, (10)

we say that (A, C) is a feasible pair and denote the set of all such L by F4.c. We wish to
minimize the function ®(L) given by Eq. (7) over L € Fac.

Lemma 3.1 was important for our construction of the optimal observer gain vector / in
Theorem 3.1. It is tempting to conjecture the following natural generalisation of this result. For
1<k<p, let c“ denote the kth row of C. As above, let 7 denote the set {j : >), aij = 1}.
A natural conjecture generalising Lemma 3.1 is that (A, C) is a feasible pair if and only if
the following two conditions are satisfied.

13929
A. McGlinchey and O. Mason Journal of the Franklin Institute 357 (2020) 13923-13940

(Fl) J CUR, supp(c).
(F2) For each k in {1,..., p}, there exists some i, such that a;,; > 0 for all je supp(c™).

Unfortunately, this conjecture is not true as is shown by the following example.

Example 3.2. Consider the matrices:

2/3 0 0
A=|0 1/2 3/4], c=(; 0 i):

1/3 O 0 Poul

Then clearly A is compartmental and ||A|| = 1. Moreover, (A, C) is feasible as the matrix
1/3 O

L= {0 O
0 O

clearly satisfies Eq. (10). However, while it is true that 7 C UP_,supp(c), there is no i
satisfying condition (F2) for k = 2.

We will revisit the previous example after our next result which extends Theorem 3.1 to
multiple output compartmental systems satisfying conditions (Fl) and (F2) above.

Theorem 3.2. Let a compartmental A € R'*" with ||A|| = 1 and C € R'*" with p> 2 be given.
Assume that the pair (A, C) satisfies conditions (F1), (F2) above. Let T= {j: yy aij = I}
and for 1<j<n, let yj = )>;_, cij. Then the pair (A, C) is feasible and moreover there exists
L € Fac such that for all L in Fac:

A 1
O(L) = O(L) = ——_., (11)

MIN je 7 Yj

where ® is given by Eg. (7).
Proof. Let L € F4 c¢ be given. Then, as A — LC > 0:

A — LC|| = max Dia LC]jj

l<j<n¢

ws (S50 Sve)
> max (> aij — ye, (12)

Note that while we are not assuming L>0O here, we do have C>0 and hence for 1 <i, j <n:

Pp P
[LC]; = Slick; < S lik |Ckj.
k=1 k=]

It follows that for any j € 7:

Suc, < ye Wlielce; = Os Wiel cKj < WLI Pay = ||LIl7.

i=l k=1 k=1 i=l

13930
A. McGlinchey and O. Mason Journal of the Franklin Institute 357 (2020) 13923-13940
Combining this with Eq. (12), we see that

||A — LC|| = max(1 — ||L]|y;) = 1 — ||L|| min y;. (13)
JET JET

It now follows immediately that for any L € Fac:
Il

P(L) = ————.
o) 1— ||A—LC] ~ minjez yj

It remains for us to show that there exists some L in Fa.c such that (L) attains this lower
bound.

To begin, write 7° for the complement of 7, /° = {1,...,n}\ J. Also, for 1<j<n, let
a; = >>", aj; thus a; <1 for all j € 7°. It is easy to see that by choosing x>0 sufficiently
small, we can ensure that

1—- (min Vj)X > Ap — Vex, WET. (14)
j<

Now, assumption (F2) implies that for |1<k<p, there is some (not necessarily unique) ix
in {1,...n} such that a;,; > O for all 7 with cj; >0O. We use this fact to construct L.

First, choose i; such that c,;>0 implies a;,; > 0. Then, for some x>0 (to be determined
later) set li = — x, i = = () for s4i,. Repeat this, choosing % for k = 2,3,...p and in each
case setting lin = = x and ln. = = 0 otherwise. Note that all of the i; selected need not necessarily
be distinct. However, it can be seen from the construction of L that:

(i) each column of L has exactly one non-zero entry which is equal to x;
(ii) ls, > 0, Cg; >O implies that as;>O (as in this case s = ig).

From (i), it follows that >~"_, li =x for 1<j<p and that LI =x. From point (i1), it
follows that by choosing x sufficiently small (and positive) we can ensure that A — LC > 0.
Clearly as L>0, LC>0. Finally, note that if 7 « 7, there is some k € {1,... p} such that
cyj > 0. Hence, by the construction of L, l; uk =x > 0. This implies that \ [A LC];; j<l
for any such j and by the definition of 7, ||A — LC|| < 1. Thus Le Fac. Finally, note that

n ?p
max a; y i, Cc = max |a; ) ) LC. ;
\sjenZ ij iss] ~ l<jen J is© Ss]

i=1 s=1

n P
max | a; — ) ) lis }Csj |} = max | aj — ) XCsj
l<j<n l<j<n 1

s=

s=1

A —Lc|

= max (a; —xy;).
Now, if we choose x>0 sufficiently small so that Eq. (14) holds, then we can ensure that
maxj<j<,(a; —xyj) = 1—xminjez yj. As ||L|| =x by construction, it follows that for such
a choice of x>0:
A x ]
&(L) = —_—_ = ———_..
XMMN jez Vj MIN je 7 Vj

This completes the proof. U

13931
A. McGlinchey and O. Mason Journal of the Franklin Institute 357 (2020) 13923-13940

Remarks:

(i) Theorem 3.2 explicitly characterizes the minimum value of ®(L) for a multiple out-
put compartmental system satisfying (Fl), (F2). Further, the proof is constructive as it
demonstrates how to construct an optimal observer gain matrix L.

(ii) For p>2, it is in general not necessary for the gain matrix L of a positive observer
(10) to be nonnegative. However the optimal L constructed in Theorem 3.2 is indeed
nonnegative. The problem of determining classes of positive linear systems for which
there exists a nonnegative optimal observer gain is an interesting one for further research.
It is certainly not going to be true for arbitrary positive systems as [3] contains examples
of systems (1) for which there exists a positive observer with LC>0O but no positive
observer with L>0.

Constructing an optimal observer gain L: It is possible to construct an optimal gain L for
a system satisfying (Fl), (F2) in the following way.

1. Set ry = min jez Yj-

2. Choose b; = min{ = ke IS°,T,; —y > O}. If the set is empty, set b} = ox.

3. k = 1: First choose 7 so that cj; > 0 > a;,; > O (this is possible by (F2)). Define the
first column of L by setting /;,; = b; and all other entries zero.

4.k =2,..., p: Repeat the previous step, choosing a corresponding i, for k € {2,..., p}.

5. Form the product LC.

6. Find the minimum value b, of

7

 

aij
Ch, .
. Choose any x>0 that is less than min {b,, by}. The matrix L = xL is optimal.

 

over pairs (i, j) with [LC]; > 0.

Example 3.3. Let

1/2 O 1/4 O
A= 0 1/3 1/4 1/3 CH 0 1/2 1 0
~ 11/3 1/4 «#20 1/4]? AL 1/4 0 1/3)
1/6 O 1/2 O
It is straightforward to see that (Fl) and (F2) are satisfied and 7 = {1,3} so the optimal

observer sensitivity is given by 1. Following the algorithm steps to construct L, T,; =1 and
b,; = min{4/3, 5/8} = 5/8. Next we note that i; = 2, i2 =3 so

0 0 0 0 0 0
_ [5/8 0 _ 0 5/16 5/8 0

L= 0 5/8 |? LC = 5/8 5/32 0 5/24
0 0 0 0 0 0

A simple calculation shows that by = 2/5 so we can (for example) choose x = 1/5 to give
0 0

~ | 1/8 0

‘=1 0 18
0 0

Our next example shows that the conclusion of Theorem 3.2 does not necessarily hold
without the assumptions (F1), (F2) on the matrix pair (A, C).

13932
A. McGlinchey and O. Mason Journal of the Franklin Institute 357 (2020) 13923-13940

Example 3.4. Consider again the matrices A, C given in Example 3.2. We saw earlier that
the pair (A, C), while feasible, does not satisfy condition (F2). Now suppose that L € R**?
is such that LC>0O and A — LC > 0. A direct calculation shows that

litle. O lp
C= f{hith O ly»
bi tho. O- |p

The conditions LC>0, A — LC > 0 now imply that

lig =ho =0; bo => 0; by = —lr2.
Thus
ly 0 2/3 — lit 0 0
L=|-lby In), A-LC= 0 1/2 3/4—b»
13) 0 1/3 — hy 0 0

It now follows that ||Z]| = J), + 2 + b, and that ||A — LC|| > 1 — (4; + 4;) = 1 —- ||L]|. This
implies that

ILI,
1—||A—LC|] ~~
Thus, for any L with O<LC<A, we must have ®(L)>1. However, for this pair (A, C),
J = {il} and minjez y; = 2. Thus in this case, there exists no LZ in F4,c with

>(L) = 1 1
7 min jez Yj 7 2

4. Trade-offs for 1, sensitivity

When designing an observer (2), the speed of convergence to the true state, as determined
by ||A — LC||, is an important consideration. In general, there will be a conflict or trade-off
between obtaining the lowest possible value for the sensitivity bound (or equivalently the
function ®) and minimising the norm ||A — LC||. In this section, we consider this trade-off
for a general positive LTI system, not necessarily compartmental, with a single output.

Consider the system (1), where A is a nonnegative matrix, not necessarily compartmental,
and C is a (non-zero) nonnegative row vector, which we will write as c’ for some c € Rt \ {0}.
Thus, we adopt the notation of Section 3.1 and consider the interplay between the objective
functions ||A — Jc’ || and ®(J) where / € IX’. is constrained to lie in the feasibility region Fy...
Formally, we will address the following question in detail.

Problem 4.1. Given A € R4*", c € R% and n €[0, 1), find the minimum value of ®(/) subject

to

1>0; A—Ic’ >0; ||A—Ic?|| = 7. (15)
We first characterise the possible values of n = ||A —/c’|| for / satisfying the first two

conditions of Eq. (15).

Lemma 4.1. Let A ¢ R‘*", c € R', be given and suppose that | € R", is such that A — Ic’ >

0. Define the vector [ for 1<i<n by
A aj
kesupp(c) Cr

13933
A. McGlinchey and O. Mason Journal of the Franklin Institute 357 (2020) 13923-13940

Then
A — Uc? || < ||A—Ic™ || < ||All (17)

Proof. As A — Ic’ > 0 and />0, it follows that for all 1 < i, J <n, ajj — lic; = O which implies
that J; < Minkesuppc) a for 1<i<n. If we set i; = MINesupp(c) oe then 1 <1. As c>0 and
the 7; induced matrix norm is monotonic [25], it follows that:

A-Ic™ <A—Icl <A = ||A—Ic"|| < |A-Ic" || < |IAl

Remarks:

(i) For the rest of this section, given A € R*”" and c € R‘, we shall use nmin and Nmax to

denote
min = |A—IcT |], max = ||All- (18)
Gi) If Amin = Nmax, then ||A — Ic" || = ||A|| for any / satisfying the first two conditions of

Eq. (15). There are two possibilities in this case: ||A|| > 1 in which case the problem is
not feasible; ||A|| < 1 and / = O gives a solution of Problem 4.1 with ®(/) = 0. Thus if
Nmin = Nmax, the problem is either infeasible or trivial, so we shall assume for the rest
of this section that Nmin <Nmax, this implies that 1 4 0.

(iii) Let A ¢ R{*", c € R4_ be such that min <max- Then it is not difficult to see that for
any 1 €["min» Nmax] there exists some / € IR’. that satisfies Eq. (15). This is essentially
an application of the Intermediate Value Theorem coupled with the continuity of the
norm.

(iv) We are interested in the function ® as a bound for the /; sensitivity of a linear observer
(2). This bound, given by Theorem 2.1, is only valid if ||A — Jc? || < 1 holds. For this
reason, we will assume for the rest of this section that nmin < 1.

Given 7 €[Nmins Nmax], we define the set F(7) as follows:
F(n) = {le R’.:A—Ic"’ > 0, \|A — Ic" || = n}. (19)

In view of the remarks above, - (7) £ {O}.
Given, A € RY", c € R1, and 7 € [mins Nmax| we define M(n) as:

M(n) =. max (et) (20)

Jesupp(c) Cj

The following lemma notes that under the assumption in point (11), M(7) 1s nonnegative.

13934
A. McGlinchey and O. Mason Journal of the Franklin Institute 357 (2020) 13923-13940

Lemma 4.2. Let A € R4*", c € RY \ {0} be given. Assume that nmin <Mmax. Then for any

ne [Nmin: Nmax], M(n) > 0.

Proof. By assumption, ||A — ict || < ||A||. This implies that for any j with )°"_, ai; = |All,

we must have c; >0. Let }°"_, aix = ||A|| for some k. It follows that k€supp(c) and that for

HE [Nmin: Nmax I:

ran Gik — 1) _ |All — S
Ck Ck 7

>

int Gj — ") 0.

M(n) = max (
Cj

Jesupp(c)

The next result characterizes the norm of / € F(7) in terms of 7.

Lemma 4.3. Let A € R'*", c € R¢, \ {0} be given and assume that nmin < max. Let | € F (7)
for some n€|Nmins Nmax). Then

Z| > M(m).

Proof. As ||A — Ic" || =, max; >~"_, (ai; — licj) = and hence, for all 1 <j<n,

So aig — ell <n => cll = Yo aij — 0
i=l i=l
From the definition of supp(c), it follows immediately that:

(== aij — 1

Cj

IZ || = max
jesupp(c)

)=mon

L

Remark: The last result gives us a lower bound for ||/|| where / is in F(7) and n€[nmin,
Nmax]. We next show that this lower bound is in fact a minimum.

Proposition 4.1. Let A ¢ RY", c € RY \ {0} be given. Assume that tmin<Mmax. For any
n €[Nmin> Nmax] let M(n) be given by Eg. (20). Then:

min{||/|| : 2 € #()} = M(n).

Proof. From Lemma 4.3, it is enough to show that there exists /* € F (7) with ||/*|| = M(n).
AS min <Nmax, it follows that there exists 7 € F(7) such that ||Z|| >0; choose such an /.

As ||A — Jc’ || =n, for all j € {1,...,}, we have that }°"_, a;; — c;||/|| < n. Furthermore,
as A>0,c>0, />0, it follows that

(i: aij > n} S supp(c)
i=l

Hence for all j ¢supp(c), )o_, aij < 7.
Define

"= Gres
oi

This is possible as we have chosen / with ||/||>0. Moreover, as 1min <"max, M(n)=>0 by
Lemma 4.2 and ||/*|| = M(n).

13935
A. McGlinchey and O. Mason Journal of the Franklin Institute 357 (2020) 13923-13940

It remains to show that /* € F(7). By Lemma 4.3, ae < 1, thus 0</* <l and A-—I*c! >

A —Ic!' > 0. To finish we need to show that ||A — /*c” || = n.
First of all, note that for all 7 ¢supp(c),

So aij — cg" = Yo aij <n
i=l i=l
Next note that the definition of M(7) implies that:

1. M(n) > Dis Gjo7 for all j €supp(c);
2. M(n) = Dist tip for some jo € supp(c).
JO

As ||/*|| =M(n), it follows that for all jEsupp(c), So", ai; — c;\|/*|| <n while for jo,
A —1*c? || = 1 Gio — Cig lE*|| = n. Thus 1* € F (7) and ||/*|| = Mm). This completes the
proof. U

Remark: It is now straightforward to apply Proposition 4.1 to answer Problem 4.1. With the
application to differential privacy in mind, we make the assumption that nin <1 (in order
to ensure the bound in Theorem 2.1 is valid). The next result follows immediately from the
definition of ® in Eq. (7) and the set F(n).

Corollary 4.1. Let A ¢ RY", c ¢ RY {0} be such that nin <MNmax ANA Nmin <1. Set ny =
Min{max, 1}. Let n€[Nmin, 01) be given. Then

min ®(/) = (ee). (21)
leF(n) 1-7

Remark: In the corollary, if 4mg,< 1 we can include the right endpoint n; (allow 7 € [Nmin,
Nmax|) but this makes no material difference to the argument or conclusion.

Example 4.1. Let

3/4 O
a= (1/5 sia) c = (1 1).

Then we can see that nmin = 3/4, Nmax = 5/4. Then for any n €[3/4, 1), we can calculate
M(n) = 5/4—7 so by Corollary 4.1 the minimum value of ®(J) for ||A — Ic’ || = n is given
by 5 —

For this example, it is worth noting that if we take / = (0, 5/16)’, i = (0,6/16)" then we
find ®(/) = 5, (/) = = 3 showing that ®(/) > ®(/) while ||/|| < ||. So reducing the norm
of the gain increases the sensitivity bound in this case.

4.1. Implications for globally optimising the sensitivity bound

We now give two simple applications of Corollary 4.1 to the problem of finding a global
minimum of ® over / in F4¢.

Proposition 4.2. Let A € R*", c € R‘, \ {0} be given. Assume that nmin <Mmax aNd Nin <1.
If ¥<"_, aij = 1 for all j €supp(c), then the infimum of ®()) for Lin Fy.¢ is “kine.

1— "min

13936
A. McGlinchey and O. Mason Journal of the Franklin Institute 357 (2020) 13923-13940

Proof. Set 7; = min{7ngx, 1}. For a given 7 €[Nmin, N1) (aS above, if n} <1 we can include
the right endpoint here), write
M(n) ar - ") 1

—— = max ¢;(7) where $;()) = —

L—7  jesuppte) ;

For each jesupp(c), as >>, a; => 1, it follows by differentiation that $; is a non-

. . M . . .
decreasing function on [min, 71). Hence, ae is a non-decreasing function and

1
M (nmin) < M(n)
| — "min ~ L- 1)
for all 7 €[Nmin, 11). The result now follows from Corollary 4.1.

Finally for this section, we prove a simple result for the case where the non-zero entries
of c are all equal.

Proposition 4.3. Let A ¢ R'*", c € R‘, \ {0} be given. Assume that Hnin < max ANd Nmin < 1.
Suppose that there is some real number X>0 such that cj; =X for all jesupp(c). If

MAX jesupp(c) »j-1 4ij > 1, then the infimum of ®(1) for | in F4,¢ is a

Proof. Again, set 7; = min{1, Mmax} and let 7 €[Nmin, 1). AS cj = A for all j € supp(c):

a1 Gj
M(n) _ MAXjesupp(e) (222-1)
l-7n l—n
_ MAX jesupp(c) (oa) — 0
AC — 7)

M(n)

If max jesuppvc) an ajj > 1, then Ton is an increasing function for all 7 in [Nmin, 1). The

result follows immediately. L
5. The J; sensitivity of positive observers with coordinate transformation

In [4], a more general form of positive observer was studied for continuous time systems.
For the discrete time setting, the observer structure studied in [4] is of the form:

z(t +1) = Fz(t) + Gy(t) (22)
R(t) = Tet).

In order for this to define a positive observer for Eq. (1), the following conditions are suffi-
cient: F>0, op(F) <1; TA — FT = GC; T is inverse positive, meaning T!>0.

By suitably adapting the calculation previously published in [23] for the observer (2), we
can readily derive the following bound for the /; sensitivity of Eq. (22). As before, we require
that ||F'|| <1 in order to ensure that the sensitivity bound is finite.

Proposition 5.1. Consider the observer (22) with ||F|| <1. Let K>0, 0<a <1 be given. The
sensitivity A of Eg. (22) with respect to the similarity relation (4) satisfies the following
bound:

K TOWNG
A< | IH I (23)
l-a\ 1-|F]|

13937
A. McGlinchey and O. Mason Journal of the Franklin Institute 357 (2020) 13923-13940

Remark: It is easy to see that a classical Luenberger observer (2) corresponds to the
choice T =J, F =A—LC, G=L, so Theorem 2.1 1s a corollary of Proposition 5.1. It is
immediate that an optimal observer of the form (22) cannot perform worse than the optimal
observer of the classical type. However, note that characterising the set of possible observers
satisfying Eq. (22) may be significantly more complicated than for the classical case. Hence,
the problem of determining an optimal observer belonging to the more general class is likely
to be far more challenging and is beyond the scope of the present paper. The point of the
next example is simply to show that it is possible to improve significantly on the theoretical
minimum for a classical observer by considering the more general type.

In Example 5.1, we consider an observer (22) for a single-output compartmental system.
Thus, an observer is defined by a triple (F, T, g) in R4*" x R’*" x RY‘. satisfying:

Fil <1; T7!>0; TA-—FT = gc’. (24)

. TO!
We construct such an observer for which //—Llsl EE

given by Theorem 3.1 for the classical observer.

is strictly less than the theoretical minimum

Example 5.1. Consider:

1/2 1/4
a=(115 tis) c’ =(1/3 1/2).

Next choose:

—/1 0), (1 0
r=(1, i) = ("4 1/30)

and g’ = (1/2 1/10). Then it is readily verified that TA — FT = gc’, and T~! > 0, ||F|| <1

 

 

so Eq. (22) defines a positive observer. Moreover — = = 3 while, for this choice of F,
T, 2, [Fe = 2. Thus, the upper bound for the general observer (23) of 2 is significantly

lower than the theoretical minimum value of 3 for a classical observer in this case.

6. Concluding remarks

Theorems 3.1 and 3.2 provide simple, usable expressions for the minimum value of the /;
sensitivity bound in Theorem 2.1 as well as indicating a constructive procedure for computing
an optimal observer gain. In Section 4 we characterize the interplay between the /; sensitivity
bound and the rate of convergence for single-output positive LTI systems. We have provided
several numerical examples to illustrate the results of the paper; Example 5.1 shows explicitly
that the more general type of observer in [4] can offer significantly improved performance.

There are several interesting directions for future research. For instance, extending Theo-
rem 3.2 to a more general class of multiple-output compartmental systems. Specifically, can
we relax the assumptions (Fl) and (F2) of Section 3.2? The optimal gain matrix in Theo-
rem 3.2 is nonnegative even though, as we have noted, this does not need to be the case for
general positive systems. This suggests the problem of identifying matrix pairs (A, C) with
p=2 for which the minimum value of ®(L) for L € F4¢ occurs at a nonnegative matrix
L. Another question is to consider arbitrary output matrices C for the multi-output case and
the corresponding optimization. Finally, determining the minimum value of the bound for the
more general observer class in Section 5 presents a significant challenge.

13938
A. McGlinchey and O. Mason Journal of the Franklin Institute 357 (2020) 13923-13940

Declaration of Competing Interest

The authors declare that they have no known competing financial interests or personal
relationships that could have appeared to influence the work reported in this paper.

Acknowledgments

The authors would like to thank the associate editor and anonymous reviewers for their
constructive feedback which has helped to significantly improve the paper.

This work was supported by Science Foundation Ireland (Grant no. 13/RC/2094), and the
European Regional Development Fund through the Southern & Eastern Regional Operational
Programme to Lero — the Irish Software Research Centre (www.lero.ie).

References

[1] L. Farina, S. Rinaldi, Positive Linear Systems: Theory and Applications, Wiley, 2000.
[2] M. Ait Rami, F. Tadeo, Positive observation problem for linear discrete positive systems, in: Proceedings of the
IEEE 45th Annual Conference on Decision and Control (CDC), 2006.
[3] M. Ait Rami, F. Tadeo, U. Helmke, Positive observers for linear positive systems, and their implications, Int.
J. Control 84 (4) (2011) 716-725.
[4] J. Back, A. Astolfi, Design of positive linear observers for positive linear systems via coordinate transformations
and positive realizations, SIAM J. Control Optim. 47 (1) (2008) 345-373.
[5] H.M. Hardin, J-H. van Schuppen, Observers for linear positive systems, Linear Algebra Appl. 425 (2007)
571-607.
[6] J.M. Van den Hof, Positive linear observers for linear compartmental systems, SIAM J. Control Optim. 36 (2)
(1998) 590-608.
[7] L. Liu, H.R. Karimi, X. Zhao, New approaches to positive observer design for discrete-time positive linear
systems, J. Frankl. Inst. 355 (2018) 4336-4350.
[8] B. Brian, J. Wang, Z. Qu, Nonlinear positive observer design for positive dynamical systems, in: Proceedings
of the American Control Conference, 2010, pp. 6231-6237.
[9] X. Zhao, T. Wu, X. Zheng, R. Li, Discussions on observer design of nonlinear positive systems via T-S fuzzy
modeling, Neurocomputing 157 (2015) 70-75.
[10] G. Wang, B. Li, Q. Zhang, C. Yang, Positive observers design for discrete-time positive systems with missing
data in output, Neurocomputing 168 (2015) 427-434.
[11] L. Hardouin, C.A. Maia, B. Cottenceau, M. Lhommeau, Observer design for max plus linear systems, IEEE
Trans. Autom. Control 55 (2) (2010) 538-543.
[12] M. Naghnaeian, P.G. Voulgaris, Performance optimization over positive /,., cones, Automatica 80 (2017)
177-188.
[13] Z. Shu, J. Lam, H. Gao, B. Du, L. Wu, Positive observer and dynamic output-feedback controllers for interval
positive linear systems, IEEE Trans. Circuits Syst. 55 (10) (2008) 3209-3222.
[14] A. Oghbaee, B. Shafai, S. Nazari, Complete characterization of disturbance estimation and fault detection for
positive systems, IET Control Theory Appl. 12 (7) (2018) 883-891.
[15] B. Shafai, S. Nazari, A. Oghbaee, Positive unknown input observer design for positive linear systems, in:
Proceedings of the 19th International Conference on System Theory, Control and Computing (ICSTCC), 2015.
[16] J.A. Jacquez, C.P. Simon, Qualitative theory of compartmental systems, Sci. World J. 35 (1) (1993) 43-79.
[17] P. Van den Driessche, J. Watmough, Reproduction numbers and sub-threshold endemic equilibria for compart-
mental models of disease transmission, Math. Biosci. 180 (1) (2002) 29-48.
[18] M.E. Valcher, I. Zorzan, State-feedback stabilization of multi-input compartmental systems, Syst. Control Lett.
119 (2018) 81-91.
[19] C. Dwork, A. Roth, The algorithmic foundations of differential privacy, Theor. Comput. Sci. 9 (3) (2014)
211-407.
[20] J. Le Ny, G.J. Pappas, Differentially private filtering, IEEE Trans. Autom. Control 59 (2) (2014) 341-354.
[21] J. Le Ny, Privacy-preserving nonlinear observer design using contraction analysis, in: Proceedings of the IEEE
54th Annual Conference on Decision and Control (CDC), 2015, pp. 4499-4504.

13939
A. McGlinchey and O. Mason Journal of the Franklin Institute 357 (2020) 13923-13940

[22] C. Dwork, Differential privacy, in: Proceedings of the 33rd Annual International Colloquium on Automata,
Languages and Programming, LNCS 4051, Springer-Verlag, 2006, pp. 1-12.

[23] A. McGlinchey, O. Mason, Differential privacy and the /; sensitivity of positive linear observers, IFAC World
Congr. 50 (1) (2017) 3111-3116.

[24] A. McGlinchey, O. Mason, Bounding the /2 sensitivity for positive linear observers, in: Proceedings of the
European Control Conference, 2018, pp. 1214-1219.

[25] R.A. Horn, C.R. Johnson, Matrix Analysis, Cambridge Univ. Press, 2012.

13940
