International Journal of Power Electronics and Drive System (IJ PEDS)
Vol. 11, No. 4, December 2020, pp. 1775~1784
ISSN: 2088-8694, DOI: 10.11591/ijpeds.v11.i4.pp1775-1784 O 1775

Control of hybrid power system based renewable ener gy

generations using PID controller

Mohamed Regad!, M’hamed Helaimi*, Rachid Taleb*, Anmed M. Othman‘, Hossam A. Gabbar?
'23 Electrical Engineering Department, Hassiba Benbouali University, Chlef, Algeria

Laboratoire Génie Electrique et Energies Renouvelables (LGEER)

4 Electrical Power and Machine Department, Faculty of Engineering, Zagazig University, Egypt
> Faculty of Energy Systems and Nuclear Science, University of Ontario Institute of Technology (UOIT),

Article Info
Article history:

Received Dec 2, 2019
Revised Apr 24, 2020
Accepted Jun 29, 2020

2000 Simcoe St. N., Oshawa ON L1H 7K4 ON, Canada

ABSTRACT

This paper addresses to integrate an optimal proportional-integrator-
derivative controller for frequency regulation in an isolated microgrid power
system based renewable generation. This autonomous microgrid system is
composed of distributed energy sources like wind, solar, diesel engine
generator, fuel cells system, and two different storage devices such as battery

energy storage system and flywheel energy storage system. Optimal tuning
of the investigated controller is considered as the main problem to be
Keywords: resolved using the Krill Herd algorithm through an objective function. The
obtained results are also accomplished with and without the battery energy
storage system. The comparison of system performance shows that the
proposed control scheme based Krill Herd algorithm is better than the genetic

Frequency control
Hybrid system

Krill Herd algorithm algorithm in the improvement of system performance.
Microgrid
PID Controller This is an open access article under the CC BY-SA license.

Corresponding Author:

Mohamed Regad,

Electrical Engineering Department,

Hassiba Benbouali University of Chlef,

Laboratoire Génie Electrique et Energies Renouvelables (LGEER),
BP. 78C, Ouled Fares 02180, Chlef, Algeria.

Email: m.regad@univ-chlef.dz

1. INTRODUCTION

Electricity plays an important role in all sides of human life. Therefore the increase of the world
energy demand, due to the population growth, modern industrial society and the environment pollution, is
moved the world towards renewable energy sources as the solution of these issues related to the energy
demand, high fuel cost, and greenhouse problems, to enhance power quality issues and energy efficacy[1].

Out of all renewable energy units, wind and solar systems are considered as secured and reliable
sources and being installed widely. These generation units have obtained popularity because of the
environment-friendly characteristics and they are inexhaustible energy sources as well as fast development in
the technologies [2]. The use of these sources recently attended a salient increase according to the countries'
development and environmental pollutions. The generation powers from this renewable generation are
intermittent that causes some mismatches between produced power and demanded one. This affects the
microgrid operation and causes instability in the frequency and power of the hybrid energy system [3]. To
tackle this problem, some storages energy systems like BESS and FESS along with conventional sources like
Diesel Engine and Fuel Cell systems are integrated into the concept of the hybrid energy system that is
considered as the microgrid. Many types of research interest in the modeling and control of these kinds of

Journal homepage: http: //iypeds .iaescore.com
1776 O ISSN: 2088-8694

hybrid systems as in [4-7] which have been accomplished to address the control of microgrid using various
cases of configurations.

In this paper, a microgrid system is considered to overcome the challenges facing the use of
renewable generation. This proposed microgrid includes two renewable generation system such as
photovoltaic (PV) panels and wind generator with diesel engine, and fuel cell system as additional
generators, the Battery and Flywheel systems are integrated into the microgrid system. From many studies,
this microgrid configuration is considered as the most important solution for producing electricity in isolated
areas. However, the major challenge that facing the exploiting the microgrid is to regulate the power and
frequency fluctuation in an islanded and connected mode of microgrid because of the difficulty of design
control[8-9]. Autonomous operation of the microgrid, through controlling the system frequency, will enhance
the performance of the microgrid.

Due to its simplicity and facility to implement the PID controller becomes the most controller used
to maintain the system frequency under fluctuations in generation power and load demands[10-11]. To
achieve the optimal control of frequency in the microgrid system, different optimization techniques are being
utilized in literature as in [12-17]. These researches applied various optimization techniques like the Genetic
Algorithm, Mine Blast Algorithm (MBA), Particle Swarm Optimization (PSO), and quasi-oppositional
harmony search to optimize the controller parameters. Recently few researches have been achieved to present
frequency control using the Krill Herd technique [18]. However, in this work, the Krill Herd algorithm is
used to optimizing the PID parameters to control the frequency and power deviations in the proposed
microgrid. The best-obtained parameters of the PID controller by KH are compared with the others presented
in [7] using GA. In general, KH is a robust search and powerful optimization technique, able to solving
global functional optimization problems [19-20]. This method is focused to simulate the behavior of krill
swarms [21]. The rest of the paper is orderly as bellow. Section 2 describes the proposed configuration of the
hybrid energy system and its different components models. In Section 3 brief introduction to the PID
controller and the objective function using in this study. Section 4 explains a review of the Krill Herd
technique using for the optimization of PID controller gains. Section 5 displays the results analysis and
comparisons with the performances of the controller using two different optimization techniques and also
their robustness contra the disconnection of energy storage devices. The paper ended with a conclusion
in Section 7.

2. PROPOSED MICROGRID SYSTEM

The proposed hybrid system model presented by the transfer function is presented in Figure 1. The
PV array and Wind Turbine Generator (WTG) are considered the principal sources to outfit the load demand.
The Diesel Engine Generator (DEG) and Fuel Cell, are used as complementary generators to ensure the
system operation continuity which affected by the interruption nature of renewable sources. The Battery and
Flywheel devices are added to the system stability. The photovoltaic generation system and the wind energy
system are combined with other sources and energy storage devices to obtain a more constant power profile.
This configuration is used in [7]. The microgrid’s parameters are illustrated in Table.1. The typical model of
the microgrid system utilized in this study is as fellow: [7-10, 22-25]

 

 

 

 

 

010=

+++} S| ca

 

 

 

 

 

 

 

 

 

>)- CY eae

|} FuelCell | DC-AC

 

 

 

 

 

 

peas ;

 

 

 

 

 

 

 

 

  

 

 

 

K,

 

 

 

Figure 1. Block of the proposed hybrid energy system

Int J Pow Elec & Dri Syst, Vol. 11, No. 4, December 2020 : 1775 — 1784
Int J Pow Elec & Dri Syst ISSN: 2088-8694 O 1777

Tablel. Proposed microgrid’s parameters

 

Component Gain (K) The time constant (s)
WTG Kwre =] Twre = 1.5
PV Kpy =1 Tyjc = 0.004
FC Krc = 0.01 Tre = 4
DEG KprG =0.003 TporG = 2
BESSS Kpess =] Tpess = 0.1
FESS Kress =] Tress = 0.1
KwtTG APwTG
= 1
Gwre 1+STwrta APwtc ( )
_ Kpy _ APpy
Gpy 7 1+STpy 7 AQ (2)
— _Krc_ _ APrc
Ggc(S) = 1+STrc Au (3)
—_  Kpeg _ APpEG
Gpgc(s) = 1STpse Au (4)
_ Kpess  _ APgess
Gpess(S) = TtSTppss Au (5)
_ Kress _ APress
Gress(S) = isSTerss AU (6)

Where Au is the signal control action of the PID controller in feedback to minimize the frequency
deviation Af.

The power generation from renewable sources and power demand is modeled in considering the
small stochastic fluctuations and large deterministic drift [6-7].

P= ((.n-/B(1- G(s)) + B)/B)T =x.0 (7)

Where 9 is the power component, P represents the output of wind or solar system and load, B gives
the value of the power, n is renormalization constant of the generated or load. (y) to correspond the per unit
(p.u.) level, I’ is a time-dependent converting signal with a gain that transcribes the sudden change in the
value for the power output [7, 23].

Figure 2 shows the stochastic model of generation powers (Pw, Psol), the total power (Pt), and also
the demand (PI). Significant fluctuations that can influence the frequency deviation can be remarked. The
stochastic natures are independent of the control strategy.

 

Pwind

 

 

 

 

 

60 60

time(sec) time(sec)

 

 

 

 

0.94 ! ! ! ! !
100 120 140 160 180 200 220

time(sec)

 

Figure 2. Realization of the solar, wind and load powers

Control of hybrid power system based renewable energy generations using PID ... (Mohamed Regad)
1778 O ISSN: 2088-8694

3. PIDCONTROLLER STRUCTURE AND OBJECTIVE FUNCTION FOR OPTIMIZATION

PID controller is used as a specific regulator in loop feedback that is used widely in the industrial
regulation system. Its standard structure has a ‘‘three-term” controller, which can be modeled using the
transfer function in its ideal form by (8) or in its parallel form by (9) [11].

G(s) = Kp (1 + = + Tps) (8)
G(s) = Kp ++ Kps (9)

Where Kp is the gain of proportionality T;is the time constant of integral, Tp the time constant the derivative,
K; is the integral gain and Kp is the derivative gain.

The ‘‘three-term” operations are presented as follows [3, 12].

--The proportional term furnishing a global regulation action proportional to the error signal meanwhile the
all-pass gain.

-The integral term decreasing steady-state errors over low-frequency using the integral action.

-The derivative term enhances transient response by high-frequency compensator using differential action.
Proportional, Integral, and Derivative terms consist of the PID controller actions.

P Ke(t)
EEE
_de(t)

Figure 3. Block of PID controller model

 
    

 

The objective function (J) is considered the optimization problem whole the variables are PID
controller parameters. It is an integral of the sum square frequency deviation (Af) and the deviation of the
signal control deviation (Au) as presented by (10) [6-7].

Jopt = fy [w(Ah)? + C*) (au)? }dt (10)

Where w transcribes the relative value of the objectives function (1.e., Integral of Squared Error—
ISE and Integral of squared Deviation of Control Output—ISDCO), and it is equal to 0.7. Kn = 10% is the
normalization of scale in ISE and ISDCO.

4. AREVIEW ON KRILL HERD OPTIMIZATION ALGORITHM

A new meta-heuristic Algorithm called Krill Herd algorithm is investigated by Gandomi and Alavi
(2012) that is inspired using the simulation of krill swarm behavior [18] This method is known as robust
optimization algorithm mimics the behavior of Krill swarms in Krill Herd using for solving difficult
optimization issues [19]. The krill motion mostly influences the objective function with the distances of each
krill swarm between food and herd density. The Krill individual’s time position is determined by the
bellowing three actions [20,25]:

1. The movement provoked by krill swarms;
2. Foraging activity; and
3. Sudden propagation, therefore.

The provoked movement refers to the density conservation of the herd by each swarm. The
mathematical formula is as follows: [18-20]

new _— N™2% q, + w,N4 (11)

Int J Pow Elec & Dri Syst, Vol. 11, No. 4, December 2020 : 1775 — 1784
Int J Pow Elec & Dri Syst ISSN: 2088-8694 0 1779
Where N™** is the maximum speed, and a; is defined as:
a; = q local + qtarget (12)

W,, is the inertia weight of the provoked movement in the interval [0, 1],N old is the last movement provoked,
qlecal is the local influence given by the neighbors and a‘@"9% is the target direction effect given by the best
krill.

The second movement is influenced by the food present location and the last experience.it can be presented
as fellow [20]:

F; = VBitwp Fo" (13)
Where

B; _— BF" 4 Bie
i i i

and Vy is the speed foraging, wyis the inertia weight, F,°'4 is the last foraging movement. The third
movement is defined as an arbitrary process that is presented with a directional factor and a propagation
speed. It is expressed by the bellowing formula [20]:

D; = D™*6 (14)

Where D™*~ is the maximum diffusion speed and 6 is the random directional vector, and its values are varied
in [-1, 1].

Using various effective parameters of the motion according to the time, the position of a krill
individual over the interval t to At is given by the bellow formula [20]:

X,(t + At) = X;(t) + at (15)

It may notice that At is one of the most essential parameters and must be correctly determined under
the problem to be solved. Indeed, this parameter influences as a scale factor for the speed vector.
Different algorithms inspired by krill can be determined using the movement characteristics of krill

individuals. The KH algorithm can be summarized by various steps as below [20].

1- Data forms: determine the simple limits, resoluteness of Krill Herd algorithm parameter(s).

2- Initialization: arbitrary initialize the krill swarm into the search environment.

3- Evaluation of objective function: calculation of each krill swarm objective function with the krill position.
- Motion calculation: -Movement provoked by other krill swarms, -Foraging movement —Physical
propagation.

4- Implement the genetic operators.

5- Updating: update the krill swarms position in the search environment.

6- Recurring: return to step 3 until the iteration number is attainted.

7- End

5. SIMULATION AND RESULTS

The proposed system is performed and analyzed under MATLAB/Simulink software. Time-Domain
analysis of the proposed hybrid system is investigated using KH and GA based PID controller. The Krill
Herd algorithm is applied to optimize the PID controller’s parameters in the proposed hybrid power system
illustrated in Figure | for frequency control and the obtained results are compared with those obtained by GA
reported in [7]. Results based on the objective function J solved using the proposed KH 1s reported. Figure.4
displays the convergence of the objective function using KH. The convergence characteristics of the Krill
Herd Algorithm for the PID controller are illustrated in Figure 4.

Control of hybrid power system based renewable energy generations using PID ... (Mohamed Regad)
1780 O ISSN: 2088-8694

 

0.0164

 

 

 

 

0.0162
0.016

0.0158

IX est)

0.0156
0.0154

0.0152

 

 

 

0.015

0 50 100 150 200 250

No. of Iterations

Figure 4. Fitness convergence of the proposed KH algorithm

Figure 5 shows the frequency and power variations with the signal control deviation. The frequency
and power deviations are affected by renewable power changing according to the weather conditions. This
effect is mitigated by the use of the PID controller based Krill Herd algorithm in comparison with the GA.
The PID controller eliminates the mismatches and enhances also the performance of the system. However, it
can be shown that the oscillations band is less with KH than with GA. This is more important to facilitate the
design of the control signal which activates the feedback components such as the FESS, BESS,
and DEG, etc.

 

 

 

 

-0.4
100 120 140 160 180 200 220

time(sec)

 

12 T T T T T

 

 

 

-0.8
100 120 140 160 180 200 220

time(sec)

 

 

 

 

time(sec)

Figure 5. Frequency and power variations with the control signal

Int J Pow Elec & Dri Syst, Vol. 11, No. 4, December 2020 : 1775 — 1784
Int J Pow Elec & Dri Syst ISSN: 2088-8694 O 1781

Figure 6 displays the responses of the various generation devices of the proposed microgrid system
such as BESS, FESS, FC, and DEG under nominal conditions of operation. It can be shown that there are
fewer fluctuations with PID controller tuning By KH than with the PID controller optimized using GA.

 

P-BESS

 

 

 

time(sec)

 

P-FESS

 

 

 

time(sec)

1.6 T T T

 

 

 

 

 

 

 

time(sec)

Figure 6. Responses of different components of the microgrid system using the best PID-KH and PID-GA

To limit the frequency variation by the elimination of the unbalance in supply and demand under the
stochastic change of both the generated power and load demand, the power deviation is controlled by a PID
controller. The parameters of the controller are optimized using the Krill Herd algorithm and compared with
the result obtained using GA in [7]. It has been shown that the frequency response using Krill Herd
algorithm-based PID outperforms the PID controller optimized using the GA algorithm. PID controller tuned
by the Krill Herd is validated as the better controller over the GA-PID controller.

Control of hybrid power system based renewable energy generations using PID ... (Mohamed Regad)
1782 O ISSN: 2088-8694

The simulation of the proposed system without battery is presented in Figure 7 and Figure 8. It can
be observed that the BESS has a high impact on the fluctuation in the frequency and power of the hybrid
system. This fluctuation caused by the stochastic and intermittent form of wind and solar powers. Also, the
impact is observed in various power generation by different sources like FC, DEG, and FESS. The results
show the robustness of the PID controller based KH that minimizes the power and frequency fluctuations in
the absence of the battery energy storage device. The generated power from different components, as
reported in Figure 9, shows the robustness of the control scheme against the energy storage disconnecting.

0.17 Best run values
Average run values

0.165

0.16

best)

> 0.155
—
0.15

0.145

 

0 20 40 60 80 100 120
No. of Iterations

Figure 7. Objective function convergence of KH algorithm

 

 

Time(s)

 

05
100 120 140 _ 160 180 200 220
Time(s)

 

 

 

 

100 120 140 160 180 200 220
Time(s)

Figure 8. Frequency and power deviations with control signal with and without BESS using PID-KH

Int J Pow Elec & Dri Syst, Vol. 11, No. 4, December 2020 : 1775 — 1784
Int J Pow Elec & Dri Syst ISSN: 2088-8694 O 1783

6.

PDEG(p.u)

 

100 120 140 160 180 200 220
Time(s)

PFC(p.u)

 

 

, 100 120 140 160 180 200 220
Time(s)

 

PFESS(p.u)

 

 

 

-0.6
100 120 140 160 180 200 220
Time(s)

Figure 9. Power of various components of the autonomous system with without and BESS

CONCLUSION

The paper presented an application of a PID controller scheme to regulate the frequency deviation in

hybrid power system consists of WTG, PV, DEG, FC, BESS, and FESS as illustrated in figure.1 which are
considered the most promising and sustainable configuration used in the kind of hybrid energy system . Solar
and wind cause frequency and power oscillations caused by the stochastic nature of this renewable
generation. Therefore, frequency control is provided by the integration of the PID controller based Krill
Herd. A comparison with the results offered by GA as reported in [7] is done. These comparisons show
evidence that the KH outperformed the GA. However, performances of the KH based PID controller is better
than PID based GA restricting the frequency and power oscillations. Also, the robustness against
disconnecting the Battery energy storage is tested.

REFERENCES

[1]
[2]
[3]

[4]
[5]

Anwar, Md Nishat, and Somnath Pan, "A frequency response model matching method for PID controller design for
processes with dead-time,"ISA transactions, Vol. 55, pp. 175-187, 2015.

Ganguly, Somnath, Chandan Kumar Shiva, and V. Mukherjee. "Frequency stabilization of isolated and grid
connected hybrid power system models," Journal of Energy Storage, Vol. 19, pp. 145-159, 2018.

Rajesh, K. S., and S. S. Dash. "Load frequency control of autonomous power system using adaptive fuzzy based
PID controller optimized on improved sine cosine algorithm,” Journal of Ambient Intelligence and Humanized
Computing, Vol. 10, no. 6, pp. 2361-2373, 2019.

Wang, Huan, et al. "Design of a Fractional Order Frequency PID Controller for an Islanded Microgrid: A Multi-
Objective Extremal Optimization Method,” Energies, Vol. 10, 1502, 2017.

Tomonobu Senjyu, et al, “A Hybrid Power System Using Alternative Energy Facilities in Isolated Island,” IEEE
Transactions on Energy Conversion, Vol. 20, No. 2, pp. 406-414, June 2005.

Control of hybrid power system based renewable energy generations using PID ... (Mohamed Regad)
1784 O ISSN: 2088-8694

[6] M.Regad, M. Helaimi, R. Taleb, H. A. Gabbar and A. M. Othman, "Fractional Order PID Control of Hybrid
Power System with Renewable Generation Using Genetic Algorithm," 2019 IEEE 7th International Conference on
Smart Energy Grid Engineering (SEGE), Oshawa, ON, Canada, pp. 139-144, 2019.

[7] I. Pan and S. Das, “Kriging based surrogate modeling for fractional-order control of microgrids,” Smart Grid, IEEE
Transactions on, vol. 6, no. 1, pp. 36-44, 2015

[8] Lee, Dong-Jing; Wang, Li, “Small-signal stability analysis of an autonomous hybrid renewable energy power
generation/energy storage system part I: Time-domain simulations,” IEEE Transactions on Energy Conversion,
2008, 23.1: 311-320.

[9] Regad, M., et al. "Optimum Synthesis of the PID Controller Parameters for Frequency Control in Microgrid Based
Renewable Generations,” International Conference in Artificial Intelligence in Renewable Energetic Systems.
Springer, Cham, 2019.

[10] DAS, Dulal Ch; Roy, A. K.; Sinha, N, “GA based frequency controller for solar thermal—diesel—wind hybrid
energy generation/energy storage system’, International Journal of Electrical Power & Energy Systems, Vol. 43,
No. 1, pp. 262-279, 2012.

[11] Regad, M., et al. "Frequency Control in Microgrid Power System with Renewable Power Generation Using PID
Controller Based on Particle Swarm Optimization,” International Conference in Artificial Intelligence in
Renewable Energetic Systems. Springer, Cham, 2019.

[12] M. Willjuice Iruthayarajan, S. Baskar, “Evolutionary algorithms based design of multivariable PID controller,”
Expert Systems with Applications, Vol. 36, No. 5, pp. 9159-9167, 2009.

[13] Ranjan, Sudhanshu, et al. "LFC for Autonomous Hybrid Micro Grid System of 3 Unequal Renewable Areas using
Mine Blast Algorithm,” International Journal of Renewable Energy Research (IJRER), Vol. 8, No. 3, pp. 1297-
1308, 2018.

[14] Shankar, G., and V. Mukherjee. "Load frequency control of an autonomous hybrid power system by quasi-
oppositional harmony search algorithm,” International Journal of Electrical Power & Energy Systems, Vol. 78, pp.
715-734, 2016.

[15] Kamble, Rajesh, et al. "Optimal sizing of Battery Energy Storage System in Microgrid by using Particle Swarm
Optimization Technique,” Journal of Integrated Science and Technology, vol. 6, no. 1 pp. 6-12, 2018.

[16] Shayanfar, H. A., H. Shayeghi, and S. Asefi2 A. Younesi. "Design of Optimal PID Controller Using Jaya
Algorithm for Frequency Stabilizing in an Isolated Wind-Diesel System,” 12th International Conference on
Technical and Physical Problems of Electrical Engineering, 2016.

[17] Bouzid, Allal M., et al. "A survey on control of electric power distributed generation systems for microgrid
applications,” Renewable and Sustainable Energy Reviews, Vol. 44, pp. 751-766, 2015.

[18] Regad Mohamed, et al. "Frequency Control of Microgrid with Renewable Generation using PID Controller based
Krill Herd,” Indonesian Journal of Electrical Engineering and Informatics (IJEEI), Vol. 8, No. 1, pp. 21-32., 2020.

[19] Gandomi, Amir Hossein, and Amir Hossein Alavi. "Krill herd: a new bio-inspired optimization algorithm,”
Communications in Nonlinear Science and Numerical Simulation, Vol. 17, No. 12, pp. 4831-4845, 2012.

[20] Elsherbiny, Aya M., Adel S. Nada, and Mohammed Kamal Ahmed. "Smooth transition from grid to standalone
solar diesel mode hybrid generation system with a battery,” International Journal of Power Electronics and Drive
Systems (IJPEDS), Vol. 10, No. 4, pp. 2065-2075, 2019.

[21] Lihong Guo et all “A new improved Krill Herd algorithm for global numerical optimization,” Neurocomputing
Vol. 138, pp. 392-402, 2014.

[22] Lal, Deepak Kumar, Ajit Kumar Barisal, and M. Tripathy. "Load frequency control of multi area interconnected
microgrid power system using grasshopper optimization algorithm optimized fuzzy PID controller,” 2018 Recent
Advances on Engineering, Technology and Computational Sciences (RAETCS), pp. 1-6. IEEE, 2018.

[23] Sen, Sachidananda, and Vishal Kumar. "Microgrid modelling: A comprehensive survey,” Annual Reviews in
Control, 2018.

[24] Regad, Mohamed, et al. "Optimal frequency control in microgrid system using fractional order PID controller
using Krill Herd algorithm,” D2exmpomexuuka u a1eKmpomexanuxka 2 (eng), 2020.

[25] Regad, Mohamed, et al. "Frequency Control of Microgrid with Renewable Generation using PID Controller based
Krill Herd,” Indonesian Journal of Electrical Engineering and Informatics (IJEEI), Vol. 8, No. 1, pp. 21-32, 2020.

Int J Pow Elec & Dri Syst, Vol. 11, No. 4, December 2020 : 1775 — 1784
