Kim et al. EURASIP Journal on Advances in Signal Processing (2020) 2020:30 FU RAS |p J ourna | on Adva nces
https://doi.org/10.1186/s13634-020-00690-7 . Sj | Process . ng
in Signa

RESEARCH Open Access

Ensemble patch transformation: a ®
flexible framework for decomposition and ~
filtering of signal

Donghoh Kim!, Guebin Choi? and Hee-Seok Oh?”

 

 

*Correspondence:
heeseok@stats.snu.ac.kr Abstract

>Department of Statistics, Seoul . . . ws . . .
National University, 1 Gwanak-ro, This paper considers the problem of signal decomposition and filtering by extending
08826 Seoul, Korea its scope to various signals that cannot be effectively dealt with existing methods. For
Full list of author information is the core of our methodology, we introduce a new approach, termed “ensemble patch
available at the end of the article . oy ; we ; ;
transformation” that provides a framework for decomposition and filtering of signals;
thus, as a result, it enhances identification of local characteristics embedded in a signal

that is crucial for signal decomposition and designs flexible filters that allow various

data analyses. In literature, there are some data-adaptive decomposition methods such
as empirical mode decomposition (EMD) by Huang (Proc. R. Soc. London A
454:903-995, 1998). Along the same line of EMD, we propose a new decomposition
algorithm that extracts essential components from a signal. Some theoretical
properties of the proposed algorithm are investigated. To evaluate the proposed
method, we analyze several synthetic examples and real signals.

Keywords: Decomposition, Ensemble filter, Extraction, Iteration, Multiscale method

 

1 Introduction
In this paper, we propose a new method for decomposition and filtering of signals, termed
“ensemble patch transformation, which adopts a multiscale concept of scale-space theory
in computer vision of [1]. The proposed ensemble patch transformation consists of two
key components. The first one is “patch process” that is defined as a data-dependent patch
of data at a particular time point ¢t. The patch process is designed for identifying local
structures of data according to the sizes of patches. The second concept is “ensemble”
that is obtained by shifting the time point t of the patch, which is suitable for representing
the temporal variation of data efficiently by enhancement of the temporal resolution of
them. Moreover, various statistics obtained from the proposed ensemble patches might
be useful for data analysis.

Successful recognition of the local frequency patterns of a signal is crucial for signal
decomposition. Empirical mode decomposition (EMD) by [2] identifies such local pat-
terns through local extrema. In the case that the local extrema reflect the time-varying

. © The Author(s). 2020 Open Access This article is licensed under a Creative Commons Attribution 4.0 International License,
GQ) Springer O pen which permits use, sharing, adaptation, distribution and reproduction in any medium or format, as long as you give appropriate
— credit to the original author(s) and the source, provide a link to the Creative Commons licence, and indicate if changes were
made. The images or other third party material in this article are included in the article’s Creative Commons licence, unless
indicated otherwise in a credit line to the material. If material is not included in the article’s Creative Commons licence and your
intended use is not permitted by statutory regulation or exceeds the permitted use, you will need to obtain permission directly
from the copyright holder. To view a copy of this licence, visit http://creativecommons.org/licenses/by/4.0/.
Kim et al. EURASIP Journal on Advances in Signal Processing (2020) 2020:30 Page 2 of 27

 

-4 2 0 2 4

 

0.0 0.2 0.4 0.6 0.8 1.0
high-frequency component

-4 -2 0 2 4

 

0.0 0.2 0.4 0.6 0.8 1.0
low-frequency component

4-20 2 4

 

0.0 0.2 0.4 0.6 0.8 1.0

 

 

Fig. 1 A signal of two components, X; = cos(100zt) + 4.cos(60zt)

 

amplitude and frequency, EMD decomposes a signal effectively according to its frequen-
cies. However, when the frequency ratio of the two components in a signal is small, EMD
fails to identify a superimposed component; thus, it produces artificial components dur-
ing the decomposition process. To clarify this problem of EMD and provide motivation
for the proposed method, we consider a synthetic signal that consists of two compo-
nents X; = cos(100zt) + 4cos(60zt), t €[ 0,1]. Figure 1 shows signal X; and its two
components.

The middle panel of Fig. 2 illustrates the decomposed results by EMD, where the dotted
lines represent the true components, and the solid lines are the extracted components.
As one can see, EMD fails to decompose the two components of the signal, where the
frequency ratio of the two components is relatively small. In other words, when the local
pattern of the high-frequency component is not distinct, EMD does not work correctly to
decompose such a signal; hence, it fails to extract the sinusoid components effectively.

We remark that Rilling and Flandrin [3] discussed the ranges of frequency and ampli-
tude ratios when EMD performs. On the other hand, the left panel of Fig. 2 presents the
decomposition results by the proposed method in Section 3, which identifies the true
components efficiently. The right panel shows the decomposition results by ensemble
EMD (EEMD) of [4], which cannot extract the true ones properly.

 

EPT EMD EEMD
high-frequency component high-frequency component high-frequency component

 

0.0 0.2 0.4 0.6 0.8 1.0 0.0 0.2 0.4 0.6 0.8 1.0 0.0 0.2 0.4 0.6 0.8 1.0
low-frequency component low-frequency component low-frequency component

 

 

  

Fig. 2 Decompositions of signal X; = cos(100zt) + 4 cos(60z t)

 

 

 
Kim et al. EURASIP Journal on Advances in Signal Processing (2020) 2020:30 Page 3 of 27

The main contribution of our study is described as follows. The two procedures, patch
process and ensemble process, are capable of providing a framework that generates var-
ious filters for decomposition, including some existing filters. Through the filter design
reflecting the characteristics of data, the proposed method provides a flexible tool for
analyzing signals. Hence, it extends the scope of signal decomposition to a broad class
of signals that cannot be dealt with some conventional methods. Specifically, as dis-
cussed later in Section 4, the proposed method can identify special features embedded in
the signal, such as sudden changes, seasonalities, and amplitude modulation terms that
are not readily obtainable in conventional ways. The rest of the paper is organized as
follows. Section 2 introduces ensemble patch transformation and investigates its utility
for multiscale analysis. In addition, various statistical measures based on the ensemble
patch transformation are discussed for data analysis. In Section 3, a new method for
signal decomposition is proposed with a practical algorithm. Furthermore, some theoret-
ical properties of the proposed algorithm are investigated. Section 4 presents simulation
studies and real data examples to evaluate the empirical performance of the proposed
method. In Section 5, as a practical issue of the proposed method, the selection of the size
parameter is discussed. Lastly, conclusions are addressed in Section 6.

We remark that in literature, there are numerous studies for signal decomposition.
Dragomiretskiy and Zosso [5] developed variational mode decomposition (VMD) for
tone detection and separation of a signal. VMD first conducts discrete Fourier transform
for detecting frequency information of each mode and then identifies several meaningful
modes using the main detected frequencies. For this procedure, it is required to preset
the number of modes for the decomposition. However, it is difficult to know the number
of meaningful modes according to their frequency information in advance. As a data-
adaptive procedure, Huang et al. [2] proposed empirical mode decomposition (EMD).
Due to its robustness to the presence of nonlinearity and nonstationarity, EMD has been
applied to various fields. Since EMD is based on an empirical algorithm, it raises several
methodological issues such as identification of local frequency patterns and intermit-
tency. There have been many proposals to enhance the performance of the conventional
EMD. Wu and Huang [4] developed the ensemble EMD (EEMD), taking an average of
EMD decompositions of noisy copies of the signal, and several authors have proposed its
variants. These include the complementary ensemble EMD of [6], the complete ensemble
EMD with the adaptive noise (CEEMDAN) of [7], and the improved complete ensemble
EMD of [8]. Daubechies et al. [9] proposed an alternative method of EMD, termed, syn-
chrosqueezed wavelet transforms, which is based on reassignment methods of wavelet
coefficients. Thakur et al. [10] discussed a selection method of various parameters in the
discrete version, and Thakur and Wu [11] and Meignen et al. [12] proposed some methods

that are robust to non-uniform samples and noise via synchrosqueezing techniques.

2 Ensemble patch transform

2.1 Multiscale patch transform

In this section, we introduce a multiscale patch transform of a one-dimensional sequence
that is designed for data processing and signal decomposition. We first define a patch pro-
cess of a real-valued univariate process (X;),. A patch for observation (t, X;) is a polygon
containing neighbors of (t, X;). A patch is a tool capturing local characteristics of a signal.
The size of the patch controls the degree of localization, and various shapes of the patch
Kim et al. EURASIP Journal on Advances in Signal Processing (2020) 2020:30 Page 4 of 27

can be employed according to the purpose of data analysis. The patch is formally defined
by its shape and size. Let 7 = {t;}; be a set of size parameters for a patch with a cer-
tain shape such as rectangle and oval. For t € 7, let P (Xz) denote the patch process for
observation (¢, X;) that is generated by a certain shape with size parameter t. We further
define a multiscale patch transform MP7 (X;) for observation (tf, X;) as a sequence of all
patches according to different T;’s,

MP} (X;) = {Pr (Xe) } 4 yess IT |"

As one can see, the precise definition of MP7 (Xz) depends on the shape of the patch. As
for the typical case, rectangle and oval are considered. Of course, we can take other shapes
as well.

Rectangle patch: For a given point (t,X;) and t € 7, this patch is centered
at the point (¢, X;) and is a closed rectangle formed by the points (¢ + k, minge[—r/2,1/2]
{Xr+k} — 0.5yT) and (¢ + k, maxe[—r/2,r/2] {Xr+k} + 0.5yT) for k €[ —t/2, 1/2]. For the
rectangle patch, the width is t and hight i; is

Me ep jay Pee) — UD Xtal HYD
where y is a scale factor.

Oval patch: For a given point (¢, X;) and t € 7, this patch is centered at the point (¢, X;)
and is characterized by boundaries (« +k, Xpsk + y/P/4—R), k €[ —t/2, t/2] where
y is a scale factor. The width for the oval patch is t as for the rectangle patch, and the
height is of decreasing pattern as moving away from a given point (¢, X;).

For an illustration of the patch process, we consider a deterministic signal X; =
25 cos(0.1zt) cos(zt), O < t < 10. We then obtain a sequence [X,} with ¢; = iT
and sampling rate J = 1/10 from the continuous signal X;. Figure 3 shows rectan-
gle patches P; (X;) of the sequence {Xz; } that are respectively performed at certain time
points ¢t; = 4,5,6 marked by red dots. We consider three different size parameters
t = 4,8, 12 for generating patches, and obtain a multiscale patch MP7 (X;) by combining
the three patches in Fig. 3a—c. Figure 4 shows patches in the entire time domain with the
parameters t = 2 and 4, respectively.

From Figs. 3 and 4 and the definitions, the patch at a particular time point ¢ is an object
that contains multiple observations around the time point f; thus, for further statistical
analysis, it is necessary to use some statistics that summarize informations of P; (X;) and
MP? (X;). For this purpose, we consider a measure KC (PF (X;)) that produces a single
statistic at time point t. Some possible measures K(-) are twofold: one is for central ten-
dency and the other is for dispersion. As measures for central tendency, in this study,
we present the following two measures. Suppose that we obtain the patch Pf (X;) for a
fixed T.

e Ave; (X;) = average ({X:,}), where {X;; } denote observations in the patch Pf (X;).
e Mi (X%) = (Lt (X;) + Uf (Xt)), where L; (X;) and U; (X;) denote lower and upper
envelopes of the patch P; (X;), respectively. M; (X;) is mean envelope. The lower

envelope L; (X;) and upper envelope U/ (X;) of the rectangle patch are

c( ‘) ke[—1t/2,1/2] , K|
ur X;)= max XxX. + 0.5yT,
f (Xe) ke[—1t/2,1/2] , K|
Kim et al. EURASIP Journal on Advances in Signal Processing (2020) 2020:30 Page 5 of 27

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

0 2 4 6 8 10
(b)
0 2 4 6 8 10
(c)
0 2 4 6 8 10
Fig. 3 Patches with rectangle shape P? (X;) of signal X; = 25 cos(0.17t) cos(at) at center points of the
patches, tj = 4,5,6.at =4,b7t =8,andet = 12

 

 

 

respectively. L; (X;) and U/ (X;) of the oval patch are

Li (Xt) — min {Xeak —¥V 72/4 — kl,
2

e€[—1/2,t
U(X) = max |Xne ty Vr /4—R},
ke[—t/2,t/2]

respectively.
For dispersion measure, we consider the followings

e sd_(Xt) = / Var({Xz,}), where {X;,} denote observations in the patch P; (X;).
@ Ri (Xt) = UF (Xt) — L; (Xz), which represents the envelope range.

Figure 5 shows Ave; (X;) and sd; (Xz) with size parameters t = 8,32,64 for a noisy
signal X; = 25cos(0.17t) cos(zt) + o€;, where 0 = 1.8 and e; denote i.i.d. standard
Gaussian random variables. As the value of size parameter Tt increases, a central measure
Ave; (X;) is getting smoother with representing the global trend of the observations. On
the other hand, the values of sd; (Xz) at both boundaries are large, and sd; (X;) becomes
larger as T increases since a large patch contains more observations. Further, it seems
that sd; (X;) by t = 64 is capable of identifying the temporal variability of the signal well.
The derivations of statistics are not limited in the above definitions, which can be further
defined by other measures such as trimmed mean and median absolute deviation of the
patch Pi (Xz).

2.2 Ensemble patch transform
To improve the temporal resolution of the patch and its measures, we introduce an

ensemble patch process of a real-valued univariate process (X;);.
Kim et al. EURASIP Journal on Advances in Signal Processing (2020) 2020:30 Page 6 of 27

 

fon

EY

Nat

ro,
yM,
hreee casita
‘nae

 

Fig. 4 Patches with rectangle shape P? (X;) of signal X; = 25 cos(0.17t) cos(wt),0 <t < 10.at =2andb
T=4

 

 

 

Definition 1 Let (X;); be a real-valued univariate process. Let ‘J denote a set of size
parameters for the patch. For any t € T, the €th shifted patch at time point t is defined as
Pry (Xt), € €[ -1/2, 1/2]. Then, a fixed t € T, a collection of all possible shifted patches
at time point t is defined as ensemble patch,

EP? (X;) := {Pry ¢(Xt) : € €[-1/2, 7/2] }.

 

10 30

-10

 

-30

(b)

 

 

0 2 4 6 8 10

 

Fig. 5 a Noisy sequence (open circles), true function (black line), Ave; (Xr) by t = 8 (red line), t = 32 (green
line), 7 = 64 (blue line), and b sd; (X;) by t = 8 (red line), t = 32 (green line), t = 64 (blue line)

 

 

 
Kim et al. EURASIP Journal on Advances in Signal Processing (2020) 2020:30 Page 7 of 27

Finally, as a dictionary, the multiscale ensemble patch process is defined the sequence of

all sets of EP; (Xt) over various T’s as

MEP? (Xz) = {EPI (X:):1 € T}.

For the sequence {X;,} in Fig. 3, we generate ensemble rectangle patches at the time
points t; = 4,5, 6 according to size parameters t = 4, 8, 12, which are displayed in Fig. 6.
A multiscale ensemble patch MEP (X;) is obtained by combining the three ensemble
patches in Fig. 6a—c.

Similarly, for further data analysis, we consider some statistics of ensemble patch
EP? (Xz). We first consider a measure of each shifted patch K(P; ,¢(Xz)) and then obtain

an ensemble measure by averaging K(P; ,¢(Xz))'s over €’s in [—t/2,t/2]. More specif-

ically, we obtain the following ensemble measures for central tendency and dispersion:
for a fixed t, suppose that we obtain the collection of all shifted patches at time point f,
EP; (X;) of the patch PF (X;).

e EAve; (X;) = average (Ave; 40 (X2)) over ¢’s, where Ave; ,(Xz) denotes the simple

average of observations in the shifted patch P¢ 4 ¢(Xt).

e EM; (Xz) = average (Mi, (X2)) over £’s, where Mie

Li+ (Xt) and U/, (Xz) that are lower and upper envelopes of the patch Pr, ,(X:).

(X;) denotes the average of

e Esd; (Xz) = average (sd7 i, (X2)) over ¢’s, where sd; ,(Xz) denotes the standard

deviation of observations in the shifted patch P¢ 4 ¢(Xt).

e ER; (Xt) = average (Rip (X;)) over ¢’s, where Ry. (Xt) = Up, p (Xt) — Ley p(X).

 

10 20

 

 

 

 

 

 

 

 

 

 

 

0

 

 

 

 

 

 

 

 

 

-20

 

(b)

 

 

 

 

 

 

 

 

10 20

 

 

 

 

 

0

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

10 20

0

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

-20

 

 

 

 

 

 

0 2 4 6 8 10

Fig. 6 Ensemble patches with rectangle shape FP (X;) of signal Xr = 25 cos(0.17t) cos(rt) at center points,
t=—45,6.atT=4,bt =8,andet=12

 

 

 
Kim et al. EURASIP Journal on Advances in Signal Processing (2020) 2020:30 Page 8 of 27

 

 

 

(b)

 

15 20

10

0 2 4 6 8 10

Fig. 7 a Noisy sequence (open circles), true function (black line), EAve; (X;) by t = 8 (red line), t = 32 (green
line), 7 = 64 (blue line), and b Esd; (X;) by t = 8 (red line), t = 32 (green line), t = 64 (blue line)

 

 

 

 

We obtain some measures based on ensemble patches of the noisy signal in Fig. 5,
EAve; (X;) and Esd; (Xz) with size parameters t = 8,32,64, which are shown in Fig. 7.
As the value of t increases, the central measure EAve; (X;) is getting smoother, and the
dispersion measure Esd; (X;) becomes more significant with having relatively large val-
ues at both boundaries. Furthermore, by comparison of the ensemble results with the
single patch results in Fig. 5, we have some observations: (a) the central measure by
ensemble patches represents the temporal trend of the underlying function well, com-
pared to that by single patches. (b) The dispersion measure with large t by ensemble
patches identifies a local variability of the underlying function efficiently. (c) The tempo-
ral resolution of both measures by ensemble patches is much more delicate than those of
single patches.

We remark that ensemble patches are able to obtain various statistics that are adapted
for data analysis. For example, as an alternative central measure, we can consider
the median for each patch P/ 4¢(Xt), say Med; ,¢(Xt) and the corresponding mean of
Med; 4o(Xz) over £, EMed; (Xz). These measures are closely related to filters for decom-
position in Section 3. Moreover, the difference between rectangle and oval patches is
not significant. It is only noticeable when considering envelopes L; (Xt) and U/ (Xz). The
mean envelope M; (Xt) obtained by the rectangle patch represents a stair-shaped curve
and is undesirable for smoothing. The oval patch, on the other hand, can be useful in cap-
turing the central tendency of the data because the resulting curve is smoother. However,
it is necessary to capture the sudden change in data as shown in Fig. 22 later. In this case,
the rectangle patch is more useful than the oval patch.

Finally, the thick-pen transformation by [13] is a special case of the above MEP] (Xz)

with Ly, ,(Xz) and Uf, ,(Xz) at the shifting index £ = 0.
Kim et al. EURASIP Journal on Advances in Signal Processing (2020) 2020:30 Page 9 of 27

 

 

>

0 1

 

0.35 0.40 0.45 0.50 0.55

Fig. 8 Ensemble mean envelope for a signal X;

 

 

 

3 Methods

3.1 Ensemble patch filtering

When a signal consists of several components with their own frequencies, ensemble patch
transformation can be utilized as a low-pass or a high-pass filter. Figure 8 illustrates the
filtering process of the ensemble mean envelope. The top panel shows a sinusoidal signal
Xt = cos(50rt) + cos(10mt) + 2¢ (t €[0.35,0.55] ) and depicts three shifted rectangle
patches covering a point X; (open circle) at ¢ = 0.45. Each th shifted patch produces
upper and lower envelopes U/, ,(Xz) and L;, ,(X¢) at time point ¢. The black dots denote
the average values of data in M7, ,(X;) at time point f = 0.45 for the shifted patches a,
b, and c. Similarly, with shifting the patch over the entire time domain, we construct a
mean envelope from each shifted patch process. The bottom panel of Fig. 8 shows three
mean envelopes (dotted line), respectively. We note that, although we use only three
shifted mean envelops for illustration purposes, the possible number of shifted mean
envelopes for a given point is the same as the size parameter t of the patch in general.
Furthermore, we take an ensemble average of those mean envelopes, which results in
the ensemble mean envelope marked by the solid line. It seems that the ensemble mean
envelope represents a lower frequency component of the signal.

For demonstrating the utility of this ensemble approach, we consider a synthetic
example. Figure 9 shows a signal X; = cos(50zrt) + cos(10zt) + 2t (¢ €[0,1]) in white
color and its ensemble patch transformation with size parameters tT = 20, 40, 80, 120,
200, and 240, respectively. The lower and upper envelopes EL; (X;), EU; (X;) and the
mean envelope EM; (X;) are obtained by the ensemble approach. The area covered by
two envelopes is colored in gray, and the mean envelope is denoted by the solid line. We
observe that with size parameter tT = 40, the ensemble mean envelope suppresses a high-
frequency component cos(50zrt). When the size parameter T is larger than 200, both the
oscillating patterns of components cos(50zt) and cos(10zt) are painted over by patch
transformation. As the value of t increases, the ensemble mean envelope tends to sup-
press the oscillating local pattern and represents the lower-frequency pattern at the same
time. The ensemble mean envelope removes the frequency pattern whose period is less
Kim et al. EURASIP Journal on Advances in Signal Processing (2020) 2020:30 Page 10 of 27

 

t=20 t=120

 

 

 

 

 

 

 

 

 

 

 

Fig.9 EM? (X;)'s of signal X; according to different ts

 

than t. By controlling the size parameter, the mean envelope EM; (X;) of the ensemble
patch transformation is used as a low-pass filter or high-pass filter.

We further perform the same experiment with measure EAve; (X;) that is average of
Ave; ,(Xz) obtained from ensemble patches. The results EAve; (X;) (solid line) with dif-
ferent tT = 20, 40, 80, 120, 200, and 240 are displayed in Fig. 10. As one can see, the results
are almost identical to those of EM; (X;) in Fig. 9.

3.2 Decomposition by ensemble patch filtering

By using the above notion of filters, we would like to decompose a signal into a high-
frequency component and a low-frequency residue component. We consider a signal
Xt = cos(90rt) + cos(107t), t €[ 0,1], shown in Fig. 11.

 

 

 

 

 

 

0.0 0.2 0.4 0.6 0.8 1.0 0.0 0.2 04 0.6 0.8 1.0

Fig. 10 EAve; (X;)'s of signal X; according to different ts

Ne S

 

 
Kim et al. EURASIP Journal on Advances in Signal Processing (2020) 2020:30 Page 11 of 27

 

 

0.0 0.2 0.4 0.6 0.8 1.0
high-frequency component

0.0 O05 1.0

 

-1.0

0.0 0.2 0.4 0.6 0.8 1.0
low-frequency component

0.0 05 1.0

 

-1.0

0.0 0.2 0.4 0.6 0.8 1.0

Fig. 11 A signal X; = cos(90mt) + cos(10zt) and its two components

 

 

 

A snapshot of the decomposition procedure by ensemble patch filtering is displayed
in Fig. 12. From top to down and left to right panels, the first panel illustrates a low-
frequency mode, say, LF; that is an ensemble mean envelope of EP; (X;) for a given t, and
the corresponding high-frequency mode HF; = X — LF, in the next panel. As one can see,
there still exists apparent low-frequency mode in HF. The third panel shows an ensemble
mean envelope of HF}, say, LF2, which seemingly identifies the low-frequency mode of
HF; in the second panel. A new high-frequency mode HF) = HF, — LFy = X — LF, — LF»
is now obtained. In the next iteration, a further ensemble mean envelope of HF», say, LF3
is almost constant; hence, the corresponding high-frequency mode HF3 = HF, — LF =
X — LF, — LF) — LF3 represents the true high-frequency component well. An iterative
procedure is required, which is along with the line of the sifting process of EMD.

From the above discussion, we propose a practical decomposition algorithm based on

ensemble patch filtering. Let Gj (X;) be a generic central measure of {P¢ ,o(Xt)}e, where

 

LF, = mean envelope of X HF, = X-LF,

0.5
0.5

-0.5 0.0
-0.5 0.0

  

-1.0
-1.0

0.0 0.2 04 0.6 0.8 1.0 0.0 0.2 0.4 0.6 0.8 1.0
LF, = mean envelope of HF, HF» = HF, -LF,

0.5
0.5

-0.5 0.0
-0.5 0.0

 

 

  

-1.0
-1.0

0.0 0.2 0.4 0.6 0.8 1.0 0.0 0.2 04 0.6 0.8 1.0
LF3 = mean envelope of HF2 HF3 = HF2—LF;

0.5

-0.5 0.0

 

 

   

-1.0

0.0 0.2 0.4 0.6 0.8 1.0 0.0 0.2 0.4 0.6 0.8 1.0

Fig. 12 Iterative decomposition procedure

 

 

 
Kim et al. EURASIP Journal on Advances in Signal Processing (2020) 2020:30 Page 12 of 27

Pi (Xe) is the ¢th shifted patch at time ¢ for a given t. Suppose that a signal X; consists

of a high-frequency component /; and a low-frequency component g; as X; = hy + g;.

1. Obtain an initial component ji = X;— GF (Xz).
2. Iterate, until convergence, the following step fork = 0,1,...,

i = it — 95 (if).

3. Take the converged estimate as the extracted component for /1;.

We have some remarks regarding the aforementioned algorithm. (a) Choice of G/: it
is feasible to use various choices of G/, including some central measures introduced in
Section 2.2, which is the main benefit of utilizing ensemble patch transformation. (b)
Choice of t: the size parameter t corresponds to a period in the time domain. Thus, the
parameter T plays a crucial role in the quality of the extracted low-frequency component.
A selection method of t will be discussed later.

We now discuss a convergence property of the above algorithm under some conditions.

Theorem 1 Suppose that we observe a real-valued sequence (X;); from a model

X, = kt + gy where {hry}, t € MR is a periodic sequence with hr = ht+1
and Io” hy = 0, and g is a signal such that |Gjo)| = 0, @ € Qy =
\@ :O= ak + 2nz, for allk =1,...,71) —landn € z} and G(w) denotes Fourier trans-

form of g;. Then, for a given to, we obtain that ni — hy ask — ow, where pir) =

hi) — EAvey (A{") and h® = X, — EAve,(X;).

Proof EAve;°(X;) can be expressed as EAve,°(X;) = @;° * 6;° * X;, where ¢;° is a

rectangular (boxcar) function defined as

1
T __ To’ [Z| < °
, 0, otherwise.
Let &;° = ¢;° « ,°. Then hi can be written as hi = (5; — &;°)** « X;, where 6, denotes

Kronecker delta function and u** = u*u*---* u denotes convolution power. In addi-
a

k
tion, H(@) = FES} = (sinc(tgw/2))*. Thus, it follows that 0 < 1— E(w) < 1 for
w ¢ Q,,. Furthermore, from the assumption of |G(w)| = 0 for w € Q,,, we conclude that
la — E%(q))* G(w)| > Oask > ~. OO

We now extend the above result with a general filter beyond the double average filter
EAve; (Xt) .

Definition 2 Let X; be a continuous-time signal. For any t, an iterative representation of
X, with filter M is defined as IR; (Xz, M) := limg_s R” (X;, M), where IR” (X;,M) =
IR (X,, M) + M(X; — IR“) (X;, M)) and IR\ (X;, M) = MX;. Furthermore, X; is
said to be (iteratively) representable with filter M if IR;(Xt, M) = Xz for all t.

We note that if X; = MX; for all ¢, then X; is (iteratively) representable with filter M.
Kim et al. EURASIP Journal on Advances in Signal Processing (2020) 2020:30 Page 13 of 27

Definition 3 Let X; denotes a continuous-time signal. Suppose that X; consists of two
components as X; = hy + g& for all t. The component h; is said to be cancelable from X;

with filter M if MX; = Mg; for all t.

Theorem 2 Let X; denotes a continuous-time signal. Suppose that X, consists of two
components as X; = hy + & for all t. Assume that (a) g is (iteratively) representable
with filter M, and (b) hy is cancelable from X, with filter M. Then, it follows that
X¢ — IR(Xt, M) = hy, for all t.

A proof is directly obtained by the above definitions.

Lemma 1 Let X; denotes a continuous-time signal. Suppose that |G(w)| = Oforw € Qy,
where G(w) is the Fourier transform of X;. Define the filter M as MX; = EAve;°(X;).
Then, X; is (iteratively) representable with filter M.

A proof of Lemma 1 is easily obtained from proof of Theorem 1; hence, we omit it.

Suppose that X; consists of two components as X; = J; + g. If M is a linear filter such
that Mh; = 0, then h; is cancelable from X; with filter MM. Thus, we obtain the following
result that extends the convergence property of Lemma 1 with MX; = EAve;°(X;) to a
general linear filter M under some conditions.

Corollary 1 Let X; be a continuous-time signal. Suppose that X; consists of two com-
ponents as X, = hy + g& for all t. Define the filter M as MX, = EAve;° (X;). Assume
that

(a) |G(@)| = 0 forw € Q,,, where G(w) is the Fourier transform of gy.
(b) hy satisfies hy = hy+7) and pan h,dt = 0.

Then, it follows that X; — IR;(Xt, M) = hy for all t.

As for a final remark, we consider a simple example related to designing an ideal filter
that provides the strength of our method. To simplify our discussion, suppose that we
observed a discrete signal such that X; = )),-7 X16(t — i). Suppose that X; consists two
component /; and gj, ie., X; = hj; + gj, where component h; satisfies hj = hji3 and
a h; = 0, and g; is a component whose value suddenly changes from —1 to 1 at i = 0
as in Table 1.

We define the filter Mas MX; = EAve;° (X;),T = 3. Note that component /;; is cance-
lable from X; with filter /, but component g; cannot be (iteratively) representable with
filter M since |G(w)| > 0 for some w € \@ :oO= ouk + 2nz, for all k= 1,2 andn € NI,
where G(w) is the Fourier transform of g;. Thus, it is not able to obtain 4; from the iter-
ative procedure X; — IR;(X;, M), because the filters of the moving average class are not
suitable for expressing data with a sharp mean change such as gj. It is generally known
that data with such a sharp mean change can be easily represented by a median filter

Table 1 Component {g;} of a signal X} = hj + gj, with hj = hj+3 and a hj =0
i Lae —3 —2 — ] 0 ] 2 3
di a — | — | — | 1 1 1 1

 

 

 
Kim et al. EURASIP Journal on Advances in Signal Processing (2020) 2020:30 Page 14 of 27

[14]. In particular, the component g; used in the example is a root signal since it does
not change even if it passes through the median filter repeatedly. Hence, the convergence
property is ensured. In summary, the average filter of Ave; (X;) is advantageous to can-
cel h;, but it cannot represent g; properly. On the other hand, median filter of Med; (Xz)
is not capable of canceling 4;, but is useful for expressing gj. However, a combination
of both filters might lead to desired decomposition results, which is feasible under the
ensemble patch transform framework, not just patch transform one. It is a benefit of the
proposed transformation combining the patch process and the ensemble process. We
now consider a composite filter /* constructed by an average filter of patch process
and a median filter of ensemble process, that is, M*X; = median (Ave;? e (Xi) ,T7 = 3.
Due to the property of the linear filter and the condition v4 h; = 0, it follows that
Aves? ,(X;) = Ave;j? (hi) + Ave; ,(gi) = Ave;?,
ponents /; and g;, and cancels h;. In the example, the value of Ave; (gi) for each € is

(gi). So, this filter separates two com-

listed in Table 2. Then, by passing the median filter as the second filter, we obtain a signal
{ wey -l,- i — i 1,... \, which completely represents component g; except i € {—1, 0}.
An iterative calculation of IR” (X;, M*) (k => 1) provides the result in Table 2. In the

example, note the difference of convergence by the filter J and M*. As the iteration
(k)

progresses with k — oo, the iterative procedure X; — IR; ’ (Xi, M) does not converge to

component {h;} at all, while X; — IR” (X;, M*) converges to component h; on Z \ {—1, 0}.

4 Results and discussion

In this section, we conduct a numerical study with various examples to assess the
practical performance of the proposed method, which is implemented by the algo-
rithm in Section 3.2. In this numerical study, we compare the proposed decomposition
method with EMD, EEMD, and CEEMDAN and various types of filters are designed
for the analysis reflecting the characteristics of a given signal. The R statistical package,
EPT, used to implement the methods and to carry out some experiments are avail-
able at https://CRAN.R-project.org/package=EPT in order that one can reproduce the

same results.

Table 2 An iterative calculation of in (X;, M*) for a signal X; of Table 1

 

 

a ee 0 1 2. 3
é=-1 a —4 Pt

Avei? (Xi) €=0 1-10 8 1 Pod
é=1 re 1 1 1 4

IR\? (X;, MA*) = median (Ave®,(X)) «ws 20 1-1 8 1 1] 1
X; — IR‘ (X;, M*) 3 hep he 2 to +20 Oh
é=-1 0 0 —4 0 0 ¢ 0

Ave? .(X; — IRt? (Xi, M*)  € = 0 (0 -2 0 0 2 0 0
e=1 =e 0 0 5 0 oO 0

Me? (X; — IR\? (Xi, M*) (0 0 0 0 0 Oo 0
IR (X;, M*) 2-1-1 =-4 i 1 1 1
IR? (X;, M*) 2 =-1 <-1 -=# I 14 1

IR\(X;, MA*) ne ST AT HG - 14

 
Kim et al. EURASIP Journal on Advances in Signal Processing (2020) 2020:30

 

00 O05 1.0

 

-1.0

0.0 0.2 0.4 0.6 0.8 1.0
piecewise high-frequency component

0.0 05 1.0

 

-1.0

0.0 0.2 0.4 0.6 0.8 1.0
piecewise low-frequency component

0.0 05 1.0

 

-1.0

0.0 0.2 0.4 0.6 0.8 1.0

 

 

Fig. 13 Test signal X; = cos(90mt)/(t < 0.5) + cos(10mtyl(t > 0.5) and its two piecewise components

 

4.1 Decomposition of non-stationary piecewise signal

We consider a non-stationary piecewise signal that consists of a low-frequency com-
ponent and a high-frequency component piecewisely defined as X; = cos(90mt)I(t <
0.5) + cos(10mt)I(t > 0.5), ¢ €[0, 1]. Figure 13 shows 1000 equally spaced signal on [0, 1].
Huang et al. [2, 15] pointed out that EMD fails to decompose a signal with mode mix-
ing, which means that different modes of oscillations coexist in a single intrinsic mode
function (IMF).

On the other hand, the proposed method is capable of locally suppressing the high-
frequency mode whose period is less than some size parameter. The dotted line and solid
line in Fig. 14 represent the true components and extracted components by each method,
respectively. From the results, we observe that the proposed method outperforms EMD,
EEMD, and CEEMDAN. Here, we use the median(Ave; ,¢(Xz)) as a central measure and
the size parameter t = 21 for our method.

4.2 Decomposition of noisy signal

We evaluate the robustness of the proposed decomposition to noise signals. We generate
a noisy signal X; = cos(90zt) + cos(107t) + €;, where €, denote Gaussian errors with
signal-to-noise ratio 7. The decomposition results by the proposed method, EMD, EEMD,
and CEEMDAN are shown in Fig. 15. As one can see, EMD is sensitive to noises. The
effect of non-informative fluctuation distorts the subsequent decomposition results of

 

EPT EMD EEMD CEEMDAN
piecewise high-frequency component high-frequency component high-frequency component high-frequency component
sisraaliedtaiaile

   

05 1.0

   

-1.0 -0.5 00 05 1.0

 

-10 -05 00 05 1.0
-10 -05 00 05 1.0

-1.0 -0.5 0.0

0.0 0.2 0.4 0.6 08 1.0 0.0 0.2 0.4 0.6 0.8 1.0 0.0 0.2 0.4 0.6 0.8 1.0 0.0 0.2 0.4 0.6 0.8 1.0
piecewise low-frequency component low-frequency component low-frequency component low-frequency component

   

05 1.0

 

 

-10 -05 00 05 1.0
1

 

-10 -05 00 O05 1.0

 

-1.0 -0.5 00 05 1.0

 

-1.0 -0.5 0.0

0.0 0.2 0.4 0.6 0.8 1.0 0 200 400 600 800 1000 0.0 0.2 0.4 0.6 0.8 1.0 0.0 0.2 0.4 0.6 0.8 1.0

Fig. 14 Decompositions of test signal X; = cos(90mt)l(t < 0.5) + cos(10mt)l(t > 0.5) by the proposed
method, EMD, EEMD, and CEEMDAN

 

 

 

Page 15 of 27
Kim et al. EURASIP Journal on Advances in Signal Processing (2020) 2020:30 Page 16 of 27

 

EPT
noise

EEMD CEEMDAN
noise noise

pt

| |

De

pt
|

De
|

 

 

0.0 0.2 0.4 0.6 0.8 1.0
high-frequency component

0.0 0.2 0.4 0.6 0.8 1.0

0.0 0.2 0.4 0.6 0.8 1.0 0.0 0.2 0.4 0.6 0.8 1.0
high-frequency component high-frequency component

-2 -1 #0 1 2
-2 -1 =#0 1 2
-2 -1 #0 1 2

   

0.0 0.2 0.4 0.6 0.8 1.0 0.0 0.2 0.4 0.6 0.8 1.0

low-frequency component

low-frequency component low-frequency component

 

 

2 -1 0 14 2
2 -1 0 4 2
2 -1 0 14 2
2 -1 0 4 2

 

 

 

 

      

Fig. 15 Decompositions of noisy signal X; + €:, X; = cos(90mt) + cos(10zmt) by the proposed method, EMD,
EEMD, and CEEMDAN

 

 

 

EMD, which is due to the interpolation process in the construction of envelopes based on
local extrema.

On the other hand, the proposed method is robust to the noises since the decomposi-
tion is processed without the identification of fluctuations. The decomposition results in
Fig. 15 support this fact. If we regard noise as fluctuation with the highest frequency, the
proposed method with relatively small t might separate a noise term from a signal. By
taking the size parameter t = 10, a noisy signal is decomposed as the highest component
of noise and the low-frequency residue component, which corresponds to a signal X;.
The low-frequency residue component is repeatedly decomposed with the size parameter
Tt = 21. For central measure, the ensemble average EAve; is used for the noisy signal. We
notice that EEMD and CEEMDAN work well for the decomposition of the noisy signal.

4.3 Analysis of beat signal

Suppose that we have a signal X; = Jy, + g@ := cos(62mt) + cos(58zt), where the
frequencies of /; and g; are very close. A signal composed of two components with sim-
ilar frequencies generates a beat signal, as shown Fig. l6a. It turns out that ;; and g;
can be separated by X; — R” (X;,M) and IR” (X;,M), where MX; = EAve;° (Xz)
and t) = 29 is the period of the component g;. Clearly, rR” (X;,M) — g and thus,
X, — IR (X;, M) > hy as k > co by Theorem 1. Figure 16b—d show X; — IR (X;, M)
for k = 10, 200, 500 and e represents R” (X;, M) with k = 500. We observe that the two
components are separated with a sufficiently large k.

The decomposition results may be meaningful, but they are not practical because it
requires too many iterations to extract the desired signal.

For a different look of the beat signal, we consider a signal, as shown in Fig. 17a, which
can be interpreted as multiplying the signal cos(60zt) by the amplitude modulating term
2 cos(27 ft), i.e., X; = cos(627t)+cos(58rt) = 2 cos(27t) cos(60z7 t). Figure 17b and c dis-
play the frequency component and amplitude modulation of X;, respectively. Figure 17d
shows the upper and lower envelopes of the ensemble patch transform and indicates that
the ensemble envelope range ER; with size parameter t = 30 holds information of the
amplitude modulation. The absolute value of amplitude modulation 2 cos(27t) marked
by the solid line of Fig. 17e is well approximated by ER; /2 marked by the dashed line
Kim et al. EURASIP Journal on Advances in Signal Processing (2020) 2020:30 Page 17 of 27

 

(a) beat signal

0.0 0.2 0.4 0.6 0.8 1.0
(b) high-frequency component after 10 iter

 

0.0 0.2 0.4 0.6 0.8 1.0
(c) high-frequency component after 200 iter

 

0.0 0.2 0.4 0.6 0.8 1.0
(d) high-frequency component after 500 iter

 

0.0 0.2 0.4 0.6 0.8 1.0
(e) low-frequency component after 500 iter

 

0.0 0.2 0.4 0.6 0.8 1.0

 

Fig. 16 Decomposition results of beat signal with an additive model

 

 

of Fig. 17e. Note that when the amplitude modulation 2 cos(27t) is close to zero, the
approximation is not appropriate. If signal X; is filtered by the approximated absolute
amplitude modulation as Ft as shown in Fig. 17f, additional information for amplitude
modulation can be obtained.

Figure 18a shows the upper and lower envelopes of the ensemble patch transform for
the filtered signal. By multiplying the ensemble envelope range (Fig. 18b) for the filtered
signal with the ensemble envelope range (Fig. 18c) at the first stage, the approximation
can be improved. See the dashed line of Fig. 18d. The approximation is significantly
improved, where the amplitude modulation 2 cos(27t) is close to zero. Therefore, the
ensemble patch transform can be applied to deduce the information about the ampli-
tude modulation, where the amplitude information is mixed with frequency information.
There is some restriction such that the amplitude modulating component should be pos-
itive. However, despite this constraint, the above filtering method is practically applicable
since the amplitude-modulated component of a real-world signal can be positive. See the

analysis of the solar radiation below.
Kim et al. EURASIP Journal on Advances in Signal Processing (2020) 2020:30 Page 18 of 27

 

 

 

 

 

(a) amplitude modulation signal
N
oO
N
I
0 200 400 600 800
(b) frequency component
°
°
oO
°
Y
0 200 400 600 800
(c) amplitude modulation
N
oO
N
I
0 200 400 600 800
(d) upper and lower envelopes of ensemble patch transform
N
oO
N
I
°
N
°
2
oO
0 200 400 600 800
(f) frequency component filtred by envelope distance of ensemble patch transform
o
°
oO
9
.
0 200 400 600 800
Fig. 17 Extraction of amplitude modulation

 

 

 

4.4 Analysis of solar radiation data

In this example, we analyze the solar radiation data that were hourly observed at three
cities in South Korea, Seoul, Daegu, and Busan during September 2003, which are
shown in Fig. 19. The data are available from the Korea Meteorological Administration
(https://data.kma.go.kr). Daegu and Busan, located in the southeast part of the Korean
Peninsula, are close to each other geographically, whereas Seoul is located in the middle
of the Peninsula. Besides, Daegu and Busan were severely damaged by a typhoon named
“MAEMI" in September 2003, while Seoul was hardly affected by the typhoon.

Table 3(a) lists the results of correlations among solar radiation observed at Seoul,
Daegu, and Busan. However, contrary to the usual expectation, the results are very similar
since the daily effect dominates the time series of solar radiation. The solar radiation data
can be interpreted as a multiplication form of the periodic component and the amplitude-
modulating component. It is required to separate the periodic pattern and the amplitude
modulation for a better understanding of the climatic similarity among the three cities.

To reveal the effects of interest, we eliminate the daily effect by using the upper enve-
lope EU; (-) with t = 24. The dashed lines of Fig. 19 represent the upper envelopes of
Kim et al. EURASIP Journal on Advances in Signal Processing (2020) 2020:30 Page 19 of 27

 

(a) frequency component filtred by envelope distance of ensemble patch transform

00 O58 1.0

-0.5

 

-1.0

0 200 400 600 800
(b) envelope distance of ensemble patch transform at the second stage

1.5 2.0

1.0

0.5

 

0.0

0 200 400 600 800
(c) envelope distance of ensemble patch transform at the first stage

1.5 2.0

1.0

0.5

 

0.0

0 200 400 600 800
(d) absolute value of amplitude modulation and envelope distance of ensemble patch transform

1.5 2.0

1.0

0.5

 

0.0

0 200 400 600 800

 

 

Fig. 18 Iterative extraction of amplitude modulation

 

solar radiation data extracted by the proposed method. It seems that the dominant daily
effects are successfully removed. For further evaluation, we compute correlations among
the upper envelopes of solar radiation data listed in Table 3(b). As one can see, the corre-
lations of Seoul-Daegu and Seoul—Busan have been decreased dramatically compared to
the correlations before the transform. Thus, Daegu and Busan have similar climatic char-
acteristics, and Seoul seems to be different from the other two cities, which is consistent
with our intuition.

We remark that the data in this example can be considered as a typical multiplicative
model. However, the log transformation that is the most popular technique for dealing
with the multiplicative model is not suitable for this example. The main reason is that
about half of the data has zero value, as shown in Fig. 19, since there is no solar radiation
during the night. On the other hand, the proposed UU (-) filter does not suffer from this
problem. Of course, it is feasible to use a log transform by adding a small value «€ like
10~1° to the data; however, it makes the daily effect stronger. The log transformation

is a technique that suppresses the amplitude modulating effects rather than extracting
Kim et al. EURASIP Journal on Advances in Signal Processing (2020) 2020:30 Page 20 of 27

 

 

 

 

(a) solar-radiation in Seoul and upper envelope of ensemble patch transform
°
oO
oO
N
°
°
oO
12 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30
(b) solar-radiation in Daegu and upper envelope of ensemble patch transform
oO
0
oO
N
°
oO
S
12 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30
(c) solar-radiation in Busan and upper envelope of ensemble patch transform
°
oD
o
N
°
°
oO
12 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30
Fig. 19 Solar radiation data in Seoul, Daegu, and Busan in September 2003

 

 

 

them; hence, it is not appropriate when one is interested in amplitude-modulation signals
themselves.

4.5 Analysis of electricity data

We analyze the US electricity production data recorded monthly from January 1973 to
December 2005, which can be obtained from R package TSA. The electricity data seem to
have a global trend and a seasonal component. A typical approach to analyzing such data
consists of two-step: stabilize the variance of the time series through a transform such as a
log transform and extract seasonality. We now interpret the electricity signal as a product
of the periodic component and the amplitude-modulated component and decompose the
data in the following order: stabilizing the volatility of data by inferring the amplitude-
modulated component and then removing the seasonal component by using the double
average filter MX; = EAve; (X;).

Table 3 Correlation of solar radiations between Seoul, Daegu, and Busan

 

 

 

Seoul Daegu Busan
(a) Correlation before transform
Seoul 1 0.7997 0.7638
Daegu 0.7997 1 0.8843
Busan 0.7638 0.8843 1
(b) Correlation after transform
Seoul 1 0.3595 0.3374
Daegu 0.3595 1 0.6511

Busan 0.3374 0.6511 ]

 
Kim et al. EURASIP Journal on Advances in Signal Processing (2020) 2020:30 Page 21 of 27

 

(a) electricity production

100000

0

 

-100000

1973 1975 1977 1979 1981 1983 1985 1987 1989 1991 1993 1995 1997 1999 2001 2003 2005
(b) stabilized electricity production

1973 1975 1977 1979 1981 1983 1985 1987 1989 1991 1993 1995 1997 1999 2001 2003 2005
(c) seasonal pattern

0.4

0.0

 

-0.4

1973. 1975 1977 1979 1981 1983 1985 1987 1989 1991 1993 1995 1997 1999 2001 2003 2005
(d) trend

-05 0.5

-1.5

-2.5

1973 1975 1977 1979 1981 1983 1985 1987 1989 1991 1993 1995 1997 1999 2001 2003 2005

 

 

Fig. 20 Decomposition of electricity data by EPT

 

Figure 20a shows the upper envelope EU (X;) and the lower envelope EL; (X;), and
Fig. 20b shows X; := ERE)’ which seemingly stabilizes the volatility of X;, where
ER; (Xt) = EU; (Xt) — EL; (Xz). We now decompose the trend and the seasonality of X; by
taking a double average filter MX; = EAve; (X) with t = 12. The trend and the season-
ality are effectively separated, as displayed in Fig. 20c and d. For comparison, two IMFs
decomposed by EMD are illustrated in Fig. 21, and the cyclic pattern of seasonality is not
clear.

We remark that the above signal X; can be considered as a multiplicative model rather
than an additive model [16]. From the above result, our proposed method is not limited
to an additive model. In other words, the proposed EPT method can be applicable to the

decomposition method for both additive and multiplicative models.

4.6 Analysis of Airmile data

Here, we analyze monthly airline passenger-mile data in the USA from January 1996 to
May 2005 of [17] in Fig. 22a. The data show a strong seasonality with holiday effects, and
these are increasing linearly overall with an intervention in September 2001 and several
months thereafter due to the terrorist acts on September 11, 2001.
Kim et al. EURASIP Journal on Advances in Signal Processing (2020) 2020:30 Page 22 of 27

 

(a) imf1

40000

 

 

oO
oO
oO
oO
oO
v a
1973 1976 1979 1982 1985 1988 1991 1994 1997 2000 2003 2006
(b) imf2
oO
oO
oO
oO
N
oO
oO
oO
oO
oO
N

 

1973 1976 1979 1982 1985 1988 1991 1994 1997 2000 2003 2006
Fig. 21 Decomposition of electricity data by EMD

 

 

 

For extracting the periodic components in the data, we design a new filter LX; :=
max (Li 40 (X2)) over ¢s in [| —t/2, t/2] that can be considered as another lower envelope of
X;. We note that the signal part expressed by the sum of the increasing trend and several
abrupt changes with positive jump sizes can be representable with filter £. The dashed
line in Fig. 22a represents the realization of filter £ with t = 12. Figure 22b shows the
extracted signal X, = X; — LX;, which removes the trend and several abrupt changes
successfully; however, the amplitudes of the extracted periodic signal are slightly differ-
ent over pulses. To further remove the amplitude modulated component, the only thing
to do is getting the upper envelope of X, ie., EU;(X;) and then dividing X by it because
EU;(Xt) = ER;(X;) due to EL;(X;) = 0 in this case. The upper envelope of X; is repre-

sented by the dashed line in Fig. 22b. Finally, we obtain the stabilized periodic signal, i.e.,
Xt
EU;(X1)
components in Fig. 22d and e, respectively. Figure 23 shows the two IMFs by EMD for Air-

 

in Fig. 22c, and, by further decomposition of the signal, the seasonal and annual

mile data. Since the abrupt changes are scattered across IMFs, the decomposition results
are distorted, and the periodic patterns are not separated effectively.

5 Selection of size parameter

Here, we discuss the selection method of size parameter t for ensemble patch transfor-
mation. First of all, in some cases, we can choose the appropriate t based on known facts
about data and analysis purposes. For example, the choice of t = 24 in Section 4.4 to
observe solar radiation data per hour and check the daily effect is simple and natural.
Sections 4.5 and 4.6 analyze the seasonal effects of monthly data, sot = 12 can bea
reasonable choice.

For estimation of the size parameter t from observations, we propose two selection
methods. One is performed in a priori way, and the other is based on a posterior infor-
mation of the decomposition. The size parameter t corresponds to a period in the time
domain. When a priori information of the periodic pattern of a signal is available, a selec-
tion of the size parameter can be conducted based on the distribution of periodic patterns.
Such information can be obtained through the empirical periods of distances between
Kim et al. EURASIP Journal on Advances in Signal Processing (2020) 2020:30 Page 23 of 27

 

 

 

 

 

(a) airmile data and lower envelope
BR
oO
+
oO
Ww
+
NR
oO
+
o
o
o
1996 1997 1998 1999 2000 2001 2002 2003 2004 2005
(b) detrended airmile data and new envelopes
S
+
o
N
oO
oO
+
oO
o
oO
oO
oO
+
oO
°
° 1996 1997 1998 1999 2000 2001 2002 2003 2004 2005
(c) stabilizing detrended airmile data
oO
9
oO
©
oO
x
oO
N
oO
oO
S
1996 1997 1998 1999 2000 2001 2002 2003 2004 2005
(d) seasonal pattern
N
oO
oO
S
N
oO
I
x
oO
I
1996 1997 1998 1999 2000 2001 2002 2003 2004 2005
(e) a year pattern
©
S
©
oO
x
oO
N
oO
oO
S
1996 1997 1998 1999 2000 2001 2002 2003 2004 2005
Fig. 22 Decomposition of Airmile data by EPT

 

 

 

local maxima (or local minima). Note that the empirical period is expressed by the num-
ber of observations between local maxima, not by the distance of the real-time. To sum

up, the proposed priori method can be described as follows.
(i
(ii

(iii

Find local maxima (or local minima) of the signal.
Obtain empirical periods of distances between local maxima.
Estimate the distribution of empirical periods.

hReYwy CN Srl  erll Nh”

(iv) Select t as the dominated period of the estimated distribution.
Figure 24 shows the distribution of empirical periods for a signal X; = cos(90mt) +
cos(10zt) and its high-frequency component cos(90zrt), where the high frequency pat-

tern is apparent in signal X;. It seems that the dominated period is 21, which is set to
Kim et al. EURASIP Journal on Advances in Signal Processing (2020) 2020:30 Page 24 of 27

 

(a) imf1

5e+06

 

—5e+06

 

1996 1997 1998 1999 2000 2001 2002 §=2003 2004 2005

(b) imf2

5e+06

—5e+06

 

1996 1997 1998 1999 2000 2001 2002 2003 2004 #2005
Fig. 23 Decomposition of Airmile data by EMD

 

 

 

be our estimated parameter, T = 21. The decomposition results of Figs. 14 and 15 in
Section 4 are based on this selection method.

In the case that the frequency ratio of components composing a signal falls below a
certain range, the local pattern of the high-frequency component may not be distinct;
thus, the above selection method based on empirical periods is not appropriate. From the
results in Fig. 2, we observe that the proposed method might separate two components
according to the frequencies. Nevertheless, the components should be weakly correlated
to each other unless they are orthogonal. Hence, for the posterior method, we use correla-
tion information between two components extracted by ensemble patch transformation.
That is, through the grid search in a certain range of the size parameter, the size parame-
ter t is selected, having the minimum correlation between the decomposed components.
Figure 25 shows the sample correlations between the extracted components for the sig-
nal X; = cos(100zt) + 4cos(60zt) in Fig. 2 over a range of t, which produces tT = 19.
The decomposition result of Fig. 2 is obtained through the ensemble average for the oval
patch with size parameter 19.

We remark that through extensive experiments, we observe that our method is some-
what robust to the selection of size parameters. Suppose that we decompose the signal

 

 

 

 

 

 

 

 

 

test signal X high-frequency component, cos(90zt)

So q

© | ©

oO oO

~ | +

oO oO

N N

oO oO

° oO

co 1 OY |

20 21 22 23 24 20 21 22 23 24

Fig. 24 The distribution of the empirical period for a signal X; = cos(90m t) + cos(10zt) and its component
cos(90z ft)

 

 

 
Kim et al. EURASIP Journal on Advances in Signal Processing

(2020) 2020:30

 

0.10 0.15

0.05

 

0.00

16 17 18 19 20 21 22

Fig. 25 Correlation between decomposed components of test signal X; = cos(100mt) + 4cos(60zt) over a
range of t

 

 

 

Xt = cos(90r t) + cos(10zt) into two components by the proposed method with a range
of t = 18 to 23. Figure 26 shows the differences between the extracted high-frequency
component and the true component cos(90zt) over the range of t. As one can see, the
results are robust to the choice of the size parameter Tt value.

Finally, the proposed selection methods of the parameter t lack theoretical justifica-
tion. An objective way with theoretical backup might improve the performance and the
practicality of the proposed method. This topic is left for future study.

6 Conclusion

In this paper, we have introduced a new transformation technique, termed “ensemble
patch transformation” for signal decomposition and data analysis. We have presented a
practical algorithm for the implementation of the proposed method with some theoret-
ical properties. The empirical performance of the proposed method has been evaluated

throughout several numerical experiments and real-world signal analysis. Results from

 

0.5
0.5

-0.5 0.0
-0.5 0.0

   

-1.0
-1.0

0.5
0.5

-0.5 0.0
-0.5 0.0

 

 

   

-1.0
-1.0

0.5
0.5

-0.5 0.0
-0.5 0.0

 

 

   

-1.0
-1.0

Fig. 26 Differences of true component cos(90z t) and decomposed high-frequency component of test
signal X; = cos(90zt) + cos(10zt) according to size parameter Tt

 

 

 

Page 25 of 27
Kim et al. EURASIP Journal on Advances in Signal Processing (2020) 2020:30 Page 26 of 27

these experiments illustrate that the proposed method possesses promising empirical
properties.

We remark that the purpose of signal decomposition is to construct the target signal X;
as a combination of components that can be interpreted or understood. However, even
when a component of a given signal can be perceived, its separation from the signal is
not trivial, which is the motivation for developing the ensemble patch transform. The
tools provided by the ensemble patch transform requires the filter design, as shown for
analyzing signals in Sections 4.3—4.6. Once a proper filter is designed, this “discomfort”
guarantees extreme degrees of freedom for analyzing a signal.

Finally, the proposed transformation holds inherently multiscale features due to the size
parameter of t, which serves to control the size of patches. That is, the size parameter
of the patch acts as the scale parameter of multiscale features. The scale-space concept
might provide a view-point on visualization of data, which considers a family of represen-
tations of data indexed by the scale parameter instead of the conventional dot-connected
plot. This topic are reserved for future research.

Abbreviations

CEEMDAN : Complete ensemble empirical mode decomposition with adaptive noise; EMD: Empirical mode
decomposition; EEMD: Ensemble empirical mode decomposition; EPT: Ensemble patch transform; VMD: variational
mode decomposition

Acknowledgements
Not applicable.

Authors’ contributions
DK and GC performed the experiments, analyzed the data, and interpreted the results. HSO contributed in developing
the proposed method. All authors wrote, read, and approved the final manuscript.

Funding
This research was supported by Basic Science Research Program through the National Research Foundation of Korea
(NRF) funded by the Ministry of Education (2016R1D1A1B03930463 and 2018R1D1A1B07042933).

Availability of data and materials
The R statistical package, EPT, used to implement the methods and to carry out some experiments are available at
https://CRAN.R- project.org/package=EPT in order that one can reproduce the same results.

Competing interests
The authors declare that they have no competing interests.

Author details

'Department of Mathematics and Statistics, Sejong University, 209 Neungdong-ro, 05006 Seoul, Korea. Artificial
Intelligence Lab, LG Electronics Inc, 38 Baumoe-ro, 06763 Seoul, Korea. 7 Department of Statistics, Seoul National
University, 1 Gwanak-ro, 08826 Seoul, Korea.

Received: 22 November 2019 Accepted: 8 June 2020
Published online: 26 June 2020

References

1. T. Lindeberg, Scale-space theory in computer vision. (Springer Science & Business Media, New York, 1994)

2. N.E. Huang, Z. Shen, S.R. Long, M. C. Wu, H. H. Shih, Q. Zheng, N. C. Yen, C. C. Tung, H. H. Liu, The empirical mode
decomposition and Hilbert spectrum for nonlinear and nonstationary time series analysis. Proc. R. Soc. London A.
454, 903-995 (1998)

3. GRilling, P. Flandrin, One or two frequencies? The empirical mode decomposition answers. IEEE Trans. Signal
Process. 56, 85-95 (2008)

4. Z.Wu,N.E. Huang, Ensemble empirical mode decomposition: a noise assisted data analysis method. Adv. Adapt.
Data Anal. 1, 1-41 (2009)

5. K.Dragomiretskiy, D. Zosso, Variational mode decomposition. IEEE Trans. Signal Process. 62, 531-544 (2014)

6. J.R. Yeh, J.S. Shieh, N. E. Huang, Complementary ensemble empirical mode decomposition: a novel noise enhanced
data analysis method. Adv. Adapt. Data Anal. 2, 135-156 (2010)

7. M.E. Torres, M. A. Colominas, G. Schlotthauer, P. Flandrin, A complete ensemble empirical mode decomposition
with adaptive noise. Proc. IEEE Int. Conf. Acoust. Speech Sig. Process (ICASSP), 4144-4147 (2011)

8. M.A. Colominas, G. Schlotthauer, M. E. Torres, Improved complete ensemble EMD: a suitable tool for biomedical
signal processing. Biomed. Signal Proc. Control. 14, 19-29 (2014)
Kim et al. EURASIP Journal on Advances in Signal Processing (2020) 2020:30 Page 27 of 27

9. |. Daubechies, J. Lu, H. T. Wu, Synchrosqueezed wavelet transforms: an empirical mode decomposition-like tool.
Appl. Comput. Harmon. Anal. 30, 243-261 (2011)

10. G. Thakur, E. Brevdo, N. S. Fuckar, H.-T. Wu, The synchrosqueezing algorithm for time-varying spectral analysis:
robustness properties and new paleoclimate applications. Signal Process. 93, 1079-1094 (2013)

11. G. Thakur, H.-T. Wu, Synchrosqueezing-based recovery of instantaneous frequency from nonuniform samples. SIAM
J. Math. Anal. 43, 2078-2095 (2011)

12. S.Meignen, T. Oberlin, S. McLaughlin, A new algorithm for multicomponent signals analysis based on
synchrosqueezing: with an application to signal sampling and denoising. IEEE Trans. Signal Process. 60, 5787-5798
(2012)

13. P. Fryzlewicz, H.-S. Oh, Thick pen transformation for time series. J. R. Stat. Soc. B. 73, 499-529 (2011)

14. N. Gallagher, G. Wise, A theoretical analysis of the properties of median filters. IEEE Trans. Acoust. Speech Signal
Process. 29, 1136-1141 (1981)

15. N.E. Huang, M. C. Wu, S. R. Long, S. Shen, W. Qu, P. Gloerson, K. L. Fan, A confidence limit for the empirical mode
decomposition and Hilbert spectral analysis. Proc. R. Soc. London A. 459, 2317-2345 (2003)

16. A.V. Metcalfe, P. S. Cowpertwait, Introductory time series with R. (Springer-Verlag, New York, 2009)

17. J.D. Cryer, K-S. Chan, Time series analysis with applications in R, Second Edition. (Springer, New York, 2008)

 

Publisher’s Note

Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.

 

Submit your manuscript to a SpringerOpen®
journal and benefit from:

> Convenient online submission

> Rigorous peer review

> Open access: articles freely available online
> High visibility within the field

> Retaining the copyright to your article

Submit your next manuscript at > springeropen.com

 

 

 
